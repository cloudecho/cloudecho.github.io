{"config":{"lang":["ja"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"HOME","text":"<p>DevOps</p> <p>DATABASE</p> <p>FRONTEND</p> <p>Misc</p> <p>BOOKS</p> <p>\u4ece0\u5f00\u59cb\u5b66Dart</p>"},{"location":"BOOKS/2016-02-27-%25e6%2595%258f%25e6%258d%25b7%25e8%25bd%25af%25e4%25bb%25b6%25e5%25bc%2580%25e5%258f%2591%25ef%25bc%259a%25e5%258e%259f%25e5%2588%2599%25e3%2580%2581%25e6%25a8%25a1%25e5%25bc%258f%25e4%25b8%258e%25e5%25ae%259e%25e8%25b7%25b5.html/","title":"\u654f\u6377\u8f6f\u4ef6\u5f00\u53d1\uff1a\u539f\u5219\u3001\u6a21\u5f0f\u4e0e\u5b9e\u8df5","text":"# Book Author Format 1 \u654f\u6377\u8f6f\u4ef6\u5f00\u53d1\uff1a\u539f\u5219\u3001\u6a21\u5f0f\u4e0e\u5b9e\u8df5 Robert C. Martin &amp; Micah Martin epub","tags":["\u654f\u6377","\u56fe\u4e66","\u5b9e\u8df5","\u539f\u5219","\u6a21\u5f0f"]},{"location":"BOOKS/2017-05-07-echo-chenping-sanmao-articles/","title":"\u4e09\u6bdb\u4f5c\u54c1\u96c6","text":"","tags":["\u4e09\u6bdb","sanmao","Echo Chen Ping","\u6587\u96c6","\u4f5c\u54c1\u96c6"]},{"location":"BOOKS/2017-05-07-echo-chenping-sanmao-articles/#_1","title":"\u6587\u96c6","text":"","tags":["\u4e09\u6bdb","sanmao","Echo Chen Ping","\u6587\u96c6","\u4f5c\u54c1\u96c6"]},{"location":"BOOKS/2017-05-07-echo-chenping-sanmao-articles/#_2","title":"\u300a\u54ed\u6ce3\u7684\u9a86\u9a7c\u300b","text":"<p>\u5728\u300a\u54ed\u6ce3\u7684\u9a86\u9a7c\u300b\u4e2d\uff0c\u4e09\u6bdb\u4f9d\u7136\u604b\u604b\u7740\u58a8\u6c99\u6f20\u751f\u6d3b\u5468\u906d\u7684\u4eba\u4e0e\u4e8b\uff0c\u300a\u6536\u9b42\u8bb0\u300b\u3001\u300a\u642d\u8f66\u5ba2\u300b\u3001\u300a\u900d\u9065\u4e03\u5c9b\u6e38\u300b\u3001\u300a\u4e00\u4e2a\u964c\u751f\u4eba\u7684\u6b7b\u300b\u3001\u300a\u5927\u80e1\u5b50\u4e0e\u6211\u300b\u7b49\u7bc7\uff0c\u60c5\u8da3\u76ce\u7136\uff1b\u300a\u6c99\u5df4\u519b\u66f9\u300b\u4e0e\u300a\u54d1\u5974\u300b\u6240\u523b\u753b\u7684\u4e3b\u89d2\uff0c\u7ed9\u4eba\u7559\u4e0b\u4e86\u96be\u4ee5\u78e8\u706d\u7684\u5370\u8c61\uff1b\u800c\u538b\u8f74\u7684\u300a\u54ed\u6ce3\u7684\u9a86\u9a7c\u300b\uff0c\u4ee5\u6e38\u51fb\u6218\u4e8b\u4e3a\u80cc\u666f\uff0c\u7ec6\u7ec6\u94fa\u5199\u4e00\u5bf9\u6c99\u6f20\u60c5\u9e33\u7684\u751f\u6b7b\u76df\uff0c\u7adf\u72b9\u5982\u53f2\u8bd7\u822c\u7684\u78c5\u7934\u3002\u4e09\u6bdb\u4e3a\u8bfb\u8005\u6784\u7b51\u4e86\u4e00\u4e2a\u6709\u6cea\u6709\u7b11\u3001\u6b32\u7f62\u4e0d\u80fd\u7684\u6587\u5b66\u4e16\u754c\u3002</p> <ul> <li>\u5c18\u7f18 \u2014\u2014\u91cd\u65b0\u7684\u7236\u4eb2\u8282\uff08\u4ee3\u5e8f\uff09</li> <li>\u6536\u9b42\u8bb0</li> <li>\u6c99\u5df4\u519b\u66f9</li> <li>\u642d\u8f66\u5ba2</li> <li>\u54ed\u6ce3\u7684\u9a86\u9a7c(1)</li> <li>\u54ed\u6ce3\u7684\u9a86\u9a7c(2)</li> <li>\u900d\u9065\u4e03\u5c9b\u6e38</li> <li>\u4e00\u4e2a\u964c\u751f\u4eba\u7684\u6b7b</li> <li>\u5927\u80e1\u5b50\u4e0e\u6211</li> <li>\u54d1 \u5974</li> </ul>","tags":["\u4e09\u6bdb","sanmao","Echo Chen Ping","\u6587\u96c6","\u4f5c\u54c1\u96c6"]},{"location":"BOOKS/2017-05-07-echo-chenping-sanmao-articles/#_3","title":"\u300a\u95f9\u5b66\u8bb0\u300b","text":"<p>\u5982\u679c\u4f60\u770b\u8fc7\u300a\u96e8\u5b63\u4e0d\u518d\u6765\u300b\u3001\u300a\u6492\u54c8\u62c9\u7684\u6545\u4e8b\u300b\uff0c\u4ee5\u53ca\u300a\u80cc\u5f71\u300b\u8fd9\u4e09\u4e2a\u9636\u6bb5\u7684\u4e09\u6bdb\uff0c\u4f60\u5fc5\u987b\u518d\u770b\u4e00\u672c\u5c5e\u4e8e\u540e\u4e09\u6bdb\u65f6\u671f\u7684\u300a\u95f9\u5b66\u8bb0\u300b\uff0c\u4e09\u6bdb\u4ee5\u6700\u65b0\u7684\u6587\u98ce\u4e0e\u5bf9\u771f\u5b9e\u751f\u6d3b\u7684\u89c1\u8bc1\uff0c\u5411\u4f60\u5c55\u73b0\u4e86\u4e00\u4e2a\u5fc3\u795e\u6cbb\u6109\u7684\u7f8e\u4e3d\u65b0\u4e16\u754c\u3002\u8bfb\u4e66\u548c\u65c5\u884c\uff0c\u662f\u6211\u4e2a\u4eba\u751f\u547d\u4e2d\u7684\u4e24\u9897\u4e00\u7ea7\u661f\uff0c\u5feb\u4e50\u6700\u6df1\u7684\u65f6\u5149\uff0c\u5927\u534a\u90fd\u7531\u8fd9\u4e24\u4ef6\u4e8b\u60c5\u4e2d\u5f97\u6765\u3002</p> <ul> <li>\u5e8f\u4e00\uff1a\u6211\u5bb6\u8001\u4e8c\u2014\u2014\u4e09\u5c0f\u59d0</li> <li>\u5e8f\u4e8c\uff1a\u6211\u6709\u8bdd\u8981\u8bf4</li> <li>\u4f60\u4ece\u54ea\u91cc\u6765</li> <li>\u5982\u679c\u6559\u5ba4\u50cf\u6e38\u4e50\u573a</li> <li>\u6625\u5929\u4e0d\u662f\u8bfb\u4e66\u5929</li> <li>\u6211\u5148\u8d70\u4e86</li> <li>\u8001\u5144\uff0c\u6211\u9192\u7740</li> <li>\u7231\u9a6c\u843d\u6c34\u4e4b\u591c</li> <li>\u6211\u8981\u56de\u5bb6</li> <li>\u6c42 \u5a5a</li> <li>\u5b64\u72ec\u7684\u957f\u8dd1\u8005</li> <li>\u6768\u67f3\u9752\u9752</li> <li>\u7f6a\u5728\u90a3\u91cc</li> <li>\u661f \u77f3</li> <li>\u5409\u5c4b\u51fa\u552e</li> <li>\u968f\u98ce\u800c\u53bb</li> <li>E\u00b7T\u56de\u5bb6</li> <li>\u91cd\u5efa\u5bb6\u56ed</li> <li>\u540e \u8bb0</li> </ul>","tags":["\u4e09\u6bdb","sanmao","Echo Chen Ping","\u6587\u96c6","\u4f5c\u54c1\u96c6"]},{"location":"BOOKS/2017-05-07-echo-chenping-sanmao-articles/#_4","title":"\u300a\u503e\u57ce\u300b","text":"<p>\u5f20\u7231\u73b2\u7684\u503e\u57ce\u4e4b\u604b\u53d1\u751f\u5728\u9999\u6e2f\uff0c\u4e09\u6bdb\u7684\u503e\u57ce\u4e4b\u604b\u5728\u4e1c\u67cf\u6797\u2014\u2014</p> <ul> <li>\u5973\u513f</li> <li>\u963f\u59e8</li> <li>\u6211\u7684\u5c0f\u59d1</li> <li>\u5c0f\u59d1</li> <li>\u6211\u7684\u5c0f\u59d1</li> <li>\u6211\u4e5f\u53eb\u5979\u5c0f\u59d1</li> <li>\u4e00\u5343\u96f6\u4e00\u591c\u7684\u963f\u59e8</li> <li>\u4e09\u6bdb\u2014\u4e00\u4f4d\u8ba4\u771f\u7684\u73a9\u7ae5</li> <li>\u80c6\u5c0f\u9b3c</li> <li>\u5439\u5175</li> <li>\u532a\u5175\u7532\u548c\u532a\u5175\u4e59</li> <li>\u7ea6\u4f1a</li> <li>\u4e00\u751f\u7684\u7231</li> <li>\u7d2b\u8863</li> <li>\u8774\u8776\u7684\u989c\u8272</li> <li>\u8bf4\u7ed9\u81ea\u5df1\u542c</li> <li>\u7231\u548c\u4fe1\u4efb</li> <li>\u7b80\u5355</li> <li>\u4ec0\u4e48\u90fd\u5feb\u4e50</li> <li>\u5929\u4e0b\u672c\u65e0\u4e8b</li> <li>\u8fd8\u7ed9\u8c01</li> <li>\u8f68\u5916\u7684\u65f6\u95f4</li> <li>\u72fc\u6765\u4e86</li> <li>\u4ed6</li> <li>\u4e0d\u8d1f\u6211\u5fc3</li> <li>\u590f\u65e5\u70df\u6101</li> <li>\u503e\u57ce</li> <li>\u8bc4\u300a\u80c6\u5c0f\u9b3c\u300b</li> <li>\u8bfb\u4e09\u6bdb\u7684\u300a\u503e\u57ce\u300b</li> </ul>","tags":["\u4e09\u6bdb","sanmao","Echo Chen Ping","\u6587\u96c6","\u4f5c\u54c1\u96c6"]},{"location":"BOOKS/2017-05-07-echo-chenping-sanmao-articles/#_5","title":"\u300a\u6492\u54c8\u62c9\u7684\u6545\u4e8b\u300b","text":"<p>\u4e09\u6bdb\u4e00\u751f\u77ed\u6682\uff0c\u4f46\u7ecf\u5386\u4e0d\u51e1\u3002\u5728\u4e09\u6bdb\u8fd8\u662f\u4e8c\u6bdb\u7684\u65f6\u5019\uff0c\u8f8d\u5b66\u7684\u5979\u4e00\u5ea6\u81ea\u95ed\u3001\u53db\u9006\uff0c\u6e38\u5b66\u897f\u73ed\u7259\u3001\u5fb7\u56fd\u3001\u7f8e\u56fd\u540e\uff0c\u6e10\u6e10\u6210\u957f\u4e3a\u72ec\u7acb\u81ea\u4fe1\u7684\u9752\u5e74\uff1b\u4e00\u4e5d\u4e03\u56db\u5e74\uff0c\u4e09\u6bdb\u4e0e\u8377\u897f\u5728\u6492\u54c8\u62c9\u6c99\u6f20\u7ed3\u5a5a\uff0c\u767d\u624b\u6210\u5bb6\uff0c\u5979\u7684\u6587\u5b66\u521b\u4f5c\u751f\u6daf\u4ece\u6b64\u5f00\u542f\uff1b\u79fb\u5c45\u52a0\u7eb3\u5229\u7fa4\u5c9b\u540e\uff0c\u4e09\u6bdb\u7684\u751f\u6d3b\u6e10\u8d8b\u5b89\u5b9a\uff0c\u5979\u7684\u521b\u4f5c\u4e5f\u8fbe\u5230\u4e86\u9ad8\u5cf0\uff1b\u4e00\u4e5d\u4e03\u4e5d\u5e74\uff0c\u8377\u897f\u610f\u5916\u53bb\u4e16\uff0c\u4e09\u6bdb\u7684\u5fc3\u7075\u53d7\u5230\u5de8\u5927\u521b\u4f24\uff0c\u4eba\u751f\u9677\u5165\u4f4e\u8c37\uff1b\u8fd4\u53f0\u540e\uff0c\u4e09\u6bdb\u518d\u5ea6\u51fa\u8d70\uff0c\u6e38\u5386\u4e2d\u5357\u7f8e\u6d32\uff0c\u5f00\u59cb\u65b0\u7684\u751f\u6d3b\u3002</p> <ul> <li>\u5988\u5988\u7684\u4e00\u5c01\u4fe1\uff08\u4ee3\u5e8f\uff09</li> <li>\u56de\u4e61\u5c0f\u7b3a\uff08\u56db\u7248\u4ee3\u5e8f\uff09</li> <li>\u6c99\u6f20\u4e2d\u7684\u996d\u5e97</li> <li>\u7ed3\u5a5a\u8bb0</li> <li>\u60ac\u58f6\u6d4e\u4e16</li> <li>\u5a03\u5a03\u65b0\u5a18</li> <li>\u8352\u5c71\u4e4b\u591c</li> <li>\u6c99\u6f20\u89c2\u6d74\u8bb0</li> <li>\u7231\u7684\u5bfb\u6c42</li> <li>\u82b3 \u90bb</li> <li>\u7d20\u4eba\u6e14\u592b</li> <li>\u6b7b\u679c</li> <li>\u5929 \u68af</li> <li>\u767d\u624b\u6210\u5bb6</li> </ul>","tags":["\u4e09\u6bdb","sanmao","Echo Chen Ping","\u6587\u96c6","\u4f5c\u54c1\u96c6"]},{"location":"BOOKS/2017-05-07-echo-chenping-sanmao-articles/#_6","title":"\u300a\u968f\u60f3\u300b","text":"<p>\u5728\u8fd9\u672c\u96c6\u4e09\u6bdb\u534a\u751f\u89c1\u89e3\u3001\u667a\u6167\u7684\u5c0f\u54c1\u91cc\uff0c\u4e09\u6bdb\u5c31\u300a\u5b69\u5b50\u300b\u3001\u300a\u5feb\u4e50\u300b\u3001\u300a\u5c81\u6708\u300b\u3001\u300a\u4f24\u300b\u3001\u300a\u81ea\u5df1\u300b\u3001\u300a\u4e50\u547d\u300b\u3001\u300a\u7537\u4e0e\u5973\u300b\u3001\u300a\u94b1\u94b1\u94b1\u300b\u3001\u300a\u7231\u60c5\u300b\u3001\u300a\u4eba\u300b\u3001\u300a\u65e0\u5fc3\u300b\u3001\u300a\u6709\u610f\u300b\u3001\u300a\u5982\u679c\u300b\u3001\u300a\u670b\u53cb\u300b\u5341\u56db\u9898\uff0c\u968f\u800c\u60f3\u8fd9\u4e86\u4e00\u756a\u3002\u5979\u4e00\u8d2f\u7684\u6587\u5b57\u9b45\u529b\u4e0d\u5728\u8bdd\u4e0b\uff0c\u518d\u63c9\u548c\u5979\u72ec\u5177\u7684\u7279\u6b8a\u5fc3\u7075\uff0c\u7535\u5149\u77f3\u706b\u8ff8\u73b0\u822c\u7684\u5947\u60f3\uff0c\u6bcf\u6bcf\u4e00\u8bfb\uff0c\u4fbf\u6709\u4e00\u79cd\u65b0\u8da3\uff0c\u4eff\u4f5b\u7a0d\u7a0d\u78b0\u89e6\u5230\u5979\u72ec\u7136\u4e16\u754c\u7684\u8fb9\u7f18\u3002</p> <ul> <li>\u5b69\u5b50</li> <li>\u5feb\u4e50</li> <li>\u5c81\u6708</li> <li>\u4f24</li> <li>\u81ea\u5df1</li> <li>\u4e50\u547d</li> <li>\u7537\u4e0e\u5973</li> <li>\u94b1\u94b1\u94b1</li> <li>\u7231\u60c5</li> <li>\u4eba</li> <li>\u6709\u610f</li> <li>\u5982 \u679c</li> <li>\u670b\u53cb</li> </ul>","tags":["\u4e09\u6bdb","sanmao","Echo Chen Ping","\u6587\u96c6","\u4f5c\u54c1\u96c6"]},{"location":"BOOKS/2017-05-07-echo-chenping-sanmao-articles/#_7","title":"\u300a\u4e07\u6c34\u5343\u5c71\u8d70\u904d\u300b","text":"<p>\u5927\u5730\u554a\uff0c\u6211\u6765\u5230\u4f60\u5cb8\u4e0a\u65f6\u539f\u662f\u4e00\u4e2a\u964c\u751f\u4eba\uff0c\u4f4f\u5728\u4f60\u623f\u5b50\u91cc\u65f6\u539f\u662f\u4e00\u4e2a\u65c5\u5ba2\uff0c\u800c\u4eca\u6211\u79bb\u5f00\u4f60\u7684\u95e8\u65f6\u5374\u662f\u4e00\u4e2a\u670b\u53cb\u4e86\u3002\u672c\u5377\u300a\u4e07\u6c34\u5343\u5c71\u8d70\u904d\u300b\u8bb0\u5f55\u4e86\u4e09\u6bdb\u8fd4\u53f0\u540e\uff0c\u518d\u5ea6\u51fa\u8d70\uff0c\u6e38\u5386\u4e2d\u5357\u7f8e\u6d32\u4ee5\u53ca\u9996\u6b21\u56de\u5f52\u6545\u571f\u7684\u65c5\u884c\u89c1\u95fb\uff0c\u5171\u5341\u516b\u7bc7\u3002\u5728\u8377\u897f\u53bb\u4e16\u4e4b\u540e\uff0c\u4e09\u6bdb\u9f13\u8d77\u751f\u6d3b\u7684\u52c7\u6c14\uff0c\u91cd\u65b0\u5f00\u59cb\u4e86\u65b0\u7684\u751f\u6d3b\u3002\u300a\u4e09\u6bdb\u96c6\u300b\u4ee5\u4e09\u6bdb\u7684\u751f\u547d\u5386\u7a0b\u4e3a\u4e3b\u9898\uff0c\u5206\u4e3a\u4e94\u5377\uff1a\u300a\u96e8\u5b63\u4e0d\u518d\u6765\u300b\u300a\u6492\u54c8\u62c9\u7684\u6545\u4e8b\u300b\u300a\u6e29\u67d4\u7684\u591c\u300b\u300a\u68a6\u91cc\u82b1\u843d\u77e5\u591a\u5c11\u300b\u53ca\u300a\u4e07\u6c34\u5343\u5c71\u8d70\u904d\u300b\u3002</p> <ul> <li>\u5927\u8725\u8734\u4e4b\u591c</li> <li>\u8857\u5934\u5df7\u5c3e</li> <li>\u9752\u9e1f\u4e0d\u5230\u7684\u5730\u65b9</li> <li>\u4e2d\u7f8e\u6d32\u7684\u82b1\u56ed</li> <li>\u7f8e\u59ae\u8868\u59b9</li> <li>\u4e00\u4e2a\u4e0d\u6309\u724c\u7406\u51fa\u724c\u7684\u5730\u65b9</li> <li>\u9644\u8bb0\uff1a\u4e00\u5c01\u7ed9\u9093\u5ff5\u6148\u795e\u7236\u7684\u4fe1</li> <li>\u836f\u5e08\u7684\u5b59\u5973\u2014\u524d\u4e16</li> <li>\u94f6\u6e56\u4e4b\u6ee8\u2014\u4eca\u751f</li> <li>\u7d22\u8bfa\u5947\u2014\u2014\u96e8\u539f\u4e4b\u4e00</li> <li>\u591c\u620f\u2014\u96e8\u539f\u4e4b\u4e8c</li> <li>\u8ff7\u57ce\u2014\u96e8\u539f\u4e4b\u4e09</li> <li>\u9003\u6c34\u2014\u96e8\u539f\u4e4b\u56db</li> <li>\u9644\u5f55\u3000\u98de\u8d8a\u7eb3\u65af\u52a0\u4e4b\u7ebf</li> </ul>","tags":["\u4e09\u6bdb","sanmao","Echo Chen Ping","\u6587\u96c6","\u4f5c\u54c1\u96c6"]},{"location":"BOOKS/2017-05-07-echo-chenping-sanmao-articles/#_8","title":"\u300a\u6e29\u67d4\u7684\u591c\u300b","text":"<ul> <li>\u4ed6\u4eec\u8bf4\u4e09\u6bdb\uff08\u5e8f\uff09</li> <li>\u5bc2 \u5730(1)</li> <li>\u5bc2 \u5730(2)</li> <li>\u4e94\u6708\u82b1(1)</li> <li>\u4e94\u6708\u82b1(2)</li> <li>\u739b\u9edb\u62c9\u6e38\u8bb0(1)</li> <li>\u739b\u9edb\u62c9\u6e38\u8bb0(2)</li> <li>\u6e29\u67d4\u7684\u591c</li> <li>\u77f3 \u5934 \u8bb0</li> <li>\u76f8\u9022\u4f55\u5fc5\u66fe\u76f8\u8bc6</li> <li>\u6c38\u8fdc\u7684\u9a6c\u5229\u4e9a</li> <li>\u9644\u5f55\uff1a\u6211\u4e0d\u662f\u4e09\u6bdb\u8ff7</li> </ul>","tags":["\u4e09\u6bdb","sanmao","Echo Chen Ping","\u6587\u96c6","\u4f5c\u54c1\u96c6"]},{"location":"BOOKS/2017-05-07-echo-chenping-sanmao-articles/#_9","title":"\u300a\u8c08\u5fc3\u300b","text":"<ul> <li>\u81ea\u7231\u800c\u4e0d\u81ea\u601c</li> <li>\u795d\u798f\u4e2d\u56fd</li> <li>\u4eba\u751f\u4f55\u5904\u4e0d\u76f8\u9022</li> <li>\u9694\u79bb\u4e0e\u6c9f\u901a</li> <li>\u4e0d\u6ee1\u3001\u4e0d\u6ee1\u3001\u4e0d\u6ee1</li> <li>\u771f\u806a\u660e\u7684\u597d\u5b69\u5b50</li> <li>\u6ca1\u6709\u627e\u5440\uff01</li> <li>\u6559\u4e66\u4e0d\u662f\u5854</li> <li>\u6700\u91cd\u8981\u7684\u662f\u88ab\u7231\u5417\uff1f</li> <li>\u4e3a\u4ec0\u4e48\u3001\u4e3a\u4ec0\u4e48\uff1f</li> <li>\u8bfb\u4e66\u548c\u8ff7\u85cf</li> <li>\u4e0d \u5f03</li> <li>\u4e0d \u9003</li> <li>\u5176\u5b9e\u90fd\u4e0d\u662f\u95ee\u9898</li> <li>\u4e0d\u80fd\u7ed9\u4f60\u5feb\u4e50</li> <li>\u5199\u4f5c\u4e0d\u96be</li> <li>\u6211\u559c\u6b22\u628a\u5feb\u4e50\u5f53\u4f20\u67d3\u75c5</li> <li>\u72f1\u5916\u7684\u5929\u7a7a\u4e5f\u662f\u4f60\u7684</li> <li>\u662f\u7f8e\u5fb7\u8fd8\u662f\u61e6\u5f31</li> <li>\u201c\u559c\u6b22\u201d\u6709\u5343\u4e07\u79cd\u98ce\u8c8c\u4e0e\u8be0\u91ca</li> <li>\u8bfb\u4e66\u4e0d\u80fd\u53ea\u8bfb\u4e00\u4e2a\u6708</li> <li>\u4e94\u4e2a\u5bf9\u8bdd</li> <li>\u5982\u679c\u662f\u6211\u7684\u5973\u513f</li> <li>\u5199\u7ed9\u201c\u6cea\u7b11\u4e09\u5e74\u201d\u7684\u5c11\u5e74</li> <li>\u5982\u679c\u6211\u662f\u4f60</li> <li>\u4e0d\u8981\u4e5f\u7f62</li> <li>\u56de\u4e0d\u51fa\u7684\u4e66\u4fe1</li> <li>\u5c0f\u670b\u53cb\u597d</li> <li>\u4e0d\u4f1a\u5fd8\u8bb0\u4f60\u8981\u7684\u660e\u4fe1\u7247</li> <li>\u5982\u4f55\u6b7b\u5f97\u5176\u6240</li> <li>\u4e0d\u8bb2\u4e86</li> <li>\u8bf4\u670b\u9053\u53cb</li> <li>\u6127\u759a\u611f</li> <li>\u5c11\u5e74\u6101</li> <li>\u540e \u8bb0</li> </ul>","tags":["\u4e09\u6bdb","sanmao","Echo Chen Ping","\u6587\u96c6","\u4f5c\u54c1\u96c6"]},{"location":"BOOKS/2017-05-07-echo-chenping-sanmao-articles/#_10","title":"\u300a\u6211\u7684\u5b9d\u8d1d\u300b","text":"<p>\u770b\u5230\u8fd9\u672c\u4e66\u4e2d\u4e00\u7bc7\u7bc7\u7684\u77ed\u5c0f\u6587\u7ae0\uff0c\u5fc3\u4eff\u4f5b\u5728\u5608\u6742\u7684\u4e16\u754c\u4e2d\u6c89\u9759\u4e0b\u6765\u3002\u4e00\u76f4\u5f88\u8ba8\u538c\u77ed\u7684\u6587\u7ae0\uff0c\u89c9\u5f97\u7d22\u7136\u65e0\u5473\uff0c\u4f46\u5979\u7684\u4e00\u76f4\u662f\u4e2a\u4f8b\u5916\u3002\u770b\u7740\u5979\u7684\u90a3\u4e00\u4e2a\u4e2a\u5b9d\u8d1d\uff0c\u7adf\u6709\u4e00\u80a1\u51b2\u52a8\uff0c\u5e0c\u671b\u5750\u5728\u5979\u7684\u9762\u524d\uff0c\u548c\u5979\u4e00\u8d77\u628a\u73a9\uff0c\u542c\u4ed6\u8bc9\u8bf4\u4e00\u4e2a\u4e2a\u7684\u6545\u4e8b\u3002</p> <ul> <li>\u7f18\u8d77</li> <li>\u672c\u6765\u662f\u4e00\u53cc\u7684</li> <li>\u7b2c\u4e00\u4e2a\u5f69\u9676</li> <li>\u9152\u888b</li> <li>\u5341\u5b57\u67b6</li> <li>\u624b\u4e0a\u7684\u5149\u73af</li> <li>\u7b2c\u4e00\u5f20\u5e8a\u7f69</li> <li>\u5988\u5988\u7684\u5fc3</li> <li>\u522b\u9488</li> <li>\u5fc3\u7231\u7684</li> <li>\u7b2c\u4e00\u4e32\u73ab\u7470\u5ff5\u73e0</li> <li>\u4e0d\u5411\u624b\u5de5\u8bf4\u518d\u89c1</li> <li>\u53cc\u9c7c</li> <li>\u523b\u8fdb\u53bb\u7684\u751f\u547d</li> <li>\u7b2c\u4e00\u6761\u9879\u94fe</li> <li>\u5929\u8863\u65e0\u7f1d</li> <li>\u8001\u522b\u9488</li> <li>\u75f4\u5fc3\u77f3</li> <li>\u7b2c\u4e00\u6b21\u505a\u5c0f\u5b66\u751f</li> <li>\u505c</li> <li>\u9879\u94fe</li> <li>\u7ed3\u5a5a\u793c\u7269</li> <li>\u7b2c\u4e00\u4e2a\u5974\u96b6</li> <li>\u4f60\u7684\u90a3\u53cc\u773c\u775b</li> <li>\u9501</li> <li>\u7b3c\u5b50\u91cc\u7684\u5c0f\u4e11</li> <li>\u7b2c\u4e00\u5339\u767d\u9a6c</li> <li>\u4e61\u6101</li> <li>\u8fd8\u662f\u9501\u4f4f\u4e86</li> <li>\u5c0f\u4e01\u795e\u7236\u7684\u5973\u4eba</li> <li>\u7b2c\u4e00\u5957\u767e\u79d1\u5168\u4e66</li> <li>\u8840\u8c61\u7259</li> <li>\u79cb\u6c34\u4f0a\u4eba</li> <li>\u871c\u6708\u9ebb\u5c06\u724c</li> <li>\u5a03\u5a03\u56fd\u5a03\u5a03\u5175</li> <li>\u4e0d\u7ea6\u5927\u9189\u4fa0</li> <li>\u4e94\u66f4\u706f</li> <li>\u5e7f\u4e1c\u6765\u7684\u8001\u8336\u58f6</li> <li>\u897f\u96c5\u56fe\u7684\u51ac\u5929</li> <li>\u534e\u9676\u7a91</li> <li>\u6797\u59b9\u59b9\u7684\u88d9\u5b50</li> <li>\u963f\u5bcc\u6c57\u4eba\u54c8\u654f\u59bb\u5b50\u7684\u9879\u94fe</li> <li>\u4e9a\u5f53\u548c\u590f\u5a03</li> <li>\u77e5\u97f3</li> <li>\u7172</li> <li>\u5e78\u798f\u7684\u76d8\u5b50</li> <li>\u6211\u8981\u5fc3\u5f62\u7684</li> <li>\u94f6\u5668\u4e00\u5927\u628a</li> <li>\u5341\u4e09\u53ea\u9f99\u867e\u548c\u4f0a\u5730\u65af</li> <li>\u8153\u5c3c\u57fa\u4eba\u7684\u5b9d\u74f6</li> <li>\u5370\u5730\u5b89\u4eba\u7684\u5a03\u5a03</li> <li>\u9f13\u6905</li> <li>\u5b88\u8d22\u5974</li> <li>\u6ca7\u6851</li> <li>\u518d\u770b\u4f60\u4e00\u773c</li> <li>\u963f\u6f58\u7684\u76d8\u5b50</li> <li>\u4ec5\u5b58\u7684\u4e09\u4e2a\u77f3\u50cf</li> <li>\u836f \u74f6</li> <li>\u9057\u7231</li> <li>\u8ba9\u6211\u8bb2\u4e2a\u6545\u4e8b</li> <li>\u5927\u5730\u4e4b\u6bcd</li> <li>\u65e5\u5386\u65e5\u5386\u6302\u5728\u5899\u58c1</li> <li>\u53d7\u96be\u7684\u57fa\u7763</li> <li>\u7cef\u7c73\u6d46\u7897</li> <li>\u725b\u7f8a\u6210\u7fa4</li> <li>\u6211\u656c\u7231\u4f60</li> <li>\u5c0f\u5077\uff0c\u5c0f\u5077</li> <li>\u521d\u89c1\u8305\u5e90</li> <li>\u7ec7\u5e03</li> <li>\uff30\uff25\uff30\uff21\u60c5\u4eba</li> <li>\u6d17\u8138\u76c6</li> <li>\u518d\u8d74\u8305\u5e90</li> <li>\u4e0d\u6253\u53cc\u5934\u86c7</li> <li>\u68a6\u5e7b\u9a91\u58eb</li> <li>\u7f8e\u6d53\u72d7\u7897</li> <li>\u4e09\u987e\u8305\u5e90</li> <li>\u95ea\u70c1\u7684\u5e76\u4e0d\u662f\u91d1\u5b50</li> <li>\u6765\u751f\u518d\u89c1</li> <li>\u64e6\u978b\u7ae5</li> <li>\u5370\u5ea6\u624b\u7ee3</li> <li>\u4e8c\u5341\u4e5d\u9897\u5f69\u77f3</li> <li>\u6a44\u6984\u6811</li> <li>\u5c0f\u8239\uff25\uff23\uff28\uff2f\u53f7</li> <li>\u98de\u9556</li> <li>\u7ea2\u5fc3\u662f\u6211\u7684</li> <li>\u65f6\u95f4\u7684\u53bb\u5904</li> <li>\u90bb\u5c45\u7684\u5f69\u5e03</li> <li>\u540e\u8bb0</li> </ul>","tags":["\u4e09\u6bdb","sanmao","Echo Chen Ping","\u6587\u96c6","\u4f5c\u54c1\u96c6"]},{"location":"BOOKS/2017-05-07-echo-chenping-sanmao-articles/#_11","title":"\u300a\u96e8\u5b63\u4e0d\u518d\u6765\u300b","text":"<p>\u672c\u5377\u300a\u96e8\u5b63\u4e0d\u518d\u6765\u300b\u4ee5\u4e09\u6bdb\u7684\u751f\u547d\u5386\u7a0b\u4e3a\u4e3b\u9898\uff0c\u8bb0\u5f55\u4e86\u4e09\u6bdb17\u5c81\u523022\u5c81\u7684\u6210\u957f\u8fc7\u7a0b\uff0c\u771f\u5b9e\u5448\u73b0\u51fa\u4e09\u6bdb\u5c11\u5973\u65f6\u4ee3\u7684\u6210\u957f\u611f\u53d7\uff0c\u8f8d\u5b66\u3001\u81ea\u95ed\u3001\u53db\u9006\uff0c\u6e38\u5b66\u897f\u73ed\u7259\u3001\u5fb7\u56fd\u3001\u7f8e\u56fd\u540e\uff0c\u6e10\u6e10\u6210\u957f\u4e3a\u72ec\u7acb\u81ea\u4fe1\u7684\u9752\u5e74\uff0c\u672c\u4e66\u4e2d\u900f\u9732\u7684\u7eaf\u771f\u60c5\u6000\u548c\u5f02\u8d28\u7f8e\u611f\uff0c\u53ef\u4ee5\u6e05\u695a\u5730\u5370\u8bc1\u5979\u4f20\u5947\u6027\u683c\u7684\u75d5\u8ff9\u3002</p> <ul> <li>\u5e8f\uff1a\u201c\u82cd\u5f31\u201d\u4e0e\u201c\u5065\u5eb7\u201d</li> <li>\u5f53\u4e09\u6bdb\u8fd8\u662f\u5728\u4e8c\u6bdb\u7684\u65f6\u5019\uff08\u81ea\u5e8f\uff09</li> <li>\u60d1</li> <li>\u79cb \u604b</li> <li>\u6708 \u6cb3</li> <li>\u6781 \u4e50 \u9e1f</li> <li>\u96e8\u5b63\u4e0d\u518d\u6765</li> <li>\u4e00\u4e2a\u661f\u671f\u4e00\u7684\u65e9\u6668</li> <li>\u5b89\u4e1c\u5c3c\u00b7\u6211\u7684\u5b89\u4e1c\u5c3c</li> <li>\u8d74\u6b27\u65c5\u9014\u89c1\u95fb\u5f55</li> <li>\u6211\u4ece\u53f0\u6e7e\u8d77\u98de</li> <li>\u7ffb\u8239\u4eba\u770b\u9ec4\u9e64\u697c</li> <li>\u5e73\u6c99\u6f20\u6f20\u591c\u5e26\u5200</li> <li>\u53bb\u5e74\u7684\u51ac\u5929</li> <li>\u9644\u5f55-\u4e09\u6bdb\u2014\u2014\u5f02\u4e61\u7684\u8d4c\u5f92(\u6842\u6587\u4e9a)</li> <li>\u8bbf\u4e09\u6bdb\u3001\u5199\u4e09\u6bdb</li> <li>\u98de\u2014\u2014\u4e09\u6bdb\u4f5c\u54c1\u7684\u4eca\u6614</li> </ul>","tags":["\u4e09\u6bdb","sanmao","Echo Chen Ping","\u6587\u96c6","\u4f5c\u54c1\u96c6"]},{"location":"BOOKS/2017-05-07-echo-chenping-sanmao-articles/#_12","title":"\u300a\u68a6\u91cc\u82b1\u843d\u77e5\u591a\u5c11\u300b","text":"<p>\u8bfb\u8fd9\u672c\u4e66\u7684\u4eba\uff0c\u4e00\u5b9a\u8981\u6709\u7231\u5fc3\uff0c\u4e00\u9897\u61c2\u611f\u6069\u7684\u5fc3\u3002\u7ffb\u5f00\u4e66\u7684\u6bcf\u4e00\u9875\uff0c\u53bb\u4f53\u4f1a\u4e09\u6bdb\u7684\u7231\u4e0e\u6cea\uff0c\u53bb\u5b66\u4f1a\u73cd\u60dc\u81ea\u5df1\u8eab\u8fb9\u7684\u4eba\u3002</p> <ul> <li>\u4e0d\u6b7b\u9e1f</li> <li>\u660e\u65e5\u53c8\u5929\u6daf</li> <li>\u4e91\u5728\u9752\u5c71\u6708\u5728\u5929</li> <li>\u5f52</li> <li>\u68a6\u91cc\u68a6\u5916</li> <li>\u4e0d\u98de\u7684\u5929\u4f7f</li> <li>\u4f3c\u66fe\u76f8\u8bc6\u71d5\u5f52\u6765</li> <li>\u68a6\u91cc\u82b1\u843d\u77e5\u591a\u5c11</li> <li>\u4e00\u4e2a\u7537\u5b69\u5b50\u7684\u7231\u60c5</li> <li>\u6211\u7684\u5199\u4f5c\u751f\u6d3b</li> <li>\u9a86\u9a7c\u4e3a\u4ec0\u4e48\u8981\u54ed\u6ce3</li> <li>\u5728\u98ce\u91cc\u98d8\u626c\u7684\u5f71\u5b50\u897f\u6c99</li> <li>\u7ae5\u8bdd\u897f\u6c99</li> <li>\u4e24\u6781\u5bf9\u8bdd\u2014\u2014\u6c88\u541b\u5c71\u548c\u4e09\u6bdb</li> </ul>","tags":["\u4e09\u6bdb","sanmao","Echo Chen Ping","\u6587\u96c6","\u4f5c\u54c1\u96c6"]},{"location":"BOOKS/2017-05-07-echo-chenping-sanmao-articles/#_13","title":"\u300a\u9001\u4f60\u4e00\u5339\u9a6c\u300b","text":"<p>\u4e00\u751f\u7231\u9a6c\u75f4\u72c2\uff0c\u5bf9\u65bc\u6211\uff0c\u9a6c\u4ee3\u8868\u8457\u8bb8\u591a\u6df1\u8fdc\u7684\u610f\u4e49\u548c\u5883\u754c\uff0c\u800c\u7260\u53c8\u662f\u4e0d\u6613\u62e5\u6709\u7684\u3002\u9a6c\u7684\u5f62\u4f53\uff0c\u4ea4\u7ec7\u8457\u96c4\u58ee\u3001\u795e\u79d8\u53c8\u540c\u65f6\u6e05\u6717\u7684\u751f\u547d\u4e4b\u6781\u7f8e\u3002\u800c\u4e14\uff0c\u7260\u7684\u51fa\u73b0\u4e8b\u6709\u80cc\u666f\u505a\u886c\u7684\u3002\u6bcf\u60f3\u8d77\u4efb\u4f55\u4e00\u5339\u9a6c\uff0c\u4e00\u5339\u98de\u8dc3\u7684\u9a6c\uff0c\u90a3\u4efd\u6fc0\u8d8a\u7684\u72c2\u559c\uff0c\u662f\u6ca1\u6709\u53e6\u4e00\u79cd\u60c5\u6000\u53ef\u4ee5\u53d6\u4ee3\u7684\u3002\u5e76\u4e0d\u6267\u8457\u65bc\u62e5\u6709\u4e00\u5339\u6478\u7684\u8457\u7684\u9a8f\u9a6c\uff0c\u90a3\u6837\u4e5f\u53ea\u6709\u4e00\u5339\u4e86\uff0c\u8fd9\u4e2a\u4e0d\u591f\u3002\u6709\u4e86\u771f\u9a6c\uff0c\u843d\u4e86\u5b9e\u50cf\uff0c\u4e0d\u81ea\u7531\uff0c\u53cd\u800c\u60b5\u7136\u82e5\u5931\u3002\u5176\u5b9e\uff0c\u9a6c\u4e5f\u597d\uff0c\u8352\u539f\u4e5f\u597d\uff0c\u96e8\u5b63\u7684\u5c11\u5e74\u3001\u68a6\u88e1\u7684\u843d\u82b1\u3001\u6bcd\u4eb2\u7684\u80cc\u5f71\u3001\u4e07\u6c34\u5343\u5c71\u7684\u957f\u8def\uff0c\u90fd\u662f\u597d\u7684\uff0c\u6ca1\u6709\u4e00\u6837\u4e0d\u5408\u81ea\u7136\uff0c\u6ca1\u6709\u4e00\u6837\u4e0d\u80fd\u63a5\u53d7\uff0c\u865a\u5b9e\u4e4b\u95f4\uff0c\u5e84\u5468\u8774\u8776\u3002\u5e38\u5e38\uff0c\u4e0d\u60f3\u518d\u63e1\u7b14\u4e86\uff0c\u5f88\u591a\u6b21\uff0c\u771f\u6b63\u4e0d\u60f3\u518d\u5199\u4e86\u3002\u53ef\u662f\uff0c\u751f\u547d\u8ddf\u4eba\u6076\u4f5c\u5267\uff0c\u5b83\u9a97\u8457\u4eba\u5316\u8fdb\u6545\u4e8b\u88e1\u53bb\u6d3b\uff0c\u5b83\u7528\u79cd\u79cd\u7684\u60c5\u8282\u5f15\u8bf1\u8457\u4eba\u70ed\u70c8\u7684\u6295\u5165\uff0c\u4eba\uff0c\u5148\u88ab\u6545\u4e8b\u6349\u8fdb\u53bb\u4e86\uff0c\u7136\u540e\uff0c\u90a3\u4e2a\u5b88\u9ea6\u7530\u7684\u7a3b\u8349\u4eba\uff0c\u5c31\u4e0a\u5f53\u53c8\u4e0a\u5f53\u7684\u8bb2\u4e86\u53c8\u8bb2\u3002\u90a3\u4e2a\u7a3b\u8349\u4eba\uff0c\u4e0d\u662f\u5510\u5409\u67ef\u5fb7\uff0c\u5b83\u5374\u504f\u504f\u7231\u9a91\u9a6c\u3002\u8fd9\u79cd\u6253\u626e\u7684\u68a6\u5e7b\u9a91\u58eb\uff0c\u770b\u89c1\u4ed6\u90a3\u526f\u6837\u5b50\u4e0a\u8def\uff0c\u8c01\u90fd\u8981\u7b11\u6b7b\u7684\u3002\u5f88\u60f3\u5927\u5927\u65b9\u65b9\u7684\u9001\u7ed9\u4e16\u754c\u4e0a\u6bcf\u4e00\u4e2a\u4eba\u4e00\u5339\u9a6c\uff0c\u5f53\u7136\uff0c\u662f\u517b\u5728\u5fc3\u88e1\u3001\u68a6\u88e1\u3001\u5e7b\u60f3\u88e1\u7684\u90a3\u79cd\u9a6c\u3002\u6211\u6709\u8bb8\u591a\u5339\u597d\u9a6c\uff0c\u662f\u4e00\u4e2a\u9ad8\u539f\u7267\u573a\u7684\u4e3b\u4eba\u3002\u81f3\u65bc\u81ea\u5df1\uff0c\u90a3\u5339\u53ea\u5c5e\u65bc\u6211\u7684\u7231\u9a6c\uff0c\u4e00\u751f\u90fd\u5728\u7684\u3002\u5e38\u5e38\uff0c\u9a91\u8457\u7260\uff0c\u5728\u65e0\u4eba\u7684\u6d77\u8fb9\u5954\u9a70\uff0c\u9a6c\u7684\u6bdb\u8272\uff0c\u5373\u4f7f\u5728\u65e0\u661f\u65e0\u6708\u7684\u591c\u88e1\uff0c\u4e5f\u80fd\u53d1\u51fa\u4e00\u79cd\u6c89\u6f5c\u53c8\u51dd\u934a\u7684\u95ea\u5149\uff0c\u662f\u4e00\u5339\u795e\u9a79\u3002\u6211\u6709\u4e00\u5339\u9ed1\u9a6c\uff0c\u7260\u7684\u540d\u5b57\uff0c\u53eb\u505a\uff0d\uff0d\u6e90\u3002</p> <ul> <li>\u6211\u7684\u5973\u513f\uff0c\u5927\u5bb6\u7684\u4e09\u6bdb</li> <li>\u7231\u9a6c\uff08\u81ea\u5e8f\uff09</li> <li>\u84e6\u7136\u56de\u9996</li> <li>\u60ca\u68a6\u4e09\u5341\u5e74</li> <li>\u56de\u5a18\u5bb6</li> <li>\u6545\u4e61\u4eba</li> <li>\u770b\u8fd9\u4e2a\u4eba</li> <li>\u6211\u6240\u77e5\u6240\u7231\u7684\u9a6c\u594e\u65af</li> <li>\u9003\u4ea1</li> <li>\u5f80\u4e8b\u5982\u70df</li> <li>\u68a6\u91cc\u4e0d\u77e5\u8eab\u662f\u5ba2</li> <li>\u91ce\u706b\u70e7\u4e0d\u5c3d</li> <li>\u4e0d\u89c9\u78a7\u5c71\u66ae\u3000\u4f46\u95fb\u4e07\u58d1\u677e</li> <li>\u5b66\u671f\u4f5c\u4e1a\u62a5\u544a</li> <li>\u4f60\u662f\u6211\u7279\u522b\u7684\u5929\u4f7f</li> <li>\u671d\u9633\u4e3a\u8c01\u5347\u8d77</li> <li>\u4e00\u751f\u7684\u6218\u5f79</li> <li>\u9001\u4f60\u4e00\u5339\u9a6c</li> <li>\u8863\u5e26\u6e10\u5bbd\u7ec8\u4e0d\u6094</li> <li>\u9648\u8001\u5e08\uff08\u8dcb\uff09</li> </ul>","tags":["\u4e09\u6bdb","sanmao","Echo Chen Ping","\u6587\u96c6","\u4f5c\u54c1\u96c6"]},{"location":"BOOKS/2017-05-07-echo-chenping-sanmao-articles/#_14","title":"\u300a\u80cc\u5f71\u300b","text":"<p>\u5979\u66fe\u7ecf\u662f\uff0c\u96e8\u5b63\u4e2d\u5fe7\u90c1\u7684\u5c11\u5973\uff0c\u6492\u54c8\u62c9\u6c99\u6f20\u91cc\u5feb\u4e50\u7684\u5c0f\u5987\u4eba\uff0c\u7136\u540e\u53c8\u6210\u4e3a\u4e00\u4e2a\u5b88\u671b\u5728\u53f0\u6e7e\u5c9b\u4e0a\u7684\u5fe7\u4f24\u5be1\u5987\u3002\u5979\u7231\u6d41\u6d6a\uff0c\u7231\u6c99\u6f20\uff0c\u7231\u7f8e\u4e3d\u548c\u6d6a\u6f2b\uff0c\u7231\u90a3\u4e2a\u5e73\u539f\u5927\u91ce\u7684\u7537\u4eba\u3002\u7ecf\u5386\u4e86\u56db\u5341\u516b\u5e74\u5927\u8d77\u5927\u843d\uff0c\u5927\u60b2\u5927\u559c\uff0c\u8f70\u8f70\u70c8\u70c8\uff0c\u751f\u6b7b\u6b4c\u54ed\uff0c\u5728\u79bb\u5343\u4e07\u7231\u5979\u7684\u4eba\u800c\u53bb\u4e4b\u524d\uff0c\u5979\u8bf4\uff1a\u2018\u6211\u5df2\u7ecf\u5ea6\u8fc7\u4e86\u5f02\u5e38\u4e30\u5bcc\u7684\u4e00\u751f\u3002\u2019</p> <ul> <li>\u9003\u5b66\u4e3a\u8bfb\u4e66\uff08\u4ee3\u5e8f\uff09</li> <li>\u6c38\u8fdc\u7684\u590f\u5a03\u5f00\u573a\u767d</li> <li>\u62fe\u8352\u68a6\u2014\u2014\u6c38\u8fdc\u7684\u590f\u5a03</li> <li>\u9ec4\u660f\u7684\u6545\u4e8b\u2014\u2014\u6c38\u8fdc\u7684\u590f\u5a03</li> <li>\u5deb\u4eba\u8bb0\u2014\u2014\u6c38\u8fdc\u7684\u590f\u5a03</li> <li>\u997a\u5b50\u5927\u738b</li> <li>\u8d64\u8db3\u5929\u4f7f\u2014\u2014\u978b\u5b50\u7684\u6545\u4e8b</li> <li>\u4eb2\u4e0d\u4eb2\uff0c\u6545\u4e61\u4eba</li> <li>\u6d6a\u8ff9\u5929\u6daf\u8bdd\u4e70\u5356</li> <li>\u80cc\u5f71</li> <li>\u8352\u5c71\u4e4b\u591c</li> <li>\u514b\u91cc\u65af</li> <li>\u79bb\u4e61\u56de\u4e61</li> <li>\u96e8\u7985\u53f0\u5317</li> <li>\u5468\u672b</li> </ul>","tags":["\u4e09\u6bdb","sanmao","Echo Chen Ping","\u6587\u96c6","\u4f5c\u54c1\u96c6"]},{"location":"BOOKS/2017-05-07-echo-chenping-sanmao-articles/#_15","title":"\u300a\u7a3b\u8349\u4eba\u624b\u8bb0\u300b","text":"<p>\u4e09\u6bdb\u7684\u8db3\u8ff9\u904d\u53ca\u4e16\u754c\u5404\u5730\uff0c\u5e73\u751f\u8457\u4f5c\u3001\u8bd1\u4f5c\u5341\u5206\u4e30\u5bcc\uff0c\u5176\u4e2d\u300a\u6492\u54c8\u62c9\u7684\u6545\u4e8b\u300b\u3001\u300a\u96e8\u5b63\u4e0d\u518d\u6765\u300b\u3001\u300a\u54ed\u6ce3\u7684\u9a86\u9a7c\u300b\u3001\u300a\u6211\u7684\u5b9d\u8d1d\u300b\u3001\u300a\u95f9\u5b66\u8bb0\u300b\u3001\u300a\u6eda\u6eda\u7ea2\u5c18\u300b\u7b49\u6563\u6587\u3001\u5c0f\u8bf4\u3001\u5267\u672c\u66f4\u662f\u810d\u7099\u4eba\u53e3\uff0c\u5728\u5168\u7403\u534e\u4eba\u793e\u4f1a\u5e7f\u4e3a\u6d41\u4f20\uff0c\u5728\u5927\u9646\u98ce\u9761\u4e00\u65f6\uff0c\u5f71\u54cd\u4e86\u6574\u6574\u4e00\u4ee3\u4eba\u3002</p> <ul> <li>\u5e8f\u8a00</li> <li>\u6c5f\u6d0b\u5927\u76d7</li> <li>\u4eb2\u7231\u7684\u5a46\u5a46\u5927\u4eba</li> <li>\u897f\u98ce\u4e0d\u8bc6\u76f8</li> <li>\u8fd9\u6837\u7684\u4eba\u751f</li> <li>\u58eb\u4e3a\u77e5\u5df1\u8005\u6b7b</li> <li>\u8b66\u544a\u9003\u59bb</li> <li>\u8fd9\u79cd\u5bb6\u5ead\u751f\u6d3b</li> <li>\u5851\u6599\u513f\u7ae5</li> <li>\u5356\u82b1\u5973</li> <li>\u5b88\u671b\u7684\u5929\u4f7f</li> <li>\u76f8\u601d\u519c\u573a</li> <li>\u5de8\u4eba</li> </ul>","tags":["\u4e09\u6bdb","sanmao","Echo Chen Ping","\u6587\u96c6","\u4f5c\u54c1\u96c6"]},{"location":"BOOKS/2017-05-07-echo-chenping-sanmao-articles/#_16","title":"\u300a\u6eda\u6eda\u7ea2\u5c18\u300b","text":"<p>\u300a\u6eda\u6eda\u7ea2\u5c18\u300b\u662f\u4e09\u6bdb\u7684\u7b2c\u4e00\u90e8\u4e2d\u6587\u7535\u5f71\u5267\u672c\uff0c\u4e5f\u662f\u552f\u4e00\u4e00\u90e8\u3002\u4ee5\u4e2d\u56fd\u8fd1\u4ee3\u53f2\u4e0a\u7684\u52a8\u4e71\u5e74\u4ee3\u4e3a\u80cc\u666f\uff0c\u7ecf\u7531\u65f6\u4ee3\u513f\u5973\u7684\u7231\u3001\u6068\u3001\u60c5\u3001\u4ec7\u51fa\u53d1\uff0c\u63cf\u7ed8\u4e00\u4e2a\u5168\u4e2d\u56fd\u4eba\u60b2\u3001\u6b22\u3001\u79bb\u3001\u5408\u7684\u6545\u4e8b\uff0c\u5b9e\u9645\u4e0a\uff0c\u5b83\u4e0d\u7ecf\u610f\u6d41\u9732\u51fa\u6765\u7684\u662f\u4e00\u5219\u51c4\u6006\u65e0\u6b62\u7684\u7231\u60c5\u6545\u4e8b\uff0c\u66f4\u662f\u4e09\u6bdb\u81ea\u8eab\u7075\u9b42\u7684\u544a\u767d\u3002\\ \u6545\u4e8b\u4ee5\u65e7\u4e0a\u6d77\u4e3a\u80cc\u666f\uff0c\u8bb2\u8ff0\u7684\u662f\u5728\u6218\u4e71\u4e2d\u80fd\u624d\u4e0e\u97f6\u534e\u3001\u6708\u51e4\u4e0e\u9769\u547d\u7537\u5973\u4e4b\u95f4\u7684\u7231\u60c5\u6545\u4e8b\u3002\u5185\u5bb9\u76f8\u4f20\u4e3a\u201c\u5f71\u5c04\u6c11\u56fd\u65f6\u671f\u5973\u4f5c\u5bb6\u5f20\u7231\u73b2\u4e0e\u80e1\u5170\u6210\u7684\u611f\u60c5\u7ea0\u845b\u201d\u3002\\ \u7535\u5f71\u300a\u6eda\u6eda\u7ea2\u5c18\u300b\u7531\u6797\u9752\u971e\u3001\u79e6\u6c49\u3001\u5f20\u66fc\u7389\u4e3b\u6f14\uff0c1990\u5e74\u516c\u6620\u3002\u8363\u83b7\u91d1\u9a6c\u5956\u516b\u9879\u5927\u5956\uff0c\u521b\u6700\u9ad8\u5f97\u5956\u7eaa\u5f55\u3002\\ \u300a\u6eda\u6eda\u7ea2\u5c18\u300b\u4e3b\u9898\u66f2\u7531\u7f57\u5927\u4f51\u586b\u8bcd\u8c31\u66f2\uff0c\u7f57\u5927\u4f51\u3001\u9648\u6dd1\u6866\u5408\u5531\u3002\u81f3\u4eca\u4f20\u4e3a\u7ecf\u5178\u3002</p> <ul> <li>\u6954\u5b50</li> <li>\u4eba\u7269\u4ecb\u7ecd</li> <li>\u7b2c\u4e00\u7ae0 \u697c\u9ad8\u65e5\u5c3d</li> <li>\u7b2c1\u573a</li> <li>\u7b2c2\u573a</li> <li>\u7b2c3\u573a</li> <li>\u7b2c\u4e8c\u7ae0 \u671b\u65ad\u5929\u6daf\u8def</li> <li>\u7b2c4\u573a</li> <li>\u7b2c5\u573a</li> <li>\u7b2c6\u573a</li> <li>\u7b2c7\u573a</li> <li>\u7b2c\u4e09\u7ae0 \u6765\u65f6\u964c\u4e0a\u521d\u718f</li> <li>\u7b2c8\u573a</li> <li>\u7b2c9\u573a</li> <li>\u7b2c10\u573a</li> <li>\u7b2c11\u573a</li> <li>\u7b2c12\u573a</li> <li>\u7b2c13\u573a</li> <li>\u7b2c\u56db\u7ae0 \u6709\u60c5\u98ce\u4e07\u91cc\u5377\u6f6e\u6765</li> <li>\u7b2c14\u573a</li> <li>\u7b2c15\u573a</li> <li>\u7b2c16\u573a</li> <li>\u7b2c17\u573a</li> <li>\u7b2c18\u573a</li> <li>\u7b2c19\u573a</li> <li>\u7b2c\u4e94\u7ae0 \u63a8\u6795\u60d8\u7136\u4e0d\u89c1</li> <li>\u7b2c20\u573a</li> <li>\u7b2c21\u573a</li> <li>\u7b2c22\u573a</li> <li>\u7b2c\u516d\u7ae0 \u5206\u643a\u5982\u6628 \u5230\u5904\u840d\u98d8\u6cca</li> <li>\u7b2c23\u573a</li> <li>\u7b2c24\u573a</li> <li>\u7b2c25\u573a</li> <li>\u7b2c26\u573a</li> <li>\u7b2c27\u573a</li> <li>\u7b2c28\u573a</li> <li>\u7b2c\u4e03\u7ae0 \u6d69\u7136\u76f8\u5bf9 \u4eca\u5915\u4f55\u5e74</li> <li>\u7b2c29\u573a</li> <li>\u7b2c30\u573a</li> <li>\u7b2c31\u573a</li> <li>\u7b2c\u516b\u7ae0 \u8c01\u9053\u4eba\u751f\u65e0\u518d\u5c11</li> <li>\u7b2c32\u573a</li> <li>\u7b2c33\u573a</li> <li>\u7b2c34\u573a</li> <li>\u7b2c\u4e5d\u7ae0 \u4f9d\u65e7\u68a6\u9b42\u4e2d</li> <li>\u7b2c35\u573a</li> <li>\u7b2c36\u573a</li> <li>\u7b2c37\u573a</li> <li>\u7b2c38\u573a</li> <li>\u7b2c\u5341\u7ae0 \u4f46\u6709\u65e7\u6b22\u65b0\u6028</li> <li>\u7b2c39\u573a</li> <li>\u7b2c40\u573a</li> <li>\u7b2c41\u573a</li> <li>\u7b2c42\u573a</li> <li>\u7b2c43\u573a</li> <li>\u7b2c44\u573a</li> <li>\u7b2c\u5341\u4e00\u7ae0 \u4eba\u751f\u5e95\u4e8b \u5f80\u6765\u5982\u68ad</li> <li>\u7b2c45\u573a</li> <li>\u7b2c46\u573a</li> <li>\u7b2c47\u573a</li> <li>\u7b2c48\u573a</li> <li>\u7b2c49\u573a</li> <li>\u7b2c50\u573a</li> <li>\u7b2c51\u573a</li> <li>\u7b2c\u5341\u4e8c\u7ae0 \u9189\u7b11\u966a\u541b\u4e09\u4e07\u573a \u4e0d\u8bc9\u79bb\u4f24</li> <li>\u7b2c52\u573a</li> <li>\u7b2c53\u573a</li> <li>\u7b2c54\u573a</li> <li>\u7b2c55\u573a</li> <li>\u7b2c56\u573a</li> <li>\u7b2c\u5341\u4e09\u7ae0 \u7985\u5fc3\u5df2\u5931\u4eba\u95f4\u7231</li> <li>\u7b2c57\u573a</li> <li>\u7b2c58\u573a</li> <li>\u7b2c59\u573a</li> <li>\u7b2c60\u573a</li> <li>\u7b2c61\u573a</li> <li>\u7b2c62\u573a</li> <li>\u7b2c\u5341\u56db\u7ae0 \u53c8\u4f55\u66fe\u68a6\u89c9</li> <li>\u7b2c63\u573a</li> <li>\u7b2c64\u573a</li> <li>\u7b2c65\u573a</li> <li>\u7b2c66\u573a</li> <li>\u7b2c67\u573a</li> <li>\u7b2c\u5341\u4e94\u7ae0 \u8e0f\u5c3d\u7ea2\u5c18 \u4f55\u5904\u662f\u543e\u4e61</li> <li>\u7b2c68\u573a</li> </ul>","tags":["\u4e09\u6bdb","sanmao","Echo Chen Ping","\u6587\u96c6","\u4f5c\u54c1\u96c6"]},{"location":"BOOKS/2017-05-07-echo-chenping-sanmao-articles/#_17","title":"\u5176\u4ed6","text":"<ul> <li>\u300a\u9ad8\u539f\u7684\u767e\u5408\u82b1: \u73bb\u5229\u7ef4\u4e9a\u8bb0\u884c\u300b</li> <li>\u300a\u8d74\u6b27\u65c5\u9014\u89c1\u95fb\u5f55\u300bn</li> <li>\u300a\u897f\u5317\u6c11\u6b4c\u5927\u5e08\u738b\u6d1b\u5bbe\u300b</li> </ul>","tags":["\u4e09\u6bdb","sanmao","Echo Chen Ping","\u6587\u96c6","\u4f5c\u54c1\u96c6"]},{"location":"BOOKS/2017-05-07-echo-chenping-sanmao-articles/#_18","title":"\u6458\u81ea","text":"<ul> <li>http://www.kanunu8.com/files/writer/248.html</li> <li>http://www.my285.com/gt/sanmao/gghc/index.htm</li> </ul>","tags":["\u4e09\u6bdb","sanmao","Echo Chen Ping","\u6587\u96c6","\u4f5c\u54c1\u96c6"]},{"location":"BOOKS/2018-05-23-%25e5%25bc%25a0%25e7%2588%25b1%25e7%258e%25b2%25e6%2596%2587%25e9%259b%2586/","title":"\u5f20\u7231\u73b2\u6587\u96c6","text":"","tags":["\u5f20\u7231\u73b2","\u6587\u96c6","\u4f5c\u54c1\u96c6","Eileen Zhang"]},{"location":"BOOKS/2018-05-23-%25e5%25bc%25a0%25e7%2588%25b1%25e7%258e%25b2%25e6%2596%2587%25e9%259b%2586/#_1","title":"\u6587\u96c6","text":"","tags":["\u5f20\u7231\u73b2","\u6587\u96c6","\u4f5c\u54c1\u96c6","Eileen Zhang"]},{"location":"BOOKS/2018-05-23-%25e5%25bc%25a0%25e7%2588%25b1%25e7%258e%25b2%25e6%2596%2587%25e9%259b%2586/#_2","title":"\u503e\u57ce\u4e4b\u604b","text":"<p>\u4e00\u4e2a\u52a8\u542c\u800c\u53c8\u8fd1\u4eba\u60c5\u7684\u6545\u4e8b\u3002\u2026\u2026\u6211\u559c\u6b22\u53c2\u5dee\u7684\u5bf9\u7167\u7684\u5199\u6cd5\uff0c\u56e0\u4e3a\u5b83\u662f\u8f83\u8fd1\u4e8b\u5b9e\u7684\u3002\u300a\u503e\u57ce\u4e4b\u604b\u300b\u91cc\uff0c\u4ece\u8150\u65e7\u7684\u5bb6\u5ead\u91cc\u8d70\u51fa\u6765\u7684\u6d41\u82cf\uff0c\u9999\u6e2f\u4e4b\u6218\u7684\u6d17\u793c\u5e76\u4e0d\u66fe\u5c06\u5979\u611f\u5316\u6210\u4e3a\u9769\u547d\u5973\u6027\uff1a\u9999\u6e2f\u4e4b\u6218\u5f71\u54cd\u8303\u67f3\u539f\uff0c\u4f7f\u5979\u8f6c\u5411\u5e73\u5b9e\u7684\u751f\u6d3b\uff0c\u7ec8\u4e8e\u7ed3\u5a5a\u4e86\uff0c\u4f46\u7ed3\u5a5a\u5e76\u4e0d\u4f7f\u4ed6\u53d8\u4e3a\u5723\u4eba\uff0c\u5b8c\u5168\u653e\u5f03\u5f80\u65e5\u7684\u751f\u6d3b\u4e60\u60ef\u4e0e\u4f5c\u98ce\u3002\u56e0\u4e4b\u67f3\u539f\u4e0e\u6d41\u82cf\u7684\u7ed3\u5c40\uff0c\u867d\u7136\u591a\u5c11\u662f\u5065\u5eb7\u7684\uff0c\u4ecd\u65e7\u662f\u5eb8\u4fd7\uff1b\u5c31\u4e8b\u8bba\u4e8b\uff0c\u4ed6\u4eec\u4e5f\u53ea\u80fd\u5982\u6b64\u3002</p> <ul> <li>\u7b2c\u4e00\u7ae0</li> <li>\u7b2c\u4e8c\u7ae0</li> <li>\u7b2c\u4e09\u7ae0</li> <li>\u7b2c\u56db\u7ae0</li> <li>\u7b2c\u4e94\u7ae0</li> <li>\u7b2c\u516d\u7ae0</li> <li>\u7b2c\u4e03\u7ae0</li> <li>\u7b2c\u516b\u7ae0</li> <li>\u7b2c\u4e5d\u7ae0</li> <li>\u7b2c\u5341\u7ae0</li> </ul>","tags":["\u5f20\u7231\u73b2","\u6587\u96c6","\u4f5c\u54c1\u96c6","Eileen Zhang"]},{"location":"BOOKS/2018-05-23-%25e5%25bc%25a0%25e7%2588%25b1%25e7%258e%25b2%25e6%2596%2587%25e9%259b%2586/#_3","title":"\u8d64\u5730\u4e4b\u604b","text":"<p>\u300a\u8d64\u5730\u4e4b\u604b\u300b\u6240\u5199\u7684\u662f\u771f\u4eba\u5b9e\u4e8b\uff0c\u4f46\u662f\u5c0f\u8bf4\u7a76\u7adf\u4e0d\u662f\u62a5\u5bfc\u6587\u5b66\uff0c\u6211\u9664\u4e86\u628a\u771f\u6b63\u7684\u4eba\u540d\u4e0e\u4e00\u90e8\u4efd\u7684\u5730\u540d\u9690\u53bb\uff0c\u800c\u4e14\u9700\u8981\u628a\u8bb8\u591a\u5c0f\u6545\u4e8b\u53e0\u5370\u5728\u4e00\u8d77\uff0c\u518d\u7ecf\u8fc7\u526a\u88c1\u4e0e\u7ec4\u7ec7\u3002\u753b\u9762\u76f8\u5f53\u5e7f\u9614\uff0c\u4f46\u4e5f\u5e76\u4e0d\u80fd\u8868\u73b0\u4eca\u65e5\u7684\u5927\u9646\u5168\u8c8c\uff0c\u8b6c\u5982\u50cf\u201c\u4e94\u53cd\u201d\uff0c\u90a3\u662f\u6bd4\u201c\u4e09\u53cd\u201d\u66f4\u6df1\u5165\u5730\u5f71\u54cd\u5230\u4e00\u822c\u6c11\u4f17\u7684\uff0c\u5c31\u5b8c\u5168\u6ca1\u6709\u89e6\u53ca\u3002\u5f53\u7136\u4e5f\u662f\u4e3a\u672c\u4e66\u4e3b\u89d2\u7684\u89c6\u91ce\u6240\u9650\u5236\u3002\u540c\u65f6\u6211\u7684\u76ee\u7684\u4e5f\u5e76\u4e0d\u662f\u5305\u7f57\u4e07\u8c61\uff0c\u800c\u662f\u5c3d\u53ef\u80fd\u5730\u590d\u5236\u5f53\u65f6\u7684\u6c14\u6c1b\u3002\u8fd9\u91cc\u6ca1\u6709\u6982\u62ec\u6027\u7684\u62a5\u5bfc\u3002\u6211\u53ea\u5e0c\u671b\u8bfb\u8005\u4eec\u770b\u8fd9\u672c\u4e66\u7684\u65f6\u5019\uff0c\u80fd\u591f\u591a\u5c11\u55c5\u5230\u4e00\u70b9\u771f\u5b9e\u7684\u751f\u6d3b\u6c14\u606f\u3002</p> <ul> <li>\u81ea \u5e8f</li> <li>\u7b2c\u4e00\u7ae0</li> <li>\u7b2c\u4e8c\u7ae0</li> <li>\u7b2c\u4e09\u7ae0</li> <li>\u7b2c\u56db\u7ae0</li> <li>\u7b2c\u4e94\u7ae0</li> <li>\u7b2c\u516d\u7ae0</li> <li>\u7b2c\u4e03\u7ae0</li> <li>\u7b2c\u516b\u7ae0</li> <li>\u7b2c\u4e5d\u7ae0</li> <li>\u7b2c\u5341\u7ae0</li> <li>\u7b2c\u5341\u4e00\u7ae0</li> </ul>","tags":["\u5f20\u7231\u73b2","\u6587\u96c6","\u4f5c\u54c1\u96c6","Eileen Zhang"]},{"location":"BOOKS/2018-05-23-%25e5%25bc%25a0%25e7%2588%25b1%25e7%258e%25b2%25e6%2596%2587%25e9%259b%2586/#_4","title":"\u534a\u751f\u7f18","text":"<p>\u300a\u534a\u751f\u7f18\u300b\u8bb2\u7684\u662f\u4e09\u5341\u5e74\u4ee3\u4e0a\u6d77\u7684\u4e00\u4e2a\u60b2\u60e8\u7684\u7231\u60c5\u6545\u4e8b\u3002\u5973\u4e3b\u4eba\u516c\u987e\u66fc\u6862\u5bb6\u5883\u8d2b\u5bd2\uff0c\u81ea\u5e7c\u4e27\u7236\uff0c\u8001\u5c0f\u4e03\u4eba\u5168\u9760\u59d0\u59d0\u66fc\u7490\u505a\u821e\u5973\u517b\u6d3b\u3002\u66fc\u6862\u6bd5\u4e1a\u540e\u5728\u4e00\u5bb6\u516c\u53f8\u5de5\u4f5c\uff0c\u4e0e\u6765\u81ea\u5357\u4eac\u7684\u8bb8\u4e16\u94a7\u76f8\u7231\uff0c\u4e16\u94a7\u6df1\u6df1\u540c\u60c5\u66fc\u6862\u7684\u5904\u5883\uff0c\u51b3\u5b9a\u4e0e\u4e4b\u7ed3\u5a5a\u3002\u66fc\u7490\u7ec8\u4e8e\u4e5f\u5ac1\u4eba\u4e86\uff0c\u59d0\u592b\u795d\u9e3f\u624d\u662f\u4e2a\u66b4\u53d1\u6237\uff0c\u5f53\u5f97\u77e5\u66fc\u7490\u4e0d\u80fd\u751f\u80b2\uff0c\u4fbf\u65e5\u751f\u538c\u5f03\u4e4b\u5fc3\uff0c\u66fc\u7490\u4e3a\u4e86\u6813\u4f4f\u795d\u751f\u51fa\u4e00\u6761\u6b8b\u8ba1\u2026\u2026\u5341\u516b\u5e74\u5728\u5929\u624d\u4f5c\u5bb6\u5f20\u7231\u73b2\u7684\u7b14\u4e0b\u4e00\u6643\u5c31\u8fc7\u53bb\u4e86\uff0c\u66fc\u6862\u548c\u4e16\u94a7\u53c8\u5728\u4e0a\u6d77\u76f8\u9047\uff0c\u800c\u5c81\u6708\u53d8\u8fc1\u7eff\u6811\u65e9\u5df2\u6210\u836b\u2026\u2026</p> <ul> <li>\u7b2c\u4e00\u7ae0</li> <li>\u7b2c\u4e8c\u7ae0</li> <li>\u7b2c\u4e09\u7ae0</li> <li>\u7b2c\u56db\u7ae0</li> <li>\u7b2c\u4e94\u7ae0</li> <li>\u7b2c\u516d\u7ae0</li> <li>\u7b2c\u4e03\u7ae0</li> <li>\u7b2c\u516b\u7ae0</li> <li>\u7b2c\u4e5d\u7ae0</li> <li>\u7b2c\u5341\u7ae0</li> <li>\u7b2c\u5341\u4e00\u7ae0</li> <li>\u7b2c\u5341\u4e8c\u7ae0</li> <li>\u7b2c\u5341\u4e09\u7ae0</li> <li>\u7b2c\u5341\u56db\u7ae0</li> <li>\u7b2c\u5341\u4e94\u7ae0</li> <li>\u7b2c\u5341\u516d\u7ae0</li> <li>\u7b2c\u5341\u4e03\u7ae0</li> </ul>","tags":["\u5f20\u7231\u73b2","\u6587\u96c6","\u4f5c\u54c1\u96c6","Eileen Zhang"]},{"location":"BOOKS/2018-05-23-%25e5%25bc%25a0%25e7%2588%25b1%25e7%258e%25b2%25e6%2596%2587%25e9%259b%2586/#_5","title":"\u79e7\u6b4c","text":"<p>\u4e00\u5230\u4e86\u8fd9\u4e2a\u5c0f\u9547\u4e0a,\u7b2c\u4e00\u5148\u770b\u89c1\u957f\u957f\u7684\u4e00\u6392\u8305\u5395\u3002\u90fd\u662f\u8fce\u9762\u4e00\u4e2a\u6728\u677f\u7167\u58c1\uff0c\u67b6\u5728\u5927\u77f3\u5934\u4e0a\uff0c\u534a\u906e\u7740\u91cc\u9762\u80cc\u5bf9\u80cc\u7684\u4e24\u4e2a\u5751\u4f4d\u3002\u63a5\u8fde\u4e0d\u65ad\u7684\u5341\u51e0\u4e2a\u5c0f\u8305\u68da\uff0c\u91cc\u9762\u4e00\u4e2a\u4eba\u4e5f\u6ca1\u6709\u3002\u4f46\u662f\u6709\u65f6\u5019\u4e00\u9635\u98ce\u5439\u8fc7\u6765\uff0c\u5fae\u5fae\u53d1\u51fa\u81ed\u6c14\u3002\u4e0b\u5348\u7684\u9633\u5149\u6de1\u6de1\u5730\u6652\u5728\u5c4b\u9876\u4e0a\u767d\u82cd\u82cd\u7684\u8305\u8349\u4e0a\u3002</p> <ul> <li>\u7b2c\u4e00\u7ae0</li> <li>\u7b2c\u4e8c\u7ae0</li> <li>\u7b2c\u4e09\u7ae0</li> <li>\u7b2c\u56db\u7ae0</li> <li>\u7b2c\u4e94\u7ae0</li> <li>\u7b2c\u516d\u7ae0</li> <li>\u7b2c\u4e03\u7ae0</li> <li>\u7b2c\u516b\u7ae0</li> <li>\u7b2c\u4e5d\u7ae0</li> <li>\u7b2c\u5341\u7ae0</li> <li>\u7b2c\u5341\u4e00\u7ae0</li> <li>\u7b2c\u5341\u4e8c\u7ae0</li> <li>\u7b2c\u5341\u4e09\u7ae0</li> <li>\u7b2c\u5341\u56db\u7ae0</li> <li>\u7b2c\u5341\u4e94\u7ae0</li> <li>\u7b2c\u5341\u516d\u7ae0</li> <li>\u7b2c\u5341\u4e03\u7ae0</li> </ul>","tags":["\u5f20\u7231\u73b2","\u6587\u96c6","\u4f5c\u54c1\u96c6","Eileen Zhang"]},{"location":"BOOKS/2018-05-23-%25e5%25bc%25a0%25e7%2588%25b1%25e7%258e%25b2%25e6%2596%2587%25e9%259b%2586/#_6","title":"\u6028\u5973","text":"<p>\u5979\u4e0d\u7531\u5f97\u60f3\u8d77\u4ece\u524d\u62ff\u6cb9\u706f\u70e7\u4e00\u4e2a\u7537\u4eba\u7684\u624b\u3002\u5ffd\u7136\u4ece\u524d\u7684\u4e8b\u90fd\u56de\u6765\u4e86\uff0c\u7830\u7830\u7830\u7684\u6253\u95e8\u58f0\uff0c\u5979\u7ad9\u5728\u6392\u95e8\u80cc\u540e\uff0c\u5fc3\u8df3\u5f97\u6bd4\u6253\u95e8\u7684\u58f0\u97f3\u8fd8\u66f4\u54cd\uff0c\u6cb9\u706f\u70ed\u70d8\u70d8\u718f\u7740\u8138\uff0c\u989d\u4e0a\u524d\u5218\u6d77\u70ed\u70d8\u70d8\u7f69\u4e0b\u6765\uff0c\u6d51\u8eab\u5fae\u5fae\u523a\u75db\u7684\u6c57\u73e0\uff0c\u5728\u9ed1\u6697\u4e2d\u6233\u51fa\u4e00\u4e2a\u4e2a\u5c0f\u5b54\uff0c\u5212\u51fa\u4e2a\u82d7\u6761\u7684\u8f6e\u5ed3\u3002\u5979\u5f15\u4ee5\u81ea\u6170\u7684\u4e00\u5207\u7a81\u7136\u90fd\u6ca1\u6709\u4e86\uff0c\u6839\u672c\u6ca1\u6709\u8fd9\u4e9b\u4e8b\uff0c\u5979\u8fd9\u8f88\u5b50\u8fd8\u6ca1\u7ecf\u8fc7\u4ec0\u4e48\u4e8b\u3002\u5927\u59d1\u5a18\uff01\u5927\u59d1\u5a18\uff01\u5728\u53eb\u7740\u5979\u7684\u540d\u5b57\u3002\u4ed6\u5728\u95e8\u5916\u53eb\u5979\u3002</p> <ul> <li>\u7b2c\u4e00\u7ae0</li> <li>\u7b2c\u4e8c\u7ae0</li> <li>\u7b2c\u4e09\u7ae0</li> <li>\u7b2c\u56db\u7ae0</li> <li>\u7b2c\u4e94\u7ae0</li> <li>\u7b2c\u516d\u7ae0</li> <li>\u7b2c\u4e03\u7ae0</li> <li>\u7b2c\u516b\u7ae0</li> <li>\u7b2c\u4e5d\u7ae0</li> <li>\u7b2c\u5341\u7ae0</li> <li>\u7b2c\u5341\u4e00\u7ae0</li> <li>\u7b2c\u5341\u4e8c\u7ae0</li> <li>\u7b2c\u5341\u4e09\u7ae0</li> <li>\u7b2c\u5341\u56db\u7ae0</li> <li>\u7b2c\u5341\u4e94\u7ae0</li> </ul>","tags":["\u5f20\u7231\u73b2","\u6587\u96c6","\u4f5c\u54c1\u96c6","Eileen Zhang"]},{"location":"BOOKS/2018-05-23-%25e5%25bc%25a0%25e7%2588%25b1%25e7%258e%25b2%25e6%2596%2587%25e9%259b%2586/#_7","title":"\u7ea2\u697c\u68a6\u9b47","text":"<p>\u90a3\u51e0\u5e74\u6211\u521a\u5de7\u6709\u673a\u4f1a\u5728\u54c8\u4f5b\u71d5\u4eac\u56fe\u4e66\u9986\u4e0e\u67cf\u514b\u83b1\u7684\u52a0\u5927\u56fe\u4e66\u9986\u501f\u4e66\uff0c\u770b\u5230\u8102\u672c\u7ea2\u697c\u68a6\u3002\u8fd1\u4eba\u7684\u8003\u636e\u90fd\u662f\u7ad9\u7740\u770b\u2500\u6765\u4e0d\u53ca\u5750\u4e0b\u3002\u81f3\u4e8e\u81ea\u5df1\u505a\uff0c\u6211\u552f\u4e00\u7684\u8d44\u683c\u662f\u5b9e\u5728\u719f\u8bfb\u7ea2\u697c\u68a6\uff0c\u4e0d\u540c\u7684\u672c\u5b50\u4e0d\u7528\u7559\u795e\u770b\uff0c\u7a0d\u5fae\u773c\u751f\u70b9\u7684\u5b57\u81ea\u4f1a\u8e66\u51fa\u6765\u3002\u4f46\u662f\u6ca1\u5199\u8fc7\u7406\u8bba\u6587\u5b57\uff0c\u5f53\u7136\u7b11\u8bdd\u4e00\u4e94\u4e00\u5341\u3002\u6211\u5927\u6982\u662f\u4e2d\u4e86\u53e4\u6587\u7684\u6bd2\uff0c\u57f9\u6839\u7684\u6563\u6587\u6700\u8bb0\u5f97\u8fd9\u4e00\u53e5\uff1a \u7b80\u77ed\u662f\u96bd\u8bed\u7684\u7075\u9b42\uff0c\u4e0d\u8fc7\u8ba4\u4e3a\u4e0d\u9650\u96bd\u8bed\uff0c\u6240\u4ee5\u4e00\u4e2a\u5b57\u770b\u5f97\u6709\u5df4\u6597\u5927\uff0c\u80fd\u7701\u4e00\u4e2a\u4e5f\u662f\u597d\u7684\u3002\u56e0\u4e3a\u6015\u5520\u53e8\uff0c\u8bf4\u7406\u5df2\u7ecf\u4e0d\u591f\u6e05\u695a\uff0c\u53c8\u628a\u5168\u6284\u672c\u2500\u5373\u6240\u8c13\u7ea2\u697c\u68a6\u7a3f\u2500 \u7b80\u79f0\u6284\u672c\u3002\u5176\u5b9e\u8fd9\u4e9b\u672c\u5b50\u90fd\u662f\u6284\u672c\u3002\u96be\u602a\u521d\u8be6\u7ea2\u697c\u68a6\u520a\u51fa\u540e\uff0c\u6709\u4e2a\u670b\u53cb\u544a\u8bc9\u6211\u770b\u4e0d\u61c2\u2500\u5f53\u7136\u8bf4\u5f97\u8f83\u5a49\u8f6c\u3002</p> <ul> <li>\u7ea2\u697c\u68a6\u672a\u5b8c(1)</li> <li>\u7ea2\u697c\u68a6\u672a\u5b8c(2)</li> <li>\u7ea2\u697c\u68a6\u63d2\u66f2\u4e4b\u4e00</li> <li>\u521d\u8be6\u7ea2\u697c\u68a6</li> <li>\u4e8c\u8be6\u7ea2\u697c\u68a6(1)</li> <li>\u4e8c\u8be6\u7ea2\u697c\u68a6(2)</li> <li>\u4e09\u8be6\u7ea2\u697c\u68a6(1)</li> <li>\u4e09\u8be6\u7ea2\u697c\u68a6(2)</li> <li>\u56db\u8be6\u7ea2\u697c\u68a6(1)</li> <li>\u56db\u8be6\u7ea2\u697c\u68a6(2)</li> <li>\u4e94\u8be6\u7ea2\u697c\u68a6(1)</li> <li>\u4e94\u8be6\u7ea2\u697c\u68a6(2)</li> </ul>","tags":["\u5f20\u7231\u73b2","\u6587\u96c6","\u4f5c\u54c1\u96c6","Eileen Zhang"]},{"location":"BOOKS/2018-05-23-%25e5%25bc%25a0%25e7%2588%25b1%25e7%258e%25b2%25e6%2596%2587%25e9%259b%2586/#_8","title":"\u90fd\u5e02\u7684\u4eba\u751f","text":"<p>\u300a\u90fd\u5e02\u7684\u4eba\u751f\u300b\u6797\u6797\u603b\u603b\u4e94\u5341\u7bc7\u4ec0\uff0c\u5927\u591a\u9009\u81ea\u300a\u6d41\u8a00\u300b\u3001\u300a\u5f20\u770b\u300b\u7b49\u96c6\u5b50\uff0c\u6b64\u5916\u8fd8\u6536\u96c6\u4e86\u4e00\u4e9b\u6563\u843d\u5728\u4e66\u520a\u4e2d\u7684\u5355\u7bc7\uff0c\u8ba1\u4e09\u5341\u4e07\u8a00\uff0c\u5305\u7eb3\u4e86\u5f20\u7231\u73b2\u5404\u4e2a\u65f6\u671f\u7684\u6563\u6587\u529b\u4f5c\u3002</p>","tags":["\u5f20\u7231\u73b2","\u6587\u96c6","\u4f5c\u54c1\u96c6","Eileen Zhang"]},{"location":"BOOKS/2018-05-23-%25e5%25bc%25a0%25e7%2588%25b1%25e7%258e%25b2%25e6%2596%2587%25e9%259b%2586/#_9","title":"\u4e00\u3001\u7eb7\u7e41\u5bb6\u4e8b","text":"<ul> <li>\u5230\u5e95\u662f\u4e0a\u6d77\u4eba\uff08\u4ee3\u5e8f\uff09</li> <li>\u5fc3\u8179\u8bdd</li> <li>\u5929\u624d\u68a6</li> <li>\u7ae5\u8a00\u65e0\u5fcc</li> <li>\u59d1\u59d1\u8bed\u5f55</li> <li>\u8bf4\u80e1\u841d\u535c</li> <li>\u591c\u8425\u7684\u5587\u53ed</li> <li>\u516c\u5bd3\u751f\u6d3b\u8bb0\u8da3</li> </ul>","tags":["\u5f20\u7231\u73b2","\u6587\u96c6","\u4f5c\u54c1\u96c6","Eileen Zhang"]},{"location":"BOOKS/2018-05-23-%25e5%25bc%25a0%25e7%2588%25b1%25e7%258e%25b2%25e6%2596%2587%25e9%259b%2586/#_10","title":"\u4e8c\u3001\u5973\u6027\u98ce\u666f","text":"<ul> <li>\u708e\u6a31\u8bed\u5f55</li> <li>\u5409\u5229</li> <li>\u53cc\u58f0</li> <li>\u6211\u770b\u82cf\u9752</li> <li>\u6c14\u77ed\u60c5\u957f\u53ca\u5176\u4ed6</li> <li>\u201c\u5377\u9996\u7389\u7167\u201d\u53ca\u5176\u4ed6</li> <li>\u8c08\u5973\u4eba</li> <li>\u6709\u5973\u540c\u8f66</li> <li>\u7231</li> <li>\u66f4\u8863\u8bb0</li> </ul>","tags":["\u5f20\u7231\u73b2","\u6587\u96c6","\u4f5c\u54c1\u96c6","Eileen Zhang"]},{"location":"BOOKS/2018-05-23-%25e5%25bc%25a0%25e7%2588%25b1%25e7%258e%25b2%25e6%2596%2587%25e9%259b%2586/#_11","title":"\u4e09\u3001\u708e\u51c9\u4e16\u6001","text":"<ul> <li>\u4e2d\u56fd\u7684\u65e5\u591c</li> <li>\u9053\u8def\u4ee5\u76ee</li> <li>\u6253\u4eba</li> <li>\u8349\u7089\u997c</li> <li>\u4e2d\u56fd\u4eba\u7684\u5b97\u6559</li> <li>\u5fc5\u4e5f\u6b63\u540d\u4e4e</li> <li>\u9020\u4eba</li> <li>\u96e8\u4f1e\u4e0b</li> <li>\u79d8\u5bc6</li> <li>\u70ec\u4f59\u5f55</li> <li>\u8c08\u5403\u4e0e\u753b\u997c\u5145\u9965</li> <li>\u8fdf\u66ae</li> </ul>","tags":["\u5f20\u7231\u73b2","\u6587\u96c6","\u4f5c\u54c1\u96c6","Eileen Zhang"]},{"location":"BOOKS/2018-05-23-%25e5%25bc%25a0%25e7%2588%25b1%25e7%258e%25b2%25e6%2596%2587%25e9%259b%2586/#_12","title":"\u56db\u3001\u827a\u82d1\u4e00\u77a5","text":"<ul> <li>\u8c08\u8df3\u821e</li> <li>\u8c08\u97f3\u4e50</li> <li>\u8c08\u753b</li> <li>\u5fd8\u4e0d\u4e86\u7684\u753b</li> <li>\u8bba\u5361\u901a\u753b\u4e4b\u524d\u9014</li> <li>\u94f6\u5bab\u5c31\u5b66\u8bb0</li> <li>\u6d0b\u4eba\u770b\u4eac\u620f\u53ca\u5176\u4ed6</li> <li>\u501f\u94f6\u706f</li> <li>\u8d70\uff01\u8d70\u5230\u697c\u4e0a\u53bb</li> </ul>","tags":["\u5f20\u7231\u73b2","\u6587\u96c6","\u4f5c\u54c1\u96c6","Eileen Zhang"]},{"location":"BOOKS/2018-05-23-%25e5%25bc%25a0%25e7%2588%25b1%25e7%258e%25b2%25e6%2596%2587%25e9%259b%2586/#_13","title":"\u4e94\u3001\u6587\u7ae0\u5bf8\u5fc3","text":"<ul> <li>\u6709\u51e0\u53e5\u8bdd\u540c\u8bfb\u8005\u8bf4</li> <li>\u81ea\u5df1\u7684\u6587\u7ae0</li> <li>\u5199\u4ec0\u4e48</li> <li>\u5b58\u7a3f</li> <li>\u8bba\u5199\u4f5c</li> <li>\u8c08\u770b\u4e66</li> <li>\u8c08\u770b\u4e66\u540e\u8bb0</li> <li>\u4e08\u4eba\u7684\u5fc3</li> <li>\u8bd7\u4e0e\u80e1\u8bf4</li> <li>\u5fc6\u80e1\u9002\u4e4b</li> <li>\u7f16\u540e\u8bb0</li> </ul>","tags":["\u5f20\u7231\u73b2","\u6587\u96c6","\u4f5c\u54c1\u96c6","Eileen Zhang"]},{"location":"BOOKS/2018-05-23-%25e5%25bc%25a0%25e7%2588%25b1%25e7%258e%25b2%25e6%2596%2587%25e9%259b%2586/#_14","title":"\u5f20\u7231\u73b2\u6563\u6587","text":"<p>\u5979\u662f\u4e00\u4e2a\u5584\u4e8e\u5c06\u827a\u672f\u751f\u6d3b\u5316\uff0c\u751f\u6d3b\u827a\u672f\u5316\u7684\u4eab\u4e50\u4e3b\u4e49\u8005\uff0c\u53c8\u662f\u4e00\u4e2a\u5bf9\u751f\u6d3b\u5145\u6ee1\u60b2\u5267\u611f\u7684\u4eba\uff1b\u5979\u662f\u540d\u95e8\u4e4b\u540e\uff0c\u8d35\u5e9c\u5c0f\u59d0\uff0c\u5374\u9a84\u50b2\u7684\u5ba3\u79f0\u81ea\u5df1\u662f\u4e00\u4e2a\u81ea\u98df\u5176\u529b\u7684\u5c0f\u5e02\u6c11\u2026\u2026\u5979\u5c31\u662f\u4e2d\u56fd\u6587\u5b66\u53f2\u4e0a\u7684\u4e00\u4e2a\u80fd\u5c06\u624d\u4e0e\u60c5\u6253\u6210\u4e00\u7247\u7684\u5f02\u6570\u4f5c\u5bb6\u2014\u2014\u5f20\u7231\u73b2!\u5982\u679c\u4f60\u60f3\u4e00\u7779\u5979\u7684\u624d\u60c5\uff0c\u672c\u4e66\uff0c\u4f60\u600e\u80fd\u9519\u8fc7\uff01</p> <ul> <li>\u8fdf\u66ae</li> <li>\u79cb\u96e8</li> <li>\u8bfb\u4e66\u62a5\u544a\u56db\u5219</li> <li>\u8bba\u5361\u901a\u753b\u4e4b\u524d\u9014</li> <li>\u7267\u7f8a\u8005\u7d20\u63cf</li> <li>\u5fc3\u613f</li> <li>\u7231</li> <li>\u5929\u624d\u68a6</li> <li>\u7ae5\u8a00\u65e0\u5fcc</li> <li>\u9053\u8def\u4ee5\u76ee</li> <li>\u66f4\u8863\u8bb0</li> <li>\u59d1\u59d1\u8bed\u5f55</li> <li>\u6c14\u77ed\u60c5\u957f\u53ca\u5176\u4ed6</li> <li>\u5409\u5229</li> <li>\u501f\u94f6\u706f</li> <li>\u70ec\u4f59\u5f55</li> <li>\u5230\u5e95\u662f\u4e0a\u6d77\u4eba</li> <li>\u6253\u4eba</li> <li>\u8bba\u5199\u4f5c</li> <li>\u79d8\u5bc6</li> <li>\u8bd7\u4e0e\u80e1\u8bf4</li> <li>\u53cc\u58f0</li> <li>\u8bf4\u80e1\u841d\u535c</li> <li>\u79c1\u8bed</li> <li>\u5fc5\u4e5f\u6b63\u540d\u4e4e</li> <li>\u516c\u5bd3\u751f\u6d3b\u8bb0\u8da3</li> <li>\u8c08\u5403\u4e0e\u753b\u997c\u5145\u9965</li> <li>\u8868\u59e8\u7ec6\u59e8\u53ca\u5176\u4ed6</li> <li>\u88ab \u7a9d</li> <li>\u8c08\u753b</li> <li>\u8c08\u5973\u4eba</li> <li>\u5b58\u7a3f</li> <li>\u8c08\u8df3\u821e</li> <li>\u8c08\u97f3\u4e50</li> <li>\u5fd8\u4e0d\u4e86\u7684\u753b</li> <li>\u6211\u770b\u82cf\u9752</li> <li>\u5199\u4ec0\u4e48</li> <li>\u708e\u6a31\u8bed\u5f55</li> <li>\u6d0b\u4eba\u770b\u4eac\u620f\u53ca\u5176\u4ed6</li> <li>\u591c\u8425\u7684\u5587\u53ed</li> <li>\u5fc6\u80e1\u9002\u4e4b</li> <li>\u94f6\u5bab\u5c31\u5b66\u8bb0</li> <li>\u6709\u51e0\u53e5\u8bdd\u540c\u8bfb\u8005\u8bf4</li> <li>\u6709\u5973\u540c\u8f66</li> <li>\u96e8\u4f1e\u4e0b</li> <li>\u8349\u7089\u997c</li> <li>\u9020\u4eba</li> <li>\u4e08\u4eba\u7684\u5fc3</li> <li>\u4e2d\u56fd\u7684\u65e5\u591c</li> <li>\u4e2d\u56fd\u4eba\u7684\u5b97\u6559</li> <li>\u81ea\u5df1\u7684\u6587\u7ae0</li> <li>\u8d70\uff01\u8d70\u5230\u697c\u4e0a\u53bb</li> <li>\u8c08\u770b\u4e66(1)</li> <li>\u8c08\u770b\u4e66(2)</li> <li>\u8c08\u770b\u4e66\u540e\u8bb0</li> <li>\u534e\u4e3d\u7f18</li> <li>\u300a\u592a\u592a\u4e07\u5c81\u300b\u9898\u8bb0</li> <li>\u300a\u7ea2\u697c\u68a6\u9b47\u300b\u81ea\u5e8f</li> <li>\u300a\u5f20\u770b\u300b\u81ea\u5e8f</li> <li>\u300a\u60d8\u7136\u8bb0\u300b\u5e8f</li> <li>\u56fd\u8bed\u672c\u300a\u6d77\u4e0a\u82b1\u300b\u8bd1\u540e\u8bb0</li> <li>\u300a\u6d77\u4e0a\u82b1\u300b\u7684\u51e0\u4e2a\u95ee\u9898</li> <li>\u6563 \u620f</li> </ul>","tags":["\u5f20\u7231\u73b2","\u6587\u96c6","\u4f5c\u54c1\u96c6","Eileen Zhang"]},{"location":"BOOKS/2018-05-23-%25e5%25bc%25a0%25e7%2588%25b1%25e7%258e%25b2%25e6%2596%2587%25e9%259b%2586/#_15","title":"\u5f20\u7231\u73b2\u4e2d\u77ed\u7bc7\u5c0f\u8bf4","text":"","tags":["\u5f20\u7231\u73b2","\u6587\u96c6","\u4f5c\u54c1\u96c6","Eileen Zhang"]},{"location":"BOOKS/2018-05-23-%25e5%25bc%25a0%25e7%2588%25b1%25e7%258e%25b2%25e6%2596%2587%25e9%259b%2586/#_16","title":"\u4e2d\u7bc7\u5c0f\u8bf4","text":"<ul> <li>\u6c89\u9999\u5c51 \u7b2c\u4e00\u7089\u9999</li> <li>\u591a\u5c11\u6068</li> <li>\u91d1\u9501\u8bb0</li> <li>\u7ea2\u73ab\u7470\u4e0e\u767d\u73ab\u7470</li> <li>\u5c0f\u827e</li> <li>\u8fde\u73af\u5957</li> <li>\u521b\u4e16\u7eaa</li> <li>\u6d6e\u82b1\u6d6a\u854a</li> <li>\u540c\u5b66\u5c11\u5e74\u90fd\u4e0d\u8d31</li> </ul>","tags":["\u5f20\u7231\u73b2","\u6587\u96c6","\u4f5c\u54c1\u96c6","Eileen Zhang"]},{"location":"BOOKS/2018-05-23-%25e5%25bc%25a0%25e7%2588%25b1%25e7%258e%25b2%25e6%2596%2587%25e9%259b%2586/#_17","title":"\u77ed\u7bc7\u5c0f\u8bf4","text":"<ul> <li>\u725b</li> <li>\u6bb7\u5b9d\u6edf\u9001\u82b1\u697c\u4f1a\u2014\u5217\u5973\u4f20\u4e4b\u4e00</li> <li>\u5c01\u9501</li> <li>\u9738\u738b\u522b\u59ec</li> <li>\u7b49</li> <li>\u7409\u7483\u74e6</li> <li>\u6c89\u9999\u5c51\u7b2c\u4e8c\u7089\u9999</li> <li>\u6842\u82b1\u84b8 \u963f\u5c0f\u60b2\u79cb</li> <li>\u5e74\u9752\u7684\u65f6\u5019</li> <li>\u8309\u8389\u9999\u7247</li> <li>\u7559\u60c5</li> <li>\u82b1\u51cb</li> <li>\u5fc3\u7ecf</li> <li>\u9e3f\u9e3e\u79a7</li> <li>\u8272\u6212</li> <li>\u76f8\u89c1\u6b22</li> <li>\u4e94\u56db\u9057\u4e8b</li> <li>\u91cd\u8bbf\u8fb9\u57ce</li> <li>\u4e0d\u5e78\u7684\u5979</li> </ul>","tags":["\u5f20\u7231\u73b2","\u6587\u96c6","\u4f5c\u54c1\u96c6","Eileen Zhang"]},{"location":"BOOKS/2018-05-23-%25e5%25bc%25a0%25e7%2588%25b1%25e7%258e%25b2%25e6%2596%2587%25e9%259b%2586/#_18","title":"\u5979\u4ece\u6d77\u4e0a\u6765\uff1a\u65f7\u4e16\u624d\u5973\u5f20\u7231\u73b2\u4f20\u5947","text":"<p>\u4f5c\u8005\uff1a[\u53f0]\u738b\u8559\u73b2\u4e00\u4e5d\u4e94\u4e94\u5e74\u79cb\u5929\u7684\u65e7\u91d1\u5c71\u7801\u5934\u4e0a\uff0c\u6e05\u6668\u7684\u5929\u8272\u662f\u6c89\u90c1\u7684\u7070\u84dd\uff0c\u6d53\u5bc6\u7684\u5927\u96fe\u8986\u76d6\u5728\u6d77\u4e0a\uff0c\u706f\u5854\u5149\u675f\u56de\u65cb\u5728\u6d77\u5cb8\uff0c\u5149\u675f\u91cc\u98d8\u7740\u5343\u4e1d\u4e07\u7f15\u5bc6\u5bc6\u7684\u96e8\u4e1d\u3002\u6e2f\u53e3\u5916\u4f20\u6765\u60a0\u957f\u7684\u6c7d\u7b1b\u58f0\uff0c\u90a3\u662f\u5927\u8239\u5728\u7b49\u5f85\u8fdb\u6e2f\u3002\u5bf9\u65e7\u91d1\u5c71\u6765\u8bf4\uff0c\u8fd9\u7834\u6653\u7684\u4e00\u523b\u4e0e\u5e73\u65e5\u65e0\u5f02\u3002\u4f46\u5728\u8239\u4e0a\u7684\u5f20\u7231\u73b2\u773c\u4e2d\uff0c\u9690\u9690\u7ea6\u7ea6\u6d6e\u73b0\u7684\u91d1\u95e8\u5927\u6865\u7ea2\u8272\u7684\u6865\u8eab\uff0c\u4eff\u4f5b\u7ed9\u4e86\u5979\u4e00\u4e2a\u4fdd\u8bc1\u3002\u8fc7\u53bb\u5728\u832b\u832b\u4e00\u7247\u7684\u5927\u6d77\u548c\u96fe\u972d\u4e2d\u9690\u9000\u3002\u672a\u6765\u5c31\u5728\u5979\u7d27\u7d27\u63e1\u7740\u8239\u8237\u680f\u6746\u7684\u7ea4\u7626\u7684\u624b\u4e2d\u3002</p> <ul> <li>\u7b2c\u4e00\u7ae0</li> <li>\u7b2c\u4e8c\u7ae0</li> <li>\u7b2c\u4e09\u7ae0</li> <li>\u7b2c\u56db\u7ae0</li> <li>\u7b2c\u4e94\u7ae0</li> <li>\u7b2c\u516d\u7ae0</li> <li>\u7b2c\u4e03\u7ae0</li> <li>\u7b2c\u516b\u7ae0</li> <li>\u7b2c\u4e5d\u7ae0</li> <li>\u7b2c\u5341\u7ae0</li> <li>\u7b2c\u5341\u4e00\u7ae0</li> <li>\u7b2c\u5341\u4e8c\u7ae0</li> <li>\u7b2c\u5341\u4e09\u7ae0</li> <li>\u7b2c\u5341\u56db\u7ae0</li> <li>\u7b2c\u5341\u4e94\u7ae0</li> <li>\u7b2c\u5341\u516d\u7ae0</li> <li>\u7b2c\u5341\u4e03\u7ae0</li> <li>\u7b2c\u5341\u516b\u7ae0</li> <li>\u7b2c\u5341\u4e5d\u7ae0</li> <li>\u7b2c\u4e8c\u5341\u7ae0</li> </ul>","tags":["\u5f20\u7231\u73b2","\u6587\u96c6","\u4f5c\u54c1\u96c6","Eileen Zhang"]},{"location":"BOOKS/2018-05-23-%25e5%25bc%25a0%25e7%2588%25b1%25e7%258e%25b2%25e6%2596%2587%25e9%259b%2586/#_19","title":"\u6458\u81ea","text":"<ul> <li>http://www.kanunu8.com/files/writer/95.html</li> </ul>","tags":["\u5f20\u7231\u73b2","\u6587\u96c6","\u4f5c\u54c1\u96c6","Eileen Zhang"]},{"location":"BOOKS/2019-10-09-mooc%25e7%25b4%25b0%25e8%25ae%2580%25e5%25bc%25b5%25e6%2584%259b%25e7%258e%25b2%25e5%259c%25a8%25e7%25ba%25bf%25e8%25af%25be%25e7%25a8%258b.html/","title":"[MOOC]\u7d30\u8b80\u5f35\u611b\u73b2\u5728\u7ebf\u8bfe\u7a0b","text":"<p>\u5728\u7ebf\u8bfe\u7a0b https://courses.openedu.tw/courses/course-v1:SP+1040002091+105/course/</p>","tags":["\u5f20\u7231\u73b2","\u6768\u4f73\u5a34","\u8bfe\u7a0b","MOOC"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/","title":"\u4e09\u9636\u9b54\u65b9CFOP\u7b80\u7248 Rubik Simple CFOP method","text":"","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#_1","title":"\u7b26\u53f7\u7ea6\u5b9a","text":"<pre><code>\u9b54\u65b9\u521d\u59cb\uff1a\u767d\u5bf9\u9ec4\uff0c\u6a59\u5bf9\u7ea2\uff0c\u84dd\u5bf9\u7eff\n\nW w\uff1a\u767d    Y y\uff1a\u9ec4    \nO o\uff1a\u6a59    R r\uff1a\u7ea2   \nB b\uff1a\u84dd    G g\uff1a\u7eff \nx: \u9876\u9762\u989c\u8272 (e.g. Y) \n&lt; &gt; ^ v (\u65b9\u5411\u7b26\u53f7): \u9876/\u5e95\u9762\u989c\u8272(e.g. Y/W)\n# \u5c0f\u5199\u5b57\u6bcd(x\u9664\u5916)\u548c\u65b9\u5411\u7b26\u53f7: \u770b\u4e0d\u89c1\u7684\u90a3\u4e00\u9762\u4e0a\u7684\u989c\u8272\n\nL: \u5de6\u9762    R: \u53f3\u9762    \nU: \u9876\u9762    D: \u5e95\u9762    \nF: \u6b63\u9762    B: \u80cc\u9762    \nFw: \u6b63\u9762\u4e24\u5c42    \nML: \u4e0e\u5de6\u9762\u5e73\u884c\u7684\u4e2d\u95f4\u5c42   \n\n\u65cb\u8f6c\u6807\u8bb0\uff08\u9b54\u65b9\u516c\u5f0f\uff09, \u4ece\u6240\u5728\u9762\u6765\u770b\u65cb\u8f6c\u65b9\u5411\n  \u4e0d\u5e26\u6807\u8bb0 : e.g. R: \u53f3\u9762\u987a\u65f6\u9488\u65cb\u8f6c90\u00b0\n  '       : e.g. R': \u53f3\u9762\u9006\u65f6\u9488\u65cb\u8f6c90\u00b0 \n  2       : \u987a\u65f6\u9488\u65cb\u8f6c180\u00b0 (i.e.\u8fde\u7eed\u65cb\u8f6c\u4e24\u6b21) \n  2'      : \u9006\u65f6\u9488\u65cb\u8f6c180\u00b0\n  x/y/z   : \u6574\u4e2a\u9b54\u65b9\u4ee5R/U/F\u7684\u65b9\u5411\u8f6c\u52a8\n  x'/y'/z\u2018: \u6574\u4e2a\u9b54\u65b9\u4ee5R'/U'/F'\u7684\u65b9\u5411\u8f6c\u52a8 \n</code></pre> <p>CFOP: Cross \u2013 F2L \u2013 OLL \u2013 PLL </p> <p>Cross (C)    First Two Layers (F2L) Orientation of the Last Layer (OLL)   Permutation of the Last Layer (PLL)    </p> <p>\u4e0b\u9762\u5047\u8bbe\u5e95\u9762\u767d\u8272(W)\uff0c\u9876\u9762\u9ec4\u8272(Y)\u3002</p>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#step1-cross","title":"STEP1. Cross","text":"<p>\u76ee\u6807\u662f\u5bf9\u597d\u5e95\u5c42\u76844\u4e2a\u68f1\u5757\u3002 </p> <ul> <li>CASE1.1. \u767d\u8272\u5728\u9876\u9762\uff0c\u65cb\u8f6c180\u00b0\u81f3\u5e95\u5c42  </li> <li>CASE1.2. \u767d\u8272\u5728\u5e95\u5c42\u4fa7\u9762\uff0c\u65cb\u8f6c180\u00b0\u81f3\u9876\u5c42\u4fa7\u9762  </li> <li>CASE1.3. \u767d\u8272\u5728\u9876\u5c42\u4fa7\u9762 \u65cb\u8f6c\u9876\u5c42\uff0c\u5c06\u767d\u8272\u653e\u5728\u76ee\u6807\u4f4d\u53f3\u9762 e.g. \u68f1\u5757\u989c\u8272\u4e3aRW\uff0c\u5c31\u4ee5R\u4e3a\u6b63\u9762\uff0c\u4f7f\u7528\u5982\u4e0b\u516c\u5f0f</li> </ul> <pre><code>+----+----+----+\n|    |    |    |\n+----+----+----+\n|    | R  |    |\n+----+----+----+\n|    |    |    |\n+----+----+----+\n\nR'  F  R\n</code></pre>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#step2-f2l","title":"STEP2. F2L","text":"","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#case1-4","title":"CASE1-4\uff1a\u57fa\u672c\u60c5\u51b5","text":"","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#case21","title":"CASE2.1","text":"<p>e.g. \u9876\u9762Y \u6b63\u9762B \u53f3\u9762R\uff1b\u89d2\u5757\u767d\u8272\u4f4d\u4e8e\u53f3\u9762 <pre><code>+----+----+----+\n|    | Br |    |\n+----+----+----+\n|    | Y  |    |\n+----+----+----+\n|    |    | Rb&gt;|\n+----+----+----+\n\nR  U  R'\n</code></pre></p>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#case22","title":"CASE2.2","text":"<p>e.g. \u9876\u9762Y \u6b63\u9762B \u5de6\u9762O\uff1b\u89d2\u5757\u767d\u8272\u4f4d\u4e8e\u5de6\u9762 <pre><code>+----+----+----+\n|    | Bo |    |\n+----+----+----+\n|    | Y  |    |\n+----+----+----+\n|&lt;Ob |    |    |\n+----+----+----+\n\nL'  U'  L\n</code></pre></p>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#case23","title":"CASE2.3","text":"<p>e.g. \u9876\u9762Y \u6b63\u9762R \u53f3\u9762G\uff1b\u89d2\u5757\u767d\u8272\u4f4d\u4e8e\u6b63\u9762 <pre><code>+----+----+----+\n|    |    |    |\n+----+----+----+\n|    | Y  | Rg |\n+----+----+----+\n|    |    | Rgv|\n+----+----+----+\n\nU  R  U'  R'\n</code></pre></p>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#case24","title":"CASE2.4","text":"<p>e.g. \u9876\u9762Y \u6b63\u9762G \u5de6\u9762R\uff1b\u89d2\u5757\u767d\u8272\u4f4d\u4e8e\u6b63\u9762</p> <pre><code>+----+----+----+\n|    |    |    |\n+----+----+----+\n| GR | Y  |    |\n+----+----+----+\n| GRv|    |    |\n+----+----+----+ \n\nU'  L'  U  L\n</code></pre>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#case25-9case21-4","title":"CASE2.5-9\uff1a\u53ef\u53d8\u6362\u4e3aCASE2.1-4","text":"","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#case25","title":"CASE2.5","text":"<p>e.g. \u6b63\u9762G \u5de6\u9762R \u5e95\u9762W\uff1b\u89d2\u5757\u767d\u8272\u4f4d\u4e8e\u5e95\u9762</p> <p>\u7528CASE2.3\u516c\u5f0f.</p> <pre><code>+----+----+----+\n|    | Rg |    |\n+----+----+----+\n|    | G  |    |\n+----+----+----+\n|    |    | Rgv|\n+----+----+----+ \n</code></pre>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#case26","title":"CASE2.6","text":"<p>e.g \u6b63\u9762O \u5de6\u9762G \u5e95\u9762W\uff1b\u89d2\u5757\u767d\u8272\u4f4d\u4e8e\u5e95\u9762</p> <p>\u7528CASE4\u516c\u5f0f.</p> <pre><code>+----+----+----+\n|    | Gr |    |\n+----+----+----+\n|    | O  |    |\n+----+----+----+\n| Grv|    |    |\n+----+----+----+ \n</code></pre>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#case27","title":"CASE2.7","text":"<p>\u767d\u8272\u5728\u4fa7\u9762\uff0c\u89d2\u5757\u4e0e\u68f1\u5757\u5728\u9876\u5c42\u5f02\u8272</p> <p>\u85cf\u89d2\u53d8\u6362\u4e3aCASE2.1-2</p>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#case28","title":"CASE2.8","text":"<p>\u767d\u8272\u5728\u4fa7\u9762\uff0c\u89d2\u5757\u4e0e\u68f1\u5757\u5728\u9876\u5c42\u540c\u8272</p> <p>\u5982\u679c\u53ea\u5dee\u4e00\u5bf9\u68f1\u89d2\u5757\uff0c\u85cf\u89d2\u53d8\u6362\u4e3aCASE2.7</p> <p>\u5426\u5219\uff0c\u85cf\u89d2\u53d8\u6362\u4e3aCASE2.3-4</p>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#case29","title":"CASE2.9","text":"<p>\u767d\u8272\u5728\u9876\u5c42\uff0c\u89d2\u5757\u4e0e\u68f1\u5757\u5206\u79bb</p> <p>\u5148\u5bf9\u9f50\u68f1\u5757\u4fa7\u9762\u4e0e\u4e2d\u5fc3\u989c\u8272\uff1b</p> <p>\u85cf\u68f1\u4e8e\u76ee\u6807\u4f4d\u5bf9\u8fb9\uff0c\u53d8\u6362\u4e3aCASE2.3-4</p>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#case210","title":"CASE2.10","text":"<p>\u7b2c\u4e8c\u5c42\u53ea\u5dee\u4e00\u4e2a\u68f1\u5757</p> <p>\u7528\u5c42\u5148\u6cd5\u8fd8\u539f.</p>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#step3-oll-10","title":"STEP3. OLL (10\u4e2a\u516c\u5f0f)","text":"","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#fru-3","title":"FRU (3\u4e2a\u516c\u5f0f)","text":"","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#case31","title":"CASE3.1  \u4e00\u5b57","text":"<p>FRU\u516c\u5f0f</p> <p><pre><code>F  R  U \nR'  U'  F'\n</code></pre> \u6ce8: \u62c7\u6307\u6309\u4f4f\u5e95\u9762\u98df\u6307\u62e8F</p>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#case32-l","title":"CASE3.2  L\u5f62\u72b6","text":"<p>FwRU\u516c\u5f0f</p> <pre><code>Fw  R  U \nR'  U'  Fw'\n</code></pre>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#case33","title":"CASE3.3  \u4e00\u70b9","text":"<p>\u7528 <code>FRU\u516c\u5f0f</code> + <code>FwRU\u516c\u5f0f</code></p>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#case34-t","title":"CASE3.4  \u6a2a\u5411T\u5b57","text":"<p>\u5de6\u9762\u4e24\u5757\u9ec4\uff0c\u524d\u540e\u5404\u4e00\u5757\u9ec4. </p> <p>\u7528<code>FRU\u516c\u5f0f</code></p> <pre><code>+----+----+----+\n|&lt;   | ^  | x  |\n+----+----+----+\n| x  | x  | x  |\n+----+----+----+\n|&lt;   | v  | x  |\n+----+----+----+ \n</code></pre>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#case35","title":"CASE3.5  \u53f3\u62c7\u6307","text":"<p>\u5de6\u9762\u4e09\u5757\u9ec4</p> <p>\u7528<code>FwRU\u516c\u5f0f</code></p> <pre><code>+----+----+----+\n|&lt;   |    | x  |\n+----+----+----+\n|&lt;   | x  | x  |\n+----+----+----+\n|&lt;   | x  | x  |\n+----+----+----+ \n</code></pre>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#case36","title":"CASE3.6  \u5de6\u62c7\u6307","text":"<p>\u53f3\u9762\u4e09\u5757\u9ec4\uff0cCASE3.5\u7684\u955c\u50cf.</p> <p>\u7528<code>FwRU\u955c\u50cf\u516c\u5f0f</code></p> <pre><code>+----+----+----+\n| x  |    |   &gt;|\n+----+----+----+\n| x  | x  |   &gt;|\n+----+----+----+\n| x  | x  |   &gt;|\n+----+----+----+ \n\nFw'  L'  U' \nL  U  Fw\n</code></pre>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#7","title":"\u5c0f\u9c7c+ (7\u4e2a\u516c\u5f0f)","text":"","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#f31-1","title":"F3.1   \u5c0f\u9c7c1","text":"<p>\u9c7c\u5934\u5728\u53f3\u4e0a\u89d2\uff0c\u53f3\u97621\u9ec4</p> <pre><code>+----+----+----+\n|    | x  | x  |\n+----+----+----+\n| x  | x  | x  |\n+----+----+----+\n|    | x  |   &gt;|\n+----+----+----+ \n\nR  U2'  \nR'  U'  R  U' \nR'\n</code></pre> <p>\u6ce8: \u9876\u5c42\u4e00\u76f4\u5728\u9006\u65f6\u9488\u65cb\u8f6c    \u00a0\u00a0\u00a0\u00a0\u62c7\u6307\u6309\u4f4f\u5e95\u9762\u505a\u7b2c\u4e00\u4e2aR    \u00a0\u00a0\u00a0\u00a0U2'\u7684\u7b2c\u4e00\u4e2aU\u7531\u62c7\u6307\u62e8\uff0c\u7b2c\u4e8c\u4e2aU\u7531\u5de6\u624b\u98df\u6307\u62e8</p>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#f32-2","title":"F3.2   \u5c0f\u9c7c2","text":"<p>\u9c7c\u5934\u5728\u53f3\u4e0b\u89d2\uff0c\u53f3\u97621\u9ec4</p> <pre><code>+----+----+----+\n|    | x  |   &gt;|\n+----+----+----+\n| x  | x  | x  |\n+----+----+----+\n|    | x  | x  |\n+----+----+----+   \n\nR' U2  \nR  U  R' U\nR\n</code></pre> <p>\u6ce8:  \u9876\u5c42\u4e00\u76f4\u5728\u987a\u65f6\u9488\u65cb\u8f6c    \u00a0\u00a0\u00a0\u00a0\u62c7\u6307\u6309\u4f4f\u9876\u9762\u505a\u7b2c\u4e00\u4e2aR'    \u00a0\u00a0\u00a0\u00a0U2\u7684\u7b2c\u4e00\u4e2aU\u7531\u98df\u6307\u62e8\uff0c\u7b2c\u4e8c\u4e2aU\u7531\u4e2d\u6307\u62e8    \u00a0\u00a0\u00a0\u00a0\u62c7\u6307\u6309\u4f4f\u5e95\u9762\u505a\u7b2c\u4e00\u4e2aR    \u00a0\u00a0\u00a0\u00a0\u6700\u540e\u4e00\u4e2aU\u7531\u65e0\u540d\u6307\u6216\u5c0f\u6307\u62e8 </p>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#f33","title":"F3.3  \u53cc\u9c7c","text":"<p>\u9876\u5c42\u7f3a2\u9ec4\uff0c\u6b63\u97621\u9ec4</p> <pre><code>+----+----+----+\n|&lt;   | x  | x  |\n+----+----+----+\n| x  | x  | x  |\n+----+----+----+\n| x  | x  | v  |\n+----+----+----+ \n\nF'\nRw  U  R'  U' \nRw'  F  R \n</code></pre>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#f34","title":"F3.4  \u897f\u9c7c","text":"<p>\u9876\u5c42\u7f3a2\u9ec4\uff0c\u6b63\u97621\u9ec4\uff0c\u80cc\u97621\u9ec4</p> <pre><code>+----+----+----+\n| ^  | x  | x  |\n+----+----+----+\n| x  | x  | x  |\n+----+----+----+\n| v  | x  | x  |\n+----+----+----+ \n\nRw  U  R'  U' \nRw'  F  R  F'\n</code></pre> <p>\u6ce8: \u62c7\u6307\u6309\u4f4f\u5e95\u9762\u505aRw  \u524d7\u6b65\u4e0eF3.3\u7684\u540e7\u6b65\u4e00\u6837</p>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#f35","title":"F3.5  \u5317\u9c7c","text":"<p>\u9876\u5c42\u7f3a2\u9ec4\uff0c\u80cc\u97622\u9ec4</p> <pre><code>+----+----+----+\n| ^  | x  | ^  |\n+----+----+----+\n| x  | x  | x  |\n+----+----+----+\n| x  | x  | x  |\n+----+----+----+ \n\nR2'  D'  R  U2'  \nR'  D  R  U2'  R\n</code></pre> <p>\u6ce8: \u62c7\u6307\u6309\u4f4f\u80cc\u9762\u505aR2'    \u00a0\u00a0\u00a0\u00a0\u6700\u540e\u7684R\u7528\u65e0\u540d\u6307\u5e26\u56de</p>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#f36-1","title":"F3.6  \u5341\u5b571","text":"<p>\u9876\u5c42\u7f3a4\u9ec4\uff0c\u6b63\u97622\u9ec4\uff0c\u80cc\u97622\u9ec4</p> <pre><code>+----+----+----+\n| ^  | x  |  ^ |\n+----+----+----+\n| x  | x  | x  |\n+----+----+----+\n| v  | x  |  v |\n+----+----+----+ \n\nR  U2  R'  U'\nR  U  R'  U'\nR  U'  R'\n</code></pre> <p>\u6ce8: \u62c7\u6307\u6309\u4f4f\u5e95\u9762\u505a\u7b2c\u4e00\u4e2aR  \u00a0\u00a0\u00a0\u00a0\u62c7\u6307\u6309\u4f4f\u6b63\u9762\u505a\u7b2c\u4e00\u4e2aR'</p>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#f37-2","title":"F3.7 \u5341\u5b572","text":"<p>\u9876\u5c42\u7f3a4\u9ec4\uff0c\u6b63\u97621\u9ec4\uff0c\u80cc\u97621\u9ec4\uff0c\u5de6\u97622\u9ec4</p> <pre><code>+----+----+----+\n|&lt;   | x  |  ^ |\n+----+----+----+\n| x  | x  | x  |\n+----+----+----+\n|&lt;   | x  |  v |\n+----+----+----+ \n\nR  U2'  \nR2'  U'  R2  U'  \nR2'  U2  R\n</code></pre> <p>\u6ce8: \u62c7\u6307\u6309\u4f4f\u6b63\u9762\u505a\u7b2c\u4e00\u4e2aR    \u00a0\u00a0\u00a0\u00a0\u62c7\u6307\u6309\u4f4f\u80cc\u9762\u6765\u505a\u6700\u540e\u7684R2'</p>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#step4-pll-6","title":"STEP4. PLL  (6\u4e2a\u516c\u5f0f)","text":"","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#41","title":"4.1  \u8fd8\u539f\u89d2\u5757","text":"","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#f411","title":"F4.1.1  \u627e\u5230\u4e24\u89d2\u540c\u8272\u7684\u8fb9","text":"<p>\u628a\u5b83\u653e\u5728\u53f3\u9762</p> <pre><code>e.g. \n+----+----+----+\n|    |    |  b |\n+----+----+----+\n|    |    |    |\n+----+----+----+\n|    |    |  b |\n+----+----+----+ \n\nx'\nR2  D2  \nR'  U'  \nR  D2  \nR'  U  R'\nx\n</code></pre>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#f412","title":"F4.1.2  \u89d2\u5757\u5bf9\u6362","text":"<pre><code>+----+----+----+\n| &lt;--|----|--&gt; |\n+----+----+----+\n|    |    |    |\n+----+----+----+\n| &lt;--|----|--&gt; |\n+----+----+----+ \n\nR2'  U  R'  U'\ny  (R  U  R'  U')2  (R  U  R')\ny'  R  U'  R2\n</code></pre>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#42","title":"4.2  \u8fd8\u539f\u68f1\u5757","text":"","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#f421","title":"F4.2.1  \u9876\u5c42\u9006\u65f6\u9488\u4e09\u8f6e\u6362","text":"<pre><code>1--&gt;2--&gt;3--&gt;1\n\n+----+----+----+\n|    |    |    |\n+----+----+----+\n|3&lt;--|----|---2|\n+----+----+----+\n|    | 1  |    |\n+----+----+----+ \n\nR  U'  (R  U)2  R  U'\nR'  U'  R2\n</code></pre>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#f422","title":"F4.2.2  \u9876\u5c42\u987a\u65f6\u9488\u4e09\u8f6e\u6362","text":"<pre><code>1--&gt;2--&gt;3--&gt;1\n\n+----+----+----+\n|    |    |    |\n+----+----+----+\n|2---|----|--&gt;3|\n+----+----+----+\n|    | 1  |    |\n+----+----+----+ \n\nR2'  U  R  U  \n(R'  U')2\nR'  U  R'\n</code></pre>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#f423","title":"F4.2.3  \u5341\u5b57\u5bf9\u6362","text":"<pre><code>+----+----+----+\n|    | \u2191  |    |\n+----+----+----+\n| &lt;--|-+--|--&gt; |\n+----+----+----+\n|    | \u2193  |    |\n+----+----+----+ \n\nML2  U\nML2  U2\nML2  U\nML2\n</code></pre>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-08-20-rubik-simplecfop/#f424","title":"F4.2.4  \u68f1\u5757\u5e73\u884c\u5bf9\u6362","text":"<pre><code>1&lt;--&gt;2,  3&lt;--&gt;4\n\n+----+----+----+\n|    | 4  |    |\n+----+----+----+\n| 3  |    | 2  |\n+----+----+----+\n|    | 1  |    |\n+----+----+----+ \n\n(ML2  U)2\nML'  U2\nML2  U2\nML'  U2\n</code></pre> <p>See: rubik.com.cn/simplecfop.htm</p>","tags":["CFOP","\u9b54\u65b9"]},{"location":"BOOKS/2021-10-29-applied-mathematical-programming/","title":"Applied Mathematical Programming  by Bradley, Hax, and Magnanti (Addison-Wesley, 1977)","text":"<p>This book is a reference book for 15.053, Optimization Methods in \u00a0\u00a0Business Analytics, taught at MIT.</p> <p>To make the book available online, most chapters have been re-typeset.</p> <p>Chapters 6, 7 and 10 were not, but are still available (as direct scans of the original chapters).</p>","tags":["mathematical","programming"]},{"location":"BOOKS/2021-10-29-applied-mathematical-programming/#downloads-of-the-book-and-its-chapters","title":"Downloads of the book and its chapters","text":"<ul> <li>Entire Book   minus Chapters 6, 7 and 10</li> <li>Chapter 1.   Mathematical Programming:  An Overview</li> <li>Chapter 2.    Solving Linear Programs</li> <li>Chapter 3.    Sensitivity Analysis</li> <li>Chapter 4.    Duality in Linear Programming</li> <li>Chapter 5.    Mathematical Programming in Practice</li> <li>Chapter 6    (scanned).   Integration of Strategic and Tactical Planning in the Aluminum Industry</li> <li>Chapter 7   (scanned).   Planning the Mission and Composition of the U.S.  Merchant Marine Fleet</li> <li>Chapter 8.    Network Models</li> <li>Chapter 9.    Integer Programming</li> <li>Chapter 10   (scanned).   Design of a Naval Tender Job Shop</li> <li>Chapter 11.   Dynamic Programming</li> <li>Chapter 12.   Large-Scale Systems</li> <li>Chapter 13.   Nonlinear Programming</li> <li>Chapter 14.   A System for Bank Portfolio Planning</li> <li>Appendix A.  Vectors and Matrices</li> <li>Appendix B.  Linear Programming in Matrix Form</li> <li>Appendix C.  A Labeling Algorithm for the Max Flow Problem</li> </ul>","tags":["mathematical","programming"]},{"location":"BOOKS/2021-10-29-applied-mathematical-programming/#some-excel-exercises","title":"Some Excel exercises.","text":"<p>Remark:  These exercises (and Excel) were developed after the book was published.</p> <ul> <li>Exercise 3.1 </li> <li>Exercise 3.2  </li> <li>Exercise 3.7 </li> <li>Exercise 3.9  </li> <li>Exercise 3.10</li> <li>Exercise 3.11 </li> <li>Exercise 3.12</li> <li>Exercise 3.14 </li> <li>Exercise 3.15 </li> <li>Exercise 3.16 </li> <li>Exercise 3.18 </li> <li>Exercise 3.19 </li> <li>Exercise 3.25 </li> <li>Exercise 3.28 </li> </ul>","tags":["mathematical","programming"]},{"location":"BOOKS/2021-10-29-applied-mathematical-programming/#other-spreadsheets","title":"Other spreadsheets","text":"<ul> <li>Section 1.3.  Blast furnace example       </li> <li>Section 1.3.  Portfolio selection example </li> <li>Section 1.4.   Glass manufacturing example</li> <li>Section 2.3.   A simple example           </li> <li>Figure 2.4.   Pivoting                    </li> <li>Figure 2.6.  Pivoting.                    </li> <li>Section 3.1.   Tableaus                   </li> <li>Section 3.6.   Glasses (again)            </li> <li>Section 3.6.   Sensitivity tableaus       </li> <li>Section 4.2.   Primal-Dual                </li> </ul> <p>Copied from http://web.mit.edu/15.053/www/AMP.htm</p>","tags":["mathematical","programming"]},{"location":"BOOKS/2021-11-20-online-ebooks/","title":"Online ebooks","text":"Book Author Wonder R.J. Palacio A Thousand Splendid Suns Khaled Hosseini Normal People SALLY ROONEY ANIMAL FARM GEORGE ORWELL THE GREAT GATSBY F. SCOTT FITZGERALD ALICE\u2019S Adventures in Wonderland LEWIS CARROLL \u4e2d\u56fd\u4eba\u7684\u601d\u7ef4\u5371\u673a \u5b8b\u6000\u5e38 \u4e11\u964b\u7684\u4e2d\u56fd\u4eba \u67cf\u6768 \u6c89\u9ed8\u7684\u5927\u591a\u6570 \u738b\u5c0f\u6ce2 \u4e30\u4e73\u80a5\u81c0 \u83ab\u8a00 \u7845\u8c37\u94a2\u94c1\u4fa0 \uff08\u7f8e\uff09\u963f\u4ec0\u5229\u00b7\u4e07\u65af"},{"location":"DATABASE/2015-07-30-centos7-%25e5%25ae%2589%25e8%25a3%2585-mariadb-mysql%25e7%25a4%25be%25e5%258c%25ba%25e7%2589%2588.html/","title":"centos7 \u5b89\u88c5 MariaDB - MySQL\u793e\u533a\u7248","text":"\u4e00\u3001\u5b89\u88c5 # yum install mariadb-server mariadb-client # systemctl start mariadb # systemctl enable mariadb \u4e8c\u3001\u914d\u7f6e 1\u3001\u4fee\u6539root\u7528\u6237\u5bc6\u7801 <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5b89\u88c5\u597dmysql\u6570\u636e\u5e93\u4e4b\u540eroot\u5bc6\u7801\u662f\u7a7a\u7684\uff0c\u4e3a\u4e86\u5b89\u5168\u8d77\u89c1\u9700\u8981\u4fee\u6539root\u7528\u6237\u5bc6\u7801 # mysqladmin -u root password 111111\u00a0\u00a0 //\u5c06root\u7528\u6237\u7684\u5bc6\u7801\u4fee\u6539\u4e3a111111</p> 2\u3001\u8868\u540d\u5927\u5c0f\u5199\u4e0d\u654f\u611f \u7528root\u5e10\u53f7\u767b\u5f55\uff0c\u5728/etc/my.cnf \u6216 /etc/myql/my.cnf\u4e2d\u7684[mysqld]\u540e\u6dfb\u52a0 lower_case_table_names=1 \u4e09\u3001\u521b\u5efa\u6570\u636e\u5e93 1\u3001\u521b\u5efa\u6570\u636e\u5e93 # mysql -u root -p <p>MariaDB [(none)]&gt;\u00a0CREATE DATABASE `malldb` DEFAULT CHARACTER SET utf8 COLLATE utf8_bin;</p> 2\u3001\u8fdc\u7a0b\u8fde\u63a5malldb\u6570\u636e\u5e93 <p>MariaDB [(none)]&gt;\u00a0grant all on malldb.* to root@'%' identified by '123456';</p>","tags":["\u6570\u636e\u5e93","MySQL","MariaDB"]},{"location":"DATABASE/2015-12-07-centos-6-4%25e7%25b3%25bb%25e7%25bb%259fmysql%25e4%25b8%25bb%25e4%25bb%258e%25e5%25a4%258d%25e5%2588%25b6%25e5%259f%25ba%25e6%259c%25ac%25e9%2585%258d%25e7%25bd%25ae%25e5%25ae%259e%25e8%25b7%25b5.html/","title":"CentOS 6.4\u7cfb\u7edfMySQL\u4e3b\u4ece\u590d\u5236\u57fa\u672c\u914d\u7f6e\u5b9e\u8df5","text":"<p>\u4f5c\u8005\uff1aYanjun</p> <p>\u5bf9\u4e8eMySQL\u6570\u636e\u5e93\u4e00\u822c\u7528\u9014\u7684\u4e3b\u4ece\u590d\u5236\uff0c\u53ef\u4ee5\u5b9e\u73b0\u6570\u636e\u7684\u5907\u4efd\uff08\u5982\u679c\u5e0c\u671b\u5728\u4e3b\u8282\u70b9\u5931\u6548\u540e\uff0c\u80fd\u591f\u4f7f\u4ece\u8282\u70b9\u81ea\u52a8\u63a5\u7ba1\uff0c\u5c31\u9700\u8981\u66f4\u52a0\u590d\u6742\u7684\u914d\u7f6e\uff0c\u8fd9\u91cc\u6682\u65f6\u5148\u4e0d\u8003\u8651\uff09\uff0c\u5982\u679c\u4e3b\u8282\u70b9\u51fa\u73b0\u786c\u4ef6\u6545\u969c\uff0c\u6570\u636e\u5e93\u670d\u52a1\u5668\u53ef\u4ee5\u76f4\u63a5\u624b\u52a8\u5207\u6362\u6210\u5907\u4efd\u8282\u70b9\uff08\u4ece\u8282\u70b9\uff09\uff0c\u7ee7\u7eed\u63d0\u4f9b\u670d\u52a1\u3002\u57fa\u672c\u7684\u4e3b\u4ece\u590d\u5236\u914d\u7f6e\u8d77\u6765\u975e\u5e38\u5bb9\u6613\uff0c\u8fd9\u91cc\u6211\u4eec\u505a\u4e2a\u7b80\u5355\u7684\u8bb0\u5f55\u603b\u7ed3\u3002 \u6211\u4eec\u9009\u62e9\u4e24\u53f0\u670d\u52a1\u5668\u6765\u8fdb\u884cMySQL\u7684\u4e3b\u4ece\u590d\u5236\u5b9e\u8df5\uff0c\u4e00\u53f0m1\u4f5c\u4e3a\u4e3b\u8282\u70b9\uff0c\u53e6\u4e00\u53f0nn\u4f5c\u4e3a\u4ece\u8282\u70b9\u3002 \u4e24\u53f0\u673a\u5668\u4e0a\u90fd\u9700\u8981\u5b89\u88c5MySQL\u6570\u636e\u5e93\uff0c\u5982\u679c\u60f3\u8981\u5378\u6389\u9ed8\u8ba4\u5b89\u88c5\u7684\uff0c\u53ef\u4ee5\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a</p> <code>1</code> <code>sudo</code> <code>rpm -e --nodeps mysql</code> <code>2</code> <code>yum list | </code><code>grep</code> <code>mysql</code> <p>\u73b0\u5728\u53ef\u4ee5\u5728CentOS 6.4\u4e0a\u76f4\u63a5\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u8fdb\u884c\u5b89\u88c5\uff1a</p> <code>1</code> <code>sudo</code> <code>yum </code><code>install</code> <code>-y mysql-server mysql mysql-deve</code> <p>\u4e3aroot\u7528\u6237\u8bbe\u7f6e\u5bc6\u7801\uff1a</p> <code>1</code> <code>mysqladmin -u root password </code><code>'shiyanjun'</code> <p>\u7136\u540e\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7MySQL\u5ba2\u6237\u7aef\u767b\u5f55\uff1a</p> <code>1</code> <code>mysql -u root -p</code> <p>\u4e3b\u8282\u70b9\u914d\u7f6e</p> <p>\u9996\u5148\uff0c\u8003\u8651\u5230\u6570\u636e\u5e93\u7684\u5b89\u5168\uff0c\u4ee5\u53ca\u4fbf\u4e8e\u7ba1\u7406\uff0c\u6211\u4eec\u9700\u8981\u5728\u4e3b\u8282\u70b9m1\u4e0a\u589e\u52a0\u4e00\u4e2a\u4e13\u7528\u7684\u590d\u5236\u7528\u6237\uff0c\u4f7f\u5f97\u4efb\u610f\u60f3\u8981\u4ece\u4e3b\u8282\u70b9\u8fdb\u884c\u590d\u5236\u4ece\u8282\u70b9\u90fd\u5fc5\u987b\u4f7f\u7528\u8fd9\u4e2a\u8d26\u53f7\uff1a</p> <code>1</code> <code>CREATE</code> <code>USER</code> <code>repli_user;</code> <code>2</code> <code>GRANT</code> <code>REPLICATION SLAVE </code><code>ON</code> <code>*.* </code><code>TO</code> <code>'repli_user'</code><code>@</code><code>'%'</code> <code>IDENTIFIED </code><code>BY</code> <code>'shiyanjun'</code><code>;</code> <p>\u8fd9\u91cc\u8fd8\u8fdb\u884c\u4e86\u64cd\u4f5c\u6388\u6743\uff0c\u4f7f\u7528\u8fd9\u4e2a\u6362\u7528\u8d26\u53f7\u6765\u6267\u884c\u96c6\u7fa4\u590d\u5236\u3002\u5982\u679c\u60f3\u8981\u9650\u5236IP\u7aef\u6bb5\uff0c\u4e5f\u53ef\u4ee5\u5728\u8fd9\u91cc\u8fdb\u884c\u914d\u7f6e\u6388\u6743\u3002 \u7136\u540e\uff0c\u5728\u4e3b\u8282\u70b9m1\u4e0a\uff0c\u4fee\u6539MySQL\u914d\u7f6e\u6587\u4ef6/etc/my.cnf\uff0c\u4f7f\u5176\u652f\u6301Master\u590d\u5236\u529f\u80fd\uff0c\u4fee\u6539\u540e\u7684\u5185\u5bb9\u5982\u4e0b\u6240\u793a\uff1a</p> <code>01</code> <code>[mysqld]</code> <code>02</code> <code>datadir=/var/lib/mysql</code> <code>03</code> <code>socket=/var/lib/mysql/mysql.sock</code> <code>04</code> <code>user=mysql</code> <code>05</code> <code># Disabling symbolic-links is recommended to prevent assorted security risks</code> <code>06</code> <code>symbolic-links=0</code> <code>07</code> <code>server-id=1</code> <code>08</code> <code>log-bin=m-bin</code> <code>09</code> <code>log-bin-index=m-bin.index</code> <code>10</code> <code>11</code> <code>[mysqld_safe]</code> <code>12</code> <code>log-error=/var/log/mysqld.log</code> <code>13</code> <code>pid-file=/var/run/mysqld/mysqld.pid</code> <p>server-id\u6307\u660e\u4e3b\u8282\u70b9\u7684\u8eab\u4efd\uff0c\u4ece\u8282\u70b9\u901a\u8fc7\u8fd9\u4e2aserver-id\u6765\u8bc6\u522b\u8be5\u8282\u70b9\u662fMaster\u8282\u70b9\uff08\u590d\u5236\u67b6\u6784\u4e2d\u7684\u6e90\u6570\u636e\u5e93\u670d\u52a1\u5668\u8282\u70b9\uff09\u3002 \u5982\u679cMySQL\u5f53\u524d\u5df2\u7ecf\u542f\u52a8\uff0c\u4fee\u6539\u5b8c\u96c6\u7fa4\u590d\u5236\u914d\u7f6e\u540e\u9700\u8981\u91cd\u542f\u670d\u52a1\u5668\uff1a</p> <code>1</code> <code>sudo</code> <code>service mysqld restart</code> <p>\u4ece\u8282\u70b9\u914d\u7f6e</p> <p>\u63a5\u7740\uff0c\u7c7b\u4f3c\u5730\u8fdb\u884c\u4ece\u8282\u70b9nn\u7684\u914d\u7f6e\uff0c\u540c\u6837\u4fee\u6539MySQL\u914d\u7f6e\u6587\u4ef6/etc/my.cnf\uff0c\u4f7f\u5176\u652f\u6301Slave\u7aef\u590d\u5236\u529f\u80fd\uff0c\u4fee\u6539\u540e\u7684\u5185\u5bb9\u5982\u4e0b\u6240\u793a\uff1a</p> <code>01</code> <code>[mysqld]</code> <code>02</code> <code>datadir=/var/lib/mysql</code> <code>03</code> <code>socket=/var/lib/mysql/mysql.sock</code> <code>04</code> <code>user=mysql</code> <code>05</code> <code># Disabling symbolic-links is recommended to prevent assorted security risks</code> <code>06</code> <code>symbolic-links=0</code> <code>07</code> <code>server-id=2</code> <code>08</code> <code>relay-log=slave-relay-bin</code> <code>09</code> <code>relay-log-index=slave-relay-bin.index</code> <code>10</code> <code>11</code> <code>[mysqld_safe]</code> <code>12</code> <code>log-error=/var/log/mysqld.log</code> <code>13</code> <code>pid-file=/var/run/mysqld/mysqld.pid</code> <p>\u540c\u6837\uff0c\u5982\u679cMySQL\u5f53\u524d\u5df2\u7ecf\u542f\u52a8\uff0c\u4fee\u6539\u5b8c\u96c6\u7fa4\u590d\u5236\u914d\u7f6e\u540e\u9700\u8981\u91cd\u542f\u670d\u52a1\u5668\uff1a</p> <code>1</code> <code>sudo</code> <code>service mysqld restart</code> <p>\u7136\u540e\uff0c\u9700\u8981\u4f7f\u4ece\u8282\u70b9nn\u6307\u5411\u4e3b\u8282\u70b9\uff0c\u5e76\u542f\u52a8Slave\u590d\u5236\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a</p> <code>1</code> <code>CHANGE MASTER </code><code>TO</code> <code>MASTER_HOST=</code><code>'m1'</code><code>, MASTER_PORT=3306, MASTER_USER=</code><code>'repli_user'</code><code>, MASTER_PASSWORD=</code><code>'shiyanjun'</code><code>;</code> <code>2</code> <code>START SLAVE;</code> <p>\u9a8c\u8bc1\u96c6\u7fa4\u590d\u5236</p> <p>\u8fd9\u65f6\uff0c\u53ef\u4ee5\u5728\u4e3b\u8282\u70b9m1\u4e0a\u6267\u884c\u76f8\u5173\u64cd\u4f5c\uff0c\u9a8c\u8bc1\u4ece\u8282\u70b9nn\u540c\u6b65\u590d\u5236\u4e86\u4e3b\u8282\u70b9\u7684\u6570\u636e\u5e93\u4e2d\u7684\u5185\u5bb9\u53d8\u66f4\u3002 \u5982\u679c\u6b64\u65f6\uff0c\u6211\u4eec\u5df2\u7ecf\u914d\u7f6e\u597d\u4e86\u4e3b\u4ece\u590d\u5236\uff0c\u90a3\u4e48\u5bf9\u4e8e\u4e3b\u8282\u70b9m1\u4e0aMysQL\u6570\u636e\u5e93\u7684\u4efb\u4f55\u53d8\u66f4\u90fd\u4f1a\u590d\u5236\u5230\u4ece\u8282\u70b9nn\u4e0a\uff0c\u5305\u62ec\u5efa\u5e93\u5efa\u8868\u3001\u63d2\u5165\u66f4\u65b0\u7b49\u64cd\u4f5c\uff0c\u4e0b\u9762\u6211\u4eec\u4ece\u5efa\u5e93\u5f00\u59cb\uff1a \u5728\u4e3b\u8282\u70b9m1\u4e0a\u5efa\u5e93\u5efa\u8868\uff1a</p> <code>01</code> <code>CREATE</code> <code>DATABASE</code> <code>workflow;</code> <code>02</code> <code>CREATE</code> <code>TABLE</code> <code>`workflow`.`project` (</code> <code>03</code> <code> </code><code>`id` </code><code>int</code><code>(11) </code><code>NOT</code> <code>NULL</code> <code>AUTO_INCREMENT,</code> <code>04</code> <code> </code><code>`</code><code>name</code><code>` </code><code>varchar</code><code>(100) </code><code>NOT</code> <code>NULL</code><code>,</code> <code>05</code> <code> </code><code>`type` tinyint(4) </code><code>NOT</code> <code>NULL</code> <code>DEFAULT</code> <code>'0'</code><code>,</code> <code>06</code> <code> </code><code>`description` </code><code>varchar</code><code>(500) </code><code>DEFAULT</code> <code>NULL</code><code>,</code> <code>07</code> <code> </code><code>`create_at` </code><code>date</code> <code>DEFAULT</code> <code>NULL</code><code>,</code> <code>08</code> <code> </code><code>`update_at` </code><code>timestamp</code> <code>NOT</code> <code>NULL</code> <code>DEFAULT</code> <code>CURRENT_TIMESTAMP</code> <code>ON</code> <code>UPDATE</code><code>CURRENT_TIMESTAMP</code><code>,</code> <code>09</code> <code> </code><code>`status` tinyint(4) </code><code>NOT</code> <code>NULL</code> <code>DEFAULT</code> <code>'0'</code><code>,</code> <code>10</code> <code> </code><code>PRIMARY</code> <code>KEY</code> <code>(`id`)</code> <code>11</code> <code>) ENGINE=InnoDB </code><code>DEFAULT</code> <code>CHARSET=utf8;</code> <p>\u5728m1\u4e0a\u67e5\u770bbinlog\u5185\u5bb9\uff0c\u6267\u884c\u547d\u4ee4\uff1a</p> <code>1</code> <code>SHOW BINLOG EVENTS\\G</code> <p>binlog\u5185\u5bb9\u5185\u5bb9\u5982\u4e0b\u6240\u793a\uff1a</p> <code>01</code> <code>*************************** 1. row ***************************</code> <code>02</code> <code> </code><code>Log_name: m-bin.000001</code> <code>03</code> <code> </code><code>Pos: 4</code> <code>04</code> <code>Event_type: Format_desc</code> <code>05</code> <code> </code><code>Server_id: 1</code> <code>06</code> <code>End_log_pos: 106</code> <code>07</code> <code> </code><code>Info: Server ver: 5.1.73-log, Binlog ver: 4</code> <code>08</code> <code>*************************** 2. row ***************************</code> <code>09</code> <code> </code><code>Log_name: m-bin.000001</code> <code>10</code> <code> </code><code>Pos: 106</code> <code>11</code> <code>Event_type: Query</code> <code>12</code> <code> </code><code>Server_id: 1</code> <code>13</code> <code>End_log_pos: 197</code> <code>14</code> <code> </code><code>Info: CREATE DATABASE workflow</code> <code>15</code> <code>*************************** 3. row ***************************</code> <code>16</code> <code> </code><code>Log_name: m-bin.000001</code> <code>17</code> <code> </code><code>Pos: 197</code> <code>18</code> <code>Event_type: Query</code> <code>19</code> <code> </code><code>Server_id: 1</code> <code>20</code> <code>End_log_pos: 671</code> <code>21</code> <code> </code><code>Info: CREATE TABLE `workflow`.`project` (</code> <code>22</code> <code> </code><code>`id` int(11) NOT NULL AUTO_INCREMENT,</code> <code>23</code> <code> </code><code>`name` varchar(100) NOT NULL,</code> <code>24</code> <code> </code><code>`type` tinyint(4) NOT NULL DEFAULT '0',</code> <code>25</code> <code> </code><code>`description` varchar(500) DEFAULT NULL,</code> <code>26</code> <code> </code><code>`create_at` date DEFAULT NULL,</code> <code>27</code> <code> </code><code>`update_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,</code> <code>28</code> <code> </code><code>`status` tinyint(4) NOT NULL DEFAULT '0',</code> <code>29</code> <code> </code><code>PRIMARY KEY (`id`)</code> <code>30</code> <code>) ENGINE=InnoDB DEFAULT CHARSET=utf8</code> <code>31</code> <code>3 rows in set (0.00 sec)</code> <p>\u901a\u8fc7\u4e0a\u8ff0binlog\u5185\u5bb9\uff0c\u6211\u4eec\u5927\u6982\u53ef\u4ee5\u770b\u5230MySQL\u7684binlog\u90fd\u8bb0\u5f55\u90a3\u4e9b\u4fe1\u606f\uff0c\u4e00\u4e2a\u4e8b\u4ef6\u5bf9\u5e94\u4e00\u884c\u8bb0\u5f55\u3002\u8fd9\u4e9b\u8bb0\u5f55\u4fe1\u606f\u7684\u7ec4\u7ec7\u7ed3\u6784\u5982\u4e0b\u6240\u793a\uff1a</p> <ul> <li>Log_name\uff1a\u65e5\u5fd7\u540d\u79f0\uff0c\u6307\u5b9a\u7684\u8bb0\u5f55\u64cd\u4f5c\u7684binlog\u65e5\u5fd7\u540d\u79f0\uff0c\u8fd9\u91cc\u662fm-bin.000001\uff0c\u4e0e\u6211\u4eec\u524d\u9762\u5728/etc/my.cnf\u4e2d\u914d\u7f6e\u7684\u76f8\u5bf9\u5e94</li> <li>Pos\uff1a\u8bb0\u5f55\u4e8b\u4ef6\u7684\u8d77\u59cb\u4f4d\u7f6e</li> <li>Event_type\uff1a\u4e8b\u4ef6\u7c7b\u578b</li> <li>End_log_pos\uff1a\u8bb0\u5f55\u4e8b\u4ef6\u7684\u7ed3\u675f\u4f4d\u7f6e</li> <li>Server_id\uff1a\u670d\u52a1\u5668\u6807\u8bc6</li> <li>Info\uff1a\u4e8b\u4ef6\u63cf\u8ff0\u4fe1\u606f</li> </ul> <p>\u7136\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u67e5\u770b\u5728\u4ece\u8282\u70b9nn\u4e0a\u590d\u5236\u7684\u60c5\u51b5\u3002\u901a\u8fc7\u5982\u4e0b\u547d\u4ee4\u67e5\u770b\u4ece\u8282\u70b9nn\u4e0a\u6570\u636e\u5e93\u548c\u8868\u7684\u4fe1\u606f\uff1a</p> <code>1</code> <code>SHOW DATABASES;</code> <code>2</code> <code>USE workflow;</code> <code>3</code> <code>SHOW TABLES;</code> <code>4</code> <code>DESC</code> <code>project;</code> <p>\u6211\u4eec\u518d\u770b\u4e00\u4e0b\u6267\u884c\u63d2\u5165\u8bed\u53e5\u7684\u60c5\u51b5\u3002\u5728\u4e3b\u8282\u70b9m1\u4e0a\u6267\u884c\u5982\u4e0bSQL\u8bed\u53e5\uff1a</p> <code>1</code> <code>INSERT</code> <code>INTO</code> <code>`workflow`.`project` </code><code>VALUES</code><code>(1, </code><code>'Avatar-II'</code><code>, 1, </code><code>'Avatar-II project'</code><code>,</code><code>'2014-02-16'</code><code>, </code><code>'2014-02-16 11:09:54'</code><code>, 0);</code> <p>\u53ef\u4ee5\u5728\u4ece\u8282\u70b9\u4e0a\u6267\u884c\u67e5\u8be2\uff0c\u770b\u5230\u4ece\u8282\u70b9nn\u4e0a\u590d\u5236\u4e86\u4e3b\u8282\u70b9m1\u4e0a\u6267\u884c\u7684INSERT\u8bed\u53e5\u7684\u8bb0\u5f55\uff1a</p> <code>1</code> <code>SELECT</code> <code>* </code><code>FROM</code> <code>workflow.project;</code> <p>\u9a8c\u8bc1\u590d\u5236\u6210\u529f\u3002</p> <p>\u590d\u5236\u5e38\u7528\u547d\u4ee4</p> <p>\u4e0b\u9762\uff0c\u6211\u4eec\u603b\u7ed3\u4e86\u51e0\u4e2a\u5728MySQL\u4e3b\u4ece\u590d\u5236\u573a\u666f\u4e2d\u5e38\u7528\u5230\u7684\u51e0\u4e2a\u76f8\u5173\u547d\u4ee4\uff1a</p> <ul> <ul> <li>\u7ec8\u6b62\u4e3b\u8282\u70b9\u590d\u5236</li> </ul> </ul> <code>1</code> <code>STOP MASTER;</code> <ul> <ul> <li>\u6e05\u9664\u4e3b\u8282\u70b9\u590d\u5236\u6587\u4ef6</li> </ul> </ul> <code>1</code> <code>RESET MASTER;</code> <ul> <ul> <li>\u7ec8\u6b62\u4ece\u8282\u70b9\u590d\u5236</li> </ul> </ul> <code>1</code> <code>STOP SLAVE;</code> <ul> <ul> <li>\u6e05\u9664\u4ece\u8282\u70b9\u590d\u5236\u6587\u4ef6</li> </ul> </ul> <code>1</code> <code>RESET SLAVE;</code> <ul> <ul> <li>\u67e5\u770b\u4e3b\u8282\u70b9\u590d\u5236\u72b6\u6001</li> </ul> </ul> <code>1</code> <code>SHOW MASTER STATUS\\G;</code> <p>\u7ed3\u679c\u793a\u4f8b\uff1a</p> <code>1</code> <code>*************************** 1. row ***************************</code> <code>2</code> <code> </code><code>File: m-bin.000001</code> <code>3</code> <code> </code><code>Position: 956</code> <code>4</code> <code> </code><code>Binlog_Do_DB:</code> <code>5</code> <code>Binlog_Ignore_DB:</code> <code>6</code> <code>1 row in set (0.00 sec)</code> <ul> <ul> <li>\u67e5\u770b\u4ece\u8282\u70b9\u590d\u5236\u72b6\u6001</li> </ul> </ul> <code>1</code> <code>SHOW SLAVE STATUS\\G;</code> <p>\u7ed3\u679c\u793a\u4f8b\uff1a</p> <code>01</code> <code>*************************** 1. row ***************************</code> <code>02</code> <code> </code><code>Slave_IO_State: Waiting for master to send event</code> <code>03</code> <code> </code><code>Master_Host: m1</code> <code>04</code> <code> </code><code>Master_User: repli_user</code> <code>05</code> <code> </code><code>Master_Port: 3306</code> <code>06</code> <code> </code><code>Connect_Retry: 60</code> <code>07</code> <code> </code><code>Master_Log_File: m-bin.000001</code> <code>08</code> <code> </code><code>Read_Master_Log_Pos: 956</code> <code>09</code> <code> </code><code>Relay_Log_File: slave-relay-bin.000002</code> <code>10</code> <code> </code><code>Relay_Log_Pos: 1097</code> <code>11</code> <code> </code><code>Relay_Master_Log_File: m-bin.000001</code> <code>12</code> <code> </code><code>Slave_IO_Running: Yes</code> <code>13</code> <code> </code><code>Slave_SQL_Running: Yes</code> <code>14</code> <code> </code><code>Replicate_Do_DB:</code> <code>15</code> <code> </code><code>Replicate_Ignore_DB:</code> <code>16</code> <code> </code><code>Replicate_Do_Table:</code> <code>17</code> <code> </code><code>Replicate_Ignore_Table:</code> <code>18</code> <code> </code><code>Replicate_Wild_Do_Table:</code> <code>19</code> <code> </code><code>Replicate_Wild_Ignore_Table:</code> <code>20</code> <code> </code><code>Last_Errno: 0</code> <code>21</code> <code> </code><code>Last_Error:</code> <code>22</code> <code> </code><code>Skip_Counter: 0</code> <code>23</code> <code> </code><code>Exec_Master_Log_Pos: 956</code> <code>24</code> <code> </code><code>Relay_Log_Space: 1252</code> <code>25</code> <code> </code><code>Until_Condition: None</code> <code>26</code> <code> </code><code>Until_Log_File:</code> <code>27</code> <code> </code><code>Until_Log_Pos: 0</code> <code>28</code> <code> </code><code>Master_SSL_Allowed: No</code> <code>29</code> <code> </code><code>Master_SSL_CA_File:</code> <code>30</code> <code> </code><code>Master_SSL_CA_Path:</code> <code>31</code> <code> </code><code>Master_SSL_Cert:</code> <code>32</code> <code> </code><code>Master_SSL_Cipher:</code> <code>33</code> <code> </code><code>Master_SSL_Key:</code> <code>34</code> <code> </code><code>Seconds_Behind_Master: 0</code> <code>35</code> <code>Master_SSL_Verify_Server_Cert: No</code> <code>36</code> <code> </code><code>Last_IO_Errno: 0</code> <code>37</code> <code> </code><code>Last_IO_Error:</code> <code>38</code> <code> </code><code>Last_SQL_Errno: 0</code> <code>39</code> <code> </code><code>Last_SQL_Error:</code> <code>40</code> <code>1 row in set (0.00 sec)</code> <ul> <ul> <li>\u67e5\u770bBINLOG\u5217\u8868</li> </ul> </ul> <code>1</code> <code>SHOW </code><code>BINARY</code> <code>LOGS\\G</code> \u672c\u6587\u57fa\u4e8e\u7f72\u540d-\u975e\u5546\u4e1a\u6027\u4f7f\u7528-\u76f8\u540c\u65b9\u5f0f\u5171\u4eab 4.0\u8bb8\u53ef\u534f\u8bae\u53d1\u5e03\uff0c\u6b22\u8fce\u8f6c\u8f7d\u3001\u4f7f\u7528\u3001\u91cd\u65b0\u53d1\u5e03\uff0c\u4f46\u52a1\u5fc5\u4fdd\u7559\u6587\u7ae0\u7f72\u540d\u65f6\u5ef6\u519b\uff08\u5305\u542b\u94fe\u63a5\uff09\uff0c\u4e0d\u5f97\u7528\u4e8e\u5546\u4e1a\u76ee\u7684\uff0c\u57fa\u4e8e\u672c\u6587\u4fee\u6539\u540e\u7684\u4f5c\u54c1\u52a1\u5fc5\u4ee5\u76f8\u540c\u7684\u8bb8\u53ef\u53d1\u5e03\u3002\u5982\u6709\u4efb\u4f55\u7591\u95ee\uff0c\u8bf7\u4e0e\u6211\u8054\u7cfb\u3002","tags":[]},{"location":"DATABASE/2015-12-07-mysql-%25e6%259f%25a5%25e8%25af%25a2%25e9%2594%2581%25e3%2580%2581%25e8%25a7%25a3%25e9%2594%2581%25e8%25af%25ad%25e5%258f%25a5.html/","title":"MySQL \u67e5\u8be2\u9501\u3001\u89e3\u9501\u8bed\u53e5","text":"<p>\u4e00\uff1a\u9501\u8868\uff1a</p> <p>\u9501\u5b9a\u6570\u636e\u8868\uff0c\u907f\u514d\u5728\u5907\u4efd\u8fc7\u7a0b\u4e2d\uff0c\u8868\u88ab\u66f4\u65b0</p> <p>mysql&gt;LOCK TABLES tbl_name READ;</p> <p>\u4e3a\u8868\u589e\u52a0\u4e00\u4e2a\u5199\u9501\u5b9a\uff1a</p> <p>mysql&gt;LOCK TABLES tbl_name WRITE;</p> <p>\u4e8c\uff1a\u67e5\u8be2mysql \u54ea\u4e9b\u8868\u6b63\u5728\u88ab\u9501\u72b6\u6001</p> <p>show OPEN TABLES where In_use &gt; 0;</p> <p>\u4e09\uff1amysql\u89e3\u9501</p> <p>\u7b2c\u4e00\u79cd</p> <p>show processlist;</p> <p>\u627e\u5230\u9501\u8fdb\u7a0b\uff0ckill id ;</p> <p>\u7b2c\u4e8c\u79cd</p> <p>mysql&gt;UNLOCK TABLES;</p> <p> </p> <p>\u6458\u81ea\u300ehttp://www.cnblogs.com/Alight/p/4193439.html\u300f</p>","tags":[]},{"location":"DATABASE/2015-12-16-mysql%25e4%25ba%258b%25e5%258a%25a1%25e4%25bb%25a5%25e5%258f%258a%25e5%258a%25a0%25e9%2594%2581%25e6%259c%25ba%25e5%2588%25b6.html/","title":"MySQL \u4e8b\u52a1\u4ee5\u53ca\u52a0\u9501\u673a\u5236","text":"\u4e8b\u52a1\u7684\u7279\u5f81ACID\uff0c\u5373\u539f\u5b50\u6027\u3001\u4e00\u81f4\u6027\u3001\u9694\u79bb\u6027\u3001\u6301\u4e45\u6027\u3002 \u539f\u5b50\u6027\u4fdd\u8bc1\u4e00\u4e2a\u4e8b\u52a1\u4e3a\u4e00\u4e2a\u6700\u5c0f\u7684\u5355\u5143\uff0c\u5185\u90e8\u4e0d\u53ef\u5206\u5272\uff1b \u4e00\u81f4\u6027\u4fdd\u8bc1\u4e8b\u52a1\u4e2d\u7684\u6bcf\u4e2a\u64cd\u4f5c\u7ebf\u7a0b\u4e0d\u53ef\u5355\u72ec\u63d0\u4ea4\uff0c\u6210\u529f\u5219\u4e00\u8d77\u63d0\u4ea4\uff0c\u4e0d\u6210\u529f\u5219\u4e8b\u52a1\u56de\u6eda\uff1b \u9694\u79bb\u6027\u4fdd\u8bc1\u4e0d\u540c\u4e8b\u52a1\u95f4\u770b\u5230\u7684\u6570\u636e\u89c6\u56fe\u76f8\u4e92\u72ec\u7acb\uff0c\u76f8\u4e92\u9694\u79bb\uff08\u9694\u79bb\u7ea7\u522b\u53ef\u8bbe\u7f6e\uff09\uff1b \u6301\u4e45\u6027\u4fdd\u8bc1\u4e8b\u52a1\u63d0\u4ea4\u540e\u6570\u636e\u4f1a\u6301\u4e45\u7684\u4fdd\u5b58\u4e0b\u6765\uff1b sql\u89c4\u8303\u5b9a\u4e49\u7684\u4e8b\u52a1\u7684\u9694\u79bb\u7ea7\u522b\uff1a 1.READ UNCOMMITTED(\u8bfb\u53d6\u672a\u63d0\u4ea4\u5185\u5bb9) \u00a0 \u00a0 \u6240\u6709\u4e8b\u52a1\u53ef\u4ee5\u770b\u5230\u672a\u63d0\u4ea4\u4e8b\u52a1\u7684\u6267\u884c\u7ed3\u679c\uff0c\u672c\u9694\u79bb\u7ea7\u522b\u5f88\u5c11\u7528\u5230\u5b9e\u9645\u5e94\u7528\u4e2d\uff0c\u8bfb\u53d6\u672a\u63d0\u4ea4\u7684\u6570\u636e\uff0c\u53c8\u79f0\u4e3a\u201c\u810f\u8bfb\u201d\u3002 2.READ COMMITTED\uff08\u8bfb\u53d6\u63d0\u4ea4\u5185\u5bb9\uff09 \u00a0 \u00a0 \u5927\u591a\u6570\u6570\u636e\u5e93\u7684\u9ed8\u8ba4\u9694\u79bb\u7ea7\u522b\u662f\u6b64\u7ea7\u522b\uff0c\u4f46\u4e0d\u662fmysql\u9ed8\u8ba4\u7684\u3002\u4e00\u4e2a\u4e8b\u52a1\u5728\u5f00\u59cb\u7684\u65f6\u5019\u53ea\u80fd\u770b\u89c1\u5df2\u63d0\u4ea4\u4e8b\u52a1\u6240\u505a\u7684\u6539\u53d8\u3002\u4e00\u4e2a\u4e8b\u52a1\u4ece\u5f00\u59cb\u5230\u63d0\u4ea4\u524d\u6240\u505a\u7684\u4efb\u4f55\u6539\u53d8\u90fd\u662f\u4e0d\u53ef\u89c1\u7684\uff0c\u9664\u975e\u63d0\u4ea4\u3002\u8fd9\u79cd\u9694\u79bb\u7ea7\u522b\u4e5f\u79f0\u4e3a\u4e0d\u53ef\u91cd\u590d\u8bfb\u3002 3.REPEATABLE READ(\u53ef\u91cd\u590d\u8bfb) \u00a0 \u00a0 \u6b64\u9694\u79bb\u7ea7\u522b\u662f\u4e3a\u4e86\u89e3\u51b3\u53ef\u91cd\u590d\u8bfb\u9694\u79bb\u7ea7\u522b\u5bfc\u81f4\u7684\u95ee\u9898\u5373\u4e00\u4e2a\u4e8b\u52a1\u591a\u4e2a\u5b9e\u4f8b\u5e76\u53d1\u8bfb\u53d6\u6570\u636e\u65f6\u4f1a\u770b\u5230\u4e0d\u540c\u7684\u7ed3\u679c\u3002\u6b64\u9694\u79bb\u7ea7\u522b\u4e0d\u4f1a\u770b\u5230\u5176\u4ed6\u4e8b\u52a1\u63d0\u4ea4\u540e\u7684\u7ed3\u679c\uff0c\u5373\u4e8b\u52a1\u5373\u4f7f\u63d0\u4ea4\u4e86\u6211\u4e5f\u770b\u4e0d\u5230\u3002\u6b64\u7ea7\u522b\u4e5f\u79f0\u4e3a\u201c\u5e7b\u8bfb\u201d\u3002 4.SERIALIZABLE(\u53ef\u4e32\u884c\u5316) \u00a0 \u00a0 \u53ef\u4e32\u884c\u5316\u662f\u6700\u9ad8\u7684\u9694\u79bb\u7ea7\u522b\uff0c\u5b83\u901a\u8fc7\u5f3a\u5236\u4e8b\u52a1\u6392\u5e8f\uff0c\u4f7f\u4e4b\u4e0d\u53ef\u91cd\u8bfb\uff0c\u89e3\u51b3\u4e86\u5e7b\u8bfb\u7684\u95ee\u9898\u3002\u6b64\u9694\u79bb\u7ea7\u522b\u4f1a\u5728\u6bcf\u4e2a\u8bfb\u7684\u6570\u636e\u884c\u4e0a\u52a0\u5171\u4eab\u9501\uff0c\u4f7f\u7528\u8fd9\u79cd\u9694\u79bb\u7ea7\u522b\u4f1a\u4ea7\u751f\u5927\u91cf\u7684\u8d85\u65f6\u73b0\u8c61\uff0c\u4e00\u822c\u5b9e\u9645\u5f00\u53d1\u4e2d\u4e0d\u4f1a\u7528\u5230\u3002 mysql\u52a0\u9501\u673a\u5236 : \u6839\u636e\u7c7b\u578b\u53ef\u5206\u4e3a\u5171\u4eab\u9501\uff08SHARED LOCK\uff09\u548c\u6392\u4ed6\u9501\uff08EXCLUSIVE LOCK\uff09\u6216\u8005\u53eb\u8bfb\u9501\uff08READ LOCK\uff09\u548c\u5199\u9501\uff08WRITE LOCK\uff09\u3002 \u6839\u636e\u7c92\u5ea6\u5212\u5206\u53c8\u5206\u8868\u9501\u548c\u884c\u9501\u3002\u8868\u9501\u7531\u6570\u636e\u5e93\u670d\u52a1\u5668\u5b9e\u73b0\uff0c\u884c\u9501\u7531\u5b58\u50a8\u5f15\u64ce\u5b9e\u73b0\u3002 mysql\u63d0\u4f9b\u4e863\u79cd\u4e8b\u52a1\u578b\u5b58\u50a8\u5f15\u64ce\uff0cInnDB\u3001NDB Cluster\u548cFalcon\u3002 \u4e00\u4e2a\u4e8b\u52a1\u6267\u884c\u7684\u4efb\u4f55\u8fc7\u7a0b\u4e2d\u90fd\u53ef\u4ee5\u83b7\u5f97\u9501\uff0c\u4f46\u662f\u53ea\u6709\u4e8b\u52a1\u63d0\u4ea4\u6216\u56de\u6eda\u7684\u65f6\u5019\u624d\u91ca\u653e\u8fd9\u4e9b\u9501\u3002\u8fd9\u4e9b\u90fd\u662f\u9690\u5f0f\u9501\u5b9a\uff0c\u4e5f\u53ef\u4ee5\u663e\u5f0f\u9501\u5b9a\uff0cInnoDB\u652f\u6301\u663e\u5f0f\u9501\u5b9a\uff0c\u4f8b\u5982\uff1a SELECT .... LOCK IN SHARE MODE (\u52a0\u5171\u4eab\u9501) SELECT .....FOR UPDATE(\u52a0\u6392\u4ed6\u9501) \u591a\u7248\u672c\u5e76\u53d1\u63a7\u5236\uff08\u91cd\u8981\uff09\uff1a Mysql\u7684\u4e8b\u52a1\u5b58\u50a8\u5f15\u64ce\u4e0d\u662f\u7b80\u5355\u5b9e\u7528\u884c\u52a0\u9501\u673a\u5236\uff0c\u800c\u662f\u53eb\u591a\u7248\u672c\u5e76\u53d1\u63a7\u5236\uff08MVCC\uff09\u6280\u672f\uff0c\u548c\u884c\u52a0\u9501\u673a\u5236\u5173\u8054\u5b9e\u7528\u3002\u4ee5\u4fbf\u5e94\u5bf9\u66f4\u9ad8\u7684\u5e76\u53d1\uff0c\u5f53\u7136\u662f\u4ee5\u6d88\u8017\u6027\u80fd\u4f5c\u4e3a\u4ee3\u4ef7\u3002 \u6bcf\u79cd\u5b58\u50a8\u5f15\u64ce\u5bf9MVCC\u7684\u5b9e\u73b0\u65b9\u5f0f\u4e0d\u540c\uff0cInnoDB\u5f15\u64ce\u7684\u7b80\u5355\u5b9e\u73b0\u65b9\u5f0f\u5982\u4e0b\uff1a InnoDB\u901a\u8fc7\u4e3a\u6bcf\u4e2a\u6570\u636e\u822a\u589e\u52a0\u4e24\u4e2a\u9690\u542b\u503c\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\u3002\u8fd9\u4e24\u4e2a\u9690\u542b\u503c\u8bb0\u5f55\u4e86\u884c\u7684\u521b\u5efa\u65f6\u95f4\uff0c\u4ee5\u53ca\u8fc7\u671f\u65f6\u95f4\u3002\u6bcf\u4e00\u884c\u5b58\u50a8\u4e8b\u4ef6\u53d1\u751f\u65f6\u7684\u7cfb\u7edf\u7248\u672c\u53f7\u3002\u6bcf\u4e00\u6b21\u5f00\u59cb\u4e00\u4e2a\u65b0\u4e8b\u52a1\u65f6\u7248\u672c\u53f7\u4f1a\u81ea\u52a8\u52a01\uff0c\u6bcf\u4e2a\u4e8b\u52a1\u90fd\u4f1a\u4fdd\u5b58\u5f00\u59cb\u65f6\u7684\u7248\u672c\u53f7\uff0c\u6bcf\u4e2a\u67e5\u8be2\u6839\u636e\u4e8b\u52a1\u7684\u7248\u672c\u53f7\u6765\u67e5\u8be2\u7ed3\u679c\u3002 \u6458\u81ea\u300ehttp://www.php1.cn/Content/Mysql_ShiWuYiJiJiaSuoJiZhi.html\u300f","tags":["MySQL","\u4e8b\u7269","\u9501\u673a\u5236"]},{"location":"DATABASE/2015-12-16-mysql-%25e5%2585%25a8%25e5%25b1%2580%25e7%25a6%2581%25e7%2594%25a8autocommit.html/","title":"MySQL \u5168\u5c40\u7981\u7528autocommit","text":"mysql\u9ed8\u8ba4\u5f00\u542fauto commit\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u7cfb\u7edf\u53d8\u91cf\u63a7\u5236\u6765\u52a8\u6001\u63a7\u5236session\u7ea7\u522bautocommit\uff0c\u5982\u4f55\u4ece\u5168\u5c40\u7981\u7528autocommit\u5462\uff0c\u4e5f\u8bb8\u6709\u65f6\u5019\u6211\u4eec\u4e0d\u60f3\u8ba9mysql\u81ea\u52a8\u63d0\u4ea4\u3002 mysql\u6709\u4e00\u4e2aCmd-Line&amp;Option file&amp;System Var\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u5b9e\u73b0\u8fd9\u6837\u7684\u529f\u80fd\uff0c\u5b83\u5c31\u662finit_connect\u3002 <p>\u8fd9\u4e2a\u53c2\u6570\u7528\u6765\u5b9a\u4e49\u6bcf\u4e2asession\u5efa\u7acb\u65f6\u81ea\u52a8\u6267\u884c\u7684query\u3002</p> <p>A string to be executed by the server for each client that connects. The string consists of one or more SQL statements. To specify multiple statements, separate them by semicolon characters.A string to be executed by the server for each client that connects. The string consists of one or more SQL statements. To specify multiple statements, separate them by semicolon characters.</p> <p>\u5229\u7528\u8fd9\u4e2a\u53d8\u91cf\uff0c\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u65b9\u5f0f\u7981\u7528autocommit\uff1a</p> <p>way1\uff1amysql&gt;SET GLOBAL init_connect=\u2019SET autocommit=0\u2032;</p> <p>way2\uff1a\u5728\u521d\u59cb\u5316\u53c2\u6570\u6587\u4ef6\u4e2d\u8bbe\u7f6e</p> <p>[mysqld] init_connect=\u2019SET autocommit=0\u2032</p> <p>way3\uff1a</p> <p>\u542f\u52a8mysql\u65f6\u5e26\u4e0a\u547d\u4ee4\u884c\u53c2\u6570\u2013init_connect=\u2019SET autocommit=0\u2032</p> <p>\u5f53\u7136\u8fd9\u4e2a\u53c2\u6570\u7684\u8bbe\u7f6e\u5bf9\u62e5\u6709super\u6743\u9650\u7684\u7528\u6237\u662f\u65e0\u6548\u7684\uff0c\u5177\u4f53\u8bf4\u660e</p> <p>Note that the content of init_connect is not executed for users that have the SUPER privilege. This is done so that an erroneous value for init_connect does not prevent all clients from connecting. For example, the value might contain a statement that has a syntax error, thus causing client connections to fail. Not executing init_connect for users that have the SUPER privilege enables them to open a connection and fix the init_connect value.</p> <p>\u53c2\u8003\uff1ahttp://dev.mysql.com/doc/refman/ ... sysvar_init_connect <p>\u6458\u81ea\u300ehttp://www.itpub.net/thread-1205953-1-1.html\u300f</p>","tags":["MySQL","autocommit"]},{"location":"DATABASE/2015-12-17-mysql-transaction-isolation%25e5%258f%2582%25e6%2595%25b0%25e7%259a%2584%25e8%25ae%25be%25e7%25bd%25ae.html/","title":"MySQL transaction-isolation\u53c2\u6570\u7684\u8bbe\u7f6e","text":"<p>1.\u5728my.cnf\u4e2d\u7684\u3010mysqld\u3011\u90e8\u5206\u6dfb\u52a0\uff1a</p> <p>[mysqld]</p> <p>transaction-isolation = read-committed</p> <p>2.\u91cd\u542fmysql\u6570\u636e\u5e93</p> <p>mysql&gt; show variables like \u2018tx%\u2019; +\u2014\u2014\u2014\u2014\u2014+\u2014\u2014\u2014\u2014\u2014-+ | Variable_name | Value\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 | +\u2014\u2014\u2014\u2014\u2014+\u2014\u2014\u2014\u2014\u2014-+ | tx_isolation\u00a0 | READ-COMMITTED | +\u2014\u2014\u2014\u2014\u2014+\u2014\u2014\u2014\u2014\u2014-+</p> <p>\u6458\u81ea\u300ehttps://anmh.wordpress.com/2010/06/30/mysql%EF%BC%9Atransaction-isolation%E5%8F%82%E6%95%B0%E7%9A%84%E8%AE%BE%E7%BD%AE/\u300f</p>","tags":["MySQL","transaction","isolation"]},{"location":"DATABASE/2016-01-26-mysql%25e6%2595%25b0%25e6%258d%25ae%25e5%258e%25bb%25e9%2587%258d%25e7%25a4%25ba%25e4%25be%258b.html/","title":"MySQL\u6570\u636e\u53bb\u91cd\u793a\u4f8b","text":"<pre>\n-- ==== \u6570\u636e\u6e05\u6d17 ====\n-- === \u88681\uff1aESB_ERP_BASIC_MODEL_PRICE ===\n-- \u6839\u636eMODL_ST\u53bb\u91cd  \u53d6\u6700\u65b0\u8bb0\u5f55\n-- S1: \u8bbe\u7f6eROWNUM\nselect @x:= 0;\n\nupdate ESB_ERP_BASIC_MODEL_PRICE t1\nset t1.ATTRIBUTE10 = (select @x := @x+1);\n\n-- S2: \u6839\u636eROWNUM\u53bb\u91cd\nDELETE FROM ESB_ERP_BASIC_MODEL_PRICE \nWHERE ATTRIBUTE10 IN (\n    select ATTRIBUTE10 from (\n      select t1.*\n       , if(@g1=t1.MODL_ST, @rank:=@rank+1, @rank:=1) as rank\n       , (@g1:=t1.MODL_ST) as g1\n      from \n        (select ATTRIBUTE10, MODL_ST, LAST_UPDATE_DATE\n        from ESB_ERP_BASIC_MODEL_PRICE\n        order by modl_st asc, LAST_UPDATE_DATE desc) t1\n      , (select @g1:=null, @rank:=0) t2\n    ) t where rank&gt;1\n)\n;\n\n\n-- === \u88682\uff1aESB_ERP_SPEC_PRICE ===\n-- \u6839\u636eMODL_ST+SPEC_ITEM_CD+SPEC_DTL_CD\u53bb\u91cd  \u53d6\u6700\u65b0\u8bb0\u5f55\n-- S1: \u8bbe\u7f6eROWNUM\nselect @x:= 0;\n\nupdate ESB_ERP_SPEC_PRICE t1\nset t1.ATTRIBUTE10 = (select @x := @x+1);\n\n-- S2: \u6839\u636eROWNUM\u53bb\u91cd\nDELETE FROM ESB_ERP_SPEC_PRICE \nWHERE ATTRIBUTE10 IN (\n    select ATTRIBUTE10 from (\n      select t1.*\n       , if(@g1=t1.group1, @rank:=@rank+1, @rank:=1) as rank\n       , (@g1:=t1.group1) as g1\n      from \n        (select ATTRIBUTE10, CONCAT(MODL_ST ,char(5), SPEC_ITEM_CD, char(5), SPEC_DTL_CD) group1, LAST_UPDATE_DATE\n        from ESB_ERP_SPEC_PRICE\n        order by MODL_ST, SPEC_ITEM_CD, SPEC_DTL_CD , LAST_UPDATE_DATE desc) t1\n      , (select @g1:=null, @rank:=0) t2\n    ) t where rank&gt;1\n)\n;\n</pre>","tags":["ETL"]},{"location":"DATABASE/2016-11-08-mongodb-%25e5%258f%25af%25e8%25a7%2586%25e5%258c%2596%25e5%25b7%25a5%25e5%2585%25b7.html/","title":"Mongodb \u53ef\u89c6\u5316\u5de5\u5177/\u56fe\u5f62\u5ba2\u6237\u7aef","text":"<p>MongoChef </p> <p>\u4e2a\u4eba\u514d\u8d39\uff0c\u5546\u4e1a\u7528\u6237\u9700\u8981\u6388\u6743</p> <p>\u4e0b\u8f7d\u5730\u5740\uff1ahttp://3t.io/mongochef/download</p>","tags":["mongodb","mongo","GUI","\u5ba2\u6237\u7aef"]},{"location":"DATABASE/2016-11-08-mongodb-%25e6%259f%25a5%25e8%25af%25a2.html/","title":"MongoDB \u67e5\u8be2","text":"<p>1.\u00a0 \u57fa\u672c\u67e5\u8be2\uff1a \u6784\u9020\u67e5\u8be2\u6570\u636e\u3002 &gt; db.test.findOne() { \"_id\" : ObjectId(\"4fd58ecbb9ac507e96276f1a\"), \"name\" : \"stephen\", \"age\" : 35, \"genda\" : \"male\", \"email\" : \"stephen@hotmail.com\" }</p> <p>--\u591a\u6761\u4ef6\u67e5\u8be2\u3002\u4e0b\u9762\u7684\u793a\u4f8b\u7b49\u540c\u4e8eSQL\u8bed\u53e5\u7684where name = \"stephen\" and age = 35 &gt; db.test.find({\"name\":\"stephen\",\"age\":35}) { \"_id\" : ObjectId(\"4fd58ecbb9ac507e96276f1a\"), \"name\" : \"stephen\", \"age\" : 35, \"genda\" : \"male\", \"email\" : \"stephen@hotmail.com\" }</p> <p>--\u8fd4\u56de\u6307\u5b9a\u7684\u6587\u6863\u952e\u503c\u5bf9\u3002\u4e0b\u9762\u7684\u793a\u4f8b\u5c06\u53ea\u662f\u8fd4\u56dename\u548cage\u952e\u503c\u5bf9\u3002 &gt; db.test.find({}, {\"name\":1,\"age\":1}) { \"_id\" : ObjectId(\"4fd58ecbb9ac507e96276f1a\"), \"name\" : \"stephen\", \"age\" : 35 }</p> <p> </p> <p>--\u6307\u5b9a\u4e0d\u8fd4\u56de\u7684\u6587\u6863\u952e\u503c\u5bf9\u3002\u4e0b\u9762\u7684\u793a\u4f8b\u5c06\u8fd4\u56de\u9664name\u4e4b\u5916\u7684\u6240\u6709\u952e\u503c\u5bf9\u3002 &gt; db.test.find({}, {\"name\":0}) { \"_id\" : ObjectId(\"4fd58ecbb9ac507e96276f1a\"), \"age\" : 35, \"genda\" : \"male\", \"email\" : \"stephen@hotmail.com\" }</p> <p>2.\u00a0 \u67e5\u8be2\u6761\u4ef6\uff1a MongoDB\u63d0\u4f9b\u4e86\u4e00\u7ec4\u6bd4\u8f83\u64cd\u4f5c\u7b26\uff1a$lt/$lte/$gt/$gte/$ne\uff0c\u4f9d\u6b21\u7b49\u4ef7\u4e8e/&gt;=/!=\u3002 --\u4e0b\u9762\u7684\u793a\u4f8b\u8fd4\u56de\u7b26\u5408\u6761\u4ef6age &gt;= 18 &amp;&amp; age &lt;= 40\u7684\u6587\u6863\u3002 &gt; db.test.find({\"age\":{\"$gte\":18, \"$lte\":40}}) { \"_id\" : ObjectId(\"4fd58ecbb9ac507e96276f1a\"), \"name\" : \"stephen\", \"age\" : 35,\"genda\" : \"male\", \"email\" : \"stephen@hotmail.com\" }</p> <p>--\u4e0b\u9762\u7684\u793a\u4f8b\u8fd4\u56de\u6761\u4ef6\u7b26\u5408name != \"stephen1\" &gt; db.test.find({\"name\":{\"$ne\":\"stephen1\"}}) { \"_id\" : ObjectId(\"4fd58ecbb9ac507e96276f1a\"), \"name\" : \"stephen\", \"age\" : 35,\"genda\" : \"male\", \"email\" : \"stephen@hotmail.com\" }</p> <p>--$in\u7b49\u540c\u4e8eSQL\u4e2d\u7684in\uff0c\u4e0b\u9762\u7684\u793a\u4f8b\u7b49\u540c\u4e8eSQL\u4e2d\u7684in (\"stephen\",\"stephen1\") &gt; db.test.find({\"name\":{\"$in\":[\"stephen\",\"stephen1\"]}}) { \"_id\" : ObjectId(\"4fd58ecbb9ac507e96276f1a\"), \"name\" : \"stephen\", \"age\" : 35,\"genda\" : \"male\", \"email\" : \"stephen@hotmail.com\" }</p> <p>--\u548cSQL\u4e0d\u540c\u7684\u662f\uff0cMongoDB\u7684in list\u4e2d\u7684\u6570\u636e\u53ef\u4ee5\u662f\u4e0d\u540c\u7c7b\u578b\u3002\u8fd9\u79cd\u60c5\u51b5\u53ef\u7528\u4e8e\u4e0d\u540c\u7c7b\u578b\u7684\u522b\u540d\u573a\u666f\u3002 &gt; db.test.find({\"name\":{\"$in\":[\"stephen\",123]}}) { \"_id\" : ObjectId(\"4fd58ecbb9ac507e96276f1a\"), \"name\" : \"stephen\", \"age\" : 35,\"genda\" : \"male\", \"email\" : \"stephen@hotmail.com\" }</p> <p>--$nin\u7b49\u540c\u4e8eSQL\u4e2d\u7684not in\uff0c\u540c\u65f6\u4e5f\u662f$in\u7684\u53d6\u53cd\u3002\u5982\uff1a &gt; db.test.find({\"name\":{\"$nin\":[\"stephen2\",\"stephen1\"]}}) { \"_id\" : ObjectId(\"4fd58ecbb9ac507e96276f1a\"), \"name\" : \"stephen\", \"age\" : 35,\"genda\" : \"male\", \"email\" : \"stephen@hotmail.com\" }</p> <p>--$or\u7b49\u540c\u4e8eSQL\u4e2d\u7684or\uff0c$or\u6240\u9488\u5bf9\u7684\u6761\u4ef6\u88ab\u653e\u5230\u4e00\u4e2a\u6570\u7ec4\u4e2d\uff0c\u6bcf\u4e2a\u6570\u7ec4\u5143\u7d20\u8868\u793aor\u7684\u4e00\u4e2a\u6761\u4ef6\u3002 --\u4e0b\u9762\u7684\u793a\u4f8b\u7b49\u540c\u4e8ename = \"stephen1\" or age = 35 &gt; db.test.find({\"$or\": [{\"name\":\"stephen1\"}, {\"age\":35}]}) { \"_id\" : ObjectId(\"4fd58ecbb9ac507e96276f1a\"), \"name\" : \"stephen\", \"age\" : 35,\"genda\" : \"male\", \"email\" : \"stephen@hotmail.com\" }</p> <p>--\u4e0b\u9762\u7684\u793a\u4f8b\u6f14\u793a\u4e86\u5982\u4f55\u6df7\u5408\u4f7f\u7528$or\u548c$in\u3002 &gt; db.test.find({\"$or\": [{\"name\":{\"$in\":[\"stephen\",\"stephen1\"]}}, {\"age\":36}]}) { \"_id\" : ObjectId(\"4fd58ecbb9ac507e96276f1a\"), \"name\" : \"stephen\", \"age\" : 35,\"genda\" : \"male\", \"email\" : \"stephen@hotmail.com\" }</p> <p>--$not\u8868\u793a\u53d6\u53cd\uff0c\u7b49\u540c\u4e8eSQL\u4e2d\u7684not\u3002 &gt; db.test.find({\"name\": {\"$not\": {\"$in\":[\"stephen2\",\"stephen1\"]}}}) { \"_id\" : ObjectId(\"4fd58ecbb9ac507e96276f1a\"), \"name\" : \"stephen\", \"age\" : 35,\"genda\" : \"male\", \"email\" : \"stephen@hotmail.com\" }</p> <p> </p> <p>3.\u00a0 null\u6570\u636e\u7c7b\u578b\u7684\u67e5\u8be2\uff1a --\u5728\u8fdb\u884c\u503c\u4e3anull\u6570\u636e\u7684\u67e5\u8be2\u65f6\uff0c\u6240\u6709\u503c\u4e3anull\uff0c\u4ee5\u53ca\u4e0d\u5305\u542b\u6307\u5b9a\u952e\u7684\u6587\u6863\u5747\u4f1a\u88ab\u68c0\u7d22\u51fa\u6765\u3002 &gt; db.test.find({\"x\":null}) { \"_id\" : ObjectId(\"4fd59d30b9ac507e96276f1b\"), \"x\" : null } { \"_id\" : ObjectId(\"4fd59d49b9ac507e96276f1c\"), \"y\" : 1 }</p> <p>--\u9700\u8981\u5c06null\u4f5c\u4e3a\u6570\u7ec4\u4e2d\u7684\u4e00\u4e2a\u5143\u7d20\u8fdb\u884c\u76f8\u7b49\u6027\u5224\u65ad\uff0c\u5373\u4fbf\u8fd9\u4e2a\u6570\u7ec4\u4e2d\u53ea\u6709\u4e00\u4e2a\u5143\u7d20\u3002 --\u518d\u6709\u5c31\u662f\u901a\u8fc7$exists\u5224\u65ad\u6307\u5b9a\u952e\u662f\u5426\u5b58\u5728\u3002 &gt; db.test.find({\"x\": {\"$in\": [null], \"$exists\":true}}) { \"_id\" : ObjectId(\"4fd59d30b9ac507e96276f1b\"), \"x\" : null }</p> <p>4.\u00a0 \u6b63\u5219\u67e5\u8be2\uff1a --MongoDB\u4e2d\u4f7f\u7528\u4e86Perl\u89c4\u5219\u7684\u6b63\u5219\u8bed\u6cd5\u3002\u5982\uff1a &gt; db.test.find() { \"_id\" : ObjectId(\"4fd59ed7b9ac507e96276f1d\"), \"name\" : \"stephen\" } { \"_id\" : ObjectId(\"4fd59edbb9ac507e96276f1e\"), \"name\" : \"stephen1\" } --i\u8868\u793a\u5ffd\u7565\u5927\u5c0f\u5199 &gt; db.test.find({\"name\":/stephen?/i}) { \"_id\" : ObjectId(\"4fd59ed7b9ac507e96276f1d\"), \"name\" : \"stephen\" } { \"_id\" : ObjectId(\"4fd59edbb9ac507e96276f1e\"), \"name\" : \"stephen1\" }</p> <p>5.\u00a0 \u6570\u7ec4\u6570\u636e\u67e5\u8be2\uff1a --\u57fa\u4e8e\u6570\u7ec4\u7684\u67e5\u627e\u3002 &gt; db.test.find() { \"_id\" : ObjectId(\"4fd5a177b9ac507e96276f1f\"), \"fruit\" : [ \"apple\", \"banana\", \"peach\" ] } { \"_id\" : ObjectId(\"4fd5a18cb9ac507e96276f20\"), \"fruit\" : [ \"apple\", \"kumquat\",\"orange\" ] } { \"_id\" : ObjectId(\"4fd5a1f0b9ac507e96276f21\"), \"fruit\" : [ \"cherry\", \"banana\",\"apple\" ] } --\u6570\u7ec4\u4e2d\u6240\u6709\u5305\u542bbanana\u7684\u6587\u6863\u90fd\u4f1a\u88ab\u68c0\u7d22\u51fa\u6765\u3002 &gt; db.test.find({\"fruit\":\"banana\"}) { \"_id\" : ObjectId(\"4fd5a177b9ac507e96276f1f\"), \"fruit\" : [ \"apple\", \"banana\", \"peach\" ] } { \"_id\" : ObjectId(\"4fd5a1f0b9ac507e96276f21\"), \"fruit\" : [ \"cherry\", \"banana\",\"apple\" ] } --\u68c0\u7d22\u6570\u7ec4\u4e2d\u9700\u8981\u5305\u542b\u591a\u4e2a\u5143\u7d20\u7684\u60c5\u51b5\uff0c\u8fd9\u91cc\u4f7f\u7528$all\u3002\u4e0b\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u6570\u7ec4\u4e2d\u5fc5\u987b\u540c\u65f6\u5305\u542bapple\u548cbanana\uff0c\u4f46\u662f\u4ed6\u4eec\u7684\u987a\u5e8f\u65e0\u5173\u7d27\u8981\u3002 &gt; db.test.find({\"fruit\": {\"$all\": [\"banana\",\"apple\"]}}) { \"_id\" : ObjectId(\"4fd5a177b9ac507e96276f1f\"), \"fruit\" : [ \"apple\", \"banana\", \"peach\" ] } { \"_id\" : ObjectId(\"4fd5a1f0b9ac507e96276f21\"), \"fruit\" : [ \"cherry\", \"banana\", \"apple\" ] } --\u4e0b\u9762\u7684\u793a\u4f8b\u8868\u793a\u7cbe\u786e\u5339\u914d\uff0c\u5373\u88ab\u68c0\u7d22\u51fa\u6765\u7684\u6587\u6863\uff0cfruit\u503c\u4e2d\u7684\u6570\u7ec4\u6570\u636e\u5fc5\u987b\u548c\u67e5\u8be2\u6761\u4ef6\u5b8c\u5168\u5339\u914d\uff0c\u5373\u4e0d\u80fd\u591a\uff0c\u4e5f\u4e0d\u80fd\u5c11\uff0c\u987a\u5e8f\u4e5f\u5fc5\u987b\u4fdd\u6301\u4e00\u81f4\u3002 &gt; db.test.find({\"fruit\":[\"apple\",\"banana\",\"peach\"]}) { \"_id\" : ObjectId(\"4fd5a177b9ac507e96276f1f\"), \"fruit\" : [ \"apple\", \"banana\", peach\" ] } --\u4e0b\u9762\u7684\u793a\u4f8b\u5c06\u5339\u914d\u6570\u7ec4\u4e2d\u6307\u5b9a\u4e0b\u6807\u5143\u7d20\u7684\u503c\u3002\u6570\u7ec4\u7684\u8d77\u59cb\u4e0b\u6807\u662f0\u3002 &gt; db.test.find({\"fruit.2\":\"peach\"}) { \"_id\" : ObjectId(\"4fd5a177b9ac507e96276f1f\"), \"fruit\" : [ \"apple\", \"banana\", peach\" ] } --\u53ef\u4ee5\u901a\u8fc7$size\u83b7\u53d6\u6570\u7ec4\u7684\u957f\u5ea6\uff0c\u4f46\u662f$size\u4e0d\u80fd\u548c\u6bd4\u8f83\u64cd\u4f5c\u7b26\u8054\u5408\u4f7f\u7528\u3002 &gt; db.test.find({\"fruit\": {$size : 3}}) { \"_id\" : ObjectId(\"4fd5a177b9ac507e96276f1f\"), \"fruit\" : [ \"apple\", \"banana\", \"peach\" ] } { \"_id\" : ObjectId(\"4fd5a18cb9ac507e96276f20\"), \"fruit\" : [ \"apple\", \"kumquat\",\"orange\" ] } { \"_id\" : ObjectId(\"4fd5a1f0b9ac507e96276f21\"), \"fruit\" : [ \"cherry\", \"banana\",\"apple\" ] } --\u5982\u679c\u9700\u8981\u68c0\u7d22size &gt; n\u7684\u7ed3\u679c\uff0c\u4e0d\u80fd\u76f4\u63a5\u4f7f\u7528$size\uff0c\u53ea\u80fd\u662f\u6dfb\u52a0\u4e00\u4e2a\u989d\u5916\u7684\u952e\u8868\u793a\u6570\u636e\u4e2d\u7684\u5143\u7d20\u6570\u636e\uff0c\u5728\u64cd\u4f5c\u6570\u636e\u4e2d\u7684\u5143\u7d20\u65f6\uff0c\u9700\u8981\u540c\u65f6\u66f4\u65b0size\u952e\u7684\u503c\u3002 --\u4e3a\u540e\u9762\u7684\u5b9e\u9a8c\u6784\u9020\u6570\u636e\u3002 &gt; db.test.update({}, {\"$set\": {\"size\":3}},false,true) &gt; db.test.find() { \"_id\" : ObjectId(\"4fd5a18cb9ac507e96276f20\"), \"fruit\" : [ \"apple\", \"kumquat\", \"orange\" ], \"size\" : 3 } { \"_id\" : ObjectId(\"4fd5a1f0b9ac507e96276f21\"), \"fruit\" : [ \"cherry\", \"banana\", \"apple\" ], \"size\" : 3 } --\u6bcf\u6b21\u6dfb\u52a0\u4e00\u4e2a\u65b0\u5143\u7d20\uff0c\u90fd\u8981\u539f\u5b50\u6027\u7684\u81ea\u589esize\u4e00\u6b21\u3002 &gt; test.update({},{\"$push\": {\"fruit\":\"strawberry\"},\"$inc\":{\"size\":1}},false,true) &gt; db.test.find() { \"_id\" : ObjectId(\"4fd5a18cb9ac507e96276f20\"), \"fruit\" : [ \"apple\", \"kumquat\", \"orange\", \"strawberry\" ], \"size\" : 4 } { \"_id\" : ObjectId(\"4fd5a1f0b9ac507e96276f21\"), \"fruit\" : [ \"cherry\", \"banana\", \"apple\", \"strawberry\" ], \"size\" : 4 } --\u901a\u8fc7$slice\u8fd4\u56de\u6570\u7ec4\u4e2d\u7684\u90e8\u5206\u6570\u636e\u3002\"$slice\":2\u8868\u793a\u6570\u7ec4\u4e2d\u7684\u524d\u4e24\u4e2a\u5143\u7d20\u3002 &gt; db.test.find({},{\"fruit\": {\"$slice\":2}, \"size\":0}) { \"_id\" : ObjectId(\"4fd5a18cb9ac507e96276f20\"), \"fruit\" : [ \"apple\", \"kumquat\" ]} { \"_id\" : ObjectId(\"4fd5a1f0b9ac507e96276f21\"), \"fruit\" : [ \"cherry\", \"banana\" ]} --\u901a\u8fc7$slice\u8fd4\u56de\u6570\u7ec4\u4e2d\u7684\u90e8\u5206\u6570\u636e\u3002\"$slice\":-2\u8868\u793a\u6570\u7ec4\u4e2d\u7684\u540e\u4e24\u4e2a\u5143\u7d20\u3002 &gt; db.test.find({},{\"fruit\": {\"$slice\":-2}, \"size\":0}) { \"_id\" : ObjectId(\"4fd5a18cb9ac507e96276f20\"), \"fruit\" : [ \"orange\", \"strawberry\" ] } { \"_id\" : ObjectId(\"4fd5a1f0b9ac507e96276f21\"), \"fruit\" : [ \"apple\", \"strawberry\" ] } --$slice : [2,1]\uff0c\u8868\u793a\u4ece\u7b2c\u4e8c\u4e2a2\u5143\u7d20\u5f00\u59cb\u53d61\u4e2a\uff0c\u5982\u679c\u83b7\u53d6\u6570\u91cf\u5927\u4e8e2\u540e\u9762\u7684\u5143\u7d20\u6570\u91cf\uff0c\u5219\u53d6\u540e\u9762\u7684\u5168\u90e8\u6570\u636e\u3002 &gt; db.test.find({},{\"fruit\": {\"$slice\":[2,1]}, \"size\":0}) { \"_id\" : ObjectId(\"4fd5a18cb9ac507e96276f20\"), \"fruit\" : [ \"orange\" ] } { \"_id\" : ObjectId(\"4fd5a1f0b9ac507e96276f21\"), \"fruit\" : [ \"apple\" ] }</p> <p>6.\u00a0 \u5185\u5d4c\u6587\u6863\u67e5\u8be2\uff1a --\u4e3a\u540e\u9762\u7684\u793a\u4f8b\u6784\u9020\u6d4b\u8bd5\u6570\u636e\u3002 &gt; db.test.find() { \"_id\" : ObjectId(\"4fd5ada3b9ac507e96276f22\"), \"name\" : { \"first\" : \"Joe\", \"last\" : \"He\" }, \"age\" : 45 }  --\u5f53\u5d4c\u5165\u5f0f\u6587\u6863\u4e3a\u6570\u7ec4\u65f6\uff0c\u9700\u8981$elemMatch\u64cd\u4f5c\u7b26\u6765\u5e2e\u52a9\u5b9a\u4f4d\u67d0\u4e00\u4e2a\u5143\u7d20\u5339\u914d\u7684\u60c5\u51b5\uff0c\u5426\u5219\u5d4c\u5165\u5f0f\u6587\u4ef6\u5c06\u8fdb\u884c\u5168\u90e8\u7684\u5339\u914d\u3002 --\u5373\u68c0\u7d22\u65f6\u9700\u8981\u5c06\u6240\u6709\u5143\u7d20\u90fd\u5217\u51fa\u6765\u4f5c\u4e3a\u67e5\u8be2\u6761\u4ef6\u65b9\u53ef\u3002 &gt; db.test.findOne() { \"_id\" : ObjectId(\"4fd5af76b9ac507e96276f23\"), \"comments\" : [ { \"author\" : \"joe\", \"score\" : 3 }, { \"author\" : \"mary\", \"score\" : 6 } ] } &gt; db.test.find({\"comments\": {\"$elemMatch\": {\"author\":\"joe\",\"score\":{\"$gte\":3}}}} { \"_id\" : ObjectId(\"4fd5af76b9ac507e96276f23\"), \"comments\" : [ { \"author\" : \"joe\", \"score\" : 3 }, { \"author\" : \"mary\", \"score\" : 6 } ] }</p> <p>7.\u00a0 \u6e38\u6807\uff1a \u6570\u636e\u5e93\u4f7f\u7528\u6e38\u6807\u6765\u8fd4\u56defind()\u7684\u6267\u884c\u7ed3\u679c\uff0c\u5ba2\u6237\u7aef\u5bf9\u6e38\u6807\u53ef\u4ee5\u8fdb\u884c\u6709\u6548\u7684\u63a7\u5236\uff0c\u5982\uff1a\u9650\u5b9a\u7ed3\u679c\u96c6\u7684\u6570\u91cf\u3001\u8df3\u8fc7\u90e8\u5206\u7ed3\u679c\u3001\u57fa\u4e8e\u4efb\u610f\u952e\u7684\u4efb\u610f\u65b9\u5411\u7684\u6392\u5e8f\u7b49\u3002 \u4e0b\u9762\u7684\u4f8b\u5b50\u5c06\u7528\u4e8e\u51c6\u5907\u6d4b\u8bd5\u6570\u636e\u3002 &gt; db.testtable.remove() &gt; for (i = 0; i &lt; 10; ++i) { ... db.testtable.insert({x:i}) ... } \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7cursor\u63d0\u4f9b\u7684hasNext()\u65b9\u6cd5\u5224\u65ad\u662f\u5426\u8fd8\u6709\u672a\u8bfb\u53d6\u7684\u6570\u636e\uff0c\u518d\u901a\u8fc7next()\u65b9\u6cd5\u8bfb\u53d6\u7ed3\u679c\u96c6\u4e2d\u7684\u4e0b\u4e00\u4e2a\u6587\u6863\u3002\u5982\uff1a &gt; var c = db.testtable.find() &gt; while (c.hasNext()) { ... print(c.next().x) ... } 0 1 2 3 4 5 6 7 8 9 \u5f53\u8c03\u7528find()\u7684\u65f6\u5019\uff0cshell\u5e76\u4e0d\u7acb\u5373\u67e5\u8be2\u6570\u636e\u5e93\uff0c\u800c\u662f\u7b49\u5f85\u771f\u6b63\u5f00\u59cb\u8981\u6c42\u83b7\u5f97\u7ed3\u679c\u7684\u65f6\u5019\u624d\u53d1\u9001\u67e5\u8be2\uff0c\u8fd9\u6837\u5728\u6267\u884c\u4e4b\u524d\u53ef\u4ee5\u7ed9\u67e5\u8be2\u9644\u52a0\u989d\u5916\u7684\u9009\u9879\u3002\u51e0\u4e4e\u6240\u6709\u7684\u6e38\u6807\u65b9\u6cd5\u90fd\u8fd4\u56de\u672c\u8eab\uff0c\u56e0\u6b64\u53ef\u4ee5\u50cf\u4e0b\u9762\u8fd9\u6837\u5c06\u6e38\u6807\u7684\u65b9\u6cd5\u94fe\u5f0f\u7ec4\u5408\u8d77\u6765\u3002\u5982\uff1a &gt; var c1 = db.testtable.find().sort({\"x\":1}).limit(1).skip(4); &gt; var c2 = db.testtable.find().limit(1).sort({\"x\":1}).skip(4); &gt; var c3 = db.testtable.find().skip(4).limit(1).sort({\"x\":1}); \u6b64\u65f6\uff0c\u67e5\u8be2\u5e76\u672a\u6267\u884c\uff0c\u6240\u6709\u8fd9\u4e9b\u51fd\u6570\u90fd\u662f\u5728\u6784\u9020\u67e5\u8be2\uff0c\u5f53\u6267\u884c\u4e0b\u9762\u7684\u8bed\u53e5\u65f6\uff0c\u67e5\u8be2\u5c06\u88ab\u771f\u6b63\u6267\u884c\uff0c &gt; c.hasNext() \u67e5\u8be2\u88ab\u53d1\u9001\u5230\u670d\u52a1\u5668\uff0cMongoDB\u670d\u52a1\u5668\u6bcf\u6b21\u5c06\u8fd4\u56de\u4e00\u6279\u6570\u636e\uff0c\u5f53\u672c\u6279\u88ab\u5168\u90e8\u8fed\u4ee3\u540e\u518d\u4ece\u670d\u52a1\u5668\u8bfb\u53d6\u4e0b\u4e00\u6279\u6570\u636e\uff0c\u76f4\u81f3\u67e5\u8be2\u7ed3\u679c\u9700\u8981\u7684\u6570\u636e\u88ab\u5168\u90e8\u8fed\u4ee3\u3002</p> <p>\u5bf9\u4e8e\u4e0a\u9762\u7684\u793a\u4f8b\uff0climit(1)\u8868\u793a\u8f93\u51fa\u7ed3\u679c\u4ec5\u4e3a\u4e00\u4e2a\uff0c\u5982\u679c\u5c0f\u4e8e1\uff0c\u5219\u4e0d\u8f93\u51fa\uff0c\u5373limit(n)\u51fd\u6570\u9650\u5b9a\u7684\u662f\u6700\u591a\u8f93\u51fa\u7ed3\u679c\u3002skip(4)\u8868\u793a\u8df3\u8fc7\u67e5\u8be2\u7ed3\u679c\u4e2d\u7684\u524d4\u4e2a\u6587\u6863\uff0c\u5982\u679c\u7ed3\u679c\u5c0f\u4e8e4\uff0c\u5219\u4e0d\u4f1a\u8fd4\u56de\u4efb\u4f55\u6587\u6863\u3002sort({\"x\":1})\u7528\u4e8e\u8bbe\u5b9a\u6392\u5e8f\u6761\u4ef6\uff0c\u5373\u6309\u7167x\u952e\u4ee5\u5347\u5e8f(1)\u7684\u65b9\u5f0f\u6392\u5e8f\uff0c\u5982\u679c\u9700\u8981\u964d\u5e8f\u6392\u5e8f\u53ef\u4ee5\u6539\u4e3a\uff1asort({\"x\":-1})\u3002sort\u4e5f\u53ef\u4ee5\u652f\u6301\u591a\u952e\u6392\u5e8f\uff0c\u5982\uff1asort({username:1, age:-1})\u5373\u5148\u6309\u7167username\u8fdb\u884c\u5347\u5e8f\u6392\u5e8f\uff0c\u5982\u679cusername\u7684\u503c\u76f8\u540c\uff0c\u518d\u4ee5age\u952e\u8fdb\u884c\u964d\u5e8f\u6392\u5e8f\u3002\u8fd9\u91cc\u9700\u8981\u6307\u51fa\u7684\u662f\uff0c\u5982\u679cskip\u8fc7\u591a\u7684\u6587\u6863\uff0c\u5c06\u4f1a\u5bfc\u81f4\u6027\u80fd\u95ee\u9898\u3002</p> \u6458\u81ea\u300chttp://www.cnblogs.com/stephen-liu74/archive/2012/08/03/2553803.html\u300d See more: MongoDB","tags":["mongodb","mongo"]},{"location":"DATABASE/2016-12-06-centos-7-2-yum-%25e5%25ae%2589%25e8%25a3%2585-mysql-%25e7%25a4%25be%25e5%258c%25ba%25e7%2589%2588.html/","title":"centos 7.2 yum \u5b89\u88c5 MySQL \u793e\u533a\u7248","text":"<p>1\u3001\u65b0\u5efayum\u6e90 [root@myhost yum.repos.d]# pwd /etc/yum.repos.d</p> <p>[root@myhost yum.repos.d]# cat mysql-community.repo</p> <p># Enable to use MySQL 5.6 [mysql56-community] name=MySQL 5.6 Community Server baseurl=http://repo.mysql.com/yum/mysql-5.6-community/el/7/x86_64 enabled=1 gpgcheck=0</p> <p>2\u3001yum \u5b89\u88c5MySQL\u793e\u533a\u7248</p> <p>[root@myhost yum.repos.d]# yum install mysql-community-server [root@myhost yum.repos.d]# systemctl list-unit-files | grep mysql [root@myhost yum.repos.d]# service mysql start</p> <p>3\u3001\u89e3\u51b3\u544a\u8b66 [root@myhost yum.repos.d]# cat /var/log/mysqld.log | grep Warning \u95ee\u9898</p> <p>2016-12-05 15:13:29 9005 [Warning] Buffered warning: Changed limits: max_open_files: 1024 (requested 5000) 2016-12-05 15:13:29 9005 [Warning] Buffered warning: Changed limits: table_open_cache: 431 (requested 2000)</p> <p>\u89e3\u51b3</p> <p>[root@myhost ~]# ulimit -a [root@myhost ~]# vi /etc/security/limits.conf</p> <p>\u8ffd\u52a0</p> <p>mysql hard nofile 65535 mysql soft nofile 65535</p> <p>[root@myhost ~]# vi /usr/lib/systemd/system/mysqld.service (in the [service] section) \u8ffd\u52a0</p> <p>LimitNOFILE=65535</p> <p>[root@myhost ~]# systemctl daemon-reload [root@myhost ~]# service mysql restart</p> <p>see more\uff1a http://stackoverflow.com/questions/32760202/buffered-warning-changed-limits-max-connections-214-requested-800</p> <p>4\u3001\u91cd\u7f6eroot\u5bc6\u7801 # service mysql stop # mysqld_safe --user=mysql --skip-grant-tables --skip-networking &amp; # mysql -u root mysql</p> <p>mysql&gt;UPDATE user SET Password=PASSWORD('new_password') where USER='root'; mysql&gt;FLUSH PRIVILEGES; mysql&gt;quit</p> <p># service mysql start</p>","tags":[]},{"location":"DATABASE/2017-05-07-oracle-9i-10g%25e7%25bc%2596%25e7%25a8%258b%25e8%2589%25ba%25e6%259c%25af-%25e6%25b7%25b1%25e5%2585%25a5%25e6%2595%25b0%25e6%258d%25ae%25e5%25ba%2593%25e4%25bd%2593%25e7%25b3%25bb%25e7%25bb%2593%25e6%259e%2584.html/","title":"Oracle 9i &10g\u7f16\u7a0b\u827a\u672f-\u6df1\u5165\u6570\u636e\u5e93\u4f53\u7cfb\u7ed3\u6784","text":"\u76ee\u5f55 <ul> <li>\u5e8f</li> <li>\u524d\u8a00</li> <li>\u76ee\u5f55</li> <li>\u914d\u7f6e\u73af\u5883</li> <li>\u7b2c\u4e00\u7ae0 \u5f00\u53d1\u6210\u529f\u7684Oracle\u5e94\u7528\u7a0b\u5e8f</li> <li>\u7b2c2\u7ae0\uff1a\u4f53\u7cfb\u7ed3\u6784\u6982\u8ff0</li> <li>\u7b2c3\u7ae0\uff1a\u6587\u4ef6</li> <li>\u7b2c4\u7ae0\uff1a\u5185\u5b58\u7ed3\u6784</li> <li>\u7b2c5\u7ae0\uff1aOracle\u8fdb\u7a0b</li> <li>\u7b2c6\u7ae0\uff1a\u9501</li> <li>\u7b2c7\u7ae0\uff1a\u5e76\u53d1\u4e0e\u591a\u7248\u672c</li> <li>\u7b2c8\u7ae0\uff1a\u4e8b\u52a1</li> <li>\u7b2c9\u7ae0\uff1aredo\u4e0eundo</li> <li>\u7b2c10\u7ae0\uff1a\u6570\u636e\u5e93\u8868</li> <li>\u7b2c11\u7ae0\uff1a\u7d22\u5f15</li> <li>\u7b2c12\u7ae0\uff1a\u6570\u636e\u7c7b\u578b</li> <li>\u7b2c13\u7ae0\uff1a\u5206\u533a</li> <li>\u7b2c14\u7ae0\uff1a\u5e76\u884c\u6267\u884c</li> <li>\u7b2c15\u7ae0\uff1a\u6570\u636e\u52a0\u8f7d\u548c\u5378\u8f7d</li> </ul> \u539f\u6587 <ul> <li>http://blog.csdn.net/knowhow?viewmode=contents</li> </ul>","tags":["\u6570\u636e\u5e93","oracle","\u7f16\u7a0b"]},{"location":"DevOps/2015-11-26-maven-%25e8%25ae%25be%25e7%25bd%25aejdk%25e7%25bc%2596%25e8%25af%2591%25e6%25b0%25b4%25e5%25b9%25b3.html/","title":"maven \u8bbe\u7f6ejdk\u7f16\u8bd1\u6c34\u5e73","text":"<p>\u5728pom.xml\u6dfb\u52a0\uff1a</p> <ol> <li>&lt;build&gt;</li> <li> &lt;plugins&gt;</li> <li> &lt;plugin&gt;</li> <li> &lt;groupId&gt;org.apache.maven.pluginsgroupId&gt; <li> &lt;artifactId&gt;maven-compiler-pluginartifactId&gt; <li> 3.1</li> <li> &lt;configuration&gt;</li> <li> &lt;source&gt;6source&gt; <li> &lt;target&gt;6target&gt; <li> &lt;encoding&gt;UTF-8encoding&gt; <li> configuration&gt; <li> plugin&gt; <li> plugins&gt; <li>build&gt; <p> </p>","tags":["maven"]},{"location":"DevOps/2015-11-27-%25e8%25bd%25ac-maven-%25e5%258f%2591%25e5%25b8%2583artifact%25e5%2588%25b0%25e4%25b8%25ad%25e5%25a4%25ae%25e5%25ba%2593.html/","title":"maven \u53d1\u5e03artifact\u5230\u4e2d\u592e\u5e93","text":"<p>\u6b65\u9aa4\u4e00\uff1a\u6ce8\u518c\u8d26\u53f7\uff0c\u7533\u8bf7ticket\u3002 \u6ce8\u518c\u5728\u8fd9\u91cc\uff1ahttps://issues.sonatype.org \u7533\u8bf7ticket\uff1a\u521b\u5efa\u4e00\u4e2aissue\uff0c\u6ce8\u610f\u8fd9\u91cc\u8981\u9009OSSRH\uff0c\u4e14\u662fPROJECT\u800c\u4e0d\u662fTASK\uff0cgroup id\u8981\u614e\u91cd\u5199\uff0c\u4e0d\u80fd\u5199\u4f60\u6ca1\u6709\u6743\u9650\u7684\uff0c\u4e0d\u7136\u670d\u52a1\u4eba\u5458\u4f1a\u8ba9\u4f60\u91cd\u5199\uff08\u534a\u5929\u5de6\u53f3\uff09\u3002 \u7533\u8bf7\u6210\u529f\u540e\u4f1a\u63d0\u793a\uff1aConfiguration has been prepared, now you can:please comment on this ticket when you promoted your first release, thanks \u6b65\u9aa4\u4e8c\uff1aGPG\uff0c\u7b7e\u540d\u548c\u52a0\u5bc6\u7528\u3002 \u4e0b\u8f7d\uff1ahttps://www.gnupg.org/download/index.html \u6ce8\u610f\uff1a\u7b7e\u540d\u7684\u540d\u5b57\uff0c\u90ae\u7bb1\u548c\u6b65\u9aa4\u4e00\u7684\u4e00\u6837\uff0c\u8bb0\u4f4fpassphrase\u7528\u4e8e\u4e0b\u9762\u6b65\u9aa4\u3002 \u6b65\u9aa4\u4e09\uff1a\u7f16\u8bd1\u548c\u63d0\u4ea4\u6587\u4ef6\u3002 \u6ce8\u610f\u4e8b\u9879\uff1a</p> <p>1\uff09.m2\\settings.xml\u6587\u4ef6\u4e2d\u8981\u52a0\u5165\uff1a</p> [html] view plaincopy <ol> <li>&lt;servers&gt;</li> <li> &lt;server&gt;</li> <li> &lt;id&gt;sonatype-nexus-snapshotsid&gt; <li> &lt;username&gt;your-jira-usernameusername&gt; <li> &lt;password&gt;your-jira-passwordpassword&gt; <li> server&gt; <li> &lt;server&gt;</li> <li> &lt;id&gt;sonatype-nexus-stagingid&gt; <li> &lt;username&gt;your-jira-usernameusername&gt; <li> &lt;password&gt;your-jira-passwordpassword&gt; <li> server&gt; <li>servers&gt; <p>2) \u00a0pom.xml\u6587\u4ef6\u4e2d\u8981\u52a0\u5165\uff08project\u6807\u7b7e\u4e0b\uff09\uff1a</p> [html] view plaincopy <ol> <li>&lt;parent&gt;</li> <li> &lt;groupId&gt;org.sonatype.ossgroupId&gt; <li> &lt;artifactId&gt;oss-parentartifactId&gt; <li> &lt;version&gt;7version&gt; <li>parent&gt; <p>3\uff09\u5982\u679c\u51fa\u73b0javadoc\u7f16\u8bd1\u4e0d\u901a\u8fc7\u7684\u53ef\u4ee5\u5728javadoc\u63d2\u4ef6\u4e0b\u52a0\u5165\uff1a</p> [html] view plaincopy <ol> <li>&lt;configuration&gt;</li> <li> &lt;additionalparam&gt;-Xdoclint:noneadditionalparam&gt; <li>configuration&gt; <p>4\uff09 \u6ce8\u610f\u5982\u8fc7\u65f6release\u8981\u52a0\u5165\uff1a</p> [html] view plaincopy <ol> <li>&lt;plugin&gt;</li> <li> &lt;groupId&gt;org.apache.maven.pluginsgroupId&gt; <li> &lt;artifactId&gt;maven-gpg-pluginartifactId&gt; <li> &lt;version&gt;${maven-gpg-plugin.version}version&gt; <li> &lt;executions&gt;</li> <li> &lt;execution&gt;</li> <li> &lt;phase&gt;verifyphase&gt; <li> &lt;goals&gt;</li> <li> &lt;goal&gt;signgoal&gt; <li> goals&gt; <li> execution&gt; <li> executions&gt; <li>plugin&gt; <p>5) \u5982\u679c\u662fjava web\u9879\u76ee\uff0cjavadoc\u53ef\u80fd\u4f1a\u62a5\u9519\uff1a\u627e\u4e0d\u5230\u7c7bjavax.servlet.ServletContext\uff0c\u53ef\u4ee5\u6dfb\u52a0\u4f9d\u8d56\uff1a</p> [html] view plaincopy <ol> <li>&lt;dependency&gt;</li> <li> &lt;groupId&gt;javax.servletgroupId&gt; <li> &lt;artifactId&gt;javax.servlet-apiartifactId&gt; <li> &lt;version&gt;3.0.1version&gt; <li> &lt;scope&gt;providedscope&gt; <li>dependency&gt; <p>6) POM\u7f16\u5199\u53ef\u53c2\u8003https://github.com/ACC-GIT/ACCWeb/blob/master/pom.xml</p> <p>\u6b65\u9aa4\u56db\uff1arelease\u548c\u63d0\u793a\u540c\u6b65\u3002 \u5148\u5728https://oss.sonatype.org/#stagingRepositories\u8fdb\u884cclose,release\u7b49\u64cd\u4f5c\uff08\u6ce8\u610f\u8fd9\u91cc\u4f1a\u68c0\u6d4b\uff09 \u7136\u540e\u5728issue\u4e2d\u56de\u590d\u670d\u52a1\u4eba\u5458\uff0c\u63d0\u51fa\u540c\u6b65\u5230\u4e2d\u592e\u5e93\uff08\u534a\u5929\u5de6\u53f3\uff09\u3002</p> <p>\u6458\u81ea\u300c\u4e92\u8054\u7f51\u300d</p>","tags":["maven"]},{"location":"DevOps/2015-11-29-%25e9%2585%258d%25e7%25bd%25aeapache-basic%25e5%2592%258cdigest%25e8%25ae%25a4%25e8%25af%2581.html/","title":"\u914d\u7f6eApache Basic\u548cDigest\u8ba4\u8bc1","text":"<p>Apache\u5e38\u89c1\u7684\u7528\u6237\u8ba4\u8bc1\u53ef\u4ee5\u5206\u4e3a\u4e0b\u9762\u4e09\u79cd\uff1a</p> <ul> <li>\u57fa\u4e8eIP\uff0c\u5b50\u7f51\u7684\u8bbf\u95ee\u63a7\u5236(ACL)</li> <li>\u57fa\u672c\u7528\u6237\u9a8c\u8bc1(Basic Authentication)</li> <li>\u6d88\u606f\u6458\u8981\u5f0f\u8eab\u4efd\u9a8c\u8bc1(Digest Authentication)</li> </ul> \u57fa\u672c\u8eab\u4efd\u9a8c\u8bc1 <p>\u539f\u7406\uff1a \u4e00\u4e2a\u9875\u9762\u8bbf\u95ee\u8bf7\u6c42</p> 1 2 <code>GET /auth/basic/ HTTP/1.1</code> <code>Host: target</code> <p>Web\u670d\u52a1\u5668\u8981\u6c42\u7528\u4e66\u8f93\u5165\u7528\u6237\u51ed\u636e\uff08\u670d\u52a1\u5668\u8fd4\u56de401\u54cd\u5e94\u5934\u548c\u2019realm\u2019\uff09</p> 1 2 3 4 5 6 7 <code>HTTP/1.1 401 Authorization Required</code> <code>Date: Sat, 08 Jun 2013 12:52:40 GMT</code> <code>WWW-Authenticate: Basic realm=\"Basic auth Dir\"\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 </code> <code>Content-Length: 401</code> <code>Keep-Alive: timeout=15, max=100</code> <code>Connection: Keep-Alive</code> <code>Content-Type: text/html; charset=iso-8859-1</code> <p>\u6d4f\u89c8\u5668\u5f39\u51fa\u767b\u5f55\u7a97\u53e3(\u5305\u542b\u2019realm\u2019)\uff0c\u8981\u6c42\u7528\u63d0\u4f9b\u7528\u6237\u540d/\u5bc6\u7801</p> 1 2 3 <code>GET /auth/basic/ HTTP/1.1</code> <code>Host: target</code> <code>Authorization: Basic TGVuZ1dhOjEyMzQ1Ng==\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 //Basic\u540e\u9762\u5c31\u662fLengWa:123456\u7ecf\u8fc7Base64\u7f16\u7801\u540e\u7684\u5b57\u7b26\u4e32</code> <p>\u670d\u52a1\u5668\u5c06\u7528\u6237\u8f93\u5165\u7684\u51ed\u636e\u548c\u670d\u52a1\u5668\u7aef\u7684\u51ed\u636e\u8fdb\u884c\u6bd4\u8f83\u3002\u5982\u679c\u4e00\u76f4\u5219\u8fd4\u56de\u6240\u8bf7\u6c42\u9875\u9762\u7684\u54cd\u5e94\u3002</p> <p>\u914d\u7f6e: \u2013 \u4ee5\u4fdd\u62a4/data/www/auth/basic\u4e3a\u4f8b</p> <p>Step 1\uff1a \u521b\u5efa\u5bc6\u7801\u6587\u4ef6\uff0c\u5e76\u6dfb\u52a0\u7b2c\u4e00\u4e2a\u7528\u6237\u3002</p> 1 2 3 4 <code>/usr/local/apache/bin&gt; ./htpasswd -c /data/www/auth/basic/user.txt LengWa </code> <code>New password:\u00a0 </code> <code>Re-type new password:\u00a0\u00a0 </code> <code>Adding password for user LengWa</code> <p>-c = create file</p> <p>\u5e38\u89c4\u6dfb\u52a0\u4e0d\u8981\u4f7f\u7528-c\u9009\u9879\uff0c\u56e0\u4e3a\u5b83\u4f1a\u8986\u76d6\u73b0\u6709\u7684\u6587\u4ef6\u3002</p> <p>\u8bbe\u7f6e\u6587\u4ef6\u6240\u6709\u6743\u548c\u6743\u9650\uff08root\u53ef\u4ee5\u8fdb\u884c\u8bfb\u5199\uff0cApache Group\u53ea\u53ef\u4ee5\u8bfb\u53d6\uff09</p> 1 2 <code>/data/www/auth/basic &gt; ls -l </code> <code>-rw-r-----\u00a0\u00a0 1 root\u00a0\u00a0\u00a0\u00a0 httpd\u00a0\u00a0\u00a0 ...\u00a0\u00a0 user.txt</code> <p>\u6ce8\u610f\uff1a \u5728\u5bc6\u7801\u6587\u4ef6\u4e2d\uff0c\u5bc6\u7801\u662f\u52a0\u5bc6\u5b58\u8d2e\u7684(eg: LengWa:$apr1$MBvROZKM$wP.pdlMonB0P4xGZwl.8G0)\u3002\u4f46\u662f\u5728\u7f51\u7edc\u4e2d\u662f\u660e\u6587\u4f20\u8f93\u7684\u3002</p> <p>Step 2\uff1a \u914d\u7f6ehttpd.conf</p> 1 2 3 4 5 6 <code> <code> </code><code>Options Indexes FollowSymLinks</code> <code> </code><code>allowoverride authconfig</code> <code> </code><code>order allow,deny</code> <code> </code><code>allow from all</code> <code></code> <p>Step3: \u7f16\u8f91/data/www/auth/basic/.htaccess</p> 1 2 3 4 <code>AuthName \"Basic Auth Dir\"</code> <code>AuthType Basic</code> <code>AuthUserFile /data/www/auth/basic/user.txt</code> <code>require valid-user</code> <p>\u91cd\u65b0\u542f\u52a8Apache\u670d\u52a1\u5668\uff0c\u8bbf\u95ee http://127.0.0.1/auth/basic/ \u9a8c\u8bc1\u52a0\u5bc6\u3002</p> <p>\u6211\u524d\u9762\u8bf4\u8fc7\u8fd9\u79cd\u52a0\u5bc6\u5728\u7f51\u7edc\u4e2d\u4f20\u8f93\u65f6\u662f\u660e\u6587\u4f20\u8f93 Base64 \u7f16\u7801\uff0c\u6211\u4e0d\u8ba4\u4e3a\u8fd9\u662f\u4e00\u79cd\u52a0\u5bc6\u7b97\u6cd5)\u7684\u3002\u5982\u679c\u4f60\u611f\u5174\u8da3\uff0c\u53ef\u4ee5\u6293\u5305\u770b\u770b\u3002</p> <p> </p> \u6d88\u606f\u6458\u8981\u5f0f\u8eab\u4efd\u9a8c\u8bc1(Digest Authentication) <p>\u539f\u7406\uff1a</p> <p>Digest Authentication\u5728\u57fa\u672c\u8eab\u4efd\u9a8c\u8bc1\u4e0a\u9762\u6269\u5c55\u4e86\u5b89\u5168\u6027. \u670d\u52a1\u5668\u4e3a\u6bcf\u4e00\u8fde\u63a5\u751f\u6210\u4e00\u4e2a\u552f\u4e00\u7684\u968f\u673a\u6570, \u5ba2\u6237\u7aef\u5bf9\u7528\u8fd9\u4e2a\u968f\u673a\u6570\u5bf9\u5bc6\u7801\u8fdb\u884cMD5\u52a0\u5bc6. \u7136\u540e\u53d1\u9001\u5230\u670d\u52a1\u5668. \u670d\u52a1\u5668\u7aef\u4e5f\u7528\u6b64\u968f\u673a\u6570\u5bf9\u5bc6\u7801\u52a0\u5bc6, \u7136\u540e\u548c\u5ba2\u6237\u7aef\u4f20\u9001\u8fc7\u6765\u7684\u52a0\u5bc6\u6570\u636e\u8fdb\u884c\u6bd4\u8f83.</p> <p>\u4e00\u4e2a\u9875\u9762\u8bbf\u95ee\u8bf7\u6c42</p> 1 2 <code>GET /auth/basic/\u00a0 HTTP/1.1</code> <code>Host: target</code> <p>Web\u670d\u52a1\u5668\u8981\u6c42\u7528\u4e66\u8f93\u5165\u7528\u6237\u51ed\u636e(\u670d\u52a1\u5668\u8fd4\u56de401\u54cd\u5e94\u5934\u548c\u2019realm\u2019)</p> 1 2 3 4 5 6 7 <code>HTTP/1.1 401 Unauthorized</code> <code>WWW-Authenticate: Digest realm=\"Digest Encrypt\", </code> <code>nonce=\"nmeEHKLeBAA=aa6ac7ab3cae8f1b73b04e1e3048179777a174b3\", </code> <code>opaque=\"0000000000000000\", \\</code> <code>stale=false, </code> <code>algorithm=MD5, </code> <code>qop=\"auth\"</code> <p>\u6d4f\u89c8\u5668\u5f39\u51fa\u767b\u5f55\u7a97\u53e3(\u5305\u542b\u2019realm\u2019), \u8981\u6c42\u7528\u63d0\u4f9b\u7528\u6237\u540d/\u5bc6\u7801</p> 1 2 3 4 5 6 7 8 9 10 11 12 <code>GET /auth/digest/ HTTP/1.1</code> <code>Accept: */*</code> <code>Authorization:\u00a0 Digest username=\"LengWa\", </code> <code>realm=\"Digest Encrypt\", </code> <code>qop=\"auth\", </code> <code>algorithm=\"MD5\", </code> <code>uri=\"/auth/digest/\", </code> <code>nonce=\"nmeEHKLeBAA=aa6ac7ab3cae8f1b73b04e1e3048179777a174b3\", </code> <code>nc=00000001, </code> <code>cnonce=\"6092d3a53e37bb44b3a6e0159974108b\", </code> <code>opaque=\"0000000000000000\", </code> <code>response=\"652b2f336aeb085d8dd9d887848c3314\"</code> <p>\u670d\u52a1\u5668\u5c06\u7528\u6237\u8f93\u5165\u52a0\u5bc6\u540e\u7684\u51ed\u636e\u548c\u670d\u52a1\u5668\u7aef\u52a0\u5bc6\u540e\u7684\u7684\u51ed\u636e\u8fdb\u884c\u6bd4\u8f83.\u5982\u679c\u4e00\u81f4\u5219\u8fd4\u56de\u6240\u8bf7\u6c42\u9875\u9762\u7684\u54cd\u5e94.</p> <p>\u914d\u7f6e:</p> <p>Step 1: \u521b\u5efa\u5bc6\u7801\u6587\u4ef6</p> <p>\u8bed\u6cd5:</p> 1 2 3 4 5 6 <code>htdiget [-c] passwordfile realm username</code> <code>/usr/local/apache/bin&gt; ./htdigest -c /data/www/auth/digest/user.txt \"Digest Encrypt\" LengWa</code> <code>Adding password for LengWa in realm \"Digest Encrypt\" .</code> <code>New password:</code> <code>Re-type new password:</code> <p>-c = create file</p> <p>\u5e38\u89c4\u6dfb\u52a0\u4e0d\u8981\u4f7f\u7528-c\u9009\u9879, \u56e0\u4e3a\u5b83\u4f1a\u8986\u76d6\u73b0\u6709\u7684\u6587\u4ef6.</p> <p>\u8bbe\u7f6e\u6587\u4ef6\u6240\u6709\u6743\u548c\u6743\u9650(root\u53ef\u4ee5\u8fdb\u884c\u8bfb\u5199, Apache Group\u53ea\u53ef\u4ee5\u8bfb\u53d6)</p> 1 2 <code>/data/www/auth/digest/ &gt; ls -l </code> <code>-rw-r-----\u00a0\u00a0 1 root\u00a0\u00a0\u00a0\u00a0 httpd\u00a0\u00a0\u00a0 ...\u00a0\u00a0 user.txt</code> <p>user.txt\u683c\u5f0f: LengWa:Digest Encrypt:d95ea4412b0fb517b25c4c46f32e5a2b</p> <p>Step2: \u914d\u7f6ehttpd.conf</p> 1 2 3 4 5 6 7 8 <code> <code> </code><code>Options Indexes FollowSymLinks</code> <code> </code><code>AuthType Digest</code> <code> </code><code>AuthName \"Digest Encrypt\"\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 //\u6ce8\u610f\u8fd9\u91cc\u7684AuthName\u548c\u4e0a\u9762\u7684realm\u5fc5\u987b\u4e00\u81f4(\u800cBasic\u9a8c\u8bc1\u5219\u53ef\u4ee5\u4e0d\u540c). \u5426\u5219\u4f60\u8f93\u5165\u6b63\u786e\u7684\u7528\u6237\u5bc6\u7801\u4e5f\u65e0\u6cd5\u901a\u8fc7\u8ba4\u8bc1</code> <code> </code><code>AuthDigestProvider file</code> <code> </code><code>AuthUserFile /data/www/auth/digest/user.txt</code> <code> </code><code>require valid-user</code> <code></code> <p>\u6ce8\uff1a\u8fd9\u91cc\u7684Directory \u4e5f\u53ef\u7528 Location \u3002</p> <p>\u73b0\u5728\u57fa\u4e8eDigest\u7684\u9a8c\u8bc1\u73af\u5883\u5c31\u642d\u5efa\u597d\u4e86.</p> <p>\u6ce8: \u5728Basic\u9a8c\u8bc1\u4e2d. \u6211\u4f7f\u7528\u4e86.htaccess \u800c\u5728Digest\u9a8c\u8bc1\u4e2d\u6211\u6ca1\u6709\u4f7f\u7528. \u53ea\u662f\u4e3a\u4e86\u4e2a\u4eba\u7684\u9700\u8981. \u4f60\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u9700\u8981\u8fdb\u884c\u914d\u7f6e.</p> <p>\u7591\u60d1: \u5bf9\u4e8e\u5728\u914d\u7f6eDigest httpd.conf\u65f6, AuthName \u5fc5\u987b\u548c\u4e0a\u9762\u7684realm\u8fd8\u662f\u4e0d\u662f\u5f88\u660e\u767d. \u4e3a\u4ec0\u4e48\u5fc5\u987b\u4e00\u81f4. \u5982\u679c\u6709\u54ea\u4f4d\u5927\u795e\u77e5\u9053. \u671b\u4e0d\u541d\u8d50\u6559\u3002</p> <p> </p> \u603b\u7ed3: <p>Basic\u9a8c\u8bc1\u65b9\u5f0f\u914d\u7f6e\u76f8\u5bf9\u7b80\u5355\uff0c\u4f46\u662f\u5b89\u5168\u6027\u592a\u4f4e\uff0c\u4e0d\u9002\u5408\u4e00\u4e9b\u52a0\u5bc6\u8981\u6c42\u6bd4\u8f83\u9ad8\u7684\u7ad9\u70b9\u3002</p> <p>Digest\u5219\u76f8\u53cd\uff0c\u52a0\u5bc6\u6027\u662f\u5f88\u9ad8\uff0c\u4f46\u662f\u914d\u7f6e\u8d77\u6765\u8fd8\u662f\u6709\u4e00\u70b9\u96be\u5ea6\u7684\uff0c\u6240\u4ee5\u5927\u5bb6\u6839\u636e\u81ea\u5df1\u9700\u8981\uff0c\u9009\u62e9\u4e0d\u540c\u7684\u52a0\u5bc6\u65b9\u5f0f\u3002</p> <p>\u6458\u81ea\u300ehttp://blog.jobbole.com/41519/\u300f</p>","tags":["apache2","httpd"]},{"location":"DevOps/2015-11-29-zookeeper%25e9%259b%2586%25e7%25be%25a4%25e9%2585%258d%25e7%25bd%25ae.html/","title":"zookeeper\u96c6\u7fa4\u914d\u7f6e","text":"<p>ZooKeeper\u662f\u4e00\u4e2a\u5206\u5e03\u5f0f\u5f00\u6e90\u6846\u67b6\uff0c\u63d0\u4f9b\u4e86\u534f\u8c03\u5206\u5e03\u5f0f\u5e94\u7528\u7684\u57fa\u672c\u670d\u52a1\uff0c\u5b83\u5411\u5916\u90e8\u5e94\u7528\u66b4\u9732\u4e00\u7ec4\u901a\u7528\u670d\u52a1\u2014\u2014\u5206\u5e03\u5f0f\u540c\u6b65\uff08Distributed Synchronization\uff09\u3001\u547d\u540d\u670d\u52a1\uff08Naming Service\uff09\u3001\u96c6\u7fa4\u7ef4\u62a4\uff08Group Maintenance\uff09\u7b49\uff0c\u7b80\u5316\u5206\u5e03\u5f0f\u5e94\u7528\u534f\u8c03\u53ca\u5176\u7ba1\u7406\u7684\u96be\u5ea6\uff0c\u63d0\u4f9b\u9ad8\u6027\u80fd\u7684\u5206\u5e03\u5f0f\u670d\u52a1\u3002ZooKeeper\u672c\u8eab\u53ef\u4ee5\u4ee5Standalone\u6a21\u5f0f\u5b89\u88c5\u8fd0\u884c\uff0c\u4e0d\u8fc7\u5b83\u7684\u957f\u5904\u5728\u4e8e\u901a\u8fc7\u5206\u5e03\u5f0fZooKeeper\u96c6\u7fa4\uff08\u4e00\u4e2aLeader\uff0c\u591a\u4e2aFollower\uff09\uff0c\u57fa\u4e8e\u4e00\u5b9a\u7684\u7b56\u7565\u6765\u4fdd\u8bc1ZooKeeper\u96c6\u7fa4\u7684\u7a33\u5b9a\u6027\u548c\u53ef\u7528\u6027\uff0c\u4ece\u800c\u5b9e\u73b0\u5206\u5e03\u5f0f\u5e94\u7528\u7684\u53ef\u9760\u6027\u3002</p> <p>\u6709\u5173ZooKeeper\u7684\u4ecb\u7ecd\uff0c\u7f51\u4e0a\u5f88\u591a\uff0c\u4e5f\u53ef\u4ee5\u53c2\u8003\u6587\u7ae0\u540e\u9762\uff0c\u6211\u6574\u7406\u7684\u4e00\u4e9b\u76f8\u5173\u94fe\u63a5\u3002</p> <p>\u4e0b\u9762\uff0c\u6211\u4eec\u7b80\u5355\u8bf4\u660e\u4e00\u4e0bZooKeeper\u7684\u914d\u7f6e\u3002</p> ZooKeeper Standalone\u6a21\u5f0f <p>\u4eceApache\u7f51\u7ad9\u4e0a\uff08zookeeper.apache.org\uff09\u4e0b\u8f7dZooKeeper\u8f6f\u4ef6\u5305\uff0c\u6211\u9009\u62e9\u4e863.3.4\u7248\u672c\u7684\uff08zookeeper-3.3.4.tar.gz\uff09\uff0c\u5728\u4e00\u53f0Linux\u673a\u5668\u4e0a\u5b89\u88c5\u975e\u5e38\u5bb9\u6613\uff0c\u53ea\u9700\u8981\u89e3\u538b\u7f29\u540e\uff0c\u7b80\u5355\u914d\u7f6e\u4e00\u4e0b\u5373\u53ef\u4ee5\u542f\u52a8ZooKeeper\u670d\u52a1\u5668\u8fdb\u7a0b\u3002</p> <p>\u5c06zookeeper-3.3.4/conf\u76ee\u5f55\u4e0b\u9762\u7684 zoo_sample.cfg\u4fee\u6539\u4e3azoo.cfg\uff0c\u914d\u7f6e\u6587\u4ef6\u5185\u5bb9\u5982\u4e0b\u6240\u793a\uff1a</p> [plain] view plaincopy <ol> <li>tickTime=2000</li> <li>dataDir=/home/hadoop/storage/zookeeper</li> <li>clientPort=2181</li> <li>initLimit=5</li> <li>syncLimit=2</li> </ol> <p>\u4e0a\u9762\u5404\u4e2a\u914d\u7f6e\u53c2\u6570\u7684\u542b\u4e49\u4e5f\u975e\u5e38\u7b80\u5355\uff0c\u5f15\u7528\u5982\u4e0b\u6240\u793a\uff1a</p> [plain] view plaincopy <ol> <li>tickTime\u00a0\u2014\u2014\u00a0the\u00a0basic\u00a0time\u00a0unit\u00a0in\u00a0milliseconds\u00a0used\u00a0by\u00a0ZooKeeper.\u00a0It\u00a0is\u00a0used\u00a0to\u00a0do\u00a0heartbeats\u00a0and\u00a0the\u00a0minimum\u00a0session\u00a0timeout\u00a0will\u00a0be\u00a0twice\u00a0the\u00a0tickTime.</li> <li>dataDir\u00a0\u2014\u2014\u00a0the\u00a0location\u00a0to\u00a0store\u00a0the\u00a0in-memory\u00a0database\u00a0snapshots\u00a0and,\u00a0unless\u00a0specified\u00a0otherwise,\u00a0the\u00a0transaction\u00a0log\u00a0of\u00a0updates\u00a0to\u00a0the\u00a0database.</li> <li>clientPort\u00a0\u2014\u2014\u00a0the\u00a0port\u00a0to\u00a0listen\u00a0for\u00a0client\u00a0connections</li> </ol> <p>\u4e0b\u9762\u542f\u52a8ZooKeeper\u670d\u52a1\u5668\u8fdb\u7a0b\uff1a</p> [plain] view plaincopy <ol> <li>cd\u00a0zookeeper-3.3.4/</li> <li>bin/zkServer.sh\u00a0start</li> </ol> <p>\u901a\u8fc7jps\u547d\u4ee4\u53ef\u4ee5\u67e5\u770bZooKeeper\u670d\u52a1\u5668\u8fdb\u7a0b\uff0c\u540d\u79f0\u4e3aQuorumPeerMain\u3002</p> <p>\u5728\u5ba2\u6237\u7aef\u8fde\u63a5ZooKeeper\u670d\u52a1\u5668\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a</p> [plain] view plaincopy <ol> <li>bin/zkCli.sh\u00a0-server\u00a0dynamic:2181</li> </ol> <p>\u4e0a\u9762dynamic\u662f\u6211\u7684\u4e3b\u673a\u540d\uff0c\u5982\u679c\u5728\u672c\u673a\u6267\u884c\uff0c\u5219\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u5373\u53ef\uff1a</p> [plain] view plaincopy <ol> <li>bin/zkCli.sh</li> </ol> <p>\u5ba2\u6237\u7aef\u8fde\u63a5\u4fe1\u606f\u5982\u4e0b\u6240\u793a\uff1a\u00a0\u63a5\u7740\uff0c\u53ef\u4ee5\u4f7f\u7528help\u67e5\u770bZookeeper\u5ba2\u6237\u7aef\u53ef\u4ee5\u4f7f\u7528\u7684\u57fa\u672c\u64cd\u4f5c\u547d\u4ee4\u3002</p> ZooKeeper Distributed\u6a21\u5f0f <p>ZooKeeper\u5206\u5e03\u5f0f\u6a21\u5f0f\u5b89\u88c5\uff08ZooKeeper\u96c6\u7fa4\uff09\u4e5f\u6bd4\u8f83\u5bb9\u6613\uff0c\u8fd9\u91cc\u8bf4\u660e\u4e00\u4e0b\u57fa\u672c\u8981\u70b9\u3002</p> <p>\u9996\u5148\u8981\u660e\u786e\u7684\u662f\uff0cZooKeeper\u96c6\u7fa4\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u5206\u5e03\u5f0f\u534f\u8c03\u670d\u52a1\u96c6\u7fa4\uff0c\u201c\u72ec\u7acb\u201d\u7684\u542b\u4e49\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u60f3\u4f7f\u7528ZooKeeper\u5b9e\u73b0\u5206\u5e03\u5f0f\u5e94\u7528\u7684\u534f\u8c03\u4e0e\u7ba1\u7406\uff0c\u7b80\u5316\u534f\u8c03\u4e0e\u7ba1\u7406\uff0c\u4efb\u4f55\u5206\u5e03\u5f0f\u5e94\u7528\u90fd\u53ef\u4ee5\u4f7f\u7528\uff0c\u8fd9\u5c31\u8981\u5f52\u529f\u4e8eZookeeper\u7684\u6570\u636e\u6a21\u578b\uff08Data Model\uff09\u548c\u5c42\u6b21\u547d\u540d\u7a7a\u95f4\uff08Hierarchical Namespace\uff09\u7ed3\u6784\uff0c\u8be6\u7ec6\u53ef\u4ee5\u53c2\u8003http://zookeeper.apache.org/doc/trunk/zookeeperOver.html\u3002\u5728\u8bbe\u8ba1\u4f60\u7684\u5206\u5e03\u5f0f\u5e94\u7528\u534f\u8c03\u670d\u52a1\u65f6\uff0c\u9996\u8981\u7684\u5c31\u662f\u8003\u8651\u5982\u4f55\u7ec4\u7ec7\u5c42\u6b21\u547d\u540d\u7a7a\u95f4\u3002</p> <p>\u4e0b\u9762\u8bf4\u660e\u5206\u5e03\u5f0f\u6a21\u5f0f\u7684\u5b89\u88c5\u914d\u7f6e\uff0c\u8fc7\u7a0b\u5982\u4e0b\u6240\u793a\uff1a</p> <p>\u7b2c\u4e00\u6b65\uff1a\u4e3b\u673a\u540d\u79f0\u5230IP\u5730\u5740\u6620\u5c04\u914d\u7f6e</p> <p>ZooKeeper\u96c6\u7fa4\u4e2d\u5177\u6709\u4e24\u4e2a\u5173\u952e\u7684\u89d2\u8272\uff1aLeader\u548cFollower\u3002\u96c6\u7fa4\u4e2d\u6240\u6709\u7684\u7ed3\u70b9\u4f5c\u4e3a\u4e00\u4e2a\u6574\u4f53\u5bf9\u5206\u5e03\u5f0f\u5e94\u7528\u63d0\u4f9b\u670d\u52a1\uff0c\u96c6\u7fa4\u4e2d\u6bcf\u4e2a\u7ed3\u70b9\u4e4b\u95f4\u90fd\u4e92\u76f8\u8fde\u63a5\uff0c\u6240\u4ee5\uff0c\u5728\u914d\u7f6e\u7684ZooKeeper\u96c6\u7fa4\u7684\u65f6\u5019\uff0c\u6bcf\u4e00\u4e2a\u7ed3\u70b9\u7684host\u5230IP\u5730\u5740\u7684\u6620\u5c04\u90fd\u8981\u914d\u7f6e\u4e0a\u96c6\u7fa4\u4e2d\u5176\u5b83\u7ed3\u70b9\u7684\u6620\u5c04\u4fe1\u606f\u3002</p> <p>\u4f8b\u5982\uff0c\u6211\u7684ZooKeeper\u96c6\u7fa4\u4e2d\u6bcf\u4e2a\u7ed3\u70b9\u7684\u914d\u7f6e\uff0c\u4ee5slave-01\u4e3a\u4f8b\uff0c/etc/hosts\u5185\u5bb9\u5982\u4e0b\u6240\u793a\uff1a</p> [plain]view plaincopy <ol> <li>192.168.0.179\u00a0\u00a0\u00a0slave-01</li> <li>192.168.0.178\u00a0\u00a0\u00a0slave-02</li> <li>192.168.0.177\u00a0\u00a0\u00a0slave-03</li> </ol> <p>ZooKeeper\u91c7\u7528\u4e00\u79cd\u79f0\u4e3aLeader election\u7684\u9009\u4e3e\u7b97\u6cd5\u3002\u5728\u6574\u4e2a\u96c6\u7fa4\u8fd0\u884c\u8fc7\u7a0b\u4e2d\uff0c\u53ea\u6709\u4e00\u4e2aLeader\uff0c\u5176\u4ed6\u7684\u90fd\u662fFollower\uff0c\u5982\u679cZooKeeper\u96c6\u7fa4\u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2dLeader\u51fa\u4e86\u95ee\u9898\uff0c\u7cfb\u7edf\u4f1a\u91c7\u7528\u8be5\u7b97\u6cd5\u91cd\u65b0\u9009\u51fa\u4e00\u4e2aLeader\u3002\u56e0\u6b64\uff0c\u5404\u4e2a\u7ed3\u70b9\u4e4b\u95f4\u8981\u80fd\u591f\u4fdd\u8bc1\u4e92\u76f8\u8fde\u63a5\uff0c\u5fc5\u987b\u914d\u7f6e\u4e0a\u8ff0\u6620\u5c04\u3002</p> <p>ZooKeeper\u96c6\u7fa4\u542f\u52a8\u7684\u65f6\u5019\uff0c\u4f1a\u9996\u5148\u9009\u51fa\u4e00\u4e2aLeader\uff0c\u5728Leader election\u8fc7\u7a0b\u4e2d\uff0c\u67d0\u4e00\u4e2a\u6ee1\u8db3\u9009\u4e3e\u7b97\u7684\u7ed3\u70b9\u5c31\u80fd\u6210\u4e3aLeader\u3002\u6574\u4e2a\u96c6\u7fa4\u7684\u67b6\u6784\u53ef\u4ee5\u53c2\u8003http://zookeeper.apache.org/doc/trunk/zookeeperOver.html#sc_designGoals\u3002</p> <p>\u7b2c\u4e8c\u6b65\uff1a\u4fee\u6539ZooKeeper\u914d\u7f6e\u6587\u4ef6</p> <p>\u5728\u5176\u4e2d\u4e00\u53f0\u673a\u5668\uff08slave-01\uff09\u4e0a\uff0c\u89e3\u538b\u7f29zookeeper-3.3.4.tar.gz\uff0c\u4fee\u6539\u914d\u7f6e\u6587\u4ef6conf/zoo.cfg\uff0c\u5185\u5bb9\u5982\u4e0b\u6240\u793a\uff1a</p> [plain]view plaincopy <ol> <li>tickTime=2000</li> <li>dataDir=/home/hadoop/storage/zookeeper</li> <li>clientPort=2181</li> <li>initLimit=5</li> <li>syncLimit=2</li> <li>server.1=slave-01:2888:3888</li> <li>server.2=slave-02:2888:3888</li> <li>server.3=slave-03:2888:3888</li> </ol> <p>\u4e0a\u8ff0\u914d\u7f6e\u5185\u5bb9\u8bf4\u660e\uff0c\u53ef\u4ee5\u53c2\u8003http://zookeeper.apache.org/doc/trunk/zookeeperStarted.html#sc_RunningReplicatedZooKeeper\u3002\u7b2c\u4e09\u6b65\uff1a\u8fdc\u7a0b\u590d\u5236\u5206\u53d1\u5b89\u88c5\u6587\u4ef6</p> <p>\u4e0a\u9762\u5df2\u7ecf\u5728\u4e00\u53f0\u673a\u5668slave-01\u4e0a\u914d\u7f6e\u5b8c\u6210ZooKeeper\uff0c\u73b0\u5728\u53ef\u4ee5\u5c06\u8be5\u914d\u7f6e\u597d\u7684\u5b89\u88c5\u6587\u4ef6\u8fdc\u7a0b\u62f7\u8d1d\u5230\u96c6\u7fa4\u4e2d\u7684\u5404\u4e2a\u7ed3\u70b9\u5bf9\u5e94\u7684\u76ee\u5f55\u4e0b\uff1a</p> [plain]view plaincopy <ol> <li>cd\u00a0/home/hadoop/installation/</li> <li>scp\u00a0-r\u00a0zookeeper-3.3.4/\u00a0hadoop@slave-02:/home/hadoop/installation/</li> <li>scp\u00a0-r\u00a0zookeeper-3.3.4/\u00a0hadoop@slave-03:/home/hadoop/installation/</li> </ol> <p>\u7b2c\u56db\u6b65\uff1a\u8bbe\u7f6emyid\u5728\u6211\u4eec\u914d\u7f6e\u7684dataDir\u6307\u5b9a\u7684\u76ee\u5f55\u4e0b\u9762\uff0c\u521b\u5efa\u4e00\u4e2amyid\u6587\u4ef6\uff0c\u91cc\u9762\u5185\u5bb9\u4e3a\u4e00\u4e2a\u6570\u5b57\uff0c\u7528\u6765\u6807\u8bc6\u5f53\u524d\u4e3b\u673a\uff0cconf/zoo.cfg\u6587\u4ef6\u4e2d\u914d\u7f6e\u7684server.X\u4e2dX\u4e3a\u4ec0\u4e48\u6570\u5b57\uff0c\u5219myid\u6587\u4ef6\u4e2d\u5c31\u8f93\u5165\u8fd9\u4e2a\u6570\u5b57\uff0c\u4f8b\u5982\uff1a</p> [plain]view plaincopy <ol> <li>hadoop@slave-01:~/installation/zookeeper-3.3.4$\u00a0echo\u00a0\"1\"\u00a0&gt;\u00a0/home/hadoop/storage/zookeeper/myid</li> <li>hadoop@slave-02:~/installation/zookeeper-3.3.4$\u00a0echo\u00a0\"2\"\u00a0&gt;\u00a0/home/hadoop/storage/zookeeper/myid</li> <li>hadoop@slave-03:~/installation/zookeeper-3.3.4$\u00a0echo\u00a0\"3\"\u00a0&gt;\u00a0/home/hadoop/storage/zookeeper/myid</li> </ol> <p>\u6309\u7167\u4e0a\u8ff0\u8fdb\u884c\u914d\u7f6e\u5373\u53ef\u3002\u7b2c\u4e94\u6b65\uff1a\u542f\u52a8ZooKeeper\u96c6\u7fa4</p> <p>\u5728ZooKeeper\u96c6\u7fa4\u7684\u6bcf\u4e2a\u7ed3\u70b9\u4e0a\uff0c\u6267\u884c\u542f\u52a8ZooKeeper\u670d\u52a1\u7684\u811a\u672c\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> [plain]view plaincopy <ol> <li>hadoop@slave-01:~/installation/zookeeper-3.3.4$\u00a0bin/zkServer.sh\u00a0start</li> <li>hadoop@slave-02:~/installation/zookeeper-3.3.4$\u00a0bin/zkServer.sh\u00a0start</li> <li>hadoop@slave-03:~/installation/zookeeper-3.3.4$\u00a0bin/zkServer.sh\u00a0start</li> </ol> <p>\u4ee5\u7ed3\u70b9slave-01\u4e3a\u4f8b\uff0c\u65e5\u5fd7\u5982\u4e0b\u6240\u793a\uff1a</p> [plain]view plaincopy <ol> <li></li> <li>2012-01-08\u00a006:51:23,210\u00a0-\u00a0INFO\u00a0\u00a0[QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97]\u00a0-\u00a0Server\u00a0environment:java.io.tmpdir=/tmp</li> <li>2012-01-08\u00a006:51:23,212\u00a0-\u00a0INFO\u00a0\u00a0[QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97]\u00a0-\u00a0Server\u00a0environment:java.compiler= <li>2012-01-08\u00a006:51:23,212\u00a0-\u00a0INFO\u00a0\u00a0[QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97]\u00a0-\u00a0Server\u00a0environment:os.name=Linux</li> <li>2012-01-08\u00a006:51:23,212\u00a0-\u00a0INFO\u00a0\u00a0[QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97]\u00a0-\u00a0Server\u00a0environment:os.arch=i386</li> <li>2012-01-08\u00a006:51:23,213\u00a0-\u00a0INFO\u00a0\u00a0[QuorumPeer:/0:0:0:0:0:0:0:0:2181:Environment@97]\u00a0-\u00a0Server\u00a0environment:os.version=3.0.0-14-</li> <li></li> <li>\u6211\u542f\u52a8\u7684\u987a\u5e8f\u662fslave-01&gt;slave-02&gt;slave-03\uff0c\u7531\u4e8eZooKeeper\u96c6\u7fa4\u542f\u52a8\u7684\u65f6\u5019\uff0c\u6bcf\u4e2a\u7ed3\u70b9\u90fd\u8bd5\u56fe\u53bb\u8fde\u63a5\u96c6\u7fa4\u4e2d\u7684\u5176\u5b83\u7ed3\u70b9\uff0c\u5148\u542f\u52a8\u7684\u80af\u5b9a\u8fde\u4e0d\u4e0a\u540e\u9762\u8fd8\u6ca1\u542f\u52a8\u7684\uff0c\u6240\u4ee5\u4e0a\u9762\u65e5\u5fd7\u524d\u9762\u90e8\u5206\u7684\u5f02\u5e38\u662f\u53ef\u4ee5\u5ffd\u7565\u7684\u3002\u901a\u8fc7\u540e\u9762\u90e8\u5206\u53ef\u4ee5\u770b\u5230\uff0c\u96c6\u7fa4\u5728\u9009\u51fa\u4e00\u4e2aLeader\u540e\uff0c\u6700\u540e\u7a33\u5b9a\u4e86\u3002</li> <p>\u5176\u4ed6\u7ed3\u70b9\u53ef\u80fd\u4e5f\u51fa\u73b0\u7c7b\u4f3c\u95ee\u9898\uff0c\u5c5e\u4e8e\u6b63\u5e38\u3002</p> <p>\u7b2c\u516d\u6b65\uff1a\u5b89\u88c5\u9a8c\u8bc1</p> <p>\u53ef\u4ee5\u901a\u8fc7ZooKeeper\u7684\u811a\u672c\u6765\u67e5\u770b\u542f\u52a8\u72b6\u6001\uff0c\u5305\u62ec\u96c6\u7fa4\u4e2d\u5404\u4e2a\u7ed3\u70b9\u7684\u89d2\u8272\uff08\u6216\u662fLeader\uff0c\u6216\u662fFollower\uff09\uff0c\u5982\u4e0b\u6240\u793a\uff0c\u662f\u5728ZooKeeper\u96c6\u7fa4\u4e2d\u7684\u6bcf\u4e2a\u7ed3\u70b9\u4e0a\u67e5\u8be2\u7684\u7ed3\u679c\uff1a</p> [plain]view plaincopy <ol> <li>hadoop@slave-01:~/installation/zookeeper-3.3.4$\u00a0bin/zkServer.sh\u00a0status</li> <li>JMX\u00a0enabled\u00a0by\u00a0default</li> <li>Using\u00a0config:\u00a0/home/hadoop/installation/zookeeper-3.3.4/bin/../conf/zoo.cfg</li> <li>Mode:\u00a0follower</li> <li>hadoop@slave-02:~/installation/zookeeper-3.3.4$\u00a0\u00a0bin/zkServer.sh\u00a0status</li> <li>JMX\u00a0enabled\u00a0by\u00a0default</li> <li>Using\u00a0config:\u00a0/home/hadoop/installation/zookeeper-3.3.4/bin/../conf/zoo.cfg</li> <li>Mode:\u00a0leader</li> <li>hadoop@slave-03:~/installation/zookeeper-3.3.4$\u00a0\u00a0bin/zkServer.sh\u00a0status</li> <li>JMX\u00a0enabled\u00a0by\u00a0default</li> <li>Using\u00a0config:\u00a0/home/hadoop/installation/zookeeper-3.3.4/bin/../conf/zoo.cfg</li> <li>Mode:\u00a0follower</li> </ol> <p>\u901a\u8fc7\u4e0a\u9762\u72b6\u6001\u67e5\u8be2\u7ed3\u679c\u53ef\u89c1\uff0cslave-02\u662f\u96c6\u7fa4\u7684Leader\uff0c\u5176\u4f59\u7684\u4e24\u4e2a\u7ed3\u70b9\u662fFollower\u3002 \u53e6\u5916\uff0c\u53ef\u4ee5\u901a\u8fc7\u5ba2\u6237\u7aef\u811a\u672c\uff0c\u8fde\u63a5\u5230ZooKeeper\u96c6\u7fa4\u4e0a\u3002\u5bf9\u4e8e\u5ba2\u6237\u7aef\u6765\u8bf4\uff0cZooKeeper\u662f\u4e00\u4e2a\u6574\u4f53\uff08ensemble\uff09\uff0c\u8fde\u63a5\u5230ZooKeeper\u96c6\u7fa4\u5b9e\u9645\u4e0a\u611f\u89c9\u5728\u72ec\u4eab\u6574\u4e2a\u96c6\u7fa4\u7684\u670d\u52a1\uff0c\u6240\u4ee5\uff0c\u4f60\u53ef\u4ee5\u5728\u4efb\u4f55\u4e00\u4e2a\u7ed3\u70b9\u4e0a\u5efa\u7acb\u5230\u670d\u52a1\u96c6\u7fa4\u7684\u8fde\u63a5\uff0c\u4f8b\u5982\uff1a</p> [plain]view plaincopy <ol> <li>hadoop@slave-03:~/installation/zookeeper-3.3.4$\u00a0bin/zkCli.sh\u00a0-server\u00a0slave-01:2181</li> <li>Connecting\u00a0to\u00a0slave-01:2181</li> <li>2012-01-08\u00a007:14:21,068\u00a0-\u00a0INFO\u00a0\u00a0[main:Environment@97]\u00a0-\u00a0Client\u00a0environment:zookeeper.version=3.3.3-1203054,\u00a0built\u00a0on\u00a011/17/2011\u00a005:47\u00a0GMT</li> <li></li> <li></li> </ol> <p>\u5f53\u524d\u6839\u8def\u5f84\u4e3a/zookeeper\u3002</p> \u603b\u7ed3\u8bf4\u660e <p>\u4e3b\u673a\u540d\u4e0eIP\u5730\u5740\u6620\u5c04\u914d\u7f6e\u95ee\u9898</p> <p>\u542f\u52a8ZooKeeper\u96c6\u7fa4\u65f6\uff0c\u5982\u679cZooKeeper\u96c6\u7fa4\u4e2dslave-01\u7ed3\u70b9\u7684\u65e5\u5fd7\u51fa\u73b0\u5982\u4e0b\u9519\u8bef\uff1a</p> [plain]view plaincopy <ol> <li>java.net.SocketTimeoutException</li> <li>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0at\u00a0sun.nio.ch.SocketAdaptor.connect(SocketAdaptor.java:109)</li> <li>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0at\u00a0org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:371)</li> <li>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0at\u00a0org.apache.zookeeper.server.quorum.QuorumCnxManager.connectAll(QuorumCnxManager.java:404)</li> <li>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0at\u00a0org.apache.zookeeper.server.quorum.FastLeaderElection.lookForLeader(FastLeaderElection.java:688)</li> <li>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0at\u00a0org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:622)</li> <li>2012-01-08\u00a006:37:46,026\u00a0-\u00a0INFO\u00a0\u00a0[QuorumPeer:/0:0:0:0:0:0:0:0:2181:FastLeaderElection@697]\u00a0-\u00a0Notification\u00a0time\u00a0out:\u00a06400</li> <li>2012-01-08\u00a006:37:57,431\u00a0-\u00a0WARN\u00a0\u00a0[QuorumPeer:/0:0:0:0:0:0:0:0:2181:QuorumCnxManager@384]\u00a0-\u00a0Cannot\u00a0open\u00a0channel\u00a0to\u00a02\u00a0at\u00a0election\u00a0address\u00a0slave-02/202.106.199.35:3888</li> <li>java.net.SocketTimeoutException</li> <li>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0at\u00a0sun.nio.ch.SocketAdaptor.connect(SocketAdaptor.java:109)</li> <li>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0at\u00a0org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:371)</li> <li>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0at\u00a0org.apache.zookeeper.server.quorum.QuorumCnxManager.connectAll(QuorumCnxManager.java:404)</li> <li>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0at\u00a0org.apache.zookeeper.server.quorum.FastLeaderElection.lookForLeader(FastLeaderElection.java:688)</li> </ol> <p>\u5f88\u663e\u7136\uff0cslave-01\u5728\u542f\u52a8\u65f6\u8fde\u63a5\u96c6\u7fa4\u4e2d\u5176\u4ed6\u7ed3\u70b9\uff08slave-02\u3001slave-03\uff09\u65f6\uff0c\u4e3b\u673a\u540d\u6620\u5c04\u7684IP\u4e0e\u6211\u4eec\u5b9e\u9645\u914d\u7f6e\u7684\u4e0d\u4e00\u81f4\uff0c\u6240\u4ee5\u96c6\u7fa4\u4e2d\u5404\u4e2a\u7ed3\u70b9\u4e4b\u95f4\u65e0\u6cd5\u5efa\u7acb\u94fe\u8def\uff0c\u6574\u4e2aZooKeeper\u96c6\u7fa4\u542f\u52a8\u662f\u5931\u8d25\u7684\u3002</p> <p>\u4e0a\u9762\u9519\u8bef\u65e5\u5fd7\u4e2dslave-02/202.106.199.35:3888\u5b9e\u9645\u5e94\u8be5\u662fslave-02/202.192.168.0.178:3888\u5c31\u5bf9\u4e86\uff0c\u4f46\u662f\u5728\u8fdb\u884c\u57df\u540d\u89e3\u6790\u7684\u65f6\u5019\u6620\u5c04\u6709\u95ee\u9898\uff0c\u4fee\u6539\u6bcf\u4e2a\u7ed3\u70b9\u7684/etc/hosts\u6587\u4ef6\uff0c\u5c06ZooKeeper\u96c6\u7fa4\u4e2d\u6240\u6709\u7ed3\u70b9\u4e3b\u673a\u540d\u5230IP\u5730\u5740\u7684\u6620\u5c04\u914d\u7f6e\u4e0a</p> <p>\u6458\u81ea\u300e\u4e92\u8054\u7f51\u300f</p>","tags":["zookeeper"]},{"location":"DevOps/2015-12-05-google-java%25e7%25bc%2596%25e7%25a8%258b%25e9%25a3%258e%25e6%25a0%25bc%25e6%258c%2587%25e5%258d%2597.html/","title":"Google Java\u7f16\u7a0b\u98ce\u683c\u6307\u5357","text":"<p>January 20, 2014</p> <p>\u4f5c\u8005\uff1aHawstein \u51fa\u5904\uff1ahttp://hawstein.com/posts/google-java-style.html \u58f0\u660e\uff1a\u672c\u6587\u91c7\u7528\u4ee5\u4e0b\u534f\u8bae\u8fdb\u884c\u6388\u6743\uff1a \u81ea\u7531\u8f6c\u8f7d-\u975e\u5546\u7528-\u975e\u884d\u751f-\u4fdd\u6301\u7f72\u540d|Creative Commons BY-NC-ND 3.0 \uff0c\u8f6c\u8f7d\u8bf7\u6ce8\u660e\u4f5c\u8005\u53ca\u51fa\u5904\u3002</p> \u76ee\u5f55 <ol> <li>\u524d\u8a00</li> <li>\u6e90\u6587\u4ef6\u57fa\u7840</li> <li>\u6e90\u6587\u4ef6\u7ed3\u6784</li> <li>\u683c\u5f0f</li> <li>\u547d\u540d\u7ea6\u5b9a</li> <li>\u7f16\u7a0b\u5b9e\u8df5</li> <li>Javadoc</li> <li>\u540e\u8bb0</li> </ol> \u524d\u8a00 <p>\u8fd9\u4efd\u6587\u6863\u662fGoogle Java\u7f16\u7a0b\u98ce\u683c\u89c4\u8303\u7684\u5b8c\u6574\u5b9a\u4e49\u3002\u5f53\u4e14\u4ec5\u5f53\u4e00\u4e2aJava\u6e90\u6587\u4ef6\u7b26\u5408\u6b64\u6587\u6863\u4e2d\u7684\u89c4\u5219\uff0c \u6211\u4eec\u624d\u8ba4\u4e3a\u5b83\u7b26\u5408Google\u7684Java\u7f16\u7a0b\u98ce\u683c\u3002</p> <p>\u4e0e\u5176\u5b83\u7684\u7f16\u7a0b\u98ce\u683c\u6307\u5357\u4e00\u6837\uff0c\u8fd9\u91cc\u6240\u8ba8\u8bba\u7684\u4e0d\u4ec5\u4ec5\u662f\u7f16\u7801\u683c\u5f0f\u7f8e\u4e0d\u7f8e\u89c2\u7684\u95ee\u9898\uff0c \u540c\u65f6\u4e5f\u8ba8\u8bba\u4e00\u4e9b\u7ea6\u5b9a\u53ca\u7f16\u7801\u6807\u51c6\u3002\u7136\u800c\uff0c\u8fd9\u4efd\u6587\u6863\u4e3b\u8981\u4fa7\u91cd\u4e8e\u6211\u4eec\u6240\u666e\u904d\u9075\u5faa\u7684\u89c4\u5219\uff0c \u5bf9\u4e8e\u90a3\u4e9b\u4e0d\u662f\u660e\u786e\u5f3a\u5236\u8981\u6c42\u7684\uff0c\u6211\u4eec\u5c3d\u91cf\u907f\u514d\u63d0\u4f9b\u610f\u89c1\u3002</p> 1.1 \u672f\u8bed\u8bf4\u660e <p>\u5728\u672c\u6587\u6863\u4e2d\uff0c\u9664\u975e\u53e6\u6709\u8bf4\u660e\uff1a</p> <ol> <li>\u672f\u8bedclass\u53ef\u8868\u793a\u4e00\u4e2a\u666e\u901a\u7c7b\uff0c\u679a\u4e3e\u7c7b\uff0c\u63a5\u53e3\u6216\u662fannotation\u7c7b\u578b(<code>@interface</code>)</li> <li>\u672f\u8bedcomment\u53ea\u7528\u6765\u6307\u4ee3\u5b9e\u73b0\u7684\u6ce8\u91ca(implementation comments)\uff0c\u6211\u4eec\u4e0d\u4f7f\u7528\u201cdocumentation comments\u201d\u4e00\u8bcd\uff0c\u800c\u662f\u7528Javadoc\u3002</li> </ol> <p>\u5176\u4ed6\u7684\u672f\u8bed\u8bf4\u660e\u4f1a\u5076\u5c14\u5728\u540e\u9762\u7684\u6587\u6863\u51fa\u73b0\u3002</p> 1.2 \u6307\u5357\u8bf4\u660e <p>\u672c\u6587\u6863\u4e2d\u7684\u793a\u4f8b\u4ee3\u7801\u5e76\u4e0d\u4f5c\u4e3a\u89c4\u8303\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u867d\u7136\u793a\u4f8b\u4ee3\u7801\u662f\u9075\u5faaGoogle\u7f16\u7a0b\u98ce\u683c\uff0c\u4f46\u5e76\u4e0d\u610f\u5473\u7740\u8fd9\u662f\u5c55\u73b0\u8fd9\u4e9b\u4ee3\u7801\u7684\u552f\u4e00\u65b9\u5f0f\u3002 \u793a\u4f8b\u4e2d\u7684\u683c\u5f0f\u9009\u62e9\u4e0d\u5e94\u8be5\u88ab\u5f3a\u5236\u5b9a\u4e3a\u89c4\u5219\u3002</p> \u6e90\u6587\u4ef6\u57fa\u7840 2.1 \u6587\u4ef6\u540d <p>\u6e90\u6587\u4ef6\u4ee5\u5176\u6700\u9876\u5c42\u7684\u7c7b\u540d\u6765\u547d\u540d\uff0c\u5927\u5c0f\u5199\u654f\u611f\uff0c\u6587\u4ef6\u6269\u5c55\u540d\u4e3a<code>.java</code>\u3002</p> 2.2 \u6587\u4ef6\u7f16\u7801\uff1aUTF-8 <p>\u6e90\u6587\u4ef6\u7f16\u7801\u683c\u5f0f\u4e3aUTF-8\u3002</p> 2.3 \u7279\u6b8a\u5b57\u7b26 2.3.1 \u7a7a\u767d\u5b57\u7b26 <p>\u9664\u4e86\u884c\u7ed3\u675f\u7b26\u5e8f\u5217\uff0cASCII\u6c34\u5e73\u7a7a\u683c\u5b57\u7b26(0x20\uff0c\u5373\u7a7a\u683c)\u662f\u6e90\u6587\u4ef6\u4e2d\u552f\u4e00\u5141\u8bb8\u51fa\u73b0\u7684\u7a7a\u767d\u5b57\u7b26\uff0c\u8fd9\u610f\u5473\u7740\uff1a</p> <ol> <li>\u6240\u6709\u5176\u5b83\u5b57\u7b26\u4e32\u4e2d\u7684\u7a7a\u767d\u5b57\u7b26\u90fd\u8981\u8fdb\u884c\u8f6c\u4e49\u3002</li> <li>\u5236\u8868\u7b26\u4e0d\u7528\u4e8e\u7f29\u8fdb\u3002</li> </ol> 2.3.2 \u7279\u6b8a\u8f6c\u4e49\u5e8f\u5217 <p>\u5bf9\u4e8e\u5177\u6709\u7279\u6b8a\u8f6c\u4e49\u5e8f\u5217\u7684\u4efb\u4f55\u5b57\u7b26(\\b, \\t, \\n, \\f, \\r, \\\u201c, \\\u2018\u53ca\\)\uff0c\u6211\u4eec\u4f7f\u7528\u5b83\u7684\u8f6c\u4e49\u5e8f\u5217\uff0c\u800c\u4e0d\u662f\u76f8\u5e94\u7684\u516b\u8fdb\u5236(\u6bd4\u5982<code>\\012</code>)\u6216Unicode(\u6bd4\u5982<code>\\u000a</code>)\u8f6c\u4e49\u3002</p> 2.3.3 \u975eASCII\u5b57\u7b26 <p>\u5bf9\u4e8e\u5269\u4f59\u7684\u975eASCII\u5b57\u7b26\uff0c\u662f\u4f7f\u7528\u5b9e\u9645\u7684Unicode\u5b57\u7b26(\u6bd4\u5982\u221e)\uff0c\u8fd8\u662f\u4f7f\u7528\u7b49\u4ef7\u7684Unicode\u8f6c\u4e49\u7b26(\u6bd4\u5982\\u221e)\uff0c\u53d6\u51b3\u4e8e\u54ea\u4e2a\u80fd\u8ba9\u4ee3\u7801\u66f4\u6613\u4e8e\u9605\u8bfb\u548c\u7406\u89e3\u3002</p> <p>Tip: \u5728\u4f7f\u7528Unicode\u8f6c\u4e49\u7b26\u6216\u662f\u4e00\u4e9b\u5b9e\u9645\u7684Unicode\u5b57\u7b26\u65f6\uff0c\u5efa\u8bae\u505a\u4e9b\u6ce8\u91ca\u7ed9\u51fa\u89e3\u91ca\uff0c\u8fd9\u6709\u52a9\u4e8e\u522b\u4eba\u9605\u8bfb\u548c\u7406\u89e3\u3002</p> <p>\u4f8b\u5982\uff1a</p> <pre><code>String unitAbbrev = \"\u03bcs\";                                 | \u8d5e\uff0c\u5373\u4f7f\u6ca1\u6709\u6ce8\u91ca\u4e5f\u975e\u5e38\u6e05\u6670\nString unitAbbrev = \"\\u03bcs\"; // \"\u03bcs\"                    | \u5141\u8bb8\uff0c\u4f46\u6ca1\u6709\u7406\u7531\u8981\u8fd9\u6837\u505a\nString unitAbbrev = \"\\u03bcs\"; // Greek letter mu, \"s\"    | \u5141\u8bb8\uff0c\u4f46\u8fd9\u6837\u505a\u663e\u5f97\u7b28\u62d9\u8fd8\u5bb9\u6613\u51fa\u9519\nString unitAbbrev = \"\\u03bcs\";                            | \u5f88\u7cdf\uff0c\u8bfb\u8005\u6839\u672c\u770b\u4e0d\u51fa\u8fd9\u662f\u4ec0\u4e48\nreturn '\\ufeff' + content; // byte order mark             | Good\uff0c\u5bf9\u4e8e\u975e\u6253\u5370\u5b57\u7b26\uff0c\u4f7f\u7528\u8f6c\u4e49\uff0c\u5e76\u5728\u5fc5\u8981\u65f6\u5199\u4e0a\u6ce8\u91ca\n</code></pre> <p>Tip: \u6c38\u8fdc\u4e0d\u8981\u7531\u4e8e\u5bb3\u6015\u67d0\u4e9b\u7a0b\u5e8f\u53ef\u80fd\u65e0\u6cd5\u6b63\u786e\u5904\u7406\u975eASCII\u5b57\u7b26\u800c\u8ba9\u4f60\u7684\u4ee3\u7801\u53ef\u8bfb\u6027\u53d8\u5dee\u3002\u5f53\u7a0b\u5e8f\u65e0\u6cd5\u6b63\u786e\u5904\u7406\u975eASCII\u5b57\u7b26\u65f6\uff0c\u5b83\u81ea\u7136\u65e0\u6cd5\u6b63\u786e\u8fd0\u884c\uff0c \u4f60\u5c31\u4f1a\u53bbfix\u8fd9\u4e9b\u95ee\u9898\u7684\u4e86\u3002(\u8a00\u4e0b\u4e4b\u610f\u5c31\u662f\u5927\u80c6\u53bb\u7528\u975eASCII\u5b57\u7b26\uff0c\u5982\u679c\u771f\u7684\u6709\u9700\u8981\u7684\u8bdd)</p> \u6e90\u6587\u4ef6\u7ed3\u6784 <p>\u4e00\u4e2a\u6e90\u6587\u4ef6\u5305\u542b(\u6309\u987a\u5e8f\u5730)\uff1a</p> <ol> <li>\u8bb8\u53ef\u8bc1\u6216\u7248\u6743\u4fe1\u606f(\u5982\u6709\u9700\u8981)</li> <li>package\u8bed\u53e5</li> <li>import\u8bed\u53e5</li> <li>\u4e00\u4e2a\u9876\u7ea7\u7c7b(\u53ea\u6709\u4e00\u4e2a)</li> </ol> <p>\u4ee5\u4e0a\u6bcf\u4e2a\u90e8\u5206\u4e4b\u95f4\u7528\u4e00\u4e2a\u7a7a\u884c\u9694\u5f00\u3002</p> 3.1 \u8bb8\u53ef\u8bc1\u6216\u7248\u6743\u4fe1\u606f <p>\u5982\u679c\u4e00\u4e2a\u6587\u4ef6\u5305\u542b\u8bb8\u53ef\u8bc1\u6216\u7248\u6743\u4fe1\u606f\uff0c\u90a3\u4e48\u5b83\u5e94\u5f53\u88ab\u653e\u5728\u6587\u4ef6\u6700\u524d\u9762\u3002</p> 3.2 package\u8bed\u53e5 <p>package\u8bed\u53e5\u4e0d\u6362\u884c\uff0c\u5217\u9650\u5236(4.4\u8282)\u5e76\u4e0d\u9002\u7528\u4e8epackage\u8bed\u53e5\u3002(\u5373package\u8bed\u53e5\u5199\u5728\u4e00\u884c\u91cc)</p> 3.3 import\u8bed\u53e5 3.3.1 import\u4e0d\u8981\u4f7f\u7528\u901a\u914d\u7b26 <p>\u5373\uff0c\u4e0d\u8981\u51fa\u73b0\u7c7b\u4f3c\u8fd9\u6837\u7684import\u8bed\u53e5\uff1a<code>import java.util.*;</code></p> 3.3.2 \u4e0d\u8981\u6362\u884c <p>import\u8bed\u53e5\u4e0d\u6362\u884c\uff0c\u5217\u9650\u5236(4.4\u8282)\u5e76\u4e0d\u9002\u7528\u4e8eimport\u8bed\u53e5\u3002(\u6bcf\u4e2aimport\u8bed\u53e5\u72ec\u7acb\u6210\u884c)</p> 3.3.3 \u987a\u5e8f\u548c\u95f4\u8ddd <p>import\u8bed\u53e5\u53ef\u5206\u4e3a\u4ee5\u4e0b\u51e0\u7ec4\uff0c\u6309\u7167\u8fd9\u4e2a\u987a\u5e8f\uff0c\u6bcf\u7ec4\u7531\u4e00\u4e2a\u7a7a\u884c\u5206\u9694\uff1a</p> <ol> <li>\u6240\u6709\u7684\u9759\u6001\u5bfc\u5165\u72ec\u7acb\u6210\u7ec4</li> <li><code>com.google</code> imports(\u4ec5\u5f53\u8fd9\u4e2a\u6e90\u6587\u4ef6\u662f\u5728<code>com.google</code>\u5305\u4e0b)</li> <li>\u7b2c\u4e09\u65b9\u7684\u5305\u3002\u6bcf\u4e2a\u9876\u7ea7\u5305\u4e3a\u4e00\u7ec4\uff0c\u5b57\u5178\u5e8f\u3002\u4f8b\u5982\uff1aandroid, com, junit, org, sun</li> <li><code>java</code> imports</li> <li><code>javax</code> imports</li> </ol> <p>\u7ec4\u5185\u4e0d\u7a7a\u884c\uff0c\u6309\u5b57\u5178\u5e8f\u6392\u5217\u3002</p> 3.4 \u7c7b\u58f0\u660e 3.4.1 \u53ea\u6709\u4e00\u4e2a\u9876\u7ea7\u7c7b\u58f0\u660e <p>\u6bcf\u4e2a\u9876\u7ea7\u7c7b\u90fd\u5728\u4e00\u4e2a\u4e0e\u5b83\u540c\u540d\u7684\u6e90\u6587\u4ef6\u4e2d(\u5f53\u7136\uff0c\u8fd8\u5305\u542b<code>.java</code>\u540e\u7f00)\u3002</p> <p>\u4f8b\u5916\uff1a<code>package-info.java</code>\uff0c\u8be5\u6587\u4ef6\u4e2d\u53ef\u6ca1\u6709<code>package-info</code>\u7c7b\u3002</p> 3.4.2 \u7c7b\u6210\u5458\u987a\u5e8f <p>\u7c7b\u7684\u6210\u5458\u987a\u5e8f\u5bf9\u6613\u5b66\u6027\u6709\u5f88\u5927\u7684\u5f71\u54cd\uff0c\u4f46\u8fd9\u4e5f\u4e0d\u5b58\u5728\u552f\u4e00\u7684\u901a\u7528\u6cd5\u5219\u3002\u4e0d\u540c\u7684\u7c7b\u5bf9\u6210\u5458\u7684\u6392\u5e8f\u53ef\u80fd\u662f\u4e0d\u540c\u7684\u3002 \u6700\u91cd\u8981\u7684\u4e00\u70b9\uff0c\u6bcf\u4e2a\u7c7b\u5e94\u8be5\u4ee5\u67d0\u79cd\u903b\u8f91\u53bb\u6392\u5e8f\u5b83\u7684\u6210\u5458\uff0c\u7ef4\u62a4\u8005\u5e94\u8be5\u8981\u80fd\u89e3\u91ca\u8fd9\u79cd\u6392\u5e8f\u903b\u8f91\u3002\u6bd4\u5982\uff0c \u65b0\u7684\u65b9\u6cd5\u4e0d\u80fd\u603b\u662f\u4e60\u60ef\u6027\u5730\u6dfb\u52a0\u5230\u7c7b\u7684\u7ed3\u5c3e\uff0c\u56e0\u4e3a\u8fd9\u6837\u5c31\u662f\u6309\u65f6\u95f4\u987a\u5e8f\u800c\u975e\u67d0\u79cd\u903b\u8f91\u6765\u6392\u5e8f\u7684\u3002</p> 3.4.2.1 \u91cd\u8f7d\uff1a\u6c38\u4e0d\u5206\u79bb <p>\u5f53\u4e00\u4e2a\u7c7b\u6709\u591a\u4e2a\u6784\u9020\u51fd\u6570\uff0c\u6216\u662f\u591a\u4e2a\u540c\u540d\u65b9\u6cd5\uff0c\u8fd9\u4e9b\u51fd\u6570/\u65b9\u6cd5\u5e94\u8be5\u6309\u987a\u5e8f\u51fa\u73b0\u5728\u4e00\u8d77\uff0c\u4e2d\u95f4\u4e0d\u8981\u653e\u8fdb\u5176\u5b83\u51fd\u6570/\u65b9\u6cd5\u3002</p> \u683c\u5f0f <p>\u672f\u8bed\u8bf4\u660e\uff1a\u5757\u72b6\u7ed3\u6784(block-like construct)\u6307\u7684\u662f\u4e00\u4e2a\u7c7b\uff0c\u65b9\u6cd5\u6216\u6784\u9020\u51fd\u6570\u7684\u4e3b\u4f53\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6570\u7ec4\u521d\u59cb\u5316\u4e2d\u7684\u521d\u59cb\u503c\u53ef\u88ab\u9009\u62e9\u6027\u5730\u89c6\u4e3a\u5757\u72b6\u7ed3\u6784(4.8.3.1\u8282)\u3002</p> 4.1 \u5927\u62ec\u53f7 4.1.1 \u4f7f\u7528\u5927\u62ec\u53f7(\u5373\u4f7f\u662f\u53ef\u9009\u7684) <p>\u5927\u62ec\u53f7\u4e0e<code>if, else, for, do, while</code>\u8bed\u53e5\u4e00\u8d77\u4f7f\u7528\uff0c\u5373\u4f7f\u53ea\u6709\u4e00\u6761\u8bed\u53e5(\u6216\u662f\u7a7a)\uff0c\u4e5f\u5e94\u8be5\u628a\u5927\u62ec\u53f7\u5199\u4e0a\u3002</p> 4.1.2 \u975e\u7a7a\u5757\uff1aK &amp; R \u98ce\u683c <p>\u5bf9\u4e8e\u975e\u7a7a\u5757\u548c\u5757\u72b6\u7ed3\u6784\uff0c\u5927\u62ec\u53f7\u9075\u5faaKernighan\u548cRitchie\u98ce\u683c (Egyptian brackets):</p> <ul> <li>\u5de6\u5927\u62ec\u53f7\u524d\u4e0d\u6362\u884c</li> <li>\u5de6\u5927\u62ec\u53f7\u540e\u6362\u884c</li> <li>\u53f3\u5927\u62ec\u53f7\u524d\u6362\u884c</li> <li>\u5982\u679c\u53f3\u5927\u62ec\u53f7\u662f\u4e00\u4e2a\u8bed\u53e5\u3001\u51fd\u6570\u4f53\u6216\u7c7b\u7684\u7ec8\u6b62\uff0c\u5219\u53f3\u5927\u62ec\u53f7\u540e\u6362\u884c; \u5426\u5219\u4e0d\u6362\u884c\u3002\u4f8b\u5982\uff0c\u5982\u679c\u53f3\u5927\u62ec\u53f7\u540e\u9762\u662felse\u6216\u9017\u53f7\uff0c\u5219\u4e0d\u6362\u884c\u3002</li> </ul> <p>\u793a\u4f8b\uff1a</p> <pre><code>return new MyClass() {\n  @Override public void method() {\n    if (condition()) {\n      try {\n        something();\n      } catch (ProblemException e) {\n        recover();\n      }\n    }\n  }\n};</code></pre> <p>4.8.1\u8282\u7ed9\u51fa\u4e86enum\u7c7b\u7684\u4e00\u4e9b\u4f8b\u5916\u3002</p> 4.1.3 \u7a7a\u5757\uff1a\u53ef\u4ee5\u7528\u7b80\u6d01\u7248\u672c <p>\u4e00\u4e2a\u7a7a\u7684\u5757\u72b6\u7ed3\u6784\u91cc\u4ec0\u4e48\u4e5f\u4e0d\u5305\u542b\uff0c\u5927\u62ec\u53f7\u53ef\u4ee5\u7b80\u6d01\u5730\u5199\u6210<code>{}</code>\uff0c\u4e0d\u9700\u8981\u6362\u884c\u3002\u4f8b\u5916\uff1a\u5982\u679c\u5b83\u662f\u4e00\u4e2a\u591a\u5757\u8bed\u53e5\u7684\u4e00\u90e8\u5206(if/else \u6216 try/catch/finally) \uff0c\u5373\u4f7f\u5927\u62ec\u53f7\u5185\u6ca1\u5185\u5bb9\uff0c\u53f3\u5927\u62ec\u53f7\u4e5f\u8981\u6362\u884c\u3002</p> <p>\u793a\u4f8b\uff1a</p> <pre><code>void doNothing() {}</code></pre> 4.2 \u5757\u7f29\u8fdb\uff1a2\u4e2a\u7a7a\u683c <p>\u6bcf\u5f53\u5f00\u59cb\u4e00\u4e2a\u65b0\u7684\u5757\uff0c\u7f29\u8fdb\u589e\u52a02\u4e2a\u7a7a\u683c\uff0c\u5f53\u5757\u7ed3\u675f\u65f6\uff0c\u7f29\u8fdb\u8fd4\u56de\u5148\u524d\u7684\u7f29\u8fdb\u7ea7\u522b\u3002\u7f29\u8fdb\u7ea7\u522b\u9002\u7528\u4e8e\u4ee3\u7801\u548c\u6ce8\u91ca\u3002(\u89c14.1.2\u8282\u4e2d\u7684\u4ee3\u7801\u793a\u4f8b)</p> 4.3 \u4e00\u884c\u4e00\u4e2a\u8bed\u53e5 <p>\u6bcf\u4e2a\u8bed\u53e5\u540e\u8981\u6362\u884c\u3002</p> 4.4 \u5217\u9650\u5236\uff1a80\u6216100 <p>\u4e00\u4e2a\u9879\u76ee\u53ef\u4ee5\u9009\u62e9\u4e00\u884c80\u4e2a\u5b57\u7b26\u6216100\u4e2a\u5b57\u7b26\u7684\u5217\u9650\u5236\uff0c\u9664\u4e86\u4e0b\u8ff0\u4f8b\u5916\uff0c\u4efb\u4f55\u4e00\u884c\u5982\u679c\u8d85\u8fc7\u8fd9\u4e2a\u5b57\u7b26\u6570\u9650\u5236\uff0c\u5fc5\u987b\u81ea\u52a8\u6362\u884c\u3002</p> <p>\u4f8b\u5916\uff1a</p> <ol> <li>\u4e0d\u53ef\u80fd\u6ee1\u8db3\u5217\u9650\u5236\u7684\u884c(\u4f8b\u5982\uff0cJavadoc\u4e2d\u7684\u4e00\u4e2a\u957fURL\uff0c\u6216\u662f\u4e00\u4e2a\u957f\u7684JSNI\u65b9\u6cd5\u53c2\u8003)\u3002</li> <li><code>package</code>\u548c<code>import</code>\u8bed\u53e5(\u89c13.2\u8282\u548c3.3\u8282)\u3002</li> <li>\u6ce8\u91ca\u4e2d\u90a3\u4e9b\u53ef\u80fd\u88ab\u526a\u5207\u5e76\u7c98\u8d34\u5230shell\u4e2d\u7684\u547d\u4ee4\u884c\u3002</li> </ol> 4.5 \u81ea\u52a8\u6362\u884c <p>\u672f\u8bed\u8bf4\u660e\uff1a\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u4e00\u884c\u957f\u4ee3\u7801\u4e3a\u4e86\u907f\u514d\u8d85\u51fa\u5217\u9650\u5236(80\u6216100\u4e2a\u5b57\u7b26)\u800c\u88ab\u5206\u4e3a\u591a\u884c\uff0c\u6211\u4eec\u79f0\u4e4b\u4e3a\u81ea\u52a8\u6362\u884c(line-wrapping)\u3002</p> <p>\u6211\u4eec\u5e76\u6ca1\u6709\u5168\u9762\uff0c\u786e\u5b9a\u6027\u7684\u51c6\u5219\u6765\u51b3\u5b9a\u5728\u6bcf\u4e00\u79cd\u60c5\u51b5\u4e0b\u5982\u4f55\u81ea\u52a8\u6362\u884c\u3002\u5f88\u591a\u65f6\u5019\uff0c\u5bf9\u4e8e\u540c\u4e00\u6bb5\u4ee3\u7801\u4f1a\u6709\u597d\u51e0\u79cd\u6709\u6548\u7684\u81ea\u52a8\u6362\u884c\u65b9\u5f0f\u3002</p> <p>Tip: \u63d0\u53d6\u65b9\u6cd5\u6216\u5c40\u90e8\u53d8\u91cf\u53ef\u4ee5\u5728\u4e0d\u6362\u884c\u7684\u60c5\u51b5\u4e0b\u89e3\u51b3\u4ee3\u7801\u8fc7\u957f\u7684\u95ee\u9898(\u662f\u5408\u7406\u7f29\u77ed\u547d\u540d\u957f\u5ea6\u5427)</p> 4.5.1 \u4ece\u54ea\u91cc\u65ad\u5f00 <p>\u81ea\u52a8\u6362\u884c\u7684\u57fa\u672c\u51c6\u5219\u662f\uff1a\u66f4\u503e\u5411\u4e8e\u5728\u66f4\u9ad8\u7684\u8bed\u6cd5\u7ea7\u522b\u5904\u65ad\u5f00\u3002</p> <ol> <li>\u5982\u679c\u5728<code>\u975e\u8d4b\u503c\u8fd0\u7b97\u7b26</code>\u5904\u65ad\u5f00\uff0c\u90a3\u4e48\u5728\u8be5\u7b26\u53f7\u524d\u65ad\u5f00(\u6bd4\u5982+\uff0c\u5b83\u5c06\u4f4d\u4e8e\u4e0b\u4e00\u884c)\u3002\u6ce8\u610f\uff1a\u8fd9\u4e00\u70b9\u4e0eGoogle\u5176\u5b83\u8bed\u8a00\u7684\u7f16\u7a0b\u98ce\u683c\u4e0d\u540c(\u5982C++\u548cJavaScript)\u3002 \u8fd9\u6761\u89c4\u5219\u4e5f\u9002\u7528\u4e8e\u4ee5\u4e0b\u201c\u7c7b\u8fd0\u7b97\u7b26\u201d\u7b26\u53f7\uff1a\u70b9\u5206\u9694\u7b26(.)\uff0c\u7c7b\u578b\u754c\u9650\u4e2d\u7684&amp;\uff08<code>)\uff0ccatch\u5757\u4e2d\u7684\u7ba1\u9053\u7b26\u53f7(<code>catch (FooException | BarException e</code>) <li>\u5982\u679c\u5728<code>\u8d4b\u503c\u8fd0\u7b97\u7b26</code>\u5904\u65ad\u5f00\uff0c\u901a\u5e38\u7684\u505a\u6cd5\u662f\u5728\u8be5\u7b26\u53f7\u540e\u65ad\u5f00(\u6bd4\u5982=\uff0c\u5b83\u4e0e\u524d\u9762\u7684\u5185\u5bb9\u7559\u5728\u540c\u4e00\u884c)\u3002\u8fd9\u6761\u89c4\u5219\u4e5f\u9002\u7528\u4e8e<code>foreach</code>\u8bed\u53e5\u4e2d\u7684\u5206\u53f7\u3002</li> <li>\u65b9\u6cd5\u540d\u6216\u6784\u9020\u51fd\u6570\u540d\u4e0e\u5de6\u62ec\u53f7\u7559\u5728\u540c\u4e00\u884c\u3002</li> <li>\u9017\u53f7(,)\u4e0e\u5176\u524d\u9762\u7684\u5185\u5bb9\u7559\u5728\u540c\u4e00\u884c\u3002</li> 4.5.2 \u81ea\u52a8\u6362\u884c\u65f6\u7f29\u8fdb\u81f3\u5c11+4\u4e2a\u7a7a\u683c <p>\u81ea\u52a8\u6362\u884c\u65f6\uff0c\u7b2c\u4e00\u884c\u540e\u7684\u6bcf\u4e00\u884c\u81f3\u5c11\u6bd4\u7b2c\u4e00\u884c\u591a\u7f29\u8fdb4\u4e2a\u7a7a\u683c(\u6ce8\u610f\uff1a\u5236\u8868\u7b26\u4e0d\u7528\u4e8e\u7f29\u8fdb\u3002\u89c12.3.1\u8282)\u3002</p> <p>\u5f53\u5b58\u5728\u8fde\u7eed\u81ea\u52a8\u6362\u884c\u65f6\uff0c\u7f29\u8fdb\u53ef\u80fd\u4f1a\u591a\u7f29\u8fdb\u4e0d\u53ea4\u4e2a\u7a7a\u683c(\u8bed\u6cd5\u5143\u7d20\u5b58\u5728\u591a\u7ea7\u65f6)\u3002\u4e00\u822c\u800c\u8a00\uff0c\u4e24\u4e2a\u8fde\u7eed\u884c\u4f7f\u7528\u76f8\u540c\u7684\u7f29\u8fdb\u5f53\u4e14\u4ec5\u5f53\u5b83\u4eec\u5f00\u59cb\u4e8e\u540c\u7ea7\u8bed\u6cd5\u5143\u7d20\u3002</p> <p>\u7b2c4.6.3\u6c34\u5e73\u5bf9\u9f50\u4e00\u8282\u4e2d\u6307\u51fa\uff0c\u4e0d\u9f13\u52b1\u4f7f\u7528\u53ef\u53d8\u6570\u76ee\u7684\u7a7a\u683c\u6765\u5bf9\u9f50\u524d\u9762\u884c\u7684\u7b26\u53f7\u3002</p> 4.6 \u7a7a\u767d 4.6.1 \u5782\u76f4\u7a7a\u767d <p>\u4ee5\u4e0b\u60c5\u51b5\u9700\u8981\u4f7f\u7528\u4e00\u4e2a\u7a7a\u884c\uff1a</p> <ol> <li>\u7c7b\u5185\u8fde\u7eed\u7684\u6210\u5458\u4e4b\u95f4\uff1a\u5b57\u6bb5\uff0c\u6784\u9020\u51fd\u6570\uff0c\u65b9\u6cd5\uff0c\u5d4c\u5957\u7c7b\uff0c\u9759\u6001\u521d\u59cb\u5316\u5757\uff0c\u5b9e\u4f8b\u521d\u59cb\u5316\u5757\u3002 <ul> <li>\u4f8b\u5916\uff1a\u4e24\u4e2a\u8fde\u7eed\u5b57\u6bb5\u4e4b\u95f4\u7684\u7a7a\u884c\u662f\u53ef\u9009\u7684\uff0c\u7528\u4e8e\u5b57\u6bb5\u7684\u7a7a\u884c\u4e3b\u8981\u7528\u6765\u5bf9\u5b57\u6bb5\u8fdb\u884c\u903b\u8f91\u5206\u7ec4\u3002</li> </ul> </li> <li>\u5728\u51fd\u6570\u4f53\u5185\uff0c\u8bed\u53e5\u7684\u903b\u8f91\u5206\u7ec4\u95f4\u4f7f\u7528\u7a7a\u884c\u3002</li> <li>\u7c7b\u5185\u7684\u7b2c\u4e00\u4e2a\u6210\u5458\u524d\u6216\u6700\u540e\u4e00\u4e2a\u6210\u5458\u540e\u7684\u7a7a\u884c\u662f\u53ef\u9009\u7684(\u65e2\u4e0d\u9f13\u52b1\u4e5f\u4e0d\u53cd\u5bf9\u8fd9\u6837\u505a\uff0c\u89c6\u4e2a\u4eba\u559c\u597d\u800c\u5b9a)\u3002</li> <li>\u8981\u6ee1\u8db3\u672c\u6587\u6863\u4e2d\u5176\u4ed6\u8282\u7684\u7a7a\u884c\u8981\u6c42(\u6bd4\u59823.3\u8282\uff1aimport\u8bed\u53e5)</li> </ol> <p>\u591a\u4e2a\u8fde\u7eed\u7684\u7a7a\u884c\u662f\u5141\u8bb8\u7684\uff0c\u4f46\u6ca1\u6709\u5fc5\u8981\u8fd9\u6837\u505a(\u6211\u4eec\u4e5f\u4e0d\u9f13\u52b1\u8fd9\u6837\u505a)\u3002</p> 4.6.2 \u6c34\u5e73\u7a7a\u767d <p>\u9664\u4e86\u8bed\u8a00\u9700\u6c42\u548c\u5176\u5b83\u89c4\u5219\uff0c\u5e76\u4e14\u9664\u4e86\u6587\u5b57\uff0c\u6ce8\u91ca\u548cJavadoc\u7528\u5230\u5355\u4e2a\u7a7a\u683c\uff0c\u5355\u4e2aASCII\u7a7a\u683c\u4e5f\u51fa\u73b0\u5728\u4ee5\u4e0b\u51e0\u4e2a\u5730\u65b9\uff1a</p> <ol> <li>\u5206\u9694\u4efb\u4f55\u4fdd\u7559\u5b57\u4e0e\u7d27\u968f\u5176\u540e\u7684\u5de6\u62ec\u53f7(<code>(</code>)(\u5982<code>if, for catch</code>\u7b49)\u3002</li> <li>\u5206\u9694\u4efb\u4f55\u4fdd\u7559\u5b57\u4e0e\u5176\u524d\u9762\u7684\u53f3\u5927\u62ec\u53f7(<code>}</code>)(\u5982<code>else, catch</code>)\u3002</li> <li>\u5728\u4efb\u4f55\u5de6\u5927\u62ec\u53f7\u524d(<code>{</code>)\uff0c\u4e24\u4e2a\u4f8b\u5916\uff1a <ul> <li><code>@SomeAnnotation({a, b})</code>(\u4e0d\u4f7f\u7528\u7a7a\u683c)\u3002</li> <li><code>String[][] x = foo;</code>(\u5927\u62ec\u53f7\u95f4\u6ca1\u6709\u7a7a\u683c\uff0c\u89c1\u4e0b\u9762\u7684Note)\u3002</li> </ul> </li> <li>\u5728\u4efb\u4f55\u4e8c\u5143\u6216\u4e09\u5143\u8fd0\u7b97\u7b26\u7684\u4e24\u4fa7\u3002\u8fd9\u4e5f\u9002\u7528\u4e8e\u4ee5\u4e0b\u201c\u7c7b\u8fd0\u7b97\u7b26\u201d\u7b26\u53f7\uff1a <ul> <li>\u7c7b\u578b\u754c\u9650\u4e2d\u7684&amp;(<code>)\u3002 <li>catch\u5757\u4e2d\u7684\u7ba1\u9053\u7b26\u53f7(<code>catch (FooException | BarException e</code>)\u3002</li> <li><code>foreach</code>\u8bed\u53e5\u4e2d\u7684\u5206\u53f7\u3002</li> <li>\u5728<code>, : ;</code>\u53ca\u53f3\u62ec\u53f7(<code>)</code>)\u540e</li> <li>\u5982\u679c\u5728\u4e00\u6761\u8bed\u53e5\u540e\u505a\u6ce8\u91ca\uff0c\u5219\u53cc\u659c\u6760(//)\u4e24\u8fb9\u90fd\u8981\u7a7a\u683c\u3002\u8fd9\u91cc\u53ef\u4ee5\u5141\u8bb8\u591a\u4e2a\u7a7a\u683c\uff0c\u4f46\u6ca1\u6709\u5fc5\u8981\u3002</li> <li>\u7c7b\u578b\u548c\u53d8\u91cf\u4e4b\u95f4\uff1aList list\u3002</li> <li>\u6570\u7ec4\u521d\u59cb\u5316\u4e2d\uff0c\u5927\u62ec\u53f7\u5185\u7684\u7a7a\u683c\u662f\u53ef\u9009\u7684\uff0c\u5373<code>new int[] {5, 6}</code>\u548c<code>new int[] { 5, 6 }</code>\u90fd\u662f\u53ef\u4ee5\u7684\u3002</li> <p>Note\uff1a\u8fd9\u4e2a\u89c4\u5219\u5e76\u4e0d\u8981\u6c42\u6216\u7981\u6b62\u4e00\u884c\u7684\u5f00\u5173\u6216\u7ed3\u5c3e\u9700\u8981\u989d\u5916\u7684\u7a7a\u683c\uff0c\u53ea\u5bf9\u5185\u90e8\u7a7a\u683c\u505a\u8981\u6c42\u3002</p> 4.6.3 \u6c34\u5e73\u5bf9\u9f50\uff1a\u4e0d\u505a\u8981\u6c42 <p>\u672f\u8bed\u8bf4\u660e\uff1a\u6c34\u5e73\u5bf9\u9f50\u6307\u7684\u662f\u901a\u8fc7\u589e\u52a0\u53ef\u53d8\u6570\u91cf\u7684\u7a7a\u683c\u6765\u4f7f\u67d0\u4e00\u884c\u7684\u5b57\u7b26\u4e0e\u4e0a\u4e00\u884c\u7684\u76f8\u5e94\u5b57\u7b26\u5bf9\u9f50\u3002</p> <p>\u8fd9\u662f\u5141\u8bb8\u7684(\u800c\u4e14\u5728\u4e0d\u5c11\u5730\u65b9\u53ef\u4ee5\u770b\u5230\u8fd9\u6837\u7684\u4ee3\u7801)\uff0c\u4f46Google\u7f16\u7a0b\u98ce\u683c\u5bf9\u6b64\u4e0d\u505a\u8981\u6c42\u3002\u5373\u4f7f\u5bf9\u4e8e\u5df2\u7ecf\u4f7f\u7528\u6c34\u5e73\u5bf9\u9f50\u7684\u4ee3\u7801\uff0c\u6211\u4eec\u4e5f\u4e0d\u9700\u8981\u53bb\u4fdd\u6301\u8fd9\u79cd\u98ce\u683c\u3002</p> <p>\u4ee5\u4e0b\u793a\u4f8b\u5148\u5c55\u793a\u672a\u5bf9\u9f50\u7684\u4ee3\u7801\uff0c\u7136\u540e\u662f\u5bf9\u9f50\u7684\u4ee3\u7801\uff1a</p> <pre><code>private int x; // this is fine\nprivate Color color; // this too\n\nprivate int   x;      // permitted, but future edits\nprivate Color color;  // may leave it unaligned</code></pre> <p>Tip\uff1a\u5bf9\u9f50\u53ef\u589e\u52a0\u4ee3\u7801\u53ef\u8bfb\u6027\uff0c\u4f46\u5b83\u4e3a\u65e5\u540e\u7684\u7ef4\u62a4\u5e26\u6765\u95ee\u9898\u3002\u8003\u8651\u672a\u6765\u67d0\u4e2a\u65f6\u5019\uff0c\u6211\u4eec\u9700\u8981\u4fee\u6539\u4e00\u5806\u5bf9\u9f50\u7684\u4ee3\u7801\u4e2d\u7684\u4e00\u884c\u3002 \u8fd9\u53ef\u80fd\u5bfc\u81f4\u539f\u672c\u5f88\u6f02\u4eae\u7684\u5bf9\u9f50\u4ee3\u7801\u53d8\u5f97\u9519\u4f4d\u3002\u5f88\u53ef\u80fd\u5b83\u4f1a\u63d0\u793a\u4f60\u8c03\u6574\u5468\u56f4\u4ee3\u7801\u7684\u7a7a\u767d\u6765\u4f7f\u8fd9\u4e00\u5806\u4ee3\u7801\u91cd\u65b0\u6c34\u5e73\u5bf9\u9f50(\u6bd4\u5982\u7a0b\u5e8f\u5458\u60f3\u4fdd\u6301\u8fd9\u79cd\u6c34\u5e73\u5bf9\u9f50\u7684\u98ce\u683c)\uff0c \u8fd9\u5c31\u4f1a\u8ba9\u4f60\u505a\u8bb8\u591a\u7684\u65e0\u7528\u529f\uff0c\u589e\u52a0\u4e86reviewer\u7684\u5de5\u4f5c\u5e76\u4e14\u53ef\u80fd\u5bfc\u81f4\u66f4\u591a\u7684\u5408\u5e76\u51b2\u7a81\u3002</p> 4.7 \u7528\u5c0f\u62ec\u53f7\u6765\u9650\u5b9a\u7ec4\uff1a\u63a8\u8350 <p>\u9664\u975e\u4f5c\u8005\u548creviewer\u90fd\u8ba4\u4e3a\u53bb\u6389\u5c0f\u62ec\u53f7\u4e5f\u4e0d\u4f1a\u4f7f\u4ee3\u7801\u88ab\u8bef\u89e3\uff0c\u6216\u662f\u53bb\u6389\u5c0f\u62ec\u53f7\u80fd\u8ba9\u4ee3\u7801\u66f4\u6613\u4e8e\u9605\u8bfb\uff0c\u5426\u5219\u6211\u4eec\u4e0d\u5e94\u8be5\u53bb\u6389\u5c0f\u62ec\u53f7\u3002 \u6211\u4eec\u6ca1\u6709\u7406\u7531\u5047\u8bbe\u8bfb\u8005\u80fd\u8bb0\u4f4f\u6574\u4e2aJava\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7\u8868\u3002</p> 4.8 \u5177\u4f53\u7ed3\u6784 4.8.1 \u679a\u4e3e\u7c7b <p>\u679a\u4e3e\u5e38\u91cf\u95f4\u7528\u9017\u53f7\u9694\u5f00\uff0c\u6362\u884c\u53ef\u9009\u3002</p> <p>\u6ca1\u6709\u65b9\u6cd5\u548c\u6587\u6863\u7684\u679a\u4e3e\u7c7b\u53ef\u5199\u6210\u6570\u7ec4\u521d\u59cb\u5316\u7684\u683c\u5f0f\uff1a</p> <pre><code>private enum Suit { CLUBS, HEARTS, SPADES, DIAMONDS }</code></pre> <p>\u7531\u4e8e\u679a\u4e3e\u7c7b\u4e5f\u662f\u4e00\u4e2a\u7c7b\uff0c\u56e0\u6b64\u6240\u6709\u9002\u7528\u4e8e\u5176\u5b83\u7c7b\u7684\u683c\u5f0f\u89c4\u5219\u4e5f\u9002\u7528\u4e8e\u679a\u4e3e\u7c7b\u3002</p> 4.8.2 \u53d8\u91cf\u58f0\u660e 4.8.2.1 \u6bcf\u6b21\u53ea\u58f0\u660e\u4e00\u4e2a\u53d8\u91cf <p>\u4e0d\u8981\u4f7f\u7528\u7ec4\u5408\u58f0\u660e\uff0c\u6bd4\u5982<code>int a, b;</code>\u3002</p> 4.8.2.2 \u9700\u8981\u65f6\u624d\u58f0\u660e\uff0c\u5e76\u5c3d\u5feb\u8fdb\u884c\u521d\u59cb\u5316 <p>\u4e0d\u8981\u5728\u4e00\u4e2a\u4ee3\u7801\u5757\u7684\u5f00\u5934\u628a\u5c40\u90e8\u53d8\u91cf\u4e00\u6b21\u6027\u90fd\u58f0\u660e\u4e86(\u8fd9\u662fc\u8bed\u8a00\u7684\u505a\u6cd5)\uff0c\u800c\u662f\u5728\u7b2c\u4e00\u6b21\u9700\u8981\u4f7f\u7528\u5b83\u65f6\u624d\u58f0\u660e\u3002 \u5c40\u90e8\u53d8\u91cf\u5728\u58f0\u660e\u65f6\u6700\u597d\u5c31\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u6216\u8005\u58f0\u660e\u540e\u5c3d\u5feb\u8fdb\u884c\u521d\u59cb\u5316\u3002</p> 4.8.3 \u6570\u7ec4 4.8.3.1 \u6570\u7ec4\u521d\u59cb\u5316\uff1a\u53ef\u5199\u6210\u5757\u72b6\u7ed3\u6784 <p>\u6570\u7ec4\u521d\u59cb\u5316\u53ef\u4ee5\u5199\u6210\u5757\u72b6\u7ed3\u6784\uff0c\u6bd4\u5982\uff0c\u4e0b\u9762\u7684\u5199\u6cd5\u90fd\u662fOK\u7684\uff1a</p> <pre><code>new int[] {\n  0, 1, 2, 3 \n}\n\nnew int[] {\n  0,\n  1,\n  2,\n  3\n}\n\nnew int[] {\n  0, 1,\n  2, 3\n}\n\nnew int[]\n    {0, 1, 2, 3}</code></pre> 4.8.3.2 \u975eC\u98ce\u683c\u7684\u6570\u7ec4\u58f0\u660e <p>\u4e2d\u62ec\u53f7\u662f\u7c7b\u578b\u7684\u4e00\u90e8\u5206\uff1a<code>String[] args</code>\uff0c \u800c\u975e<code>String args[]</code>\u3002</p> 4.8.4 switch\u8bed\u53e5 <p>\u672f\u8bed\u8bf4\u660e\uff1aswitch\u5757\u7684\u5927\u62ec\u53f7\u5185\u662f\u4e00\u4e2a\u6216\u591a\u4e2a\u8bed\u53e5\u7ec4\u3002\u6bcf\u4e2a\u8bed\u53e5\u7ec4\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2aswitch\u6807\u7b7e(<code>case FOO:</code>\u6216<code>default:</code>)\uff0c\u540e\u9762\u8ddf\u7740\u4e00\u6761\u6216\u591a\u6761\u8bed\u53e5\u3002</p> 4.8.4.1 \u7f29\u8fdb <p>\u4e0e\u5176\u5b83\u5757\u72b6\u7ed3\u6784\u4e00\u81f4\uff0cswitch\u5757\u4e2d\u7684\u5185\u5bb9\u7f29\u8fdb\u4e3a2\u4e2a\u7a7a\u683c\u3002</p> <p>\u6bcf\u4e2aswitch\u6807\u7b7e\u540e\u65b0\u8d77\u4e00\u884c\uff0c\u518d\u7f29\u8fdb2\u4e2a\u7a7a\u683c\uff0c\u5199\u4e0b\u4e00\u6761\u6216\u591a\u6761\u8bed\u53e5\u3002</p> 4.8.4.2 Fall-through\uff1a\u6ce8\u91ca <p>\u5728\u4e00\u4e2aswitch\u5757\u5185\uff0c\u6bcf\u4e2a\u8bed\u53e5\u7ec4\u8981\u4e48\u901a\u8fc7<code>break, continue, return</code>\u6216\u629b\u51fa\u5f02\u5e38\u6765\u7ec8\u6b62\uff0c\u8981\u4e48\u901a\u8fc7\u4e00\u6761\u6ce8\u91ca\u6765\u8bf4\u660e\u7a0b\u5e8f\u5c06\u7ee7\u7eed\u6267\u884c\u5230\u4e0b\u4e00\u4e2a\u8bed\u53e5\u7ec4\uff0c \u4efb\u4f55\u80fd\u8868\u8fbe\u8fd9\u4e2a\u610f\u601d\u7684\u6ce8\u91ca\u90fd\u662fOK\u7684(\u5178\u578b\u7684\u662f\u7528<code>// fall through</code>)\u3002\u8fd9\u4e2a\u7279\u6b8a\u7684\u6ce8\u91ca\u5e76\u4e0d\u9700\u8981\u5728\u6700\u540e\u4e00\u4e2a\u8bed\u53e5\u7ec4(\u4e00\u822c\u662f<code>default</code>)\u4e2d\u51fa\u73b0\u3002\u793a\u4f8b\uff1a</p> <pre><code>switch (input) {\n  case 1:\n  case 2:\n    prepareOneOrTwo();\n    // fall through\n  case 3:\n    handleOneTwoOrThree();\n    break;\n  default:\n    handleLargeNumber(input);\n}</code></pre> 4.8.4.3 default\u7684\u60c5\u51b5\u8981\u5199\u51fa\u6765 <p>\u6bcf\u4e2aswitch\u8bed\u53e5\u90fd\u5305\u542b\u4e00\u4e2a<code>default</code>\u8bed\u53e5\u7ec4\uff0c\u5373\u4f7f\u5b83\u4ec0\u4e48\u4ee3\u7801\u4e5f\u4e0d\u5305\u542b\u3002</p> 4.8.5 \u6ce8\u89e3(Annotations) <p>\u6ce8\u89e3\u7d27\u8ddf\u5728\u6587\u6863\u5757\u540e\u9762\uff0c\u5e94\u7528\u4e8e\u7c7b\u3001\u65b9\u6cd5\u548c\u6784\u9020\u51fd\u6570\uff0c\u4e00\u4e2a\u6ce8\u89e3\u72ec\u5360\u4e00\u884c\u3002\u8fd9\u4e9b\u6362\u884c\u4e0d\u5c5e\u4e8e\u81ea\u52a8\u6362\u884c(\u7b2c4.5\u8282\uff0c\u81ea\u52a8\u6362\u884c)\uff0c\u56e0\u6b64\u7f29\u8fdb\u7ea7\u522b\u4e0d\u53d8\u3002\u4f8b\u5982\uff1a</p> <pre><code>@Override\n@Nullable\npublic String getNameIfPresent() { ... }</code></pre> <p>\u4f8b\u5916\uff1a\u5355\u4e2a\u7684\u6ce8\u89e3\u53ef\u4ee5\u548c\u7b7e\u540d\u7684\u7b2c\u4e00\u884c\u51fa\u73b0\u5728\u540c\u4e00\u884c\u3002\u4f8b\u5982\uff1a</p> <pre><code>@Override public int hashCode() { ... }</code></pre> <p>\u5e94\u7528\u4e8e\u5b57\u6bb5\u7684\u6ce8\u89e3\u7d27\u968f\u6587\u6863\u5757\u51fa\u73b0\uff0c\u5e94\u7528\u4e8e\u5b57\u6bb5\u7684\u591a\u4e2a\u6ce8\u89e3\u5141\u8bb8\u4e0e\u5b57\u6bb5\u51fa\u73b0\u5728\u540c\u4e00\u884c\u3002\u4f8b\u5982\uff1a</p> <pre><code>@Partial @Mock DataLoader loader;</code></pre> <p>\u53c2\u6570\u548c\u5c40\u90e8\u53d8\u91cf\u6ce8\u89e3\u6ca1\u6709\u7279\u5b9a\u89c4\u5219\u3002</p> 4.8.6 \u6ce8\u91ca 4.8.6.1 \u5757\u6ce8\u91ca\u98ce\u683c <p>\u5757\u6ce8\u91ca\u4e0e\u5176\u5468\u56f4\u7684\u4ee3\u7801\u5728\u540c\u4e00\u7f29\u8fdb\u7ea7\u522b\u3002\u5b83\u4eec\u53ef\u4ee5\u662f<code>/* ... */</code>\u98ce\u683c\uff0c\u4e5f\u53ef\u4ee5\u662f<code>// ...</code>\u98ce\u683c\u3002\u5bf9\u4e8e\u591a\u884c\u7684<code>/* ... */</code>\u6ce8\u91ca\uff0c\u540e\u7eed\u884c\u5fc5\u987b\u4ece<code>*</code>\u5f00\u59cb\uff0c \u5e76\u4e14\u4e0e\u524d\u4e00\u884c\u7684<code>*</code>\u5bf9\u9f50\u3002\u4ee5\u4e0b\u793a\u4f8b\u6ce8\u91ca\u90fd\u662fOK\u7684\u3002</p> <pre><code>/*\n * This is          // And so           /* Or you can\n * okay.            // is this.          * even do this. */\n */</code></pre> <p>\u6ce8\u91ca\u4e0d\u8981\u5c01\u95ed\u5728\u7531\u661f\u53f7\u6216\u5176\u5b83\u5b57\u7b26\u7ed8\u5236\u7684\u6846\u67b6\u91cc\u3002</p> <p>Tip\uff1a\u5728\u5199\u591a\u884c\u6ce8\u91ca\u65f6\uff0c\u5982\u679c\u4f60\u5e0c\u671b\u5728\u5fc5\u8981\u65f6\u80fd\u91cd\u65b0\u6362\u884c(\u5373\u6ce8\u91ca\u50cf\u6bb5\u843d\u98ce\u683c\u4e00\u6837)\uff0c\u90a3\u4e48\u4f7f\u7528<code>/* ... */</code>\u3002</p> 4.8.7 Modifiers <p>\u7c7b\u548c\u6210\u5458\u7684modifiers\u5982\u679c\u5b58\u5728\uff0c\u5219\u6309Java\u8bed\u8a00\u89c4\u8303\u4e2d\u63a8\u8350\u7684\u987a\u5e8f\u51fa\u73b0\u3002</p> <pre><code>public protected private abstract static final transient volatile synchronized native strictfp</code></pre> \u547d\u540d\u7ea6\u5b9a 5.1 \u5bf9\u6240\u6709\u6807\u8bc6\u7b26\u90fd\u901a\u7528\u7684\u89c4\u5219 <p>\u6807\u8bc6\u7b26\u53ea\u80fd\u4f7f\u7528ASCII\u5b57\u6bcd\u548c\u6570\u5b57\uff0c\u56e0\u6b64\u6bcf\u4e2a\u6709\u6548\u7684\u6807\u8bc6\u7b26\u540d\u79f0\u90fd\u80fd\u5339\u914d\u6b63\u5219\u8868\u8fbe\u5f0f<code>\\w+</code>\u3002</p> <p>\u5728Google\u5176\u5b83\u7f16\u7a0b\u8bed\u8a00\u98ce\u683c\u4e2d\u4f7f\u7528\u7684\u7279\u6b8a\u524d\u7f00\u6216\u540e\u7f00\uff0c\u5982<code>name_</code>, <code>mName</code>, <code>s_name</code>\u548c<code>kName</code>\uff0c\u5728Java\u7f16\u7a0b\u98ce\u683c\u4e2d\u90fd\u4e0d\u518d\u4f7f\u7528\u3002</p> 5.2 \u6807\u8bc6\u7b26\u7c7b\u578b\u7684\u89c4\u5219 5.2.1 \u5305\u540d <p>\u5305\u540d\u5168\u90e8\u5c0f\u5199\uff0c\u8fde\u7eed\u7684\u5355\u8bcd\u53ea\u662f\u7b80\u5355\u5730\u8fde\u63a5\u8d77\u6765\uff0c\u4e0d\u4f7f\u7528\u4e0b\u5212\u7ebf\u3002</p> 5.2.2 \u7c7b\u540d <p>\u7c7b\u540d\u90fd\u4ee5<code>UpperCamelCase</code>\u98ce\u683c\u7f16\u5199\u3002</p> <p>\u7c7b\u540d\u901a\u5e38\u662f\u540d\u8bcd\u6216\u540d\u8bcd\u77ed\u8bed\uff0c\u63a5\u53e3\u540d\u79f0\u6709\u65f6\u53ef\u80fd\u662f\u5f62\u5bb9\u8bcd\u6216\u5f62\u5bb9\u8bcd\u77ed\u8bed\u3002\u73b0\u5728\u8fd8\u6ca1\u6709\u7279\u5b9a\u7684\u89c4\u5219\u6216\u884c\u4e4b\u6709\u6548\u7684\u7ea6\u5b9a\u6765\u547d\u540d\u6ce8\u89e3\u7c7b\u578b\u3002</p> <p>\u6d4b\u8bd5\u7c7b\u7684\u547d\u540d\u4ee5\u5b83\u8981\u6d4b\u8bd5\u7684\u7c7b\u7684\u540d\u79f0\u5f00\u59cb\uff0c\u4ee5<code>Test</code>\u7ed3\u675f\u3002\u4f8b\u5982\uff0c<code>HashTest</code>\u6216<code>HashIntegrationTest</code>\u3002</p> 5.2.3 \u65b9\u6cd5\u540d <p>\u65b9\u6cd5\u540d\u90fd\u4ee5<code>lowerCamelCase</code>\u98ce\u683c\u7f16\u5199\u3002</p> <p>\u65b9\u6cd5\u540d\u901a\u5e38\u662f\u52a8\u8bcd\u6216\u52a8\u8bcd\u77ed\u8bed\u3002</p> <p>\u4e0b\u5212\u7ebf\u53ef\u80fd\u51fa\u73b0\u5728JUnit\u6d4b\u8bd5\u65b9\u6cd5\u540d\u79f0\u4e2d\u7528\u4ee5\u5206\u9694\u540d\u79f0\u7684\u903b\u8f91\u7ec4\u4ef6\u3002\u4e00\u4e2a\u5178\u578b\u7684\u6a21\u5f0f\u662f\uff1a<code>test_\uff0c\u4f8b\u5982<code>testPop_emptyStack</code>\u3002 \u5e76\u4e0d\u5b58\u5728\u552f\u4e00\u6b63\u786e\u7684\u65b9\u5f0f\u6765\u547d\u540d\u6d4b\u8bd5\u65b9\u6cd5\u3002 5.2.4 \u5e38\u91cf\u540d <p>\u5e38\u91cf\u540d\u547d\u540d\u6a21\u5f0f\u4e3a<code>CONSTANT_CASE</code>\uff0c\u5168\u90e8\u5b57\u6bcd\u5927\u5199\uff0c\u7528\u4e0b\u5212\u7ebf\u5206\u9694\u5355\u8bcd\u3002\u90a3\uff0c\u5230\u5e95\u4ec0\u4e48\u7b97\u662f\u4e00\u4e2a\u5e38\u91cf\uff1f</p> <p>\u6bcf\u4e2a\u5e38\u91cf\u90fd\u662f\u4e00\u4e2a\u9759\u6001final\u5b57\u6bb5\uff0c\u4f46\u4e0d\u662f\u6240\u6709\u9759\u6001final\u5b57\u6bb5\u90fd\u662f\u5e38\u91cf\u3002\u5728\u51b3\u5b9a\u4e00\u4e2a\u5b57\u6bb5\u662f\u5426\u662f\u4e00\u4e2a\u5e38\u91cf\u65f6\uff0c \u8003\u8651\u5b83\u662f\u5426\u771f\u7684\u611f\u89c9\u50cf\u662f\u4e00\u4e2a\u5e38\u91cf\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4efb\u4f55\u4e00\u4e2a\u8be5\u5b9e\u4f8b\u7684\u89c2\u6d4b\u72b6\u6001\u662f\u53ef\u53d8\u7684\uff0c\u5219\u5b83\u51e0\u4e4e\u80af\u5b9a\u4e0d\u4f1a\u662f\u4e00\u4e2a\u5e38\u91cf\u3002 \u53ea\u662f\u6c38\u8fdc\u4e0d<code>\u6253\u7b97</code>\u6539\u53d8\u5bf9\u8c61\u4e00\u822c\u662f\u4e0d\u591f\u7684\uff0c\u5b83\u8981\u771f\u7684\u4e00\u76f4\u4e0d\u53d8\u624d\u80fd\u5c06\u5b83\u793a\u4e3a\u5e38\u91cf\u3002</p> <pre><code>// Constants\nstatic final int NUMBER = 5;\nstatic final ImmutableList&lt;String&gt; NAMES = ImmutableList.of(\"Ed\", \"Ann\");\nstatic final Joiner COMMA_JOINER = Joiner.on(',');  // because Joiner is immutable\nstatic final SomeMutableType[] EMPTY_ARRAY = {};\nenum SomeEnum { ENUM_CONSTANT }\n\n// Not constants\nstatic String nonFinal = \"non-final\";\nfinal String nonStatic = \"non-static\";\nstatic final Set&lt;String&gt; mutableCollection = new HashSet&lt;String&gt;();\nstatic final ImmutableSet&lt;SomeMutableType&gt; mutableElements = ImmutableSet.of(mutable);\nstatic final Logger logger = Logger.getLogger(MyClass.getName());\nstatic final String[] nonEmptyArray = {\"these\", \"can\", \"change\"};</code></pre> <p>\u8fd9\u4e9b\u540d\u5b57\u901a\u5e38\u662f\u540d\u8bcd\u6216\u540d\u8bcd\u77ed\u8bed\u3002</p> 5.2.5 \u975e\u5e38\u91cf\u5b57\u6bb5\u540d <p>\u975e\u5e38\u91cf\u5b57\u6bb5\u540d\u4ee5<code>lowerCamelCase</code>\u98ce\u683c\u7f16\u5199\u3002</p> <p>\u8fd9\u4e9b\u540d\u5b57\u901a\u5e38\u662f\u540d\u8bcd\u6216\u540d\u8bcd\u77ed\u8bed\u3002</p> 5.2.6 \u53c2\u6570\u540d <p>\u53c2\u6570\u540d\u4ee5<code>lowerCamelCase</code>\u98ce\u683c\u7f16\u5199\u3002</p> <p>\u53c2\u6570\u5e94\u8be5\u907f\u514d\u7528\u5355\u4e2a\u5b57\u7b26\u547d\u540d\u3002</p> 5.2.7 \u5c40\u90e8\u53d8\u91cf\u540d <p>\u5c40\u90e8\u53d8\u91cf\u540d\u4ee5<code>lowerCamelCase</code>\u98ce\u683c\u7f16\u5199\uff0c\u6bd4\u8d77\u5176\u5b83\u7c7b\u578b\u7684\u540d\u79f0\uff0c\u5c40\u90e8\u53d8\u91cf\u540d\u53ef\u4ee5\u6709\u66f4\u4e3a\u5bbd\u677e\u7684\u7f29\u5199\u3002</p> <p>\u867d\u7136\u7f29\u5199\u66f4\u5bbd\u677e\uff0c\u4f46\u8fd8\u662f\u8981\u907f\u514d\u7528\u5355\u5b57\u7b26\u8fdb\u884c\u547d\u540d\uff0c\u9664\u4e86\u4e34\u65f6\u53d8\u91cf\u548c\u5faa\u73af\u53d8\u91cf\u3002</p> <p>\u5373\u4f7f\u5c40\u90e8\u53d8\u91cf\u662ffinal\u548c\u4e0d\u53ef\u6539\u53d8\u7684\uff0c\u4e5f\u4e0d\u5e94\u8be5\u628a\u5b83\u793a\u4e3a\u5e38\u91cf\uff0c\u81ea\u7136\u4e5f\u4e0d\u80fd\u7528\u5e38\u91cf\u7684\u89c4\u5219\u53bb\u547d\u540d\u5b83\u3002</p> 5.2.8 \u7c7b\u578b\u53d8\u91cf\u540d <p>\u7c7b\u578b\u53d8\u91cf\u53ef\u7528\u4ee5\u4e0b\u4e24\u79cd\u98ce\u683c\u4e4b\u4e00\u8fdb\u884c\u547d\u540d\uff1a</p> <ul> <li>\u5355\u4e2a\u7684\u5927\u5199\u5b57\u6bcd\uff0c\u540e\u9762\u53ef\u4ee5\u8ddf\u4e00\u4e2a\u6570\u5b57(\u5982\uff1aE, T, X, T2)\u3002</li> <li>\u4ee5\u7c7b\u547d\u540d\u65b9\u5f0f(5.2.2\u8282)\uff0c\u540e\u9762\u52a0\u4e2a\u5927\u5199\u7684T(\u5982\uff1aRequestT, FooBarT)\u3002</li> </ul> 5.3 \u9a7c\u5cf0\u5f0f\u547d\u540d\u6cd5(CamelCase) <p>\u9a7c\u5cf0\u5f0f\u547d\u540d\u6cd5\u5206\u5927\u9a7c\u5cf0\u5f0f\u547d\u540d\u6cd5(<code>UpperCamelCase</code>)\u548c\u5c0f\u9a7c\u5cf0\u5f0f\u547d\u540d\u6cd5(<code>lowerCamelCase</code>)\u3002 \u6709\u65f6\uff0c\u6211\u4eec\u6709\u4e0d\u53ea\u4e00\u79cd\u5408\u7406\u7684\u65b9\u5f0f\u5c06\u4e00\u4e2a\u82f1\u8bed\u8bcd\u7ec4\u8f6c\u6362\u6210\u9a7c\u5cf0\u5f62\u5f0f\uff0c\u5982\u7f29\u7565\u8bed\u6216\u4e0d\u5bfb\u5e38\u7684\u7ed3\u6784(\u4f8b\u5982\"IPv6\"\u6216\"iOS\")\u3002Google\u6307\u5b9a\u4e86\u4ee5\u4e0b\u7684\u8f6c\u6362\u65b9\u6848\u3002</p> <p>\u540d\u5b57\u4ece<code>\u6563\u6587\u5f62\u5f0f</code>(prose form)\u5f00\u59cb:</p> <ol> <li>\u628a\u77ed\u8bed\u8f6c\u6362\u4e3a\u7eafASCII\u7801\uff0c\u5e76\u4e14\u79fb\u9664\u4efb\u4f55\u5355\u5f15\u53f7\u3002\u4f8b\u5982\uff1a\"M\u00fcller\u2019s algorithm\"\u5c06\u53d8\u6210\"Muellers algorithm\"\u3002</li> <li>\u628a\u8fd9\u4e2a\u7ed3\u679c\u5207\u5206\u6210\u5355\u8bcd\uff0c\u5728\u7a7a\u683c\u6216\u5176\u5b83\u6807\u70b9\u7b26\u53f7(\u901a\u5e38\u662f\u8fde\u5b57\u7b26)\u5904\u5206\u5272\u5f00\u3002 <ul> <li>\u63a8\u8350\uff1a\u5982\u679c\u67d0\u4e2a\u5355\u8bcd\u5df2\u7ecf\u6709\u4e86\u5e38\u7528\u7684\u9a7c\u5cf0\u8868\u793a\u5f62\u5f0f\uff0c\u6309\u5b83\u7684\u7ec4\u6210\u5c06\u5b83\u5206\u5272\u5f00(\u5982\"AdWords\"\u5c06\u5206\u5272\u6210\"ad words\")\u3002 \u9700\u8981\u6ce8\u610f\u7684\u662f\"iOS\"\u5e76\u4e0d\u662f\u4e00\u4e2a\u771f\u6b63\u7684\u9a7c\u5cf0\u8868\u793a\u5f62\u5f0f\uff0c\u56e0\u6b64\u8be5\u63a8\u8350\u5bf9\u5b83\u5e76\u4e0d\u9002\u7528\u3002</li> </ul> </li> <li>\u73b0\u5728\u5c06\u6240\u6709\u5b57\u6bcd\u90fd\u5c0f\u5199(\u5305\u62ec\u7f29\u5199)\uff0c\u7136\u540e\u5c06\u5355\u8bcd\u7684\u7b2c\u4e00\u4e2a\u5b57\u6bcd\u5927\u5199\uff1a <ul> <li>\u6bcf\u4e2a\u5355\u8bcd\u7684\u7b2c\u4e00\u4e2a\u5b57\u6bcd\u90fd\u5927\u5199\uff0c\u6765\u5f97\u5230\u5927\u9a7c\u5cf0\u5f0f\u547d\u540d\u3002</li> <li>\u9664\u4e86\u7b2c\u4e00\u4e2a\u5355\u8bcd\uff0c\u6bcf\u4e2a\u5355\u8bcd\u7684\u7b2c\u4e00\u4e2a\u5b57\u6bcd\u90fd\u5927\u5199\uff0c\u6765\u5f97\u5230\u5c0f\u9a7c\u5cf0\u5f0f\u547d\u540d\u3002</li> </ul> </li> <li>\u6700\u540e\u5c06\u6240\u6709\u7684\u5355\u8bcd\u8fde\u63a5\u8d77\u6765\u5f97\u5230\u4e00\u4e2a\u6807\u8bc6\u7b26\u3002</li> </ol> <p>\u793a\u4f8b\uff1a</p> <pre><code>Prose form                Correct               Incorrect\n------------------------------------------------------------------\n\"XML HTTP request\"        XmlHttpRequest        XMLHTTPRequest\n\"new customer ID\"         newCustomerId         newCustomerID\n\"inner stopwatch\"         innerStopwatch        innerStopWatch\n\"supports IPv6 on iOS?\"   supportsIpv6OnIos     supportsIPv6OnIOS\n\"YouTube importer\"        YouTubeImporter\n                          YoutubeImporter*\n</code></pre> <p>\u52a0\u661f\u53f7\u5904\u8868\u793a\u53ef\u4ee5\uff0c\u4f46\u4e0d\u63a8\u8350\u3002</p> <p>Note\uff1a\u5728\u82f1\u8bed\u4e2d\uff0c\u67d0\u4e9b\u5e26\u6709\u8fde\u5b57\u7b26\u7684\u5355\u8bcd\u5f62\u5f0f\u4e0d\u552f\u4e00\u3002\u4f8b\u5982\uff1a\"nonempty\"\u548c\"non-empty\"\u90fd\u662f\u6b63\u786e\u7684\uff0c\u56e0\u6b64\u65b9\u6cd5\u540d<code>checkNonempty</code>\u548c<code>checkNonEmpty</code>\u4e5f\u90fd\u662f\u6b63\u786e\u7684\u3002</p> \u7f16\u7a0b\u5b9e\u8df5 6.1 @Override\uff1a\u80fd\u7528\u5219\u7528 <p>\u53ea\u8981\u662f\u5408\u6cd5\u7684\uff0c\u5c31\u628a<code>@Override</code>\u6ce8\u89e3\u7ed9\u7528\u4e0a\u3002</p> 6.2 \u6355\u83b7\u7684\u5f02\u5e38\uff1a\u4e0d\u80fd\u5ffd\u89c6 <p>\u9664\u4e86\u4e0b\u9762\u7684\u4f8b\u5b50\uff0c\u5bf9\u6355\u83b7\u7684\u5f02\u5e38\u4e0d\u505a\u54cd\u5e94\u662f\u6781\u5c11\u6b63\u786e\u7684\u3002(\u5178\u578b\u7684\u54cd\u5e94\u65b9\u5f0f\u662f\u6253\u5370\u65e5\u5fd7\uff0c\u6216\u8005\u5982\u679c\u5b83\u88ab\u8ba4\u4e3a\u662f\u4e0d\u53ef\u80fd\u7684\uff0c\u5219\u628a\u5b83\u5f53\u4f5c\u4e00\u4e2a<code>AssertionError</code>\u91cd\u65b0\u629b\u51fa\u3002)</p> <p>\u5982\u679c\u5b83\u786e\u5b9e\u662f\u4e0d\u9700\u8981\u5728catch\u5757\u4e2d\u505a\u4efb\u4f55\u54cd\u5e94\uff0c\u9700\u8981\u505a\u6ce8\u91ca\u52a0\u4ee5\u8bf4\u660e(\u5982\u4e0b\u9762\u7684\u4f8b\u5b50)\u3002</p> <pre><code>try {\n  int i = Integer.parseInt(response);\n  return handleNumericResponse(i);\n} catch (NumberFormatException ok) {\n  // it's not numeric; that's fine, just continue\n}\nreturn handleTextResponse(response);</code></pre> <p>\u4f8b\u5916\uff1a\u5728\u6d4b\u8bd5\u4e2d\uff0c\u5982\u679c\u4e00\u4e2a\u6355\u83b7\u7684\u5f02\u5e38\u88ab\u547d\u540d\u4e3a<code>expected</code>\uff0c\u5219\u5b83\u53ef\u4ee5\u88ab\u4e0d\u52a0\u6ce8\u91ca\u5730\u5ffd\u7565\u3002\u4e0b\u9762\u662f\u4e00\u79cd\u975e\u5e38\u5e38\u89c1\u7684\u60c5\u5f62\uff0c\u7528\u4ee5\u786e\u4fdd\u6240\u6d4b\u8bd5\u7684\u65b9\u6cd5\u4f1a\u629b\u51fa\u4e00\u4e2a\u671f\u671b\u4e2d\u7684\u5f02\u5e38\uff0c \u56e0\u6b64\u5728\u8fd9\u91cc\u5c31\u6ca1\u6709\u5fc5\u8981\u52a0\u6ce8\u91ca\u3002</p> <pre><code>try {\n  emptyStack.pop();\n  fail();\n} catch (NoSuchElementException expected) {\n}</code></pre> 6.3 \u9759\u6001\u6210\u5458\uff1a\u4f7f\u7528\u7c7b\u8fdb\u884c\u8c03\u7528 <p>\u4f7f\u7528\u7c7b\u540d\u8c03\u7528\u9759\u6001\u7684\u7c7b\u6210\u5458\uff0c\u800c\u4e0d\u662f\u5177\u4f53\u67d0\u4e2a\u5bf9\u8c61\u6216\u8868\u8fbe\u5f0f\u3002</p> <pre><code>Foo aFoo = ...;\nFoo.aStaticMethod(); // good\naFoo.aStaticMethod(); // bad\nsomethingThatYieldsAFoo().aStaticMethod(); // very bad</code></pre> 6.4 Finalizers: \u7981\u7528 <p>\u6781\u5c11\u4f1a\u53bb\u91cd\u5199<code>Object.finalize</code>\u3002</p> <p>Tip\uff1a\u4e0d\u8981\u4f7f\u7528finalize\u3002\u5982\u679c\u4f60\u975e\u8981\u4f7f\u7528\u5b83\uff0c\u8bf7\u5148\u4ed4\u7ec6\u9605\u8bfb\u548c\u7406\u89e3Effective Java \u7b2c7\u6761\u6b3e\uff1a\u201cAvoid Finalizers\u201d\uff0c\u7136\u540e\u4e0d\u8981\u4f7f\u7528\u5b83\u3002</p> Javadoc 7.1 \u683c\u5f0f 7.1.1 \u4e00\u822c\u5f62\u5f0f <p>Javadoc\u5757\u7684\u57fa\u672c\u683c\u5f0f\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>/**\n * Multiple lines of Javadoc text are written here,\n * wrapped normally...\n */\npublic int method(String p1) { ... }</code></pre> <p>\u6216\u8005\u662f\u4ee5\u4e0b\u5355\u884c\u5f62\u5f0f\uff1a</p> <pre><code>/** An especially short bit of Javadoc. */</code></pre> <p>\u57fa\u672c\u683c\u5f0f\u603b\u662fOK\u7684\u3002\u5f53\u6574\u4e2aJavadoc\u5757\u80fd\u5bb9\u7eb3\u4e8e\u4e00\u884c\u65f6(\u4e14\u6ca1\u6709Javadoc\u6807\u8bb0@XXX)\uff0c\u53ef\u4ee5\u4f7f\u7528\u5355\u884c\u5f62\u5f0f\u3002</p> 7.1.2 \u6bb5\u843d <p>\u7a7a\u884c(\u5373\uff0c\u53ea\u5305\u542b\u6700\u5de6\u4fa7\u661f\u53f7\u7684\u884c)\u4f1a\u51fa\u73b0\u5728\u6bb5\u843d\u4e4b\u95f4\u548cJavadoc\u6807\u8bb0(@XXX)\u4e4b\u524d(\u5982\u679c\u6709\u7684\u8bdd)\u3002 \u9664\u4e86\u7b2c\u4e00\u4e2a\u6bb5\u843d\uff0c\u6bcf\u4e2a\u6bb5\u843d\u7b2c\u4e00\u4e2a\u5355\u8bcd\u524d\u90fd\u6709\u6807\u7b7e<code> <p>\uff0c\u5e76\u4e14\u5b83\u548c\u7b2c\u4e00\u4e2a\u5355\u8bcd\u95f4\u6ca1\u6709\u7a7a\u683c\u3002</p> 7.1.3 Javadoc\u6807\u8bb0 <p>\u6807\u51c6\u7684Javadoc\u6807\u8bb0\u6309\u4ee5\u4e0b\u987a\u5e8f\u51fa\u73b0\uff1a<code>@param</code>, <code>@return</code>, <code>@throws</code>, <code>@deprecated</code>, \u524d\u9762\u8fd94\u79cd\u6807\u8bb0\u5982\u679c\u51fa\u73b0\uff0c\u63cf\u8ff0\u90fd\u4e0d\u80fd\u4e3a\u7a7a\u3002 \u5f53\u63cf\u8ff0\u65e0\u6cd5\u5728\u4e00\u884c\u4e2d\u5bb9\u7eb3\uff0c\u8fde\u7eed\u884c\u9700\u8981\u81f3\u5c11\u518d\u7f29\u8fdb4\u4e2a\u7a7a\u683c\u3002</p> 7.2 \u6458\u8981\u7247\u6bb5 <p>\u6bcf\u4e2a\u7c7b\u6216\u6210\u5458\u7684Javadoc\u4ee5\u4e00\u4e2a\u7b80\u77ed\u7684\u6458\u8981\u7247\u6bb5\u5f00\u59cb\u3002\u8fd9\u4e2a\u7247\u6bb5\u662f\u975e\u5e38\u91cd\u8981\u7684\uff0c\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u5b83\u662f\u552f\u4e00\u51fa\u73b0\u7684\u6587\u672c\uff0c\u6bd4\u5982\u5728\u7c7b\u548c\u65b9\u6cd5\u7d22\u5f15\u4e2d\u3002</p> <p>\u8fd9\u53ea\u662f\u4e00\u4e2a\u5c0f\u7247\u6bb5\uff0c\u53ef\u4ee5\u662f\u4e00\u4e2a\u540d\u8bcd\u77ed\u8bed\u6216\u52a8\u8bcd\u77ed\u8bed\uff0c\u4f46\u4e0d\u662f\u4e00\u4e2a\u5b8c\u6574\u7684\u53e5\u5b50\u3002\u5b83\u4e0d\u4f1a\u4ee5<code>A {@code Foo} is a...</code>\u6216<code>This method returns...</code>\u5f00\u5934, \u5b83\u4e5f\u4e0d\u4f1a\u662f\u4e00\u4e2a\u5b8c\u6574\u7684\u7948\u4f7f\u53e5\uff0c\u5982<code>Save the record...</code>\u3002\u7136\u800c\uff0c\u7531\u4e8e\u5f00\u5934\u5927\u5199\u53ca\u88ab\u52a0\u4e86\u6807\u70b9\uff0c\u5b83\u770b\u8d77\u6765\u5c31\u50cf\u662f\u4e2a\u5b8c\u6574\u7684\u53e5\u5b50\u3002</p> <p>Tip\uff1a\u4e00\u4e2a\u5e38\u89c1\u7684\u9519\u8bef\u662f\u628a\u7b80\u5355\u7684Javadoc\u5199\u6210<code>/** @return the customer ID */</code>\uff0c\u8fd9\u662f\u4e0d\u6b63\u786e\u7684\u3002\u5b83\u5e94\u8be5\u5199\u6210<code>/** Returns the customer ID. */</code>\u3002</p> 7.3 \u54ea\u91cc\u9700\u8981\u4f7f\u7528Javadoc <p>\u81f3\u5c11\u5728\u6bcf\u4e2apublic\u7c7b\u53ca\u5b83\u7684\u6bcf\u4e2apublic\u548cprotected\u6210\u5458\u5904\u4f7f\u7528Javadoc\uff0c\u4ee5\u4e0b\u662f\u4e00\u4e9b\u4f8b\u5916\uff1a</p> 7.3.1 \u4f8b\u5916\uff1a\u4e0d\u8a00\u81ea\u660e\u7684\u65b9\u6cd5 <p>\u5bf9\u4e8e\u7b80\u5355\u660e\u663e\u7684\u65b9\u6cd5\u5982<code>getFoo</code>\uff0cJavadoc\u662f\u53ef\u9009\u7684(\u5373\uff0c\u662f\u53ef\u4ee5\u4e0d\u5199\u7684)\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\u9664\u4e86\u5199\u201cReturns the foo\u201d\uff0c\u786e\u5b9e\u4e5f\u6ca1\u6709\u4ec0\u4e48\u503c\u5f97\u5199\u4e86\u3002</p> <p>\u5355\u5143\u6d4b\u8bd5\u7c7b\u4e2d\u7684\u6d4b\u8bd5\u65b9\u6cd5\u53ef\u80fd\u662f\u4e0d\u8a00\u81ea\u660e\u7684\u6700\u5e38\u89c1\u4f8b\u5b50\u4e86\uff0c\u6211\u4eec\u901a\u5e38\u53ef\u4ee5\u4ece\u8fd9\u4e9b\u65b9\u6cd5\u7684\u63cf\u8ff0\u6027\u547d\u540d\u4e2d\u77e5\u9053\u5b83\u662f\u5e72\u4ec0\u4e48\u7684\uff0c\u56e0\u6b64\u4e0d\u9700\u8981\u989d\u5916\u7684\u6587\u6863\u8bf4\u660e\u3002</p> <p>Tip\uff1a\u5982\u679c\u6709\u4e00\u4e9b\u76f8\u5173\u4fe1\u606f\u662f\u9700\u8981\u8bfb\u8005\u4e86\u89e3\u7684\uff0c\u90a3\u4e48\u4ee5\u4e0a\u7684\u4f8b\u5916\u4e0d\u5e94\u4f5c\u4e3a\u5ffd\u89c6\u8fd9\u4e9b\u4fe1\u606f\u7684\u7406\u7531\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e\u65b9\u6cd5\u540d<code>getCanonicalName</code>\uff0c \u5c31\u4e0d\u5e94\u8be5\u5ffd\u89c6\u6587\u6863\u8bf4\u660e\uff0c\u56e0\u4e3a\u8bfb\u8005\u5f88\u53ef\u80fd\u4e0d\u77e5\u9053\u8bcd\u8bed<code>canonical name</code>\u6307\u7684\u662f\u4ec0\u4e48\u3002</p> 7.3.2 \u4f8b\u5916\uff1a\u91cd\u5199 <p>\u5982\u679c\u4e00\u4e2a\u65b9\u6cd5\u91cd\u5199\u4e86\u8d85\u7c7b\u4e2d\u7684\u65b9\u6cd5\uff0c\u90a3\u4e48Javadoc\u5e76\u975e\u5fc5\u9700\u7684\u3002</p> 7.3.3 \u53ef\u9009\u7684Javadoc <p>\u5bf9\u4e8e\u5305\u5916\u4e0d\u53ef\u89c1\u7684\u7c7b\u548c\u65b9\u6cd5\uff0c\u5982\u6709\u9700\u8981\uff0c\u4e5f\u662f\u8981\u4f7f\u7528Javadoc\u7684\u3002\u5982\u679c\u4e00\u4e2a\u6ce8\u91ca\u662f\u7528\u6765\u5b9a\u4e49\u4e00\u4e2a\u7c7b\uff0c\u65b9\u6cd5\uff0c\u5b57\u6bb5\u7684\u6574\u4f53\u76ee\u7684\u6216\u884c\u4e3a\uff0c \u90a3\u4e48\u8fd9\u4e2a\u6ce8\u91ca\u5e94\u8be5\u5199\u6210Javadoc\uff0c\u8fd9\u6837\u66f4\u7edf\u4e00\u66f4\u53cb\u597d\u3002</p> \u540e\u8bb0 <p>\u672c\u6587\u6863\u7ffb\u8bd1\u81eaGoogle Java Style\uff0c \u8bd1\u8005@Hawstein\u3002</p>","tags":["java","\u89c4\u8303"]},{"location":"DevOps/2015-12-08-activemq-delay-and-schedule-message-delivery-download.html/","title":"ActiveMQ Delay and Schedule Message Delivery","text":"<p>ActiveMQ from version 5.4 has an optional persistent scheduler built into the ActiveMQ message broker. It is enabled by setting the broker schedulerSupport attribute to true in the Xml Configuration. An ActiveMQ client can take advantage of a delayed delivery by using the following message properties:</p> <p>Check your Message Properties</p> <p>The message property <code>scheduledJobId\u00a0</code>is reserved for use by the Job Scheduler. If this property is set before sending, the message will be sent immediately and not scheduled. Also, after a scheduled message is received, the property<code>scheduledJobId</code>\u00a0will be set on the received message so keep this in mind if using something like a Camel Route which might automatically copy properties over when re-sending a message.</p> Property name type description AMQ_SCHEDULED_DELAY long The time in milliseconds that a message will wait before being scheduled to be delivered by the broker AMQ_SCHEDULED_PERIOD long The time in milliseconds to wait after the start time to wait before scheduling the message again AMQ_SCHEDULED_REPEAT int The number of times to repeat scheduling a message for delivery AMQ_SCHEDULED_CRON String Use a Cron entry to set the schedule <p>For the connivence of Java JMS clients - there's an interface with the property names used for scheduling atorg.apache.activemq.ScheduledMessage.</p> <p>For example, to have a message scheduled for delivery in 60 seconds - you would need to set the AMQ_SCHEDULED_DELAYproperty:</p> <code>MessageProducer producer = session.createProducer(destination);</code> <code>TextMessage message = session.createTextMessage(</code><code>\"test msg\"</code><code>);</code> <code>long</code> <code>time = </code><code>60</code> <code>* </code><code>1000</code><code>;</code> <code>message.setLongProperty(ScheduledMessage.AMQ_SCHEDULED_DELAY, time);</code> <code>producer.send(message);</code> <p>You can set a message to wait with an initial delay, and the repeat delivery 10 times, waiting 10 seconds between each re-delivery:</p> <code>MessageProducer producer = session.createProducer(destination);</code> <code>TextMessage message = session.createTextMessage(</code><code>\"test msg\"</code><code>);</code> <code>long</code> <code>delay = </code><code>30</code> <code>* </code><code>1000</code><code>;</code> <code>long</code> <code>period = </code><code>10</code> <code>* </code><code>1000</code><code>;</code> <code>int</code> <code>repeat = </code><code>9</code><code>;</code> <code>message.setLongProperty(ScheduledMessage.AMQ_SCHEDULED_DELAY, delay);</code> <code>message.setLongProperty(ScheduledMessage.AMQ_SCHEDULED_PERIOD, period);</code> <code>message.setIntProperty(ScheduledMessage.AMQ_SCHEDULED_REPEAT, repeat);</code> <code>producer.send(message);</code> <p>You can also use CRON to schedule a message, for example, if you want a message scheduled to be delivered every hour, you would need to set the CRON entry to be - 0 * * * * - e.g.</p> <code>MessageProducer producer = session.createProducer(destination);</code> <code>TextMessage message = session.createTextMessage(</code><code>\"test msg\"</code><code>);</code> <code>message.setStringProperty(ScheduledMessage.AMQ_SCHEDULED_CRON, </code><code>\"0 * * * *\"</code><code>);</code> <code>producer.send(message);</code> <p>CRON scheduling takes priority over using message delay - however, if a repeat and period is set with a CRON entry, the ActiveMQ scheduler will schedule delivery of the message for every time the CRON entry fires. Easier to explain with an example. Supposing that you want a message to be delivered 10 times, with a one second delay between each message - and you wanted this to happen every hour - you'd do this:</p> <code>MessageProducer producer = session.createProducer(destination);</code> <code>TextMessage message = session.createTextMessage(</code><code>\"test msg\"</code><code>);</code> <code>message.setStringProperty(ScheduledMessage.AMQ_SCHEDULED_CRON, </code><code>\"0 * * * *\"</code><code>);</code> <code>message.setLongProperty(ScheduledMessage.AMQ_SCHEDULED_DELAY, </code><code>1000</code><code>);</code> <code>message.setLongProperty(ScheduledMessage.AMQ_SCHEDULED_PERIOD, </code><code>1000</code><code>);</code> <code>message.setIntProperty(ScheduledMessage.AMQ_SCHEDULED_REPEAT, </code><code>9</code><code>);</code> <code>producer.send(message);</code> <p>\u6458\u81ea\u300ehttp://activemq.apache.org/delay-and-schedule-message-delivery.html\u300f</p>","tags":["activemq","jms"]},{"location":"DevOps/2015-12-08-quartz-cron%25e8%25a1%25a8%25e8%25be%25be%25e5%25bc%258f.html/","title":"QuartZ Cron\u8868\u8fbe\u5f0f","text":"CronTrigger <p>CronTriggers\u5f80\u5f80\u6bd4SimpleTrigger\u66f4\u6709\u7528\uff0c\u5982\u679c\u60a8\u9700\u8981\u57fa\u4e8e\u65e5\u5386\u7684\u6982\u5ff5\uff0c\u800c\u975eSimpleTrigger\u5b8c\u5168\u6307\u5b9a\u7684\u65f6\u95f4\u95f4\u9694\uff0c\u590d\u53d1\u7684\u53d1\u5c04\u5de5\u4f5c\u7684\u65f6\u95f4\u8868\u3002 CronTrigger\uff0c\u4f60\u53ef\u4ee5\u6307\u5b9a\u89e6\u53d1\u7684\u65f6\u95f4\u8868\u5982\u201c\u6bcf\u661f\u671f\u4e94\u4e2d\u5348\u201d\uff0c\u6216\u201c\u6bcf\u4e2a\u5de5\u4f5c\u65e59:30\u65f6\u201d\uff0c\u751a\u81f3\u201c\u6bcf5\u5206\u949f\u4e00\u73ed9:00\u548c10:00\u9022\u661f\u671f\u4e00\u4e0a\u5348\uff0c\u661f\u671f\u4e09\u661f\u671f\u4e94\u201c\u3002 \u5373\u4fbf\u5982\u6b64\uff0cSimpleTrigger\u4e00\u6837\uff0cCronTrigger\u62e5\u6709\u7684startTime\u6307\u5b9a\u7684\u65f6\u95f4\u8868\u65f6\u751f\u6548\uff0c\u6307\u5b9a\u7684\u65f6\u95f4\u8868\u65f6\uff0c\u5e94\u505c\u6b62\uff08\u53ef\u9009\uff09\u7ed3\u675f\u65f6\u95f4\u3002</p> Cron Expressions <p>cron\u7684\u8868\u8fbe\u5f0f\u88ab\u7528\u6765\u914d\u7f6eCronTrigger\u5b9e\u4f8b\u3002\u00a0cron\u7684\u8868\u8fbe\u5f0f\u662f\u5b57\u7b26\u4e32\uff0c\u5b9e\u9645\u4e0a\u662f\u7531\u4e03\u5b50\u8868\u8fbe\u5f0f\uff0c\u63cf\u8ff0\u4e2a\u522b\u7ec6\u8282\u7684\u65f6\u95f4\u8868\u3002\u8fd9\u4e9b\u5b50\u8868\u8fbe\u5f0f\u662f\u5206\u5f00\u7684\u7a7a\u767d\uff0c\u4ee3\u8868\uff1a</p> <ol> <li>1.\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0Seconds</li> <li>2.\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0Minutes</li> <li>3.\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0Hours</li> <li>4.\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0Day-of-Month</li> <li>5.\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0Month</li> <li>6.\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0Day-of-Week</li> <li>7.\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0Year (\u53ef\u9009\u5b57\u6bb5)</li> </ol> <p>\u4f8b \u00a0\"0 0 12 ? * WED\" \u5728\u6bcf\u661f\u671f\u4e09\u4e0b\u534812:00 \u6267\u884c,</p> <p>\u4e2a\u522b\u5b50\u8868\u8fbe\u5f0f\u53ef\u4ee5\u5305\u542b\u8303\u56f4, \u4f8b\u5982\uff0c\u5728\u524d\u9762\u7684\u4f8b\u5b50\u91cc(\"WED\")\u53ef\u4ee5\u66ff\u6362\u6210 \"MON-FRI\", \"MON, WED, FRI\"\u751a\u81f3\"MON-WED,SAT\".</p> <p>\u201c*\u201d \u4ee3\u8868\u6574\u4e2a\u65f6\u95f4\u6bb5.</p> <p>\u6bcf\u4e00\u4e2a\u5b57\u6bb5\u90fd\u6709\u4e00\u5957\u53ef\u4ee5\u6307\u5b9a\u6709\u6548\u503c\uff0c\u5982</p> <p>Seconds (\u79d2)\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \uff1a\u53ef\u4ee5\u7528\u6570\u5b570\uff0d59 \u8868\u793a\uff0c</p> <p>Minutes(\u5206)\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \uff1a\u53ef\u4ee5\u7528\u6570\u5b570\uff0d59 \u8868\u793a\uff0c</p> <p>Hours(\u65f6)\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \uff1a\u53ef\u4ee5\u7528\u6570\u5b570-23\u8868\u793a,</p> <p>Day-of-Month(\u5929) \uff1a\u53ef\u4ee5\u7528\u6570\u5b571-31 \u4e2d\u7684\u4efb\u4e00\u4e00\u4e2a\u503c\uff0c\u4f46\u8981\u6ce8\u610f\u4e00\u4e9b\u7279\u522b\u7684\u6708\u4efd</p> <p>Month(\u6708)\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \uff1a\u53ef\u4ee5\u75280-11 \u6216\u7528\u5b57\u7b26\u4e32 \u00a0\u201cJAN, FEB, MAR, APR, MAY, JUN, JUL, AUG, SEP, OCT, NOV and DEC\u201d \u8868\u793a</p> <p>Day-of-Week(\u6bcf\u5468)\uff1a\u53ef\u4ee5\u7528\u6570\u5b571-7\u8868\u793a\uff081 \uff1d \u661f\u671f\u65e5\uff09\u6216\u7528\u5b57\u7b26\u53e3\u4e32\u201cSUN, MON, TUE, WED, THU, FRI and SAT\u201d\u8868\u793a</p> <p>\u201c/\u201d\uff1a\u4e3a\u7279\u522b\u5355\u4f4d\uff0c\u8868\u793a\u4e3a\u201c\u6bcf\u201d\u5982\u201c0/15\u201d\u8868\u793a\u6bcf\u969415\u5206\u949f\u6267\u884c\u4e00\u6b21,\u201c0\u201d\u8868\u793a\u4e3a\u4ece\u201c0\u201d\u5206\u5f00\u59cb, \u201c3/20\u201d\u8868\u793a\u8868\u793a\u6bcf\u969420\u5206\u949f\u6267\u884c\u4e00\u6b21\uff0c\u201c3\u201d\u8868\u793a\u4ece\u7b2c3\u5206\u949f\u5f00\u59cb\u6267\u884c</p> <p>\u201c?\u201d\uff1a\u8868\u793a\u6bcf\u6708\u7684\u67d0\u4e00\u5929\uff0c\u6216\u7b2c\u5468\u7684\u67d0\u4e00\u5929</p> <p>\u201cL\u201d\uff1a\u7528\u4e8e\u6bcf\u6708\uff0c\u6216\u6bcf\u5468\uff0c\u8868\u793a\u4e3a\u6bcf\u6708\u7684\u6700\u540e\u4e00\u5929\uff0c\u6216\u6bcf\u4e2a\u6708\u7684\u6700\u540e\u661f\u671f\u51e0\u5982\u201c6L\u201d\u8868\u793a\u201c\u6bcf\u6708\u7684\u6700\u540e\u4e00\u4e2a\u661f\u671f\u4e94\u201d</p> <p>\u201cW\u201d\uff1a\u8868\u793a\u4e3a\u6700\u8fd1\u5de5\u4f5c\u65e5\uff0c\u5982\u201c15W\u201d\u653e\u5728\u6bcf\u6708\uff08day-of-month\uff09\u5b57\u6bb5\u4e0a\u8868\u793a\u4e3a\u201c\u5230\u672c\u670815\u65e5\u6700\u8fd1\u7684\u5de5\u4f5c\u65e5\u201d</p> <p>\u201c\u201c#\u201d\uff1a\u662f\u7528\u6765\u6307\u5b9a\u201c\u7684\u201d\u6bcf\u6708\u7b2cn\u4e2a\u5de5\u4f5c\u65e5,\u4f8b \u5728\u6bcf\u5468\uff08day-of-week\uff09\u8fd9\u4e2a\u5b57\u6bb5\u4e2d\u5185\u5bb9\u4e3a\"6#3\" or \"FRI#3\" \u5219\u8868\u793a\u201c\u6bcf\u6708\u7b2c\u4e09\u4e2a\u661f\u671f\u4e94\u201d</p> <p> </p> <p>1\uff09Cron\u8868\u8fbe\u5f0f\u7684\u683c\u5f0f\uff1a\u79d2 \u5206 \u65f6 \u65e5 \u6708 \u5468 \u5e74(\u53ef\u9009)\u3002</p> <p>\u5b57\u6bb5\u540d\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u5141\u8bb8\u7684\u503c\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u5141\u8bb8\u7684\u7279\u6b8a\u5b57\u7b26 \u79d2\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0 0-59\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 , - * / \u5206\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0-59\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 , - * / \u5c0f\u65f6\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0 0-23\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 , - * / \u65e5\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0 1-31\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 , - * ? / L W C \u6708\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 1-12 or JAN-DEC\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0, - * / \u5468\u51e0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 1-7 or SUN-SAT\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0, - * ? / L C # \u5e74 (\u53ef\u9009\u5b57\u6bb5)\u00a0\u00a0\u00a0\u00a0 empty, 1970-2099\u00a0\u00a0\u00a0\u00a0\u00a0 , - * /</p> <p> </p> <p>\u201c?\u201d\u5b57\u7b26\uff1a\u8868\u793a\u4e0d\u786e\u5b9a\u7684\u503c</p> <p>\u201c,\u201d\u5b57\u7b26\uff1a\u6307\u5b9a\u6570\u4e2a\u503c</p> <p>\u201c-\u201d\u5b57\u7b26\uff1a\u6307\u5b9a\u4e00\u4e2a\u503c\u7684\u8303\u56f4</p> <p>\u201c/\u201d\u5b57\u7b26\uff1a\u6307\u5b9a\u4e00\u4e2a\u503c\u7684\u589e\u52a0\u5e45\u5ea6\u3002n/m\u8868\u793a\u4ecen\u5f00\u59cb\uff0c\u6bcf\u6b21\u589e\u52a0m</p> <p>\u201cL\u201d\u5b57\u7b26\uff1a\u7528\u5728\u65e5\u8868\u793a\u4e00\u4e2a\u6708\u4e2d\u7684\u6700\u540e\u4e00\u5929\uff0c\u7528\u5728\u5468\u8868\u793a\u8be5\u6708\u6700\u540e\u4e00\u4e2a\u661f\u671fX</p> <p>\u201cW\u201d\u5b57\u7b26\uff1a\u6307\u5b9a\u79bb\u7ed9\u5b9a\u65e5\u671f\u6700\u8fd1\u7684\u5de5\u4f5c\u65e5(\u5468\u4e00\u5230\u5468\u4e94)</p> <p>\u201c#\u201d\u5b57\u7b26\uff1a\u8868\u793a\u8be5\u6708\u7b2c\u51e0\u4e2a\u5468X\u30026#3\u8868\u793a\u8be5\u6708\u7b2c3\u4e2a\u5468\u4e94</p> <p> </p> <p> </p> <p>2\uff09Cron\u8868\u8fbe\u5f0f\u8303\u4f8b\uff1a</p> <p>\u6bcf\u96945\u79d2\u6267\u884c\u4e00\u6b21\uff1a*/5 * * * * ?</p> <p>\u6bcf\u96941\u5206\u949f\u6267\u884c\u4e00\u6b21\uff1a0 */1 * * * ?</p> <p>\u6bcf\u592923\u70b9\u6267\u884c\u4e00\u6b21\uff1a0 0 23 * * ?</p> <p>\u6bcf\u5929\u51cc\u66681\u70b9\u6267\u884c\u4e00\u6b21\uff1a0 0 1 * * ?</p> <p>\u6bcf\u67081\u53f7\u51cc\u66681\u70b9\u6267\u884c\u4e00\u6b21\uff1a0 0 1 1 * ?</p> <p>\u6bcf\u6708\u6700\u540e\u4e00\u592923\u70b9\u6267\u884c\u4e00\u6b21\uff1a0 0 23 L * ?</p> <p>\u6bcf\u5468\u661f\u671f\u5929\u51cc\u66681\u70b9\u5b9e\u884c\u4e00\u6b21\uff1a0 0 1 ? * L</p> <p>\u572826\u5206\u300129\u5206\u300133\u5206\u6267\u884c\u4e00\u6b21\uff1a0 26,29,33 * * * ?</p> <p>\u6bcf\u5929\u76840\u70b9\u300113\u70b9\u300118\u70b9\u300121\u70b9\u90fd\u6267\u884c\u4e00\u6b21\uff1a0 0 0,13,18,21 * * ?</p> <p>\u6458\u81ea\u300ehttp://www.cnblogs.com/sunjie9606/archive/2012/03/15/2397626.html\u300f</p>","tags":["QuartZ","Cron"]},{"location":"DevOps/2015-12-09-%25e5%2588%25a9%25e7%2594%25a8cors%25e5%25ae%259e%25e7%258e%25b0js%25e8%25b7%25a8%25e5%259f%259f%25e8%25ae%25bf%25e9%2597%25ae.html/","title":"\u5229\u7528cors\u5b9e\u73b0js\u8de8\u57df\u8bbf\u95ee","text":"<p>\u6211\u9a8c\u8bc1\u4e86\u4e24\u4e2a\uff0c\u4e00\u4e2a\u662ftomcat\u4e0b\u81ea\u5e26\u7684cors\u8fc7\u6ee4\u5668\uff0c\u4e00\u4e2a\u662fcors-filter-1.7.jar\u4e0b\u7684\u8fc7\u6ee4\u5668\u3002\u4e24\u4e2a\u6211\u90fd\u6d4b\u8bd5\u4e86\uff0c\u6ca1\u95ee\u9898\u3002</p> <p>\u5e94\u7528tomcat\u7684filter\u914d\u7f6e\u5982\u4e0b\uff1a\u53c2\u6570cors.allowOrigin\u53ef\u4ee5\u6307\u5b9a\u5177\u4f53\u7684\u6e90\u6765\u8bbf\u95ee</p> <pre>\n  CorsFilter\n  org.apache.catalina.filters.CorsFilter\n  \n    cors.allowed.origins\n    *\n  \n  \n    cors.allowed.methods\n    GET,POST,HEAD,OPTIONS,PUT\n  \n  \n    cors.allowed.headers\n    Content-Type,X-Requested-With,accept,Origin,Access-Control-Request-Method,Access-Control-Request-Headers\n  \n  \n    cors.exposed.headers\n    Access-Control-Allow-Origin,Access-Control-Allow-Credentials\n  \n  \n    cors.support.credentials\n    true\n  \n  \n    cors.preflight.maxage\n    10\n  \n\n\n  CorsFilter\n  /*\n</pre> <p>\u6216\u8005\u5e94\u7528cors-filter-1.7.jar\uff0c\u8fd8\u9700\u8981java-property-utils-1.9.jar\uff0c\u53ef\u4ee5\u5728http://mvnrepository.com/artifact/com.thetransactioncompany/cors-filter \u9009\u62e9\u67d0\u4e2a\u7248\u672c\u5bfc\u5165pom.xml\u4e2d\uff0c\u81ea\u52a8\u5bfc\u5165jar\u5305\u3002</p> <p>\u914d\u7f6e\u5982\u4e0b\uff1a\u53c2\u6570cors.allowOrigin\u53ef\u4ee5\u6307\u5b9a\u5177\u4f53\u7684\u6e90\u6765\u8bbf\u95ee</p> <pre>\n    CORS\n    com.thetransactioncompany.cors.CORSFilter\n    \n     cors.allowOrigin\n        *\n    \n    \n     cors.supportedMethods\n        GET, POST, HEAD, PUT, DELETE\n    \n    \n     cors.supportedHeaders\n        Accept, Origin, X-Requested-With, Content-Type, Last-Modified\n    \n    \n        cors.exposedHeaders\n        Set-Cookie\n    \n    \n        cors.supportsCredentials\n        true\n    \n\n\n    CORS\n    /*\n</pre> \u6458\u81ea\u300ehttp://www.cnblogs.com/chiyouguli/p/4283349.html\u300f <p> </p>","tags":["cors","js\u8de8\u57df"]},{"location":"DevOps/2015-12-19-web-xml-%25e4%25b8%25ad%25e7%259a%2584listener%25e3%2580%2581-filter%25e3%2580%2581servlet-%25e5%258a%25a0%25e8%25bd%25bd%25e9%25a1%25ba%25e5%25ba%258f.html/","title":"web.xml \u4e2d\u7684listener\u3001 filter\u3001servlet \u52a0\u8f7d\u987a\u5e8f\u6781\u5176\u8be6\u89e3","text":"<p>\u5728\u9879\u76ee\u4e2d\u603b\u4f1a\u9047\u5230\u4e00\u4e9b\u5173\u4e8e\u52a0\u8f7d\u7684\u4f18\u5148\u7ea7\u95ee\u9898\uff0c\u8fd1\u671f\u4e5f\u540c\u6837\u9047\u5230\u8fc7\u7c7b\u4f3c\u7684\uff0c\u6240\u4ee5\u81ea\u5df1\u67e5\u627e\u8d44\u6599\u603b\u7ed3\u4e86\u4e0b\uff0c\u4e0b\u9762\u6709\u4e9b\u662f\u8f6c\u8f7d\u5176\u4ed6\u4eba\u7684\uff0c\u6bd5\u7adf\u4eba\u5bb6\u5199\u7684\u4e0d\u9519\uff0c\u81ea\u5df1\u4e5f\u5c31\u4e0d\u91cd\u590d\u9020\u8f6e\u5b50\u4e86\uff0c\u53ea\u662f\u7565\u52a0\u70b9\u4e86\u81ea\u5df1\u7684\u4fee\u9970\u3002</p> <p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u9996\u5148\u53ef\u4ee5\u80af\u5b9a\u7684\u662f\uff0c\u52a0\u8f7d\u987a\u5e8f\u4e0e\u5b83\u4eec\u5728 web.xml \u6587\u4ef6\u4e2d\u7684\u5148\u540e\u987a\u5e8f\u65e0\u5173\u3002\u5373\u4e0d\u4f1a\u56e0\u4e3a filter \u5199\u5728 listener \u7684\u524d\u9762\u800c\u4f1a\u5148\u52a0\u8f7d filter\u3002\u6700\u7ec8\u5f97\u51fa\u7684\u7ed3\u8bba\u662f\uff1alistener -&gt; filter -&gt; servlet</p> <p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u540c\u65f6\u8fd8\u5b58\u5728\u7740\u8fd9\u6837\u4e00\u79cd\u914d\u7f6e\u8282\uff1acontext-param\uff0c\u5b83\u7528\u4e8e\u5411 ServletContext \u63d0\u4f9b\u952e\u503c\u5bf9\uff0c\u5373\u5e94\u7528\u7a0b\u5e8f\u4e0a\u4e0b\u6587\u4fe1\u606f\u3002\u6211\u4eec\u7684 listener, filter \u7b49\u5728\u521d\u59cb\u5316\u65f6\u4f1a\u7528\u5230\u8fd9\u4e9b\u4e0a\u4e0b\u6587\u4e2d\u7684\u4fe1\u606f\uff0c\u90a3\u4e48 context-param \u914d\u7f6e\u8282\u662f\u4e0d\u662f\u5e94\u8be5\u5199\u5728 listener \u914d\u7f6e\u8282\u524d\u5462\uff1f\u5b9e\u9645\u4e0a context-param \u914d\u7f6e\u8282\u53ef\u5199\u5728\u4efb\u610f\u4f4d\u7f6e\uff0c\u56e0\u6b64\u771f\u6b63\u7684\u52a0\u8f7d\u987a\u5e8f\u4e3a\uff1acontext-param -&gt; listener -&gt; filter -&gt; servlet</p> <p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u5bf9\u4e8e\u67d0\u7c7b\u914d\u7f6e\u8282\u800c\u8a00\uff0c\u4e0e\u5b83\u4eec\u51fa\u73b0\u7684\u987a\u5e8f\u662f\u6709\u5173\u7684\u3002\u4ee5 filter \u4e3a\u4f8b\uff0cweb.xml \u4e2d\u5f53\u7136\u53ef\u4ee5\u5b9a\u4e49\u591a\u4e2a filter\uff0c\u4e0e filter \u76f8\u5173\u7684\u4e00\u4e2a\u914d\u7f6e\u8282\u662f filter-mapping\uff0c\u8fd9\u91cc\u4e00\u5b9a\u8981\u6ce8\u610f\uff0c\u5bf9\u4e8e\u62e5\u6709\u76f8\u540c filter-name \u7684 filter \u548c filter-mapping \u914d\u7f6e\u8282\u800c\u8a00\uff0cfilter-mapping \u5fc5\u987b\u51fa\u73b0\u5728 filter \u4e4b\u540e\uff0c\u5426\u5219\u5f53\u89e3\u6790\u5230 filter-mapping \u65f6\uff0c\u5b83\u6240\u5bf9\u5e94\u7684 filter-name \u8fd8\u672a\u5b9a\u4e49\u3002web \u5bb9\u5668\u542f\u52a8\u65f6\u521d\u59cb\u5316\u6bcf\u4e2a filter \u65f6\uff0c\u662f\u6309\u7167 filter \u914d\u7f6e\u8282\u51fa\u73b0\u7684\u987a\u5e8f\u6765\u521d\u59cb\u5316\u7684\uff0c\u5f53\u8bf7\u6c42\u8d44\u6e90\u5339\u914d\u591a\u4e2a filter-mapping \u65f6\uff0cfilter \u62e6\u622a\u8d44\u6e90\u662f\u6309\u7167 filter-mapping \u914d\u7f6e\u8282\u51fa\u73b0\u7684\u987a\u5e8f\u6765\u4f9d\u6b21\u8c03\u7528 doFilter() \u65b9\u6cd5\u7684\u3002</p> <p> servlet \u540c filter \u7c7b\u4f3c \uff0c\u6b64\u5904\u4e0d\u518d\u8d58\u8ff0\u3002</p> <p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u7531\u6b64\uff0c\u53ef\u4ee5\u770b\u51fa\uff0cweb.xml \u7684\u52a0\u8f7d\u987a\u5e8f\u662f\uff1acontext-param -&gt; listener -&gt; filter -&gt; servlet \uff0c\u800c\u540c\u4e2a\u7c7b\u578b\u4e4b\u95f4\u7684\u5b9e\u9645\u7a0b\u5e8f\u8c03\u7528\u7684\u65f6\u5019\u7684\u987a\u5e8f\u662f\u6839\u636e\u5bf9\u5e94\u7684 mapping \u7684\u987a\u5e8f\u8fdb\u884c\u8c03\u7528\u7684\u3002</p> <p>web.xml\u6587\u4ef6\u8be6\u89e3 ======================================================================== Web.xml\u5e38\u7528\u5143\u7d20 \u5b9a\u4e49\u4e86WEB\u5e94\u7528\u7684\u540d\u5b57  \u58f0\u660eWEB\u5e94\u7528\u7684\u63cf\u8ff0\u4fe1\u606f <p> context-param\u5143\u7d20\u58f0\u660e\u5e94\u7528\u8303\u56f4\u5185\u7684\u521d\u59cb\u5316\u53c2\u6570\u3002  \u8fc7\u6ee4\u5668\u5143\u7d20\u5c06\u4e00\u4e2a\u540d\u5b57\u4e0e\u4e00\u4e2a\u5b9e\u73b0javax.servlet.Filter\u63a5\u53e3\u7684\u7c7b\u76f8\u5173\u8054\u3002  \u4e00\u65e6\u547d\u540d\u4e86\u4e00\u4e2a\u8fc7\u6ee4\u5668\uff0c\u5c31\u8981\u5229\u7528filter-mapping\u5143\u7d20\u628a\u5b83\u4e0e\u4e00\u4e2a\u6216\u591a\u4e2aservlet\u6216JSP\u9875\u9762\u76f8\u5173\u8054\u3002</p> servlet API\u7684\u7248\u672c2.3\u589e\u52a0\u4e86\u5bf9\u4e8b\u4ef6\u76d1\u542c\u7a0b\u5e8f\u7684\u652f\u6301\uff0c\u4e8b\u4ef6\u76d1\u542c\u7a0b\u5e8f\u5728\u5efa\u7acb\u3001\u4fee\u6539\u548c\u5220\u9664\u4f1a\u8bdd\u6216servlet\u73af\u5883\u65f6\u5f97\u5230\u901a\u77e5\u3002 Listener\u5143\u7d20\u6307\u51fa\u4e8b\u4ef6\u76d1\u542c\u7a0b\u5e8f\u7c7b\u3002  \u5728\u5411servlet\u6216JSP\u9875\u9762\u5236\u5b9a\u521d\u59cb\u5316\u53c2\u6570\u6216\u5b9a\u5236URL\u65f6\uff0c\u5fc5\u987b\u9996\u5148\u547d\u540dservlet\u6216JSP\u9875\u9762\u3002Servlet\u5143\u7d20\u5c31\u662f\u7528\u6765\u5b8c\u6210\u6b64\u9879\u4efb\u52a1\u7684\u3002  \u670d\u52a1\u5668\u4e00\u822c\u4e3aservlet\u63d0\u4f9b\u4e00\u4e2a\u7f3a\u7701\u7684URL\uff1ahttp://host/webAppPrefix/servlet/ServletName\u3002 \u4f46\u662f\uff0c\u5e38\u5e38\u4f1a\u66f4\u6539\u8fd9\u4e2aURL\uff0c\u4ee5\u4fbfservlet\u53ef\u4ee5\u8bbf\u95ee\u521d\u59cb\u5316\u53c2\u6570\u6216\u66f4\u5bb9\u6613\u5730\u5904\u7406\u76f8\u5bf9URL\u3002\u5728\u66f4\u6539\u7f3a\u7701URL\u65f6\uff0c\u4f7f\u7528servlet-mapping\u5143\u7d20\u3002 <p> \u5982\u679c\u67d0\u4e2a\u4f1a\u8bdd\u5728\u4e00\u5b9a\u65f6\u95f4\u5185\u672a\u88ab\u8bbf\u95ee\uff0c\u670d\u52a1\u5668\u53ef\u4ee5\u629b\u5f03\u5b83\u4ee5\u8282\u7701\u5185\u5b58\u3002 \u53ef\u901a\u8fc7\u4f7f\u7528HttpSession\u7684setMaxInactiveInterval\u65b9\u6cd5\u660e\u786e\u8bbe\u7f6e\u5355\u4e2a\u4f1a\u8bdd\u5bf9\u8c61\u7684\u8d85\u65f6\u503c\uff0c\u6216\u8005\u53ef\u5229\u7528session-config\u5143\u7d20\u5236\u5b9a\u7f3a\u7701\u8d85\u65f6\u503c\u3002</p> <p>\u5982\u679cWeb\u5e94\u7528\u5177\u6709\u60f3\u5230\u7279\u6b8a\u7684\u6587\u4ef6\uff0c\u5e0c\u671b\u80fd\u4fdd\u8bc1\u7ed9\u4ed6\u4eec\u5206\u914d\u7279\u5b9a\u7684MIME\u7c7b\u578b\uff0c\u5219mime-mapping\u5143\u7d20\u63d0\u4f9b\u8fd9\u79cd\u4fdd\u8bc1\u3002  \u6307\u793a\u670d\u52a1\u5668\u5728\u6536\u5230\u5f15\u7528\u4e00\u4e2a\u76ee\u5f55\u540d\u800c\u4e0d\u662f\u6587\u4ef6\u540d\u7684URL\u65f6\uff0c\u4f7f\u7528\u54ea\u4e2a\u6587\u4ef6\u3002  \u5728\u8fd4\u56de\u7279\u5b9aHTTP\u72b6\u6001\u4ee3\u7801\u65f6\uff0c\u6216\u8005\u7279\u5b9a\u7c7b\u578b\u7684\u5f02\u5e38\u88ab\u629b\u51fa\u65f6\uff0c\u80fd\u591f\u5236\u5b9a\u5c06\u8981\u663e\u793a\u7684\u9875\u9762\u3002  \u5bf9\u6807\u8bb0\u5e93\u63cf\u8ff0\u7b26\u6587\u4ef6\uff08Tag Libraryu Descriptor file\uff09\u6307\u5b9a\u522b\u540d\u3002\u6b64\u529f\u80fd\u4f7f\u4f60\u80fd\u591f\u66f4\u6539TLD\u6587\u4ef6\u7684\u4f4d\u7f6e\uff0c \u800c\u4e0d\u7528\u7f16\u8f91\u4f7f\u7528\u8fd9\u4e9b\u6587\u4ef6\u7684JSP\u9875\u9762\u3002 \u58f0\u660e\u4e0e\u8d44\u6e90\u76f8\u5173\u7684\u4e00\u4e2a\u7ba1\u7406\u5bf9\u8c61\u3002  \u58f0\u660e\u4e00\u4e2a\u8d44\u6e90\u5de5\u5382\u4f7f\u7528\u7684\u5916\u90e8\u8d44\u6e90\u3002  \u5236\u5b9a\u5e94\u8be5\u4fdd\u62a4\u7684URL\u3002\u5b83\u4e0elogin-config\u5143\u7d20\u8054\u5408\u4f7f\u7528  \u6307\u5b9a\u670d\u52a1\u5668\u5e94\u8be5\u600e\u6837\u7ed9\u8bd5\u56fe\u8bbf\u95ee\u53d7\u4fdd\u62a4\u9875\u9762\u7684\u7528\u6237\u6388\u6743\u3002\u5b83\u4e0esercurity-constraint\u5143\u7d20\u8054\u5408\u4f7f\u7528\u3002 \u7ed9\u51fa\u5b89\u5168\u89d2\u8272\u7684\u4e00\u4e2a\u5217\u8868\uff0c\u8fd9\u4e9b\u89d2\u8272\u5c06\u51fa\u73b0\u5728servlet\u5143\u7d20\u5185\u7684security-role-ref\u5143\u7d20 \u7684role-name\u5b50\u5143\u7d20\u4e2d\u3002\u5206\u522b\u5730\u58f0\u660e\u89d2\u8272\u53ef\u4f7f\u9ad8\u7ea7IDE\u5904\u7406\u5b89\u5168\u4fe1\u606f\u66f4\u4e3a\u5bb9\u6613\u3002 \u58f0\u660eWeb\u5e94\u7528\u7684\u73af\u5883\u9879\u3002 \u58f0\u660e\u4e00\u4e2aEJB\u7684\u4e3b\u76ee\u5f55\u7684\u5f15\u7528\u3002 &lt; ejb-local-ref&gt;\u58f0\u660e\u4e00\u4e2aEJB\u7684\u672c\u5730\u4e3b\u76ee\u5f55\u7684\u5e94\u7528\u3002 </p> <p>\u76f8\u5e94\u5143\u7d20\u914d\u7f6e</p> <p>1\u3001Web\u5e94\u7528\u56fe\u6807\uff1a\u6307\u51faIDE\u548cGUI\u5de5\u5177\u7528\u6765\u8868\u793aWeb\u5e94\u7528\u7684\u5927\u56fe\u6807\u548c\u5c0f\u56fe\u6807 /images/app_small.gif /images/app_large.gif  2\u3001Web \u5e94\u7528\u540d\u79f0\uff1a\u63d0\u4f9bGUI\u5de5\u5177\u53ef\u80fd\u4f1a\u7528\u6765\u6807\u8bb0\u8fd9\u4e2a\u7279\u5b9a\u7684Web\u5e94\u7528\u7684\u4e00\u4e2a\u540d\u79f0 Tomcat Example 3\u3001Web \u5e94\u7528\u63cf\u8ff0\uff1a \u7ed9\u51fa\u4e8e\u6b64\u76f8\u5173\u7684\u8bf4\u660e\u6027\u6587\u672c Tomcat Example servlets and JSP pages. 4\u3001\u4e0a\u4e0b\u6587\u53c2\u6570\uff1a\u58f0\u660e\u5e94\u7528\u8303\u56f4\u5185\u7684\u521d\u59cb\u5316\u53c2\u6570\u3002 ContextParameter test It is a test parameter.  \u5728servlet\u91cc\u9762\u53ef\u4ee5\u901a\u8fc7getServletContext().getInitParameter(\"context/param\")\u5f97\u5230 <p>5\u3001\u8fc7\u6ee4\u5668\u914d\u7f6e\uff1a\u5c06\u4e00\u4e2a\u540d\u5b57\u4e0e\u4e00\u4e2a\u5b9e\u73b0javaxs.servlet.Filter\u63a5\u53e3\u7684\u7c7b\u76f8\u5173\u8054\u3002 setCharacterEncoding com.myTest.setCharacterEncodingFilter encoding GB2312 setCharacterEncoding /*  6\u3001\u76d1\u542c\u5668\u914d\u7f6e</p> listener.SessionListener  7\u3001Servlet\u914d\u7f6e \u57fa\u672c\u914d\u7f6e snoop SnoopServlet snoop /snoop  \u9ad8\u7ea7\u914d\u7f6e snoop SnoopServlet foo bar Security role for anonymous access tomcat snoop /snoop  \u5143\u7d20\u8bf4\u660e  \u7528\u6765\u58f0\u660e\u4e00\u4e2aservlet\u7684\u6570\u636e\uff0c\u4e3b\u8981\u6709\u4ee5\u4e0b\u5b50\u5143\u7d20\uff1a  \u6307\u5b9aservlet\u7684\u540d\u79f0  \u6307\u5b9aservlet\u7684\u7c7b\u540d\u79f0  \u6307\u5b9aweb\u7ad9\u53f0\u4e2d\u7684\u67d0\u4e2aJSP\u7f51\u9875\u7684\u5b8c\u6574\u8def\u5f84  \u7528\u6765\u5b9a\u4e49\u53c2\u6570\uff0c\u53ef\u6709\u591a\u4e2ainit-param\u3002\u5728servlet\u7c7b\u4e2d\u901a\u8fc7getInitParamenter(String name)\u65b9\u6cd5\u8bbf\u95ee\u521d\u59cb\u5316\u53c2\u6570 \u6307\u5b9a\u5f53Web\u5e94\u7528\u542f\u52a8\u65f6\uff0c\u88c5\u8f7dServlet\u7684\u6b21\u5e8f\u3002 \u5f53\u503c\u4e3a\u6b63\u6570\u6216\u96f6\u65f6\uff1aServlet\u5bb9\u5668\u5148\u52a0\u8f7d\u6570\u503c\u5c0f\u7684servlet\uff0c\u518d\u4f9d\u6b21\u52a0\u8f7d\u5176\u4ed6\u6570\u503c\u5927\u7684servlet. \u5f53\u503c\u4e3a\u8d1f\u6216\u672a\u5b9a\u4e49\uff1aServlet\u5bb9\u5668\u5c06\u5728Web\u5ba2\u6237\u9996\u6b21\u8bbf\u95ee\u8fd9\u4e2aservlet\u65f6\u52a0\u8f7d\u5b83  \u7528\u6765\u5b9a\u4e49servlet\u6240\u5bf9\u5e94\u7684URL\uff0c\u5305\u542b\u4e24\u4e2a\u5b50\u5143\u7d20  \u6307\u5b9aservlet\u7684\u540d\u79f0  \u6307\u5b9aservlet\u6240\u5bf9\u5e94\u7684URL 8\u3001\u4f1a\u8bdd\u8d85\u65f6\u914d\u7f6e\uff08\u5355\u4f4d\u4e3a\u5206\u949f\uff09 120  9\u3001MIME\u7c7b\u578b\u914d\u7f6e htm text/html  10\u3001\u6307\u5b9a\u6b22\u8fce\u6587\u4ef6\u9875\u914d\u7f6e index.jsp index.html index.htm  11\u3001\u914d\u7f6e\u9519\u8bef\u9875\u9762 \u4e00\u3001 \u901a\u8fc7\u9519\u8bef\u7801\u6765\u914d\u7f6eerror-page 404 /NotFound.jsp  \u4e0a\u9762\u914d\u7f6e\u4e86\u5f53\u7cfb\u7edf\u53d1\u751f404\u9519\u8bef\u65f6\uff0c\u8df3\u8f6c\u5230\u9519\u8bef\u5904\u7406\u9875\u9762NotFound.jsp\u3002 \u4e8c\u3001\u901a\u8fc7\u5f02\u5e38\u7684\u7c7b\u578b\u914d\u7f6eerror-page java.lang.NullException /error.jsp  \u4e0a\u9762\u914d\u7f6e\u4e86\u5f53\u7cfb\u7edf\u53d1\u751fjava.lang.NullException\uff08\u5373\u7a7a\u6307\u9488\u5f02\u5e38\uff09\u65f6\uff0c\u8df3\u8f6c\u5230\u9519\u8bef\u5904\u7406\u9875\u9762error.jsp 12\u3001TLD\u914d\u7f6e http://jakarta.apache.org/tomcat/debug-taglib /WEB-INF/jsp/debug-taglib.tld  \u5982\u679cMyEclipse\u4e00\u76f4\u5728\u62a5\u9519,\u5e94\u8be5\u628a \u653e\u5230 \u4e2d http://jakarta.apache.org/tomcat/debug-taglib /WEB-INF/pager-taglib.tld  13\u3001\u8d44\u6e90\u7ba1\u7406\u5bf9\u8c61\u914d\u7f6e jms/StockQueue  14\u3001\u8d44\u6e90\u5de5\u5382\u914d\u7f6e mail/Session javax.mail.Session Container  \u914d\u7f6e\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u5c31\u53ef\u5728\u6b64\u914d\u7f6e\uff1a JNDI JDBC DataSource of shop jdbc/sample_db javax.sql.DataSource Container  15\u3001\u5b89\u5168\u9650\u5236\u914d\u7f6e Example Security Constraint Protected Area /jsp/security/protected/* DELETE GET POST PUT tomcat role1  16\u3001\u767b\u9646\u9a8c\u8bc1\u914d\u7f6e FORM Example-Based Authentiation Area /jsp/security/protected/login.jsp /jsp/security/protected/error.jsp  17\u3001\u5b89\u5168\u89d2\u8272\uff1asecurity-role\u5143\u7d20\u7ed9\u51fa\u5b89\u5168\u89d2\u8272\u7684\u4e00\u4e2a\u5217\u8868\uff0c\u8fd9\u4e9b\u89d2\u8272\u5c06\u51fa\u73b0\u5728servlet\u5143\u7d20\u5185\u7684security-role-ref\u5143\u7d20\u7684role-name\u5b50\u5143\u7d20\u4e2d\u3002 \u5206\u522b\u5730\u58f0\u660e\u89d2\u8272\u53ef\u4f7f\u9ad8\u7ea7IDE\u5904\u7406\u5b89\u5168\u4fe1\u606f\u66f4\u4e3a\u5bb9\u6613\u3002 tomcat  18\u3001Web\u73af\u5883\u53c2\u6570\uff1aenv-entry\u5143\u7d20\u58f0\u660eWeb\u5e94\u7528\u7684\u73af\u5883\u9879 minExemptions 1 java.lang.Integer  19\u3001EJB \u58f0\u660e Example EJB reference ejb/Account Entity com.mycompany.mypackage.AccountHome com.mycompany.mypackage.Account  20\u3001\u672c\u5730EJB\u58f0\u660e Example Loacal EJB reference ejb/ProcessOrder Session com.mycompany.mypackage.ProcessOrderHome com.mycompany.mypackage.ProcessOrder  21\u3001\u914d\u7f6eDWR dwr-invoker uk.ltd.getahead.dwr.DWRServlet dwr-invoker /dwr/*  22\u3001\u914d\u7f6eStruts Struts Blank Application action  org.apache.struts.action.ActionServlet detail 2 debug 2 config /WEB-INF/struts-config.xml application ApplicationResources 2 action *.do index.jsp <p> struts-bean /WEB-INF/tld/struts-bean.tld struts-html /WEB-INF/tld/struts-html.tld struts-nested /WEB-INF/tld/struts-nested.tld struts-logic /WEB-INF/tld/struts-logic.tld struts-tiles /WEB-INF/tld/struts-tiles.tld  23\u3001\u914d\u7f6eSpring\uff08\u57fa\u672c\u4e0a\u90fd\u662f\u5728Struts\u4e2d\u914d\u7f6e\u7684\uff09</p> <p> contextConfigLocation  /WEB-INF/applicationContext.xml, /WEB-INF/action-servlet.xml  </p> <p></p> org.springframework.web.context.ContextLoaderListener  org.springframework.web.context.request.RequestContextListener  \u6458\u81ea\u300ehttp://www.cnblogs.com/JesseV/archive/2009/11/17/1605015.html\u300f","tags":["web.xml","servelt","listener","filter"]},{"location":"DevOps/2015-12-25-maven-profiles-for-different-environments/","title":"maven \u5982\u4f55\u4e3a\u5f00\u53d1\u548c\u751f\u4ea7\u73af\u5883\u5efa\u7acb\u4e0d\u540c\u7684\u914d\u7f6e\u6587\u4ef6","text":"<p><code>src/main</code>\u76ee\u5f55\u4e0b\u539f\u6765\u6709 <code>java</code>, <code>resources</code>, \u65b0\u5efa\u73af\u5883\u76f8\u5173\u7684\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\uff1a</p> <ul> <li>resources : \u4e00\u4e9b\u5171\u4eab\u7684\u914d\u7f6e\u6587\u4ef6</li> <li>environment/dev : \u5f00\u53d1\u73af\u5883\u4e0b\u7528\u7684\u914d\u7f6e\u6587\u4ef6, \u6253\u5305\u65f6\u4f1a\u8986\u76d6resources\u76ee\u5f55\u4e0b\u7684\u540c\u540d\u6587\u4ef6.</li> <li>environment/test : \u6d4b\u8bd5\u73af\u5883\u4e0b\u7528\u7684\u914d\u7f6e\u6587\u4ef6, \u6253\u5305\u65f6\u4f1a\u8986\u76d6resources\u76ee\u5f55\u4e0b\u7684\u540c\u540d\u6587\u4ef6.</li> <li>environment/prod : \u751f\u4ea7\u73af\u5883\u4e0b\u7528\u7684\u914d\u7f6e\u6587\u4ef6, \u6253\u5305\u65f6\u4f1a\u8986\u76d6resources\u76ee\u5f55\u4e0b\u7684\u540c\u540d\u6587\u4ef6.</li> </ul> <p>\u672c\u673a\u5f00\u53d1\u65f6\u8bbe\u7f6e\u6e90\u7801\u76ee\u5f55\u4e3a java, resources, \u53ef\u76f4\u63a5\u5f00\u53d1\u8c03\u8bd5.</p> <p>\u7f16\u8bd1\u7684\u65f6\u5019\u5e0c\u671bmaven\u6839\u636e\u4e0d\u540c\u73af\u5883, \u6253\u5305\u4e0d\u540c\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6, \u6211\u4eec\u5229\u7528maven\u7684profile\u548cmaven-resources-plugin\u63d2\u4ef6\u6765\u5b9e\u73b0\u8fd9\u4e2a\u76ee\u6807.</p> <p>e.g. \u8fd0\u884c <code>mvn clean package -P test</code> \u6253\u5305.</p> <p><code>pom.xml</code> \u76f8\u5173\u914d\u7f6e\u5982\u4e0b\uff1a</p> <pre><code>    &lt;!-- == \u914d\u7f6e\u5f00\u53d1/\u6d4b\u8bd5/\u751f\u4ea7\u73af\u5883 == --&gt;\n    &lt;properties&gt;\n        &lt;package.target&gt;prod&lt;/package.target&gt;\n    &lt;/properties&gt;\n\n    &lt;profiles&gt;\n        &lt;profile&gt;\n            &lt;id&gt;dev&lt;/id&gt;\n            &lt;properties&gt;\n                &lt;package.target&gt;dev&lt;/package.target&gt;\n            &lt;/properties&gt;\n        &lt;/profile&gt;\n        &lt;profile&gt;\n            &lt;id&gt;test&lt;/id&gt;\n            &lt;properties&gt;\n                &lt;package.target&gt;test&lt;/package.target&gt;\n            &lt;/properties&gt;\n        &lt;/profile&gt;\n        &lt;profile&gt;\n            &lt;id&gt;prod&lt;/id&gt;\n            &lt;properties&gt;\n                &lt;package.target&gt;prod&lt;/package.target&gt;\n            &lt;/properties&gt;\n        &lt;/profile&gt;\n    &lt;/profiles&gt;\n\n    &lt;!-- == \u4f7f\u7528maven-resources-plugin\u62f7\u8d1d\u4e0d\u540c\u73af\u5883\u4e0b\u7684\u8d44\u6e90 == --&gt;\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt;\n                &lt;version&gt;2.5&lt;/version&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;id&gt;copy-resources&lt;/id&gt;\n                        &lt;phase&gt;generate-resources&lt;/phase&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;copy-resources&lt;/goal&gt;\n                        &lt;/goals&gt;\n                        &lt;configuration&gt;\n                            &lt;outputDirectory&gt;target/classes&lt;/outputDirectory&gt;\n                            &lt;resources&gt;\n                                &lt;resource&gt;\n                                    &lt;directory&gt;src/main/environment/${package.target}&lt;/directory&gt;\n                                &lt;/resource&gt;\n                            &lt;/resources&gt;\n                        &lt;/configuration&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n</code></pre>","tags":["maven","package"]},{"location":"DevOps/2016-01-03-jssc-library-for-easy-work-with-serial-ports.html/","title":"jSSC library - for easy work with serial ports","text":"<p>jSSC (Java Simple Serial Connector) - library for work with serial port from Java. The library was created as a simple and reliable replacement of existing facilities. Briefly about the opportunities it provides. With jSSC you can get the port names, read and write data, control lines RTS and DTR, receive Event etc. jSSC designed to operate 24/7 multi-threaded systems and is currently successfully used in automation, data collection and recording. Now let me give a few examples of actual work with the component.</p> <p>Example 1. Getting the names of serial ports:</p> <pre>import jssc.SerialPortList;\n\u00a0\npublic class Main {\n\u00a0\n    public static void main(String[] args) {\n        //Method getPortNames() returns an array of strings. Elements of the array is already sorted.\n        String[] portNames = SerialPortList.getPortNames();\n        for(int i = 0; i &lt; portNames.length; i++){\n            System.out.println(portNames[i]);\n        }\n    }\n}</pre> <p>Example 2. Read and write data:</p> <pre>import jssc.SerialPort;\nimport jssc.SerialPortException;\n\u00a0\npublic class Main {\n\u00a0\n    public static void main(String[] args) {\n        //In the constructor pass the name of the port with which we work\n        SerialPort serialPort = new SerialPort(\"COM1\");\n        try {\n            //Open port\n            serialPort.openPort();\n            //We expose the settings. You can also use this line - serialPort.setParams(9600, 8, 1, 0);\n            serialPort.setParams(SerialPort.BAUDRATE_9600, \n                                 SerialPort.DATABITS_8,\n                                 SerialPort.STOPBITS_1,\n                                 SerialPort.PARITY_NONE);\n            //Writes data to port\n            serialPort.writeBytes(\"Test\");\n            //Read the data of 10 bytes. Be careful with the method readBytes(), if the number of bytes in the input buffer\n            //is less than you need, then the method will wait for the right amount. Better to use it in conjunction with the\n            //interface SerialPortEventListener.\n            byte[] buffer = serialPort.readBytes(10);\n            //Closing the port\n            serialPort.closePort();\n        }\n        catch (SerialPortException ex) {\n            System.out.println(ex);\n        }\n    }\n}</pre> <p>Example 3. Read and write data using the interface SerialPortEventListener:</p> <pre>import jssc.SerialPort;\nimport jssc.SerialPortEvent;\nimport jssc.SerialPortEventListener;\nimport jssc.SerialPortException;\n\u00a0\npublic class Main {\n\u00a0\n    static SerialPort serialPort;\n\u00a0\n    public static void main(String[] args) {\n        serialPort = new SerialPort(\"COM1\"); \n        try {\n            serialPort.openPort();\n            serialPort.setParams(9600, 8, 1, 0);\n            //Preparing a mask. In a mask, we need to specify the types of events that we want to track.\n            //Well, for example, we need to know what came some data, thus in the mask must have the\n            //following value: MASK_RXCHAR. If we, for example, still need to know about changes in states \n            //of lines CTS and DSR, the mask has to look like this: SerialPort.MASK_RXCHAR + SerialPort.MASK_CTS + SerialPort.MASK_DSR\n            int mask = SerialPort.MASK_RXCHAR;\n            //Set the prepared mask\n            serialPort.setEventsMask(mask);\n            //Add an interface through which we will receive information about events\n            serialPort.addEventListener(new SerialPortReader());\n        }\n        catch (SerialPortException ex) {\n            System.out.println(ex);\n        }\n    }\n\u00a0\n    static class SerialPortReader implements SerialPortEventListener {\n\u00a0\n        public void serialEvent(SerialPortEvent event) {\n            //Object type SerialPortEvent carries information about which event occurred and a value.\n            //For example, if the data came a method event.getEventValue() returns us the number of bytes in the input buffer.\n            if(event.isRXCHAR()){\n                if(event.getEventValue() == 10){\n                    try {\n                        byte buffer[] = serialPort.readBytes(10);\n                    }\n                    catch (SerialPortException ex) {\n                        System.out.println(ex);\n                    }\n                }\n            }\n            //If the CTS line status has changed, then the method event.getEventValue() returns 1 if the line is ON and 0 if it is OFF.\n            else if(event.isCTS()){\n                if(event.getEventValue() == 1){\n                    System.out.println(\"CTS - ON\");\n                }\n                else {\n                    System.out.println(\"CTS - OFF\");\n                }\n            }\n            else if(event.isDSR()){\n                if(event.getEventValue() == 1){\n                    System.out.println(\"DSR - ON\");\n                }\n                else {\n                    System.out.println(\"DSR - OFF\");\n                }\n            }\n        }\n    }\n}</pre> <p>Here are a few examples to work with the component. I wish you success. At the moment there is a stable implementation of the libraries under Win32 (Win98-Win7).</p> <p>\u6458\u81ea\u300ehttp://www.javaprogrammingforums.com/java-se-api-tutorials/5603-jssc-library-easy-work-serial-ports.html\u300f</p> <p>GitHub\uff1ahttps://github.com/scream3r/java-simple-serial-connector</p>","tags":["jssc","serial"]},{"location":"DevOps/2016-01-03-netty-websocket-%25e7%25a4%25ba%25e4%25be%258b.html/","title":"Netty WebSocket \u793a\u4f8b","text":"<p>\u4ee3\u7801:</p> <p>Server</p> <pre>package netty.protocol.websocket.server;\n\nimport io.netty.bootstrap.ServerBootstrap;\nimport io.netty.channel.Channel;\nimport io.netty.channel.ChannelInitializer;\nimport io.netty.channel.ChannelPipeline;\nimport io.netty.channel.EventLoopGroup;\nimport io.netty.channel.nio.NioEventLoopGroup;\nimport io.netty.channel.socket.SocketChannel;\nimport io.netty.channel.socket.nio.NioServerSocketChannel;\nimport io.netty.handler.codec.http.HttpObjectAggregator;\nimport io.netty.handler.codec.http.HttpServerCodec;\nimport io.netty.handler.stream.ChunkedWriteHandler;\n\n/**\n * TODO\n *\n * @description\n * @author ez\n * @time 2015\u5e746\u67083\u65e5 \u4e0b\u53484:42:31\n */\npublic class WebSocketServer {\n    public void run(int port) throws Exception {\n        EventLoopGroup bossGroup = new NioEventLoopGroup();\n        EventLoopGroup workerGroup = new NioEventLoopGroup();\n        try {\n            ServerBootstrap b = new ServerBootstrap();\n            b.group(bossGroup, workerGroup)\n                    .channel(NioServerSocketChannel.class)\n                    .childHandler(new ChannelInitializer() {\n\n                        @Override\n                        protected void initChannel(SocketChannel ch)\n                                throws Exception {\n                            ChannelPipeline pipeline = ch.pipeline();\n                            /*\n                             * HttpServerCodec ,\u5c06\u8bf7\u6c42\u548c\u5e94\u7b54\u6d88\u606f\u7f16\u7801\u6216\u8005\u89e3\u7801\u4e3aHTTP\u6d88\u606f\n                             */\n                            pipeline.addLast(\"http-codec\",\n                                    new HttpServerCodec());\n                            /*\n                             * HttpObjectAggregator ,\n                             * \u5c06HTTP\u6d88\u606f\u7684\u591a\u4e2a\u90e8\u5206\u7ec4\u5408\u6210\u4e00\u6761\u5b8c\u6574\u7684HTTP\u6d88\u606f;\n                             */\n                            pipeline.addLast(\"aggregator\",\n                                    new HttpObjectAggregator(65536));\n                            /*\n                             * ChunkedWriteHandler ,\n                             * \u7684\u4e3b\u8981\u4f5c\u7528\u662f\u652f\u6301\u5f02\u6b65\u53d1\u9001\u5927\u7684\u7801\u6d41(\u4f8b\u5982\u5927\u6587\u4ef6\u4f20\u8f93),\u4f46\u4e0d\u5360\u7528\u8fc7\u591a\u7684\u5185\u5b58,\u9632\u6b62JAVA\u5185\u5b58\u6ea2\u51fa\n                             */\n                            ch.pipeline().addLast(\"http-chunked\",\n                                    new ChunkedWriteHandler());\n                            /*\n                             * WebSocketServerHandler \u81ea\u5df1\u7684\u4e1a\u52a1\u5904\u7406\n                             */\n                            pipeline.addLast(\"handler\",\n                                    new WebSocketServerHandler());\n                        }\n                    });\n\n            Channel ch = b.bind(port).sync().channel();\n            System.out.println(\"Web socket server started at port \" + port\n                    + '.');\n            System.out\n                    .println(\"Open your browser and navigate to http://localhost:\"\n                            + port + '/');\n\n            ch.closeFuture().sync();\n        } finally {\n            bossGroup.shutdownGracefully();\n            workerGroup.shutdownGracefully();\n        }\n    }\n\n    public static void main(String[] args) throws Exception {\n        int port = 8080;\n        if (args.length &gt; 0) {\n            try {\n                port = Integer.parseInt(args[0]);\n            } catch (NumberFormatException e) {\n                e.printStackTrace();\n            }\n        }\n        new WebSocketServer().run(port);\n    }\n}\n\n\n<p>\u00a0</p>\n<p>Handler</p>\n\n\n<pre>package netty.protocol.websocket.server;\n\nimport static io.netty.handler.codec.http.HttpHeaders.isKeepAlive;\nimport static io.netty.handler.codec.http.HttpHeaders.setContentLength;\nimport static io.netty.handler.codec.http.HttpResponseStatus.BAD_REQUEST;\nimport static io.netty.handler.codec.http.HttpVersion.HTTP_1_1;\nimport io.netty.buffer.ByteBuf;\nimport io.netty.buffer.Unpooled;\nimport io.netty.channel.ChannelFuture;\nimport io.netty.channel.ChannelFutureListener;\nimport io.netty.channel.ChannelHandlerContext;\nimport io.netty.channel.SimpleChannelInboundHandler;\nimport io.netty.handler.codec.http.DefaultFullHttpResponse;\nimport io.netty.handler.codec.http.FullHttpRequest;\nimport io.netty.handler.codec.http.FullHttpResponse;\nimport io.netty.handler.codec.http.websocketx.CloseWebSocketFrame;\nimport io.netty.handler.codec.http.websocketx.PingWebSocketFrame;\nimport io.netty.handler.codec.http.websocketx.PongWebSocketFrame;\nimport io.netty.handler.codec.http.websocketx.TextWebSocketFrame;\nimport io.netty.handler.codec.http.websocketx.WebSocketFrame;\nimport io.netty.handler.codec.http.websocketx.WebSocketServerHandshaker;\nimport io.netty.handler.codec.http.websocketx.WebSocketServerHandshakerFactory;\nimport io.netty.util.CharsetUtil;\n\nimport java.util.logging.Level;\nimport java.util.logging.Logger;\n\n/**\n * TODO\n *\n * @description\n * @author ez\n * @time 2015\u5e746\u67083\u65e5 \u4e0b\u53484:42:59\n */\npublic class WebSocketServerHandler extends SimpleChannelInboundHandler","tags":["netty","WebSocket"]},{"location":"DevOps/2016-01-03-swixml-sample-code.html/","title":"Swixml Sample Code","text":"Java and XML Sample Code <ol> <li>HelloWorld: Small Sample with Label, TextField, Button, and Submit Action <ul> <li>Java2Html | Source | XML | Screenshot</li> </ul> </li> <li>HelloMac: Small Sample, showing a some Mac features. <ul> <li>Java2Html | Source | XML | Screenshot</li> </ul> </li> <li>Eventhandling: Actions and ActionCommands <ul> <li>Java2Html | Source | XML | Screenshot</li> </ul> </li> <li>Accelerators and Mnemonics <ul> <li>Java2Html | Source | XML | Screenshot</li> </ul> </li> <li>Layout Managers <ul>JGoodies FormLayout Example <li>Java2Html | Source | XML Screenshot</li> </ul> <ul>GridBag Layout Example <li>Java2Html | Source | XML Screenshot</li> </ul> <ul>Card Layout Example <li>Java2Html | Source | XML | Screenshot</li> </ul> <ul>Fun with Layouts, a lot of different Layouts in an Internal Frame <li>Java2Html | Source | XML | Screenshot</li> </ul> </li> <li>Swixml and Localization <ul> <li>Java2Html | Source | XML | Screenshot</li> </ul> </li> <li>How to do Applets with Swixml <ul> <li>Java2Html | Source | XML | Screenshot</li> </ul> </li> <li>Extend the Swixml TagLibrary with your own tags <ul> <li>Java2Html | Source | XML | Screenshot</li> <li>Java2Html | Source</li> <li>Java2Html | Source</li> <li>Java2Html | Source</li> </ul> </li> <li>ComboBox Tag with an initclass attribute. <ul> <li>Java2Html | Source | XML | Screenshot</li> <li>Java2Html | Source</li> </ul> <p>The initclass is loaded, an instance is obtained and passed into the constructor of the tag's implementing class. <li>List Tag with an initclass attribute. <ul> <li>Java2Html | Source | XML | Screenshot</li> <li>Java2Html | Source</li> </ul> <p>The initclass is loaded, an instance is obtained and passed into the constructor of the tag's implementing class. <li>Swixml now understands some XPointer / XInclude syntax <ul> <li>Java2Html | Source | XML | XML | Screenshot</li> </ul> </li> <li>Custom Tags <ul> <li>Java2Html | Source | XML | Screenshot</li> </ul> </li> <li>Action Generator( public void myMethod() {..} instead of having to define public Action members. <ul> <li>Java2Html | Source | XML | Screenshot</li> </ul> </li> <p>\u6458\u81ea\u300ehttp://swixml.org/samples/index.html\u300f</p> <p>GitHub:\u00a0https://github.com/bsorrentino/swixml2 The goals of project is both to extend the original swixml project providing integration with Swing Application Framework (JSR 296) and Beans Binding (JSR 295) to further simplifying the GUI creation &amp; management and to provide a strict integration with maven </p>","tags":["swing","swixml"]},{"location":"DevOps/2016-01-08-maven-assembly-plugin-%25e6%2589%2593%25e5%258c%2585%25e5%258f%25af%25e6%2589%25a7%25e8%25a1%258cjar%25e5%258c%2585.html/","title":"maven-assembly-plugin \u6253\u5305\u53ef\u6267\u884cjar\u5305","text":"<pre>\n \n   \n     \n      maven-assembly-plugin  \n       \n        false  \n         \n          jar-with-dependencies \n          \n         \n           \n            the.Main \n           \n         \n        \n       \n         \n          make-assembly  \n          package  \n           \n            assembly \n           \n         \n       \n     \n   \n\n</pre>","tags":["maven"]},{"location":"DevOps/2016-01-16-secure-cookie-with-httponly-and-secure-flag-in-apache.html/","title":"Secure cookie with HttpOnly and Secure flag in Apache","text":"Secure Apache Web Server from XSS Attack <p>Do you know you can mitigate most common XSS attack using HttpOnly and Secure flag with your cookie? XSS is dangerous, very dangerous. By looking at increasing number of XSS attack on daily basis, you must secure you web applications.</p> <p>Without having HttpOnly and Secure flag in HTTP response header, it is possible to steal or manipulate web application session and cookies. It\u2019s good practice to set HttpOnly and Secure flag in application code by developers. However, due to bad programming or developers\u2019 unawareness it comes to Web Infrastructures.</p> <p>I will not talk about how to set these at code level. You can refer here.</p> <p>While performing security test on web applications, it\u2019s expected that you will have to fix these to pass the penetration test. This is how you can fix these in Apache Web Server.</p> Implement in Apache: <p>1.\u00a0\u00a0\u00a0\u00a0 Ensure you have mod_headers.so enabled in Apache instance</p> <p>2.\u00a0\u00a0\u00a0\u00a0 Add following entry in httpd.conf</p> <pre>Header edit Set-Cookie ^(.*)$ $1;HttpOnly;Secure</pre> <p>3.\u00a0\u00a0\u00a0\u00a0 Restart Apache Web Server</p> <p>Note: Header edit is not compatible with lower than Apache 2.2.4 version. You can use following to set HttpOnly and Secure flag in lower than 2.2.4 version. Thanks to Ytse for sharing this information.</p> <pre>Header set Set-Cookie HttpOnly;Secure</pre> Verification: <p>Open your website with HTTP Watch, Live HTTP Header or HTTP Header Online tool.</p> <p>Check HTTP response header, you should see as highlighted</p> <p></p> \u6458\u81ea\u300chttp://geekflare.com/httponly-secure-cookie-apache/\u300d","tags":["apache2","XSS"]},{"location":"DevOps/2016-03-06-maven%25e5%25ae%259e%25e6%2588%2598-%25e5%25b8%25b8%25e7%2594%25a8maven%25e6%258f%2592%25e4%25bb%25b6%25e4%25bb%258b%25e7%25bb%258d.html/","title":"Maven\u5b9e\u6218 &mdash; \u5e38\u7528Maven\u63d2\u4ef6\u4ecb\u7ecd","text":"<p>\u6211\u4eec\u90fd\u77e5\u9053Maven\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u63d2\u4ef6\u6846\u67b6\uff0c\u5b83\u7684\u6838\u5fc3\u5e76\u4e0d\u6267\u884c\u4efb\u4f55\u5177\u4f53\u7684\u6784\u5efa\u4efb\u52a1\uff0c\u6240\u6709\u8fd9\u4e9b\u4efb\u52a1\u90fd\u4ea4\u7ed9\u63d2\u4ef6\u6765\u5b8c\u6210\uff0c\u4f8b\u5982\u7f16\u8bd1\u6e90\u4ee3\u7801\u662f\u7531maven-compiler-plugin\u5b8c\u6210\u7684\u3002\u8fdb\u4e00\u6b65\u8bf4\uff0c\u6bcf\u4e2a\u4efb\u52a1\u5bf9\u5e94\u4e86\u4e00\u4e2a\u63d2\u4ef6\u76ee\u6807\uff08goal\uff09\uff0c\u6bcf\u4e2a\u63d2\u4ef6\u4f1a\u6709\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u76ee\u6807\uff0c\u4f8b\u5982maven-compiler-plugin\u7684compile\u76ee\u6807\u7528\u6765\u7f16\u8bd1\u4f4d\u4e8e<code>src/main/java/</code>\u76ee\u5f55\u4e0b\u7684\u4e3b\u6e90\u7801\uff0ctestCompile\u76ee\u6807\u7528\u6765\u7f16\u8bd1\u4f4d\u4e8e<code>src/test/java/</code>\u76ee\u5f55\u4e0b\u7684\u6d4b\u8bd5\u6e90\u7801\u3002</p> <p>\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u4e24\u79cd\u65b9\u5f0f\u8c03\u7528Maven\u63d2\u4ef6\u76ee\u6807\u3002\u7b2c\u4e00\u79cd\u65b9\u5f0f\u662f\u5c06\u63d2\u4ef6\u76ee\u6807\u4e0e\u751f\u547d\u5468\u671f\u9636\u6bb5\uff08lifecycle phase\uff09\u7ed1\u5b9a\uff0c\u8fd9\u6837\u7528\u6237\u5728\u547d\u4ee4\u884c\u53ea\u662f\u8f93\u5165\u751f\u547d\u5468\u671f\u9636\u6bb5\u800c\u5df2\uff0c\u4f8b\u5982Maven\u9ed8\u8ba4\u5c06maven-compiler-plugin\u7684compile\u76ee\u6807\u4e0ecompile\u751f\u547d\u5468\u671f\u9636\u6bb5\u7ed1\u5b9a\uff0c\u56e0\u6b64\u547d\u4ee4mvn compile\u5b9e\u9645\u4e0a\u662f\u5148\u5b9a\u4f4d\u5230compile\u8fd9\u4e00\u751f\u547d\u5468\u671f\u9636\u6bb5\uff0c\u7136\u540e\u518d\u6839\u636e\u7ed1\u5b9a\u5173\u7cfb\u8c03\u7528maven-compiler-plugin\u7684compile\u76ee\u6807\u3002\u7b2c\u4e8c\u79cd\u65b9\u5f0f\u662f\u76f4\u63a5\u5728\u547d\u4ee4\u884c\u6307\u5b9a\u8981\u6267\u884c\u7684\u63d2\u4ef6\u76ee\u6807\uff0c\u4f8b\u5982mvn archetype:generate \u5c31\u8868\u793a\u8c03\u7528maven-archetype-plugin\u7684generate\u76ee\u6807\uff0c\u8fd9\u79cd\u5e26\u5192\u53f7\u7684\u8c03\u7528\u65b9\u5f0f\u4e0e\u751f\u547d\u5468\u671f\u65e0\u5173\u3002</p> <p>\u8ba4\u8bc6\u4e0a\u8ff0Maven\u63d2\u4ef6\u7684\u57fa\u672c\u6982\u5ff5\u80fd\u5e2e\u52a9\u4f60\u7406\u89e3Maven\u7684\u5de5\u4f5c\u673a\u5236\uff0c\u4e0d\u8fc7\u8981\u60f3\u66f4\u9ad8\u6548\u7387\u5730\u4f7f\u7528Maven\uff0c\u4e86\u89e3\u4e00\u4e9b\u5e38\u7528\u7684\u63d2\u4ef6\u8fd8\u662f\u5f88\u6709\u5fc5\u8981\u7684\uff0c\u8fd9\u53ef\u4ee5\u5e2e\u52a9\u4f60\u907f\u514d\u4e00\u4e0d\u5c0f\u5fc3\u91cd\u65b0\u53d1\u660e\u8f6e\u5b50\u3002\u591a\u5e74\u6765Maven\u793e\u533a\u79ef\u7d2f\u4e86\u5927\u91cf\u7684\u7ecf\u9a8c\uff0c\u5e76\u968f\u4e4b\u5f62\u6210\u4e86\u4e00\u4e2a\u6210\u719f\u7684\u63d2\u4ef6\u751f\u6001\u5708\u3002Maven\u5b98\u65b9\u6709\u4e24\u4e2a\u63d2\u4ef6\u5217\u8868\uff0c\u7b2c\u4e00\u4e2a\u5217\u8868\u7684GroupId\u4e3aorg.apache.maven.plugins\uff0c\u8fd9\u91cc\u7684\u63d2\u4ef6\u6700\u4e3a\u6210\u719f\uff0c\u5177\u4f53\u5730\u5740\u4e3a\uff1ahttp://maven.apache.org/plugins/index.html\u3002\u7b2c\u4e8c\u4e2a\u5217\u8868\u7684GroupId\u4e3aorg.codehaus.mojo\uff0c\u8fd9\u91cc\u7684\u63d2\u4ef6\u6ca1\u6709\u90a3\u4e48\u6838\u5fc3\uff0c\u4f46\u4e5f\u6709\u4e0d\u5c11\u5341\u5206\u6709\u7528\uff0c\u5176\u5730\u5740\u4e3a\uff1ahttp://mojo.codehaus.org/plugins.html\u3002</p> <p>\u63a5\u4e0b\u6765\u7b14\u8005\u6839\u636e\u81ea\u5df1\u7684\u7ecf\u9a8c\u4ecb\u7ecd\u4e00\u4e9b\u6700\u5e38\u7528\u7684Maven\u63d2\u4ef6\uff0c\u5728\u4e0d\u540c\u7684\u73af\u5883\u4e0b\u5b83\u4eec\u5404\u81ea\u90fd\u6709\u5176\u51fa\u8272\u7684\u8868\u73b0\uff0c\u719f\u7ec3\u5730\u4f7f\u7528\u5b83\u4eec\u80fd\u8ba9\u4f60\u7684\u65e5\u5e38\u6784\u5efa\u5de5\u4f5c\u4e8b\u534a\u529f\u500d\u3002</p> maven-antrun-plugin <p>http://maven.apache.org/plugins/maven-antrun-plugin/</p> <p>maven-antrun-plugin\u80fd\u8ba9\u7528\u6237\u5728Maven\u9879\u76ee\u4e2d\u8fd0\u884cAnt\u4efb\u52a1\u3002\u7528\u6237\u53ef\u4ee5\u76f4\u63a5\u5728\u8be5\u63d2\u4ef6\u7684\u914d\u7f6e\u4ee5Ant\u7684\u65b9\u5f0f\u7f16\u5199Target\uff0c\u7136\u540e\u4ea4\u7ed9\u8be5\u63d2\u4ef6\u7684run\u76ee\u6807\u53bb\u6267\u884c\u3002\u5728\u4e00\u4e9b\u7531Ant\u5f80Maven\u8fc1\u79fb\u7684\u9879\u76ee\u4e2d\uff0c\u8be5\u63d2\u4ef6\u5c24\u5176\u6709\u7528\u3002\u6b64\u5916\u5f53\u4f60\u53d1\u73b0\u9700\u8981\u7f16\u5199\u4e00\u4e9b\u81ea\u5b9a\u4e49\u7a0b\u5ea6\u5f88\u9ad8\u7684\u4efb\u52a1\uff0c\u540c\u65f6\u53c8\u89c9\u5f97Maven\u4e0d\u591f\u7075\u6d3b\u65f6\uff0c\u4e5f\u53ef\u4ee5\u4ee5Ant\u7684\u65b9\u5f0f\u5b9e\u73b0\u4e4b\u3002maven-antrun-plugin\u7684run\u76ee\u6807\u901a\u5e38\u4e0e\u751f\u547d\u5468\u671f\u7ed1\u5b9a\u8fd0\u884c\u3002</p> maven-archetype-plugin <p>http://maven.apache.org/archetype/maven-archetype-plugin/</p> <p>Archtype\u6307\u9879\u76ee\u7684\u9aa8\u67b6\uff0cMaven\u521d\u5b66\u8005\u6700\u5f00\u59cb\u6267\u884c\u7684Maven\u547d\u4ee4\u53ef\u80fd\u5c31\u662fmvn archetype:generate\uff0c\u8fd9\u5b9e\u9645\u4e0a\u5c31\u662f\u8ba9maven-archetype-plugin\u751f\u6210\u4e00\u4e2a\u5f88\u7b80\u5355\u7684\u9879\u76ee\u9aa8\u67b6\uff0c\u5e2e\u52a9\u5f00\u53d1\u8005\u5feb\u901f\u4e0a\u624b\u3002\u53ef\u80fd\u4e5f\u6709\u4eba\u770b\u5230\u4e00\u4e9b\u6587\u6863\u5199\u4e86mvn archetype:create\uff0c\u4f46\u5b9e\u9645\u4e0acreate\u76ee\u6807\u5df2\u7ecf\u88ab\u5f03\u7528\u4e86\uff0c\u53d6\u800c\u4ee3\u4e4b\u7684\u662fgenerate\u76ee\u6807\uff0c\u8be5\u76ee\u6807\u4f7f\u7528\u4ea4\u4e92\u5f0f\u7684\u65b9\u5f0f\u63d0\u793a\u7528\u6237\u8f93\u5165\u5fc5\u8981\u7684\u4fe1\u606f\u4ee5\u521b\u5efa\u9879\u76ee\uff0c\u4f53\u9a8c\u66f4\u597d\u3002maven-archetype-plugin\u8fd8\u6709\u4e00\u4e9b\u5176\u4ed6\u76ee\u6807\u5e2e\u52a9\u7528\u6237\u81ea\u5df1\u5b9a\u4e49\u9879\u76ee\u539f\u578b\uff0c\u4f8b\u5982\u4f60\u7531\u4e00\u4e2a\u4ea7\u54c1\u9700\u8981\u4ea4\u4ed8\u7ed9\u5f88\u591a\u5ba2\u6237\u8fdb\u884c\u4e8c\u6b21\u5f00\u53d1\uff0c\u4f60\u5c31\u53ef\u4ee5\u4e3a\u4ed6\u4eec\u63d0\u4f9b\u4e00\u4e2aArchtype\uff0c\u5e2e\u52a9\u4ed6\u4eec\u5feb\u901f\u4e0a\u624b\u3002</p> maven-assembly-plugin <p>http://maven.apache.org/plugins/maven-assembly-plugin/</p> <p>maven-assembly-plugin\u7684\u7528\u9014\u662f\u5236\u4f5c\u9879\u76ee\u5206\u53d1\u5305\uff0c\u8be5\u5206\u53d1\u5305\u53ef\u80fd\u5305\u542b\u4e86\u9879\u76ee\u7684\u53ef\u6267\u884c\u6587\u4ef6\u3001\u6e90\u4ee3\u7801\u3001readme\u3001\u5e73\u53f0\u811a\u672c\u7b49\u7b49\u3002maven-assembly-plugin\u652f\u6301\u5404\u79cd\u4e3b\u6d41\u7684\u683c\u5f0f\u5982zip\u3001tar.gz\u3001jar\u548cwar\u7b49\uff0c\u5177\u4f53\u6253\u5305\u54ea\u4e9b\u6587\u4ef6\u662f\u9ad8\u5ea6\u53ef\u63a7\u7684\uff0c\u4f8b\u5982\u7528\u6237\u53ef\u4ee5\u6309\u6587\u4ef6\u7ea7\u522b\u7684\u7c92\u5ea6\u3001\u6587\u4ef6\u96c6\u7ea7\u522b\u7684\u7c92\u5ea6\u3001\u6a21\u5757\u7ea7\u522b\u7684\u7c92\u5ea6\u3001\u4ee5\u53ca\u4f9d\u8d56\u7ea7\u522b\u7684\u7c92\u5ea6\u63a7\u5236\u6253\u5305\uff0c\u6b64\u5916\uff0c\u5305\u542b\u548c\u6392\u9664\u914d\u7f6e\u4e5f\u662f\u652f\u6301\u7684\u3002maven-assembly-plugin\u8981\u6c42\u7528\u6237\u4f7f\u7528\u4e00\u4e2a\u540d\u4e3a<code>assembly.xml</code>\u7684\u5143\u6570\u636e\u6587\u4ef6\u6765\u8868\u8ff0\u6253\u5305\uff0c\u5b83\u7684single\u76ee\u6807\u53ef\u4ee5\u76f4\u63a5\u5728\u547d\u4ee4\u884c\u8c03\u7528\uff0c\u4e5f\u53ef\u4ee5\u88ab\u7ed1\u5b9a\u81f3\u751f\u547d\u5468\u671f\u3002</p> maven-dependency-plugin <p>http://maven.apache.org/plugins/maven-dependency-plugin/</p> <p>maven-dependency-plugin\u6700\u5927\u7684\u7528\u9014\u662f\u5e2e\u52a9\u5206\u6790\u9879\u76ee\u4f9d\u8d56\uff0cdependency:list\u80fd\u591f\u5217\u51fa\u9879\u76ee\u6700\u7ec8\u89e3\u6790\u5230\u7684\u4f9d\u8d56\u5217\u8868\uff0cdependency:tree\u80fd\u8fdb\u4e00\u6b65\u7684\u63cf\u7ed8\u9879\u76ee\u4f9d\u8d56\u6811\uff0cdependency:analyze\u53ef\u4ee5\u544a\u8bc9\u4f60\u9879\u76ee\u4f9d\u8d56\u6f5c\u5728\u7684\u95ee\u9898\uff0c\u5982\u679c\u4f60\u6709\u76f4\u63a5\u4f7f\u7528\u5230\u7684\u5374\u672a\u58f0\u660e\u7684\u4f9d\u8d56\uff0c\u8be5\u76ee\u6807\u5c31\u4f1a\u53d1\u51fa\u8b66\u544a\u3002maven-dependency-plugin\u8fd8\u6709\u5f88\u591a\u76ee\u6807\u5e2e\u52a9\u4f60\u64cd\u4f5c\u4f9d\u8d56\u6587\u4ef6\uff0c\u4f8b\u5982dependency:copy-dependencies\u80fd\u5c06\u9879\u76ee\u4f9d\u8d56\u4ece\u672c\u5730Maven\u4ed3\u5e93\u590d\u5236\u5230\u67d0\u4e2a\u7279\u5b9a\u7684\u6587\u4ef6\u5939\u4e0b\u9762\u3002</p> maven-enforcer-plugin <p>http://maven.apache.org/plugins/maven-enforcer-plugin/</p> <p>\u5728\u4e00\u4e2a\u7a0d\u5927\u4e00\u70b9\u7684\u7ec4\u7ec7\u6216\u56e2\u961f\u4e2d\uff0c\u4f60\u65e0\u6cd5\u4fdd\u8bc1\u6240\u6709\u6210\u5458\u90fd\u719f\u6089Maven\uff0c\u90a3\u4ed6\u4eec\u505a\u4e00\u4e9b\u6bd4\u8f83\u611a\u8822\u7684\u4e8b\u60c5\u5c31\u4f1a\u53d8\u5f97\u5f88\u6b63\u5e38\uff0c\u4f8b\u5982\u7ed9\u9879\u76ee\u5f15\u5165\u4e86\u5916\u90e8\u7684SNAPSHOT\u4f9d\u8d56\u800c\u5bfc\u81f4\u6784\u5efa\u4e0d\u7a33\u5b9a\uff0c\u4f7f\u7528\u4e86\u4e00\u4e2a\u4e0e\u5927\u5bb6\u4e0d\u4e00\u81f4\u7684Maven\u7248\u672c\u800c\u7ecf\u5e38\u62b1\u6028\u6784\u5efa\u51fa\u73b0\u8be1\u5f02\u95ee\u9898\u3002maven-enforcer-plugin\u80fd\u591f\u5e2e\u52a9\u4f60\u907f\u514d\u4e4b\u7c7b\u95ee\u9898\uff0c\u5b83\u5141\u8bb8\u4f60\u521b\u5efa\u4e00\u7cfb\u5217\u89c4\u5219\u5f3a\u5236\u5927\u5bb6\u9075\u5b88\uff0c\u5305\u62ec\u8bbe\u5b9aJava\u7248\u672c\u3001\u8bbe\u5b9aMaven\u7248\u672c\u3001\u7981\u6b62\u67d0\u4e9b\u4f9d\u8d56\u3001\u7981\u6b62SNAPSHOT\u4f9d\u8d56\u3002\u53ea\u8981\u5728\u4e00\u4e2a\u7236POM\u914d\u7f6e\u89c4\u5219\uff0c\u7136\u540e\u8ba9\u5927\u5bb6\u7ee7\u627f\uff0c\u5f53\u89c4\u5219\u906d\u5230\u7834\u574f\u7684\u65f6\u5019\uff0cMaven\u5c31\u4f1a\u62a5\u9519\u3002\u9664\u4e86\u6807\u51c6\u7684\u89c4\u5219\u4e4b\u5916\uff0c\u4f60\u8fd8\u53ef\u4ee5\u6269\u5c55\u8be5\u63d2\u4ef6\uff0c\u7f16\u5199\u81ea\u5df1\u7684\u89c4\u5219\u3002maven-enforcer-plugin\u7684enforce\u76ee\u6807\u8d1f\u8d23\u68c0\u67e5\u89c4\u5219\uff0c\u5b83\u9ed8\u8ba4\u7ed1\u5b9a\u5230\u751f\u547d\u5468\u671f\u7684validate\u9636\u6bb5\u3002</p> maven-help-plugin <p>http://maven.apache.org/plugins/maven-help-plugin/</p> <p>maven-help-plugin\u662f\u4e00\u4e2a\u5c0f\u5de7\u7684\u8f85\u52a9\u5de5\u5177\uff0c\u6700\u7b80\u5355\u7684help:system\u53ef\u4ee5\u6253\u5370\u6240\u6709\u53ef\u7528\u7684\u73af\u5883\u53d8\u91cf\u548cJava\u7cfb\u7edf\u5c5e\u6027\u3002help:effective-pom\u548chelp:effective-settings\u6700\u4e3a\u6709\u7528\uff0c\u5b83\u4eec\u5206\u522b\u6253\u5370\u9879\u76ee\u7684\u6709\u6548POM\u548c\u6709\u6548settings\uff0c\u6709\u6548POM\u662f\u6307\u5408\u5e76\u4e86\u6240\u6709\u7236POM\uff08\u5305\u62ecSuper POM\uff09\u540e\u7684XML\uff0c\u5f53\u4f60\u4e0d\u786e\u5b9aPOM\u7684\u67d0\u4e9b\u4fe1\u606f\u4ece\u4f55\u800c\u6765\u65f6\uff0c\u5c31\u53ef\u4ee5\u67e5\u770b\u6709\u6548POM\u3002\u6709\u6548settings\u540c\u7406\uff0c\u7279\u522b\u662f\u5f53\u4f60\u53d1\u73b0\u81ea\u5df1\u914d\u7f6e\u7684settings.xml\u6ca1\u6709\u751f\u6548\u65f6\uff0c\u5c31\u53ef\u4ee5\u7528help:effective-settings\u6765\u9a8c\u8bc1\u3002\u6b64\u5916\uff0cmaven-help-plugin\u7684describe\u76ee\u6807\u53ef\u4ee5\u5e2e\u52a9\u4f60\u63cf\u8ff0\u4efb\u4f55\u4e00\u4e2aMaven\u63d2\u4ef6\u7684\u4fe1\u606f\uff0c\u8fd8\u6709all-profiles\u76ee\u6807\u548cactive-profiles\u76ee\u6807\u5e2e\u52a9\u67e5\u770b\u9879\u76ee\u7684Profile\u3002</p> maven-release-plugin <p>http://maven.apache.org/plugins/maven-release-plugin/</p> <p>maven-release-plugin\u7684\u7528\u9014\u662f\u5e2e\u52a9\u81ea\u52a8\u5316\u9879\u76ee\u7248\u672c\u53d1\u5e03\uff0c\u5b83\u4f9d\u8d56\u4e8ePOM\u4e2d\u7684SCM\u4fe1\u606f\u3002release:prepare\u7528\u6765\u51c6\u5907\u7248\u672c\u53d1\u5e03\uff0c\u5177\u4f53\u7684\u5de5\u4f5c\u5305\u62ec\u68c0\u67e5\u662f\u5426\u6709\u672a\u63d0\u4ea4\u4ee3\u7801\u3001\u68c0\u67e5\u662f\u5426\u6709SNAPSHOT\u4f9d\u8d56\u3001\u5347\u7ea7\u9879\u76ee\u7684SNAPSHOT\u7248\u672c\u81f3RELEASE\u7248\u672c\u3001\u4e3a\u9879\u76ee\u6253\u6807\u7b7e\u7b49\u7b49\u3002release:perform\u5219\u662f\u7b7e\u51fa\u6807\u7b7e\u4e2d\u7684RELEASE\u6e90\u7801\uff0c\u6784\u5efa\u5e76\u53d1\u5e03\u3002\u7248\u672c\u53d1\u5e03\u662f\u975e\u5e38\u7410\u788e\u7684\u5de5\u4f5c\uff0c\u5b83\u6d89\u53ca\u4e86\u5404\u79cd\u68c0\u67e5\uff0c\u800c\u4e14\u7531\u4e8e\u8be5\u5de5\u4f5c\u4ec5\u4ec5\u662f\u5076\u5c14\u9700\u8981\uff0c\u56e0\u6b64\u624b\u52a8\u64cd\u4f5c\u5f88\u5bb9\u6613\u9057\u6f0f\u4e00\u4e9b\u7ec6\u8282\uff0cmaven-release-plugin\u8ba9\u8be5\u5de5\u4f5c\u53d8\u5f97\u975e\u5e38\u5feb\u901f\u7b80\u4fbf\uff0c\u4e0d\u6613\u51fa\u9519\u3002maven-release-plugin\u7684\u5404\u79cd\u76ee\u6807\u901a\u5e38\u76f4\u63a5\u5728\u547d\u4ee4\u884c\u8c03\u7528\uff0c\u56e0\u4e3a\u7248\u672c\u53d1\u5e03\u663e\u7136\u4e0d\u662f\u65e5\u5e38\u6784\u5efa\u751f\u547d\u5468\u671f\u7684\u4e00\u90e8\u5206\u3002</p> maven-resources-plugin <p>http://maven.apache.org/plugins/maven-resources-plugin/</p> <p>\u4e3a\u4e86\u4f7f\u9879\u76ee\u7ed3\u6784\u66f4\u4e3a\u6e05\u6670\uff0cMaven\u533a\u522b\u5bf9\u5f85Java\u4ee3\u7801\u6587\u4ef6\u548c\u8d44\u6e90\u6587\u4ef6\uff0cmaven-compiler-plugin\u7528\u6765\u7f16\u8bd1Java\u4ee3\u7801\uff0cmaven-resources-plugin\u5219\u7528\u6765\u5904\u7406\u8d44\u6e90\u6587\u4ef6\u3002\u9ed8\u8ba4\u7684\u4e3b\u8d44\u6e90\u6587\u4ef6\u76ee\u5f55\u662f<code>src/main/resources</code>\uff0c\u5f88\u591a\u7528\u6237\u4f1a\u9700\u8981\u6dfb\u52a0\u989d\u5916\u7684\u8d44\u6e90\u6587\u4ef6\u76ee\u5f55\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6emaven-resources-plugin\u6765\u5b9e\u73b0\u3002\u6b64\u5916\uff0c\u8d44\u6e90\u6587\u4ef6\u8fc7\u6ee4\u4e5f\u662fMaven\u7684\u4e00\u5927\u7279\u6027\uff0c\u4f60\u53ef\u4ee5\u5728\u8d44\u6e90\u6587\u4ef6\u4e2d\u4f7f\u7528${propertyName}\u5f62\u5f0f\u7684Maven\u5c5e\u6027\uff0c\u7136\u540e\u914d\u7f6emaven-resources-plugin\u5f00\u542f\u5bf9\u8d44\u6e90\u6587\u4ef6\u7684\u8fc7\u6ee4\uff0c\u4e4b\u540e\u5c31\u53ef\u4ee5\u9488\u5bf9\u4e0d\u540c\u73af\u5883\u901a\u8fc7\u547d\u4ee4\u884c\u6216\u8005Profile\u4f20\u5165\u5c5e\u6027\u7684\u503c\uff0c\u4ee5\u5b9e\u73b0\u66f4\u4e3a\u7075\u6d3b\u7684\u6784\u5efa\u3002</p> maven-surefire-plugin <p>http://maven.apache.org/plugins/maven-surefire-plugin/</p> <p>\u53ef\u80fd\u662f\u7531\u4e8e\u5386\u53f2\u7684\u539f\u56e0\uff0cMaven 2/3\u4e2d\u7528\u4e8e\u6267\u884c\u6d4b\u8bd5\u7684\u63d2\u4ef6\u4e0d\u662fmaven-test-plugin\uff0c\u800c\u662fmaven-surefire-plugin\u3002\u5176\u5b9e\u5927\u90e8\u5206\u65f6\u95f4\u5185\uff0c\u53ea\u8981\u4f60\u7684\u6d4b\u8bd5\u7c7b\u9075\u5faa\u901a\u7528\u7684\u547d\u4ee4\u7ea6\u5b9a\uff08\u4ee5Test\u7ed3\u5c3e\u3001\u4ee5TestCase\u7ed3\u5c3e\u3001\u6216\u8005\u4ee5Test\u5f00\u5934\uff09\uff0c\u5c31\u51e0\u4e4e\u4e0d\u7528\u77e5\u6653\u8be5\u63d2\u4ef6\u7684\u5b58\u5728\u3002\u7136\u800c\u5728\u5f53\u4f60\u60f3\u8981\u8df3\u8fc7\u6d4b\u8bd5\u3001\u6392\u9664\u67d0\u4e9b\u6d4b\u8bd5\u7c7b\u3001\u6216\u8005\u4f7f\u7528\u4e00\u4e9bTestNG\u7279\u6027\u7684\u65f6\u5019\uff0c\u4e86\u89e3maven-surefire-plugin\u7684\u4e00\u4e9b\u914d\u7f6e\u9009\u9879\u5c31\u5f88\u6709\u7528\u4e86\u3002\u4f8b\u5982\u00a0mvn test -Dtest=FooTest\u00a0\u8fd9\u6837\u4e00\u6761\u547d\u4ee4\u7684\u6548\u679c\u662f\u4ec5\u8fd0\u884cFooTest\u6d4b\u8bd5\u7c7b\uff0c\u8fd9\u662f\u901a\u8fc7\u63a7\u5236maven-surefire-plugin\u7684test\u53c2\u6570\u5b9e\u73b0\u7684\u3002</p> build-helper-maven-plugin <p>http://mojo.codehaus.org/build-helper-maven-plugin/</p> <p>Maven\u9ed8\u8ba4\u53ea\u5141\u8bb8\u6307\u5b9a\u4e00\u4e2a\u4e3bJava\u4ee3\u7801\u76ee\u5f55\u548c\u4e00\u4e2a\u6d4b\u8bd5Java\u4ee3\u7801\u76ee\u5f55\uff0c\u867d\u7136\u8fd9\u5176\u5b9e\u662f\u4e2a\u5e94\u5f53\u5c3d\u91cf\u9075\u5b88\u7684\u7ea6\u5b9a\uff0c\u4f46\u5076\u5c14\u4f60\u8fd8\u662f\u4f1a\u5e0c\u671b\u80fd\u591f\u6307\u5b9a\u591a\u4e2a\u6e90\u7801\u76ee\u5f55\uff08\u4f8b\u5982\u4e3a\u4e86\u5e94\u5bf9\u9057\u7559\u9879\u76ee\uff09\uff0cbuild-helper-maven-plugin\u7684add-source\u76ee\u6807\u5c31\u662f\u670d\u52a1\u4e8e\u8fd9\u4e2a\u76ee\u7684\uff0c\u901a\u5e38\u5b83\u88ab\u7ed1\u5b9a\u5230\u9ed8\u8ba4\u751f\u547d\u5468\u671f\u7684generate-sources\u9636\u6bb5\u4ee5\u6dfb\u52a0\u989d\u5916\u7684\u6e90\u7801\u76ee\u5f55\u3002\u9700\u8981\u5f3a\u8c03\u7684\u662f\uff0c\u8fd9\u79cd\u505a\u6cd5\u8fd8\u662f\u4e0d\u63a8\u8350\u7684\uff0c\u56e0\u4e3a\u5b83\u7834\u574f\u4e86 Maven\u7684\u7ea6\u5b9a\uff0c\u800c\u4e14\u53ef\u80fd\u4f1a\u9047\u5230\u5176\u4ed6\u4e25\u683c\u9075\u5b88\u7ea6\u5b9a\u7684\u63d2\u4ef6\u5de5\u5177\u65e0\u6cd5\u6b63\u786e\u8bc6\u522b\u989d\u5916\u7684\u6e90\u7801\u76ee\u5f55\u3002</p> <p>build-helper-maven-plugin\u7684\u53e6\u4e00\u4e2a\u975e\u5e38\u6709\u7528\u7684\u76ee\u6807\u662fattach-artifact\uff0c\u4f7f\u7528\u8be5\u76ee\u6807\u4f60\u53ef\u4ee5\u4ee5classifier\u7684\u5f62\u5f0f\u9009\u53d6\u90e8\u5206\u9879\u76ee\u6587\u4ef6\u751f\u6210\u9644\u5c5e\u6784\u4ef6\uff0c\u5e76\u540c\u65f6install\u5230\u672c\u5730\u4ed3\u5e93\uff0c\u4e5f\u53ef\u4ee5deploy\u5230\u8fdc\u7a0b\u4ed3\u5e93\u3002</p> exec-maven-plugin <p>http://mojo.codehaus.org/exec-maven-plugin/</p> <p>exec-maven-plugin\u5f88\u597d\u7406\u89e3\uff0c\u987e\u540d\u601d\u4e49\uff0c\u5b83\u80fd\u8ba9\u4f60\u8fd0\u884c\u4efb\u4f55\u672c\u5730\u7684\u7cfb\u7edf\u7a0b\u5e8f\uff0c\u5728\u67d0\u4e9b\u7279\u5b9a\u60c5\u51b5\u4e0b\uff0c\u8fd0\u884c\u4e00\u4e2aMaven\u5916\u90e8\u7684\u7a0b\u5e8f\u53ef\u80fd\u5c31\u662f\u6700\u7b80\u5355\u7684\u95ee\u9898\u89e3\u51b3\u65b9\u6848\uff0c\u8fd9\u5c31\u662fexec:exec\u7684\u7528\u9014\uff0c\u5f53\u7136\uff0c\u8be5\u63d2\u4ef6\u8fd8\u5141\u8bb8\u4f60\u914d\u7f6e\u76f8\u5173\u7684\u7a0b\u5e8f\u8fd0\u884c\u53c2\u6570\u3002\u9664\u4e86exec\u76ee\u6807\u4e4b\u5916\uff0cexec-maven-plugin\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e2ajava\u76ee\u6807\uff0c\u8be5\u76ee\u6807\u8981\u6c42\u4f60\u63d0\u4f9b\u4e00\u4e2amainClass\u53c2\u6570\uff0c\u7136\u540e\u5b83\u80fd\u591f\u5229\u7528\u5f53\u524d\u9879\u76ee\u7684\u4f9d\u8d56\u4f5c\u4e3aclasspath\uff0c\u5728\u540c\u4e00\u4e2aJVM\u4e2d\u8fd0\u884c\u8be5mainClass\u3002\u6709\u65f6\u5019\uff0c\u4e3a\u4e86\u7b80\u5355\u7684\u6f14\u793a\u4e00\u4e2a\u547d\u4ee4\u884cJava\u7a0b\u5e8f\uff0c\u4f60\u53ef\u4ee5\u5728POM\u4e2d\u914d\u7f6e\u597dexec-maven-plugin\u7684\u76f8\u5173\u8fd0\u884c\u53c2\u6570\uff0c\u7136\u540e\u76f4\u63a5\u5728\u547d\u4ee4\u8fd0\u884c\u00a0mvn exec:java\u00a0\u4ee5\u67e5\u770b\u8fd0\u884c\u6548\u679c\u3002</p> jetty-maven-plugin <p>http://wiki.eclipse.org/Jetty/Feature/Jetty_Maven_Plugin</p> <p>\u5728\u8fdb\u884cWeb\u5f00\u53d1\u7684\u65f6\u5019\uff0c\u6253\u5f00\u6d4f\u89c8\u5668\u5bf9\u5e94\u7528\u8fdb\u884c\u624b\u52a8\u7684\u6d4b\u8bd5\u51e0\u4e4e\u662f\u65e0\u6cd5\u907f\u514d\u7684\uff0c\u8fd9\u79cd\u6d4b\u8bd5\u65b9\u6cd5\u901a\u5e38\u5c31\u662f\u5c06\u9879\u76ee\u6253\u5305\u6210war\u6587\u4ef6\uff0c\u7136\u540e\u90e8\u7f72\u5230Web\u5bb9\u5668\u4e2d\uff0c\u518d\u542f\u52a8\u5bb9\u5668\u8fdb\u884c\u9a8c\u8bc1\uff0c\u8fd9\u663e\u7136\u5341\u5206\u8017\u65f6\u3002\u4e3a\u4e86\u5e2e\u52a9\u5f00\u53d1\u8005\u8282\u7701\u65f6\u95f4\uff0cjetty-maven-plugin\u5e94\u8fd0\u800c\u751f\uff0c\u5b83\u5b8c\u5168\u517c\u5bb9 Maven\u9879\u76ee\u7684\u76ee\u5f55\u7ed3\u6784\uff0c\u80fd\u591f\u5468\u671f\u6027\u5730\u68c0\u67e5\u6e90\u6587\u4ef6\uff0c\u4e00\u65e6\u53d1\u73b0\u53d8\u66f4\u540e\u81ea\u52a8\u66f4\u65b0\u5230\u5185\u7f6e\u7684Jetty Web\u5bb9\u5668\u4e2d\u3002\u505a\u4e00\u4e9b\u57fa\u672c\u914d\u7f6e\u540e\uff08\u4f8b\u5982Web\u5e94\u7528\u7684contextPath\u548c\u81ea\u52a8\u626b\u63cf\u53d8\u66f4\u7684\u65f6\u95f4\u95f4\u9694\uff09\uff0c\u4f60\u53ea\u8981\u6267\u884c\u00a0mvn jetty:run\u00a0\uff0c\u7136\u540e\u5728IDE\u4e2d\u4fee\u6539\u4ee3\u7801\uff0c\u4ee3\u7801\u7ecfIDE\u81ea\u52a8\u7f16\u8bd1\u540e\u4ea7\u751f\u53d8\u66f4\uff0c\u518d\u7531jetty-maven-plugin\u4fa6\u6d4b\u5230\u540e\u66f4\u65b0\u81f3Jetty\u5bb9\u5668\uff0c\u8fd9\u65f6\u4f60\u5c31\u53ef\u4ee5\u76f4\u63a5\u6d4b\u8bd5Web\u9875\u9762\u4e86\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cjetty-maven-plugin\u5e76\u4e0d\u662f\u5bbf\u4e3b\u4e8eApache\u6216Codehaus\u7684\u5b98\u65b9\u63d2\u4ef6\uff0c\u56e0\u6b64\u4f7f\u7528\u7684\u65f6\u5019\u9700\u8981\u989d\u5916\u7684\u914d\u7f6e<code>settings.xml</code>\u7684pluginGroups\u5143\u7d20\uff0c\u5c06org.mortbay.jetty\u8fd9\u4e2apluginGroup\u52a0\u5165\u3002</p> versions-maven-plugin <p>http://mojo.codehaus.org/versions-maven-plugin/</p> <p>\u5f88\u591aMaven\u7528\u6237\u9047\u5230\u8fc7\u8fd9\u6837\u4e00\u4e2a\u95ee\u9898\uff0c\u5f53\u9879\u76ee\u5305\u542b\u5927\u91cf\u6a21\u5757\u7684\u65f6\u5019\uff0c\u4e3a\u4ed6\u4eec\u96c6\u4f53\u66f4\u65b0\u7248\u672c\u5c31\u53d8\u6210\u4e00\u4ef6\u70e6\u4eba\u7684\u4e8b\u60c5\uff0c\u5230\u5e95\u6709\u6ca1\u6709\u81ea\u52a8\u5316\u5de5\u5177\u80fd\u5e2e\u52a9\u5b8c\u6210\u8fd9\u4ef6\u4e8b\u60c5\u5462\uff1f\uff08\u5f53\u7136\u4f60\u53ef\u4ee5\u4f7f\u7528sed\u4e4b\u7c7b\u7684\u6587\u672c\u64cd\u4f5c\u5de5\u5177\uff0c\u4e0d\u8fc7\u4e0d\u5728\u672c\u6587\u8ba8\u8bba\u8303\u56f4\uff09\u7b54\u6848\u662f\u80af\u5b9a\u7684\uff0cversions-maven- plugin\u63d0\u4f9b\u4e86\u5f88\u591a\u76ee\u6807\u5e2e\u52a9\u4f60\u7ba1\u7406Maven\u9879\u76ee\u7684\u5404\u79cd\u7248\u672c\u4fe1\u606f\u3002\u4f8b\u5982\u6700\u5e38\u7528\u7684\uff0c\u547d\u4ee4\u00a0mvn versions:set -DnewVersion=1.1-SNAPSHOT\u00a0\u5c31\u80fd\u5e2e\u52a9\u4f60\u628a\u6240\u6709\u6a21\u5757\u7684\u7248\u672c\u66f4\u65b0\u52301.1-SNAPSHOT\u3002\u8be5\u63d2\u4ef6\u8fd8\u63d0\u4f9b\u4e86\u5176\u4ed6\u4e00\u4e9b\u5f88\u6709\u7528\u7684\u76ee\u6807\uff0cdisplay-dependency- updates\u80fd\u544a\u8bc9\u4f60\u9879\u76ee\u4f9d\u8d56\u6709\u54ea\u4e9b\u53ef\u7528\u7684\u66f4\u65b0\uff1b\u7c7b\u4f3c\u7684display-plugin-updates\u80fd\u544a\u8bc9\u4f60\u53ef\u7528\u7684\u63d2\u4ef6\u66f4\u65b0\uff1b\u7136\u540euse- latest-versions\u80fd\u81ea\u52a8\u5e2e\u4f60\u5c06\u6240\u6709\u4f9d\u8d56\u5347\u7ea7\u5230\u6700\u65b0\u7248\u672c\u3002\u6700\u540e\uff0c\u5982\u679c\u4f60\u5bf9\u6240\u505a\u7684\u66f4\u6539\u6ee1\u610f\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u00a0mvn versions:commit\u00a0\u63d0\u4ea4\uff0c\u4e0d\u6ee1\u610f\u7684\u8bdd\u4e5f\u53ef\u4ee5\u4f7f\u7528\u00a0mvn versions:revert\u00a0\u8fdb\u884c\u64a4\u9500\u3002</p> \u5c0f\u7ed3 <p>\u672c\u6587\u4ecb\u7ecd\u4e86\u4e00\u4e9b\u6700\u5e38\u7528\u7684Maven\u63d2\u4ef6\uff0c\u8fd9\u91cc\u6307\u7684\u201c\u5e38\u7528\u201d\u662f\u6307\u7ecf\u5e38\u9700\u8981\u8fdb\u884c\u914d\u7f6e\u7684\u63d2\u4ef6\uff0c\u4e8b\u5b9e\u4e0a\u6211\u4eec\u7528Maven\u7684\u65f6\u5019\u5f88\u591a\u5176\u5b83\u63d2\u4ef6\u4e5f\u662f\u5fc5\u987b\u7684\uff0c\u4f8b\u5982\u9ed8\u8ba4\u7684\u7f16\u8bd1\u63d2\u4ef6maven-compiler-plugin\u548c\u9ed8\u8ba4\u7684\u6253\u5305\u63d2\u4ef6maven-jar-plugin\uff0c\u4f46\u56e0\u4e3a\u5f88\u5c11\u9700\u8981\u5bf9\u5b83\u4eec\u8fdb\u884c\u914d\u7f6e\uff0c\u56e0\u6b64\u4e0d\u5728\u672c\u6587\u8ba8\u8bba\u8303\u56f4\u3002\u4e86\u89e3\u5e38\u7528\u7684Maven\u63d2\u4ef6\u80fd\u5e2e\u52a9\u4f60\u4e8b\u500d\u529f\u534a\u5730\u5b8c\u6210\u9879\u76ee\u6784\u5efa\u4efb\u52a1\uff0c\u53cd\u4e4b\u4f60\u5c31\u53ef\u80fd\u4f1a\u56e0\u4e3a\u7ecf\u5e38\u9047\u5230\u4e00\u4e9b\u96be\u4ee5\u89e3\u51b3\u7684\u95ee\u9898\u800c\u611f\u5230\u6cae\u4e27\u3002\u672c\u6587\u4ecb\u7ecd\u7684\u63d2\u4ef6\u57fa\u672c\u80fd\u8986\u76d6\u5927\u90e8\u5206Maven\u7528\u6237\u7684\u65e5\u5e38\u4f7f\u7528\u9700\u8981\uff0c\u5982\u679c\u4f60\u771f\u6709\u975e\u5e38\u7279\u6b8a\u7684\u9700\u6c42\uff0c\u81ea\u884c\u7f16\u5199\u4e00\u4e2aMaven\u63d2\u4ef6\u4e5f\u4e0d\u662f\u96be\u4e8b\uff0c\u66f4\u4f55\u51b5\u8fd8\u6709\u8fd9\u4e48\u591a\u5f00\u653e\u6e90\u4ee3\u7801\u7684\u63d2\u4ef6\u4f9b\u4f60\u53c2\u8003\u3002</p> <p>\u672c\u6587\u7684\u8fd9\u4e2a\u63d2\u4ef6\u5217\u8868\u5e76\u4e0d\u662f\u4e00\u4e2a\u5b8c\u6574\u5217\u8868\uff0c\u8bfb\u8005\u6709\u5174\u8da3\u7684\u8bdd\u4e5f\u53ef\u4ee5\u53bb\u4ed4\u7ec6\u6d4f\u89c8\u4e00\u4e0bApache\u548cCodehaus Mojo\u7684Maven\u63d2\u4ef6\u5217\u8868\uff0c\u4ee5\u7684\u5230\u4e00\u4e2a\u66f4\u4e3a\u5168\u9762\u7684\u8ba4\u8bc6\u3002\u6700\u540e\uff0c\u5728\u7ebf\u7684Maven\u4ed3\u5e93\u641c\u7d22\u5f15\u64ce\u5982http://search.maven.org/\u4e5f\u80fd\u5e2e\u52a9\u4f60\u5feb\u901f\u627e\u5230\u81ea\u5df1\u611f\u5174\u8da3\u7684Maven\u63d2\u4ef6\u3002</p> <p> </p> <p>\u6458\u81ea \u300chttp://www.infoq.com/cn/news/2011/04/xxb-maven-7-plugin\u300d \u300chttp://www.infoq.com/cn/news/2011/05/xxb-maven-8-plugin\u300d</p>","tags":["maven","\u63d2\u4ef6","plugin"]},{"location":"DevOps/2016-03-06-maven-practice-%25e6%2596%2587%25e9%259b%2586-infoq.html/","title":"Maven Practice \u6587\u96c6 @InfoQ","text":"<p>http://www.infoq.com/cn/maven-practice</p>","tags":[]},{"location":"DevOps/2016-04-04-redis%25e4%25b8%25bb%25e4%25bb%258e%25e9%2585%258d%25e7%25bd%25ae%25e5%258f%258a%25e4%25bd%25bf%25e7%2594%25a8keepalived%25e5%25ae%259e%25e7%258e%25b0redis%25e9%25ab%2598%25e5%258f%25af%25e7%2594%25a8.html/","title":"Redis\u4e3b\u4ece\u914d\u7f6e\u53ca\u4f7f\u7528KeepAlived\u5b9e\u73b0Redis\u9ad8\u53ef\u7528","text":"\u4e00\uff1a\u73af\u5883\u4ecb\u7ecd Master:\u00a0172.16.206.29 Slave:\u00a0172.16.206.28 Virtural\u00a0IP\u00a0Address\u00a0(VIP):\u00a0172.16.206.250 \u4e8c\uff1a\u8bbe\u8ba1\u601d\u8def\uff1a \u5f53\u00a0Master\u00a0\u4e0e\u00a0Slave\u00a0\u5747\u8fd0\u4f5c\u6b63\u5e38\u65f6,\u00a0Master\u8d1f\u8d23\u670d\u52a1\uff0cSlave\u8d1f\u8d23Standby\uff1b \u5f53\u00a0Master\u00a0\u6302\u6389\uff0cSlave\u00a0\u6b63\u5e38\u65f6,\u00a0Slave\u63a5\u7ba1\u670d\u52a1\uff0c\u6709\u5199\u6743\u9650\uff0c\u540c\u65f6\u5173\u95ed\u4e3b\u4ece\u590d\u5236\u529f\u80fd\uff1b \u5f53\u00a0Master\u00a0\u6062\u590d\u6b63\u5e38\uff0c\u5219\u4eceSlave\u540c\u6b65\u6570\u636e\uff0c\u540c\u6b65\u6570\u636e\u4e4b\u540e\u5173\u95ed\u4e3b\u4ece\u590d\u5236\u529f\u80fd\uff0c\u6062\u590dMaster\u8eab\u4efd\uff0c\u540c\u65f6Slave\u7b49\u5f85Master\u540c\u6b65\u6570\u636e\u5b8c\u6210\u4e4b\u540e\uff0c\u6062\u590dSlave\u8eab\u4efd\u3002 \u4e09\uff1a\u5b89\u88c5\u914d\u7f6e\u524d\u51c6\u5907\u5de5\u4f5c \u5728\u4e3b\u670d\u52a1\u5668\u00a0172.16.206.29\u00a0\u4e0a\u9762\u505a\u4e0b\u9762\u64cd\u4f5c echo\u00a0\u201c172.16.206.29\u00a0osb29\u201d\u00a0&gt;&gt;\u00a0/etc/hosts echo\u00a0\u201c172.16.206.28\u00a0osb28\u201d\u00a0&gt;&gt;\u00a0/etc/hosts \u5728\u4ece\u670d\u52a1\u5668\u00a0172.16.206.28\u00a0\u4e0a\u9762\u505a\u4e0b\u9762\u64cd\u4f5c echo\u00a0\u201c172.16.206.29\u00a0osb29\u201d\u00a0&gt;&gt;\u00a0/etc/hosts echo\u00a0\u201c172.16.206.28\u00a0osb28\u201d\u00a0&gt;&gt;\u00a0/etc/hosts \u56db\uff1a\u4e3b\u670d\u52a1\u5668\u914d\u7f6eredis 1\uff0e\u4e0b\u8f7dredis\u00a0\u7248\u672c2.8.19 wget\u00a0http://download.redis.io/releases/redis-2.8.19.tar.gz 2\uff0e\u89e3\u538b\u00a0tar\u00a0-zxvf\u00a0redis-2.8.19.tar.gz 3\uff0ecd\u00a0redis-2.8.19 4\uff0emake\u00a0&amp;&amp;\u00a0make\u00a0install 5\uff0ecp\u00a0redis.conf\u00a0/etc/redis.conf cd\u00a0src/ cp\u00a0redis-server\u00a0redis-cli\u00a0redis-benchmark\u00a0redis-check-aofredis-check-dump\u00a0/usr/local/bin 6\uff0e\u4fee\u6539\u00a0/etc/redis.conf\u91cc\u9762\u53ef\u4ee5\u628adaemonize\u00a0no\u00a0\u4fee\u6539\u4e3adaemonize\u00a0yes \u76ee\u7684\u662f\u53ef\u4ee5\u5728\u540e\u53f0\u6267\u884credis-server\u3002 7\uff0einit.d\u00a0\u542f\u52a8\u811a\u672c \u00a0\u00a0\u00a0\u00a0vi\u00a0/etc/init.d/redis-server #!/usr/bin/env\u00a0bash # #\u00a0redis\u00a0start\u00a0up\u00a0the\u00a0redis\u00a0server\u00a0daemon # #\u00a0chkconfig:\u00a0345\u00a099\u00a099 #\u00a0description:\u00a0redis\u00a0service\u00a0in\u00a0/etc/init.d/redis #\u00a0chkconfig\u00a0--add\u00a0redis\u00a0or\u00a0chkconfig\u00a0--list\u00a0redis #\u00a0service\u00a0redis\u00a0start\u00a0or\u00a0service\u00a0redis\u00a0stop #\u00a0processname:\u00a0redis-server #\u00a0config:\u00a0/etc/redis.conf PATH=/usr/local/bin:/sbin:/usr/bin:/bin REDISPORT=6379 EXEC=/usr/local/bin/redis-server REDIS_CLI=/usr/local/bin/redis-cli PIDFILE=/var/run/redis.pid CONF=\"/etc/redis.conf\" #make\u00a0sure\u00a0some\u00a0dir\u00a0exist if\u00a0[\u00a0!\u00a0-d\u00a0/var/lib/redis\u00a0]\u00a0then mkdir\u00a0-p\u00a0/var/lib/redis mkdir\u00a0-p\u00a0/var/log/redis fi case\u00a0\"$1\"\u00a0in status) ps\u00a0-A|grep\u00a0redis ;; start) if\u00a0[\u00a0-f\u00a0$PIDFILE\u00a0] then echo\u00a0\"$PIDFILE\u00a0exists,\u00a0process\u00a0is\u00a0already\u00a0running\u00a0or\u00a0crashed\" else echo\u00a0\"Starting\u00a0Redis\u00a0server...\" $EXEC\u00a0$CONF fi if\u00a0[\u00a0\"$?\"=\"0\"\u00a0] then echo\u00a0\"Redis\u00a0is\u00a0running...\" fi ;; stop) if\u00a0[\u00a0!\u00a0-f\u00a0$PIDFILE\u00a0] then echo\u00a0\"$PIDFILE\u00a0does\u00a0not\u00a0exist,\u00a0process\u00a0is\u00a0not\u00a0running\" else PID=$(cat\u00a0$PIDFILE) echo\u00a0\"Stopping\u00a0...\" $REDIS_CLI\u00a0-p\u00a0$REDISPORT\u00a0SHUTDOWN while\u00a0[\u00a0-x\u00a0${PIDFILE}\u00a0] do echo\u00a0\"Waiting\u00a0for\u00a0Redis\u00a0to\u00a0shutdown\u00a0...\" sleep\u00a01 done echo\u00a0\"Redis\u00a0stopped\" fi ;; restart|force-reload) ${0}\u00a0stop ${0}\u00a0start ;; *) echo\u00a0\"Usage:\u00a0/etc/init.d/redis\u00a0{start|stop|restart|force-reload}\"\u00a0&gt;&amp;2 exit\u00a01 esac \u6267\u884c\uff1a $\u00a0chmod\u00a0o+x\u00a0/etc/init.d/redis-server $\u00a0chkconfig\u00a0\u2013add\u00a0redis-server $\u00a0service\u00a0redis-server\u00a0start \u4e94\uff1a\u4ece\u670d\u52a1\u5668\u914d\u7f6eredis \u4ece\u670d\u52a1\u5668\uff0c\u914d\u7f6e\u4e00\u6837\uff0c\u53ea\u4e0d\u8fc7\u00a0\u4fee\u6539/etc/redis.conf\u00a0\u4e2d slaveof\u00a0 \u4fee\u6539\u4e3a slaveof\u00a0172.16.206.28\u00a06379 \u7136\u540e\u5f00\u542f\u4ece\u670d\u52a1\u5668\u7684redis\u670d\u52a1\u3002 start\u00a0redis-server\u00a0start \u516d\uff1a\u8fdb\u884credis\u4e3b\u4ece\u6d4b\u8bd5 #\u4e3b\u670d\u52a1\u5668 redis-cli\u00a0-p\u00a06379\u00a0set\u00a0hello\u00a0world #\u4ece\u670d\u52a1\u5668 redis-cli\u00a0-p\u00a06379\u00a0get\u00a0hello \u201cworld\u201d #\u4e3b\u670d\u52a1\u5668 redis-cli\u00a0-p\u00a06379\u00a0set\u00a0hello2\u00a0world2 #\u4ece\u670d\u52a1\u5668 redis-cli\u00a0-p\u00a06379\u00a0get\u00a0hello2 \u201cworld2\u201d redis-cli\u00a0-p\u00a06379\u00a0set\u00a0hello\u00a0world (error)\u00a0READONLY\u00a0You\u00a0can\u2019t\u00a0write\u00a0against\u00a0a\u00a0read\u00a0only\u00a0slave. \u6210\u529f\u914d\u7f6e\u4e3b\u4eceredis\u670d\u52a1\u5668\uff0c\u7531\u4e8e\u914d\u7f6e\u4e2d\u6709\u4e00\u6761\u4ece\u670d\u52a1\u5668\u662f\u53ea\u8bfb\u7684\uff0c\u6240\u4ee5\u4ece\u670d\u52a1\u5668\u6ca1\u6cd5\u8bbe\u7f6e\u6570\u636e\uff0c\u53ea\u53ef\u4ee5\u8bfb\u53d6\u6570\u636e\u3002 \u4e03\uff1a\u5b89\u88c5\u548c\u914d\u7f6ekeepalived 1\uff0e\u00a0wget\u00a0http://www.keepalived.org/software/keepalived-1.2.15.tar.gz tar\u00a0-zxvf\u00a0keepalived-1.2.15.tar.gz cd\u00a0keepalived-1.2.15 2\uff0e\u00a0\u00a0\u5b89\u88c5openssl-devel\u548ckernel-devel yum\u00a0install\u00a0openssl-devel yum\u00a0install\u00a0kernel-devel ln\u00a0-s\u00a0/usr/src/kernels/2.6.32-431.el6.x86_64\u00a0/usr/src/linux 3\uff0e\u00a0\u914d\u7f6e\u7f16\u8bd1\u5b89\u88c5 ./configure\u2013prefix=/usr/local/keepalived\u00a0\u00a0\u2013with-kernel-dir=/usr/src/linux\u00a0\u00a0\u00a0\u2013enable-sha1 make\u00a0&amp;&amp;\u00a0make\u00a0install 4\uff0e\u00a0\u590d\u5236keepalived\u76f8\u5173\u6587\u4ef6 cp\u00a0/usr/local/keepalived/etc/sysconfig/keepalived\u00a0/etc/sysconfig/keepalived cp\u00a0/usr/local/keepalived/sbin/keepalived\u00a0/usr/sbin/keepalived cp\u00a0/usr/local/keepalived/etc/rc.d/init.d/keepalived\u00a0/etc/init.d/keepalived mkdir\u00a0/etc/keepalived cp\u00a0/usr/local/keepalived/etc/keepalived/samples/keepalived.conf.virtualhost /etc/keepalived/keepalived.conf \u516b\uff1a\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u548c\u76f8\u5173\u811a\u672c 1\uff0e\u00a0\u5728Master\u4e0a\u521b\u5efa\u914d\u7f6e\u6587\u4ef6keepalived.conf vi\u00a0/etc/keepalived/keepalived.conf ////////////////////////////////////////////////// !\u00a0Configuration\u00a0File\u00a0for\u00a0keepalived vrrp_script\u00a0chk_redis\u00a0{ \u00a0\u00a0script\u00a0\"/etc/keepalived/scripts/redis_check.sh\"\u00a0###\u76d1\u63a7\u811a\u672c \u00a0\u00a0interval\u00a02\u00a0###\u76d1\u63a7\u65f6\u95f4 } #\u7f51\u5361\u9700\u8981\u6ce8\u610f\uff0c\u4f7f\u7528ifconfig\u67e5\u770b\u4e00\u4e0b\u5f53\u524d\u6d3b\u52a8\u7f51\u5361 vrrp_instance\u00a0VI_1\u00a0{ \u00a0\u00a0state\u00a0MASTER\u00a0###\u8bbe\u7f6e\u4e3aMASTER \u00a0\u00a0interface\u00a0eth0\u00a0###\u76d1\u63a7\u7f51\u5361 \u00a0\u00a0virtual_router_id\u00a051 \u00a0\u00a0priority\u00a0100\u00a0###\u6743\u91cd\u503c \u00a0\u00a0authentication\u00a0{ \u00a0\u00a0\u00a0\u00a0auth_type\u00a0PASS\u00a0###\u52a0\u5bc6 \u00a0\u00a0\u00a0\u00a0auth_pass\u00a01111\u00a0###\u5bc6\u7801 \u00a0\u00a0} \u00a0\u00a0track_script\u00a0{ \u00a0\u00a0\u00a0\u00a0chk_redis\u00a0###\u6267\u884c\u4e0a\u9762\u5b9a\u4e49\u7684chk_redis \u00a0\u00a0} \u00a0\u00a0virtual_ipaddress\u00a0{ \u00a0\u00a0\u00a0\u00a0172.16.206.250\u00a0######VIP \u00a0\u00a0} \u00a0\u00a0notify_master\u00a0/etc/keepalived/scripts/redis_master.sh \u00a0\u00a0notify_backup\u00a0/etc/keepalived/scripts/redis_backup.sh \u00a0\u00a0notify_fault\u00a0/etc/keepalived/scripts/redis_fault.sh \u00a0\u00a0notify_stop\u00a0/etc/keepalived/scripts/redis_stop.sh } 2\uff0e\u5728Slave\u4e0a\u521b\u5efa\u914d\u7f6e\u6587\u4ef6keepalived.conf vim\u00a0/etc/keepalived/keepalived.conf ////////////////////////////////////////////////// !\u00a0Configuration\u00a0File\u00a0for\u00a0keepalived vrrp_script\u00a0chk_redis\u00a0{ \u00a0\u00a0script\u00a0\"/etc/keepalived/scripts/redis_check.sh\"\u00a0###\u76d1\u63a7\u811a\u672c \u00a0\u00a0interval\u00a02\u00a0###\u76d1\u63a7\u65f6\u95f4 } #\u540c\u6837\u8981\u6ce8\u610f\u7f51\u5361 vrrp_instance\u00a0VI_1\u00a0{ \u00a0\u00a0state\u00a0BACKUP\u00a0###\u8bbe\u7f6e\u4e3aBACKUP \u00a0\u00a0interface\u00a0eth0\u00a0###\u76d1\u63a7\u7f51\u5361 \u00a0\u00a0virtual_router_id\u00a051 \u00a0\u00a0priority\u00a010\u00a0###\u6bd4MASTRE\u6743\u91cd\u503c\u4f4e \u00a0\u00a0authentication\u00a0{ \u00a0\u00a0\u00a0\u00a0auth_type\u00a0PASS \u00a0\u00a0\u00a0\u00a0auth_pass\u00a01111\u00a0###\u5bc6\u7801\u4e0eMASTRE\u76f8\u540c \u00a0\u00a0} \u00a0\u00a0track_script\u00a0{ \u00a0\u00a0\u00a0\u00a0chk_redis\u00a0###\u6267\u884c\u4e0a\u9762\u5b9a\u4e49\u7684chk_redis \u00a0\u00a0} \u00a0\u00a0virtual_ipaddress\u00a0{ \u00a0\u00a0\u00a0\u00a0172.16.206.250\u00a0####vip \u00a0\u00a0} \u00a0\u00a0notify_master\u00a0/etc/keepalived/scripts/redis_master.sh \u00a0\u00a0notify_backup\u00a0/etc/keepalived/scripts/redis_backup.sh \u00a0\u00a0notify_fault\u00a0/etc/keepalived/scripts/redis_fault.sh \u00a0\u00a0notify_stop\u00a0/etc/keepalived/scripts/redis_stop.sh } 3\uff0e\u5728Master\u548cSlave\u4e0a\u521b\u5efa\u76d1\u63a7Redis\u7684\u811a\u672c $\u00a0\u00a0mkdir\u00a0/etc/keepalived/scripts $\u00a0\u00a0vim\u00a0/etc/keepalived/scripts/redis_check.sh #!/bin/bash ALIVE=`/usr/local/bin/redis-cli\u00a0-p\u00a06379\u00a0-a\u00a0password_of_redis\u00a0PING` if\u00a0[\u00a0\"$ALIVE\"\u00a0==\u00a0\"PONG\"\u00a0];\u00a0then \u00a0\u00a0echo\u00a0$ALIVE \u00a0\u00a0exit\u00a00 else \u00a0\u00a0echo\u00a0$ALIVE \u00a0\u00a0exit\u00a01 fi 4\uff0e\u7f16\u5199\u5173\u952e\u811a\u672c notify_master\u00a0/etc/keepalived/scripts/redis_master.sh notify_backup\u00a0/etc/keepalived/scripts/redis_backup.sh notify_fault\u00a0/etc/keepalived/scripts/redis_fault.sh notify_stop\u00a0/etc/keepalived/scripts/redis_stop.sh Keepalived\u5728\u8f6c\u6362\u72b6\u6001\u65f6\u4f1a\u4f9d\u7167\u72b6\u6001\u6765\u6267\u884c\u811a\u672c\uff1a <ul> <li>\u5f53\u8fdb\u5165Master\u72b6\u6001\u65f6\u4f1a\u547c\u53eb\u00a0notify_master</li> <li>\u5f53\u8fdb\u5165Backup\u72b6\u6001\u65f6\u4f1a\u547c\u53eb\u00a0notify_backup</li> <li>\u5f53\u53d1\u73b0\u5f02\u5e38\u60c5\u51b5\u65f6\u8fdb\u5165Fault\u72b6\u6001\u547c\u53eb\u00a0notify_fault</li> <li>\u5f53\u7a0b\u5e8f\u7ec8\u6b62\u65f6\u5219\u547c\u53eb\u00a0notify_stop</li> </ul> 4.1\u00a0\u5728Redis\u00a0Master\u4e0a\u521b\u5efanotity_master\u4e0enotify_backup\u811a\u672c\uff1a vi\u00a0/etc/keepalived/scripts/redis_master.sh #!/bin/bash REDISCLI=\"/usr/local/bin/redis-cli\" LOGFILE=\"/var/log/keepalived-redis-state.log\" echo\u00a0\"[master]\"\u00a0&gt;&gt;\u00a0$LOGFILE date\u00a0&gt;&gt;\u00a0$LOGFILE echo\u00a0\"Being\u00a0master....\"\u00a0&gt;&gt;\u00a0$LOGFILE\u00a02&gt;&amp;1 echo\u00a0\"Run\u00a0SLAVEOF\u00a0cmd\u00a0...\"\u00a0&gt;&gt;\u00a0$LOGFILE $REDISCLI\u00a0SLAVEOF\u00a0172.16.206.sl\u00a06379\u00a0&gt;&gt;\u00a0$LOGFILE\u00a02&gt;&amp;1 sleep\u00a010\u00a0#\u5ef6\u8fdf10\u79d2\u4ee5\u540e\u5f85\u6570\u636e\u540c\u6b65\u5b8c\u6210\u540e\u518d\u53d6\u6d88\u540c\u6b65\u72b6\u6001 echo\u00a0\"Run\u00a0SLAVEOF\u00a0NO\u00a0ONE\u00a0cmd\u00a0...\"\u00a0&gt;&gt;\u00a0$LOGFILE $REDISCLI\u00a0SLAVEOF\u00a0NO\u00a0ONE\u00a0&gt;&gt;\u00a0$LOGFILE\u00a02&gt;&amp;1 vi\u00a0/etc/keepalived/scripts/redis_backup.sh #!/bin/bash REDISCLI=\"/usr/local/bin/redis-cli\" LOGFILE=\"/var/log/keepalived-redis-state.log\" echo\u00a0\"[backup]\"\u00a0&gt;&gt;\u00a0$LOGFILE date\u00a0&gt;&gt;\u00a0$LOGFILE echo\u00a0\"Being\u00a0slave....\"\u00a0&gt;&gt;\u00a0$LOGFILE\u00a02&gt;&amp;1 sleep\u00a015\u00a0#\u5ef6\u8fdf15\u79d2\u5f85\u6570\u636e\u88ab\u5bf9\u65b9\u540c\u6b65\u5b8c\u6210\u4e4b\u540e\u518d\u5207\u6362\u4e3b\u4ece\u89d2\u8272 echo\u00a0\"Run\u00a0SLAVEOF\u00a0cmd\u00a0...\"\u00a0&gt;&gt;\u00a0$LOGFILE $REDISCLI\u00a0SLAVEOF\u00a0192.168.1.sl\u00a06379\u00a0&gt;&gt;\u00a0$LOGFILE\u00a02&gt;&amp;1 4.2\u00a0\u5728Redis\u00a0Slave\u4e0a\u521b\u5efanotity_master\u4e0enotify_backup\u811a\u672c\uff1a vi\u00a0/etc/keepalived/scripts/redis_master.sh #!/bin/bash REDISCLI=\"/usr/local/bin/redis-cli\" LOGFILE=\"/var/log/keepalived-redis-state.log\" echo\u00a0\"[master]\"\u00a0&gt;&gt;\u00a0$LOGFILE date\u00a0&gt;&gt;\u00a0$LOGFILE echo\u00a0\"Being\u00a0master....\"\u00a0&gt;&gt;\u00a0$LOGFILE\u00a02&gt;&amp;1 echo\u00a0\"Run\u00a0SLAVEOF\u00a0cmd\u00a0...\"\u00a0&gt;&gt;\u00a0$LOGFILE $REDISCLI\u00a0SLAVEOF\u00a0192.168.1.ma\u00a06379\u00a0&gt;&gt;\u00a0$LOGFILE\u00a02&gt;&amp;1 sleep\u00a010\u00a0#\u5ef6\u8fdf10\u79d2\u4ee5\u540e\u5f85\u6570\u636e\u540c\u6b65\u5b8c\u6210\u540e\u518d\u53d6\u6d88\u540c\u6b65\u72b6\u6001 echo\u00a0\"Run\u00a0SLAVEOF\u00a0NO\u00a0ONE\u00a0cmd\u00a0...\"\u00a0&gt;&gt;\u00a0$LOGFILE $REDISCLI\u00a0SLAVEOF\u00a0NO\u00a0ONE\u00a0&gt;&gt;\u00a0$LOGFILE\u00a02&gt;&amp;1 vi\u00a0/etc/keepalived/scripts/redis_backup.sh #!/bin/bash REDISCLI=\"/usr/local/bin/redis-cli\" LOGFILE=\"/var/log/keepalived-redis-state.log\" echo\u00a0\"[backup]\"\u00a0&gt;&gt;\u00a0$LOGFILE date\u00a0&gt;&gt;\u00a0$LOGFILE echo\u00a0\"Being\u00a0slave....\"\u00a0&gt;&gt;\u00a0$LOGFILE\u00a02&gt;&amp;1 sleep\u00a015\u00a0#\u5ef6\u8fdf15\u79d2\u5f85\u6570\u636e\u88ab\u5bf9\u65b9\u540c\u6b65\u5b8c\u6210\u4e4b\u540e\u518d\u5207\u6362\u4e3b\u4ece\u89d2\u8272 echo\u00a0\"Run\u00a0SLAVEOF\u00a0cmd\u00a0...\"\u00a0&gt;&gt;\u00a0$LOGFILE $REDISCLI\u00a0SLAVEOF\u00a0192.168.1.4\u00a06379\u00a0&gt;&gt;\u00a0$LOGFILE\u00a02&gt;&amp;1 4.3\u00a0\u7136\u540e\u5728Master\u4e0eSlave\u521b\u5efa\u5982\u4e0b\u76f8\u540c\u7684\u811a\u672c\uff1a vi\u00a0/etc/keepalived/scripts/redis_fault.sh #!/bin/bash LOGFILE=/var/log/keepalived-redis-state.log echo\u00a0\"[fault]\"\u00a0&gt;&gt;\u00a0$LOGFILE date\u00a0&gt;&gt;\u00a0$LOGFILE vi\u00a0/etc/keepalived/scripts/redis_stop.sh #!/bin/bash LOGFILE=/var/log/keepalived-redis-state.log echo\u00a0\"[stop]\"\u00a0&gt;&gt;\u00a0$LOGFILE date\u00a0&gt;&gt;\u00a0$LOGFILE 4.4\u00a0\u5728\u4e3b\u4ece\u670d\u52a1\u5668\u4e0a\u9762\u7ed9\u811a\u672c\u90fd\u52a0\u4e0a\u53ef\u6267\u884c\u6743\u9650\uff1a chmod\u00a0+x\u00a0/etc/keepalived/scripts/*.sh \u4e5d\uff1a\u76f8\u5173\u529f\u80fd\u6d4b\u8bd5 1.\u00a0\u542f\u52a8Master\u548cslave\u4e0a\u7684Redis service\u00a0redis-server\u00a0start 2.\u542f\u52a8Master\u548cslave\u4e0a\u7684Keepalived /etc/init.d/keepalived\u00a0start 3.\u5c1d\u8bd5\u901a\u8fc7VIP\u8fde\u63a5Redis: $\u00a0redis-cli\u00a0-h\u00a0172.16.206.250\u00a0-p\u00a06379\u00a0-a\u00a0password_of_redis\u00a0INFO \u8fde\u63a5\u6210\u529f\uff0c\u53ef\u4ee5\u770b\u5230\u4e3b\u4ece\u673a\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\uff1a role:master slave0:172.16.206.28,6379,online 4.\u5c1d\u8bd5\u63d2\u5165\u4e00\u4e9b\u6570\u636e\uff1a $\u00a0redis-cli\u00a0-h\u00a0172.16.206.250\u00a0SET\u00a0hello3\u00a0world3 OK \u4eceVIP\u8bfb\u53d6\u6570\u636e $\u00a0redis-cli\u00a0-h\u00a0172.16.206.250\u00a0GET\u00a0hello3 \u201cworld3\u201d \u4eceMaster\u8bfb\u53d6\u6570\u636e $\u00a0redis-cli\u00a0-h\u00a0172.16.206.29\u00a0GET\u00a0hello3 \u201cworld3\u201d \u4eceSlave\u8bfb\u53d6\u6570\u636e $\u00a0redis-cli\u00a0-h\u00a0172.16.206.28\u00a0GET\u00a0hello3 \u201cworld3\u201d 5.\u5c06Master\u4e0a\u7684Redis\u8fdb\u7a0b\u6740\u6b7b\uff1a $\u00a0service\u00a0redis-server\u00a0stop \u67e5\u770bMaster\u4e0a\u7684Keepalived\u65e5\u5fd7 $\u00a0tail\u00a0-f\u00a0/var/log/keepalived-redis-state.log [fault] Mon\u00a0Jan\u00a0\u00a05\u00a014:06:22\u00a0CST\u00a02015 \u540c\u65f6Slave\u4e0a\u7684\u65e5\u5fd7\u663e\u793a\uff1a $\u00a0tail\u00a0-f\u00a0/var/log/keepalived-redis-state.log [master] Mon\u00a0Jan\u00a0\u00a05\u00a014:13:52\u00a0CST\u00a02015 Being\u00a0master\u2026. Run\u00a0SLAVEOF\u00a0cmd\u00a0\u2026 OK\u00a0Already\u00a0connected\u00a0to\u00a0specified\u00a0master Run\u00a0SLAVEOF\u00a0NO\u00a0ONE\u00a0cmd\u00a0\u2026 OK \u73b0\u5728\uff0cSlave\u5df2\u7ecf\u63a5\u7ba1\u670d\u52a1\uff0c\u5e76\u4e14\u62e5\u6709Master\u7684\u89d2\u8272 $\u00a0redis-cli\u00a0-h\u00a0172.16.206.250\u00a0INFO $\u00a0redis-cli\u00a0-h\u00a0172.16.206.28\u00a0INFO role:master 6.\u7136\u540e\u6062\u590dMaster\u7684Redis\u8fdb\u7a0b $\u00a0\u00a0service\u00a0redis-server\u00a0start \u67e5\u770bMaster\u4e0a\u7684Keepalived\u65e5\u5fd7 $\u00a0tail\u00a0-f\u00a0/var/log/keepalived-redis-state.log [master] 2015\u5e74\u00a001\u6708\u00a005\u65e5\u00a0\u661f\u671f\u4e00\u00a015:48:08\u00a0CST Being\u00a0master\u2026. Run\u00a0SLAVEOF\u00a0cmd\u00a0\u2026 OK Run\u00a0SLAVEOF\u00a0NO\u00a0ONE\u00a0cmd\u00a0\u2026 OK \u540c\u65f6Slave\u4e0a\u7684\u65e5\u5fd7\u663e\u793a\uff1a $\u00a0tail\u00a0-f\u00a0/var/log/keepalived-redis-state.log [backup] Mon\u00a0Jan\u00a0\u00a05\u00a014:53:16\u00a0CST\u00a02015 Being\u00a0slave\u2026. Run\u00a0SLAVEOF\u00a0cmd\u00a0\u2026 OK Master\u5df2\u7ecf\u518d\u6b21\u6062\u590d\u4e86Master\u89d2\u8272 \u6458\u81ea\u300chttp://abcve.com/redis-keepalived/\u300d","tags":["Keepalived","Redis","\u9ad8\u53ef\u7528"]},{"location":"DevOps/2016-11-04-gitsvn-resetrevert-%25e5%259b%259e%25e6%25bb%259a%25e5%2588%25b0%25e6%259c%258d%25e5%258a%25a1%25e5%2599%25a8%25e4%25b8%258a%25e7%259a%2584%25e6%259f%2590%25e4%25b8%2580%25e4%25b8%25aa%25e7%2589%2588%25e6%259c%25ac.html/","title":"git/svn reset/revert \u56de\u6eda\u5230\u670d\u52a1\u5668\u4e0a\u7684\u67d0\u4e00\u4e2a\u7248\u672c","text":"<p>Git:</p> <p>1\u3001git log</p> <p>\u67e5\u627e\u5230\u8981\u56de\u6eda\u7684\u7248\u672c\u53f7\uff0c\u8bbe\u4e3aaldfjsajdfljsadf</p> <p>2\u3001git reset \u00a0--hard\u00a0aldfjsajdfljsadf</p> <p>reset \u4f1a\u5f71\u54cd commit\u00a0aldfjsajdfljsadf \u4e4b\u540e\u7684commit\u90fd\u4f1a\u88ab\u9000\u56de\u5230\u6682\u5b58\u533a</p> <p>revert\u662f\u64a4\u9500\u67d0\u6b21\u64cd\u4f5c\uff0c\u6b64\u6b21\u64cd\u4f5c\u4e4b\u524d\u7684commit\u90fd\u4f1a\u88ab\u4fdd\u7559\uff0c\u8c8c\u4f3c\u4e4b\u540e\u7684\u4e5f\u4f1a\u88ab\u4fdd\u7559</p> <p>git revert \u64a4\u9500 \u67d0\u6b21\u64cd\u4f5c\uff0c\u6b64\u6b21\u64cd\u4f5c\u4e4b\u524d\u548c\u4e4b\u540e\u7684commit\u548chistory\u90fd\u4f1a\u4fdd\u7559\uff0c\u5e76\u4e14\u628a\u8fd9\u6b21\u64a4\u9500 \u4f5c\u4e3a\u4e00\u6b21\u6700\u65b0\u7684\u63d0\u4ea4 * git revert HEAD\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u64a4\u9500\u524d\u4e00\u6b21 commit * git revert HEAD^\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u64a4\u9500\u524d\u524d\u4e00\u6b21 commit * git revert commit \uff08\u6bd4\u5982\uff1afa042ce57ebbe5bb9c8db709f719cec2c58ee7ff\uff09\u64a4\u9500\u6307\u5b9a\u7684\u7248\u672c\uff0c\u64a4\u9500\u4e5f\u4f1a\u4f5c\u4e3a\u4e00\u6b21\u63d0\u4ea4\u8fdb\u884c\u4fdd\u5b58\u3002 git revert\u662f\u63d0\u4ea4\u4e00\u4e2a\u65b0\u7684\u7248\u672c\uff0c\u5c06\u9700\u8981revert\u7684\u7248\u672c\u7684\u5185\u5bb9\u518d\u53cd\u5411\u4fee\u6539\u56de\u53bb\uff0c\u7248\u672c\u4f1a\u9012\u589e\uff0c\u4e0d\u5f71\u54cd\u4e4b\u524d\u63d0\u4ea4\u7684\u5185\u5bb9</p> <p>Svn:</p> <p>svn log</p> <p>\u67e5\u627e\u5230\u8981\u56de\u6eda\u7684\u7248\u672c\u53f7</p> <p>------------------------------------------------------------------------ r26 | yaoming | 2014-02-12 15:06:17 +0800 | 5 \u884c [BSP]\u79fb\u9664BSP\u5206\u652f \u9002\u7528\u673a\u578b:M65U \u9a8c\u8bc1\u5efa\u8bae: \u5173\u8054\u53d8\u66f4\u9879: \u65e0 checked by liuxiang ------------------------------------------------------------------------ r25 | yaoming | 2014-02-11 17:55:44 +0800 | 5 \u884c [BSP]\u6dfb\u52a0MT6592\u5e73\u53f0\u652f\u6301 \u9002\u7528\u673a\u578b:M65U \u9a8c\u8bc1\u5efa\u8bae: \u5173\u8054\u53d8\u66f4\u9879: \u65e0 checked by liuxiang</p> <p>\u4ece26\u56de\u6eda\u523025</p> <p>svn diff -r 26:25 \"\" </p> <p>svn merge -r\u00a026:25 \"\"</p> svn\u4ee3\u7801\u56de\u6eda\u547d\u4ee4 \u53d6\u6d88\u5bf9\u4ee3\u7801\u7684\u4fee\u6539\u5206\u4e3a\u4e24\u79cd\u60c5\u51b5\uff1a \u7b2c\u4e00\u79cd\u60c5\u51b5\uff1a\u6539\u52a8\u6ca1\u6709\u88ab\u63d0\u4ea4\uff08commit\uff09\u3002 \u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528svn revert\u5c31\u80fd\u53d6\u6d88\u4e4b\u524d\u7684\u4fee\u6539\u3002 svn revert\u7528\u6cd5\u5982\u4e0b\uff1a # svn revert [-R] something \u5176\u4e2dsomething\u53ef\u4ee5\u662f\uff08\u76ee\u5f55\u6216\u6587\u4ef6\u7684\uff09\u76f8\u5bf9\u8def\u5f84\u4e5f\u53ef\u4ee5\u662f\u7edd\u5bf9\u8def\u5f84\u3002 \u5f53something\u4e3a\u5355\u4e2a\u6587\u4ef6\u65f6\uff0c\u76f4\u63a5svn revert something\u5c31\u884c\u4e86\uff1b\u5f53something\u4e3a\u76ee\u5f55\u65f6\uff0c\u9700\u8981\u52a0\u4e0a\u53c2\u6570-R(Recursive,\u9012\u5f52)\uff0c\u5426\u5219\u53ea\u4f1a\u5c06something\u8fd9\u4e2a\u76ee\u5f55\u7684\u6539\u52a8\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4e5f\u53ef\u4ee5\u4f7f\u7528svn update\u547d\u4ee4\u6765\u53d6\u6d88\u5bf9\u4e4b\u524d\u7684\u4fee\u6539\uff0c\u4f46\u4e0d\u5efa\u8bae\u4f7f\u7528\u3002\u56e0\u4e3asvn update\u4f1a\u53bb\u8fde\u63a5\u4ed3\u5e93\u670d\u52a1\u5668\uff0c\u8017\u8d39\u65f6\u95f4\u3002 \u6ce8\u610f\uff1asvn revert\u672c\u8eab\u6709\u56fa\u6709\u7684\u5371\u9669\uff0c\u56e0\u4e3a\u5b83\u7684\u76ee\u7684\u662f\u653e\u5f03\u672a\u63d0\u4ea4\u7684\u4fee\u6539\u3002\u4e00\u65e6\u4f60\u9009\u62e9\u4e86\u6062\u590d\uff0cSubversion\u6ca1\u6709\u65b9\u6cd5\u627e\u56de\u672a\u63d0\u4ea4\u7684\u4fee\u6539\u3002 \u7b2c\u4e8c\u79cd\u60c5\u51b5\uff1a\u6539\u52a8\u5df2\u7ecf\u88ab\u63d0\u4ea4\uff08commit\uff09\u3002 \u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7528svn merge\u547d\u4ee4\u6765\u8fdb\u884c\u56de\u6eda\u3002 \u00a0\u00a0\u00a0\u56de\u6eda\u7684\u64cd\u4f5c\u8fc7\u7a0b\u5982\u4e0b\uff1a \u00a0\u00a0\u00a01\u3001\u4fdd\u8bc1\u6211\u4eec\u62ff\u5230\u7684\u662f\u6700\u65b0\u4ee3\u7801\uff1a \u00a0\u00a0\u00a0\u00a0\u00a0svn update \u00a0\u00a0\u00a0\u00a0\u00a0\u5047\u8bbe\u6700\u65b0\u7248\u672c\u53f7\u662f28\u3002 \u00a0\u00a0\u00a02\u3001\u7136\u540e\u627e\u51fa\u8981\u56de\u6eda\u7684\u786e\u5207\u7248\u672c\u53f7\uff1a \u00a0\u00a0\u00a0\u00a0\u00a0svn log [something] \u00a0\u00a0\u00a0\u00a0\u00a0\u5047\u8bbe\u6839\u636esvn log\u65e5\u5fd7\u67e5\u51fa\u8981\u56de\u6eda\u7684\u7248\u672c\u53f7\u662f25\uff0c\u6b64\u5904\u7684something\u53ef\u4ee5\u662f\u6587\u4ef6\u3001\u76ee\u5f55\u6216\u6574\u4e2a\u9879\u76ee \u00a0\u00a0\u00a0\u00a0\u00a0\u5982\u679c\u60f3\u8981\u66f4\u8be6\u7ec6\u7684\u4e86\u89e3\u60c5\u51b5\uff0c\u53ef\u4ee5\u4f7f\u7528svn diff -r 28:25 [something] \u00a0\u00a0\u00a03\u3001\u56de\u6eda\u5230\u7248\u672c\u53f725\uff1a \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0svn merge -r 28:25 something \u00a0\u00a0\u00a0\u00a0\u00a0\u4e3a\u4e86\u4fdd\u9669\u8d77\u89c1\uff0c\u518d\u6b21\u786e\u8ba4\u56de\u6eda\u7684\u7ed3\u679c\uff1a \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0svn diff [something] \u00a0\u00a0\u00a0\u00a0\u00a0\u53d1\u73b0\u6b63\u786e\u65e0\u8bef\uff0c\u63d0\u4ea4\u3002 \u00a0\u00a0\u00a04\u3001\u63d0\u4ea4\u56de\u6eda\uff1a \u00a0\u00a0\u00a0\u00a0\u00a0svn commit -m \"Revert revision from r28 to r25,because of ...\" \u00a0\u00a0\u00a0\u00a0\u00a0\u63d0\u4ea4\u540e\u7248\u672c\u53d8\u6210\u4e8629\u3002 \u00a0\u00a0\u00a0\u5c06\u4ee5\u4e0a\u64cd\u4f5c\u603b\u7ed3\u4e3a\u4e09\u6761\u5982\u4e0b\uff1a \u00a0\u00a0\u00a01. svn update\uff0csvn log\uff0c\u627e\u5230\u6700\u65b0\u7248\u672c\uff08latest revision\uff09 \u00a0\u00a0\u00a02. \u627e\u5230\u81ea\u5df1\u60f3\u8981\u56de\u6eda\u7684\u7248\u672c\u53f7\uff08rollbak revision\uff09 \u00a0\u00a0\u00a03. \u7528svn merge\u6765\u56de\u6eda\uff1a svn merge -r : something \u6458\u81ea\u300chttp://blog.csdn.net/angle_birds/article/details/19506405\u300d","tags":["svn","git"]},{"location":"DevOps/2016-12-08-centos-6-yum-%25e5%25ae%2589%25e8%25a3%2585-glusterfs-3-6.html/","title":"CentOS 6 yum \u5b89\u88c5  GlusterFS 3.6","text":"<p>GlusterFS \u5b89\u88c5\u81f3 o2o-gluster-1,o2o-gluster-2 ============================================================ \u4e24\u53f0\u673a\u7ec4\u6210GlusterFS Server\u96c6\u7fa4\u3002 1\u3001\u5b89\u88c5\u4f9d\u8d56\u5305 # yum -y install wget # cd /etc/yum.repos.d/ # wget http://download.gluster.org/pub/gluster/glusterfs/3.6/LATEST/CentOS/glusterfs-epel.repo # yum -y install epel-release</p> <p>2\u3001\u5b89\u88c5\u670d\u52a1\u7aef (o2o-gluster-1,o2o-gluster-2) # yum install glusterfs-server # service glusterd start  \u6216  # /etc/init.d/glusterd start # chkconfig glusterfsd on</p> <p>**\u5982\u679c\u662fo2o-gluster-1\uff0co2o-gluster-2\u96c6\u7fa4** ----------------------------------------------- \u4e0b\u9762\u8fd9\u884c\u547d\u4ee4\u5728\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\u6267\u884c\u5373\u53ef\uff0c\u72b6\u6001\u5c06\u540c\u6b65\u5230\u5176\u4ed6\u670d\u52a1\u5668 \u4f8b\u5982\u5728o2o-gluster-1\u4e0a\u6267\u884c # gluster peer probe o2o-gluster-2 -----------------------------------------------</p> <p>\u67e5\u770b\u72b6\u6001 # gluster peer status</p> <p>\u6ce8\uff1a\u5df2\u6302\u8f7d\u72ec\u7acb\u786c\u76d8\u5206\u533a\u5230/gfs_data\u76ee\u5f55 \u5728o2o-gluster-1\u548co2o-gluster-2\u4e2d\u5206\u522b\u6267\u884c # mkdir -p /gfs_data/glusterfs/brick1</p> <p>**\u5982\u679c\u662fo2o-gluster-1\uff0co2o-gluster-2\u96c6\u7fa4** ----------------------------------------------- \u5728o2o-gluster-1\u548co2o-gluster-2\u5176\u4e2d\u4e00\u53f0\u673a\u5668\u4e0a\u6267\u884c replica \u6307\u5b9a\u526f\u672c\u6570\u91cf # gluster volume create gv0 replica 2 o2o-gluster-1:/gfs_data/glusterfs/brick1 o2o-gluster-2:/gfs_data/glusterfs/brick1 -----------------------------------------------</p> <p>**\u5982\u679c\u662fo2o-gluster-1\u5355\u673a** ----------------------------------------------- gluster volume create gv0 o2o-gluster-1:/gfs_data/glusterfs/brick1 -----------------------------------------------</p> <p>\u542f\u52a8volume # gluster volume start gv0</p> <p>\u82e5\u8981\u4f7f\u7528Cache # gluster volume set gv0 performance.cache-size 1GB</p> <p># \u53ef\u9009\u9879\uff1a\u914d\u7f6eACL\u53ea\u5141\u8bb8\u6307\u5b9aIP\u8bbf\u95ee\u96c6\u7fa4\uff0c\u4f8b\u5982\uff1a gluster volume set gv0 auth.allow 10.10.0.1,10.10.0.2 \u67e5\u770bvolume\u72b6\u6001 # gluster volume status # gluster volume info</p> <p>3\u3001**\u5ba2\u6237\u7aef**\u6302\u8f7d\u8fdc\u7a0b\u6587\u4ef6\u7cfb\u7edf \uff08\u4ee5o2o-proxy-1\u4e3a\u4f8b\uff09 \u67e5\u627e glusterfs \u547d\u4ee4 # which glusterfs /usr/sbin/glusterfs  </p> <p>\u5982\u679cglusterfs\u547d\u4ee4**\u4e0d\u5b58\u5728**\uff0c\u5219\u5b89\u88c5glusterfs-client # yum install glusterfs-client </p> <p>\u6302\u8f7d\u76ee\u5f55 # mkdir -p /data/gfs_data # chown -R prod:prod /data/gfs_data</p> <p>\u5728\u5ba2\u6237\u673a\uff08\u4f8b\u5982o2o-proxy-1\uff09\u4e0a\u6267\u884c\u6302\u8f7d\u547d\u4ee4\uff08\u8bfb\u5199\u6a21\u5f0f\uff09\uff1a mount -t glusterfs -o rw o2o-gluster-1:/gv0 /data/gfs_data \u6ce8\uff1aro:\u53ea\u8bfb\u6a21\u5f0f  rw:\u8bfb\u5199\u6a21\u5f0f</p> <p>\u8bbe\u7f6e\u4e3a\u5f00\u673a\u81ea\u52a8\u6302\u8f7d # vi /etc/fstab \u8ffd\u52a0 o2o-gluster-1:/gv0 /data/gfs_data glusterfs defaults,_netdev 0 0</p>","tags":[]},{"location":"DevOps/2016-12-08-centos-6-yum-%25e5%25ae%2589%25e8%25a3%2585-nginx.html/","title":"CentOS 6  yum \u5b89\u88c5 nginx","text":"<p># cat /etc/redhat-release CentOS release 6.5 (Final)</p> <p># vi /etc/yum.repos.d/nginx.repo</p> <p>[nginx] name=nginx repo baseurl=http://nginx.org/packages/centos/6/x86_64/ gpgcheck=0 enabled=1</p> <p># yum install nginx</p> <p>\u542f\u52a8 # service ngnix start</p>","tags":[]},{"location":"DevOps/2016-12-20-mongodb-%25e7%25a3%2581%25e7%259b%2598%25e7%25a9%25ba%25e9%2597%25b4%25e9%2587%258d%25e7%2594%25a8%25e6%25b5%258b%25e8%25af%2595%25e5%25af%25b9%25e6%25af%2594-2-6-12-v-s-3-2-11.html/","title":"mongodb \u78c1\u76d8\u7a7a\u95f4\u91cd\u7528\u6d4b\u8bd5\u5bf9\u6bd4 (2.6.12 v.s. 3.2.11)","text":"","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-20-mongodb-%25e7%25a3%2581%25e7%259b%2598%25e7%25a9%25ba%25e9%2597%25b4%25e9%2587%258d%25e7%2594%25a8%25e6%25b5%258b%25e8%25af%2595%25e5%25af%25b9%25e6%25af%2594-2-6-12-v-s-3-2-11.html/#conclusion","title":"Conclusion","text":"<p>\u4ece\u6d4b\u8bd5\u65e5\u5fd7\u53ef\u4ee5\u770b\u51fa\uff1a mongodb3\u9ed8\u8ba4\u7684WiredTiger\u5b58\u50a8\u5f15\u64ce\uff0c\u4e0emongodb2\u7684MMAP\u76f8\u6bd4\uff0c\u5728\u7a7a\u95f4\u5229\u7528\u7387\u4e0a\u6709\u7740\u8d28\u7684\u98de\u8d8a\uff1b mongodb3\u5728\u5220\u9664\u96c6\u5408\u540e\uff0c\u5bf9\u5e94\u7684\u78c1\u76d8\u7a7a\u95f4\u4f1a\u7acb\u5373\u56de\u6536\uff0c\u8fd9\u6781\u5927\u7684\u51cf\u8f7b\u4e86\u8fd0\u7ef4\u5de5\u4f5c\u91cf\u3002</p> <p>\u4ee5\u4e0b\u662f\u6d4b\u8bd5\u65e5\u5fd7 (<code>mongodb_reuse_diskspace_test_log.txt</code>).</p>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-20-mongodb-%25e7%25a3%2581%25e7%259b%2598%25e7%25a9%25ba%25e9%2597%25b4%25e9%2587%258d%25e7%2594%25a8%25e6%25b5%258b%25e8%25af%2595%25e5%25af%25b9%25e6%25af%2594-2-6-12-v-s-3-2-11.html/#mongodb-2612-test-log","title":"Mongodb 2.6.12 test log","text":"<pre><code>$ mongo --version\nMongoDB shell version: 2.6.12\n=====================================================\n\u6d4b\u8bd5\u96c6\u5408\u540d\u79f0\uff1aperson2\n\u51c6\u5907\ndb.person2.drop();\ndb.repairDatabase();\n\n$ du -h -d 1 data/master\n80M data/master/admin\n0B data/master/journal\n10G data/master/local\n80M data/master/logevents\n10G data/master\n\n\u5199\u5165727.2\u4e07\n727.2\u4e07 person2.dataSize=1.6254186630249023G \u6bcf\u6761\u6570\u636e 240bytes\n$ du -h -d 1 data/master\n0B data/master/_tmp\n80M data/master/admin\n289M data/master/journal\n10G data/master/local\n4.0G data/master/logevents\n14G data/master\n\n\u518d\u5199\u5165500\u4e07\n[2016-12-15 14:08:33.460 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-15 14:09:39.644 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-15 14:09:40.471 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-15 14:10:48.308 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-15 14:10:48.969 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-15 14:11:58.608 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-15 14:11:59.592 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-15 14:13:09.636 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-15 14:13:10.622 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-15 14:14:35.282 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n\n1227.2\u4e07 person2.dataSize=2.7430057525634766G\n$ du -h -d 1 data/master\n0B data/master/_tmp\n80M data/master/admin\n491M data/master/journal\n10G data/master/local\n6.0G data/master/logevents\n17G data/master\n\n\u5220\u9664\u96c6\u5408 db.person2.drop();\n$ du -h -d 1 data/master\n0B data/master/_tmp\n80M data/master/admin\n492M data/master/journal\n10G data/master/local\n6.0G data/master/logevents\n17G data/master\n\n\u518d\u5199\u5165500\u4e07\n[2016-12-15 14:17:39.876 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-15 14:18:29.688 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-15 14:18:30.380 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-15 14:19:18.009 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-15 14:19:18.591 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-15 14:20:07.668 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-15 14:20:08.188 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-15 14:20:58.533 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-15 14:20:59.098 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-15 14:21:56.991 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n\n500\u4e07 person2.dataSize=1.1175870895385742G\n$ du -h -d 1 data/master\n0B data/master/_tmp\n80M data/master/admin\n325M data/master/journal\n10G data/master/local\n6.0G data/master/logevents\n16G data/master\n</code></pre>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-20-mongodb-%25e7%25a3%2581%25e7%259b%2598%25e7%25a9%25ba%25e9%2597%25b4%25e9%2587%258d%25e7%2594%25a8%25e6%25b5%258b%25e8%25af%2595%25e5%25af%25b9%25e6%25af%2594-2-6-12-v-s-3-2-11.html/#mongodb-3211-test-log","title":"Mongodb 3.2.11 test log","text":"<pre><code>$ mongo --version\nMongoDB shell version: 3.2.11\n=====================================================\n[echo@EchoMa data]$ du -h -d 1 master\n20K master/diagnostic.data\n300M master/journal\n64K master/local\n300M master\n\n\u9996\u5148\u5411logevents.person2\u5199\u5165800\u4e07\n\n[2016-12-20 11:14:57.037 CST] main INFO context.TestContextManager: Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [javax/servlet/ServletContext]\n[2016-12-20 11:14:57.212 CST] main INFO xml.XmlBeanDefinitionReader: Loading XML bean definitions from URL [file:/Users/echo/workjava/ctower-v3.0/mongodb-demo/target/classes/applicationContext-mongo2.xml]\n[2016-12-20 11:14:57.533 CST] main INFO support.GenericApplicationContext: Refreshing org.springframework.context.support.GenericApplicationContext@321e4dd0: startup date [Tue Dec 20 11:14:57 CST 2016]; root of context hierarchy\n[2016-12-20 11:14:57.644 CST] main INFO config.PropertyPlaceholderConfigurer: Loading properties file from URL [file:/Users/echo/workjava/ctower-v3.0/mongodb-demo/target/classes/conf/conf-mongo2.properties]\n[2016-12-20 11:14:57.678 CST] main INFO support.DefaultListableBeanFactory: Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@a78f12e: defining beans [org.springframework.beans.factory.config.PropertyPlaceholderConfigurer#0,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,mongo,org.springframework.beans.factory.config.CustomEditorConfigurer#0,org.springframework.beans.factory.config.CustomEditorConfigurer#1,org.springframework.beans.factory.config.CustomEditorConfigurer#2,mongoDbFactory,mongoTemplate,org.springframework.context.annotation.ConfigurationClassPostProcessor.importAwareProcessor]; root of factory hierarchy\n[2016-12-20 11:14:59.535 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-20 11:16:11.159 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-20 11:16:11.201 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: Person2 \u8bb0\u5f55\u6570: 1000010\n[2016-12-20 11:16:12.463 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-20 11:17:13.819 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-20 11:17:13.820 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: Person2 \u8bb0\u5f55\u6570: 2000010\n[2016-12-20 11:17:14.273 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-20 11:18:15.463 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-20 11:18:15.479 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: Person2 \u8bb0\u5f55\u6570: 3000010\n[2016-12-20 11:18:17.394 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-20 11:19:13.793 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-20 11:19:13.794 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: Person2 \u8bb0\u5f55\u6570: 4000010\n[2016-12-20 11:19:14.279 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-20 11:20:46.799 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-20 11:20:46.806 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: Person2 \u8bb0\u5f55\u6570: 5000010\n[2016-12-20 11:20:47.462 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-20 11:22:59.124 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-20 11:22:59.127 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: Person2 \u8bb0\u5f55\u6570: 6000010\n[2016-12-20 11:23:00.799 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-20 11:24:26.280 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-20 11:24:26.283 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: Person2 \u8bb0\u5f55\u6570: 7000010\n[2016-12-20 11:24:27.261 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-20 11:26:03.717 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-20 11:26:03.723 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: Person2 \u8bb0\u5f55\u6570: 8000010\n[2016-12-20 11:26:03.805 CST] Thread-2 INFO support.GenericApplicationContext: Closing org.springframework.context.support.GenericApplicationContext@321e4dd0: startup date [Tue Dec 20 11:14:57 CST 2016]; root of context hierarchy\n[2016-12-20 11:26:03.811 CST] Thread-2 INFO support.DefaultListableBeanFactory: Destroying singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@a78f12e: defining beans [org.springframework.beans.factory.config.PropertyPlaceholderConfigurer#0,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,mongo,org.springframework.beans.factory.config.CustomEditorConfigurer#0,org.springframework.beans.factory.config.CustomEditorConfigurer#1,org.springframework.beans.factory.config.CustomEditorConfigurer#2,mongoDbFactory,mongoTemplate,org.springframework.context.annotation.ConfigurationClassPostProcessor.importAwareProcessor]; root of factory hierarchy\n\n\u67e5\u770b\u78c1\u76d8\u6587\u4ef6\u5927\u5c0f\n[echo@EchoMa mongodb3]$ du -h -d 1 data/master\n140K data/master/admin\n1.1M data/master/diagnostic.data\n400M data/master/journal\n478M data/master/local\n703M data/master/logevents\n1.5G data/master\n\n\u5220\u9664person2\u96c6\u5408\ndb.person2.drop();\n\n[echo@EchoMa mongodb3]$ du -h -d 1 data/master\n140K data/master/admin\n1.1M data/master/diagnostic.data\n400M data/master/journal\n478M data/master/local\n8.0K data/master/logevents\n879M data/master\n\n\u518d\u5199\u5165800\u4e07\n[2016-12-20 11:43:27.632 CST] main INFO context.TestContextManager: Could not instantiate TestExecutionListener [org.springframework.test.context.web.ServletTestExecutionListener]. Specify custom listener classes or make the default listener classes (and their required dependencies) available. Offending class: [javax/servlet/ServletContext]\n[2016-12-20 11:43:27.814 CST] main INFO xml.XmlBeanDefinitionReader: Loading XML bean definitions from URL [file:/Users/echo/workjava/ctower-v3.0/mongodb-demo/target/classes/applicationContext-mongo.xml]\n[2016-12-20 11:43:28.159 CST] main INFO support.GenericApplicationContext: Refreshing org.springframework.context.support.GenericApplicationContext@401a37b1: startup date [Tue Dec 20 11:43:28 CST 2016]; root of context hierarchy\n[2016-12-20 11:43:28.296 CST] main INFO config.PropertyPlaceholderConfigurer: Loading properties file from URL [file:/Users/echo/workjava/ctower-v3.0/mongodb-demo/target/classes/conf/conf-mongo.properties]\n[2016-12-20 11:43:28.329 CST] main INFO support.DefaultListableBeanFactory: Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@54891f43: defining beans [org.springframework.beans.factory.config.PropertyPlaceholderConfigurer#0,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,mongo,org.springframework.beans.factory.config.CustomEditorConfigurer#0,org.springframework.beans.factory.config.CustomEditorConfigurer#1,org.springframework.beans.factory.config.CustomEditorConfigurer#2,mongoDbFactory,mongoTemplate,org.springframework.context.annotation.ConfigurationClassPostProcessor.importAwareProcessor]; root of factory hierarchy\n[2016-12-20 11:43:30.177 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-20 11:44:55.370 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-20 11:44:55.435 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: Person2 \u8bb0\u5f55\u6570: 1000000\n[2016-12-20 11:44:56.017 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-20 11:46:36.982 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-20 11:46:36.987 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: Person2 \u8bb0\u5f55\u6570: 2000000\n[2016-12-20 11:46:37.680 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-20 11:47:39.489 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-20 11:47:39.492 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: Person2 \u8bb0\u5f55\u6570: 3000000\n[2016-12-20 11:47:40.754 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-20 11:49:25.819 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-20 11:49:25.828 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: Person2 \u8bb0\u5f55\u6570: 4000000\n[2016-12-20 11:49:26.283 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-20 11:50:47.129 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-20 11:50:47.135 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: Person2 \u8bb0\u5f55\u6570: 5000000\n[2016-12-20 11:50:48.615 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-20 11:52:36.344 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-20 11:52:36.348 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: Person2 \u8bb0\u5f55\u6570: 6000000\n[2016-12-20 11:52:37.756 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-20 11:54:06.097 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-20 11:54:06.100 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: Person2 \u8bb0\u5f55\u6570: 7000000\n[2016-12-20 11:54:06.721 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: 1000000\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\n[2016-12-20 11:55:36.462 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: \u5199\u51651000000\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\n[2016-12-20 11:55:36.462 CST] main INFO mongodb.MongoDbReuseDiskspaceTest: Person2 \u8bb0\u5f55\u6570: 8000000\n[2016-12-20 11:55:36.486 CST] Thread-2 INFO support.GenericApplicationContext: Closing org.springframework.context.support.GenericApplicationContext@401a37b1: startup date [Tue Dec 20 11:43:28 CST 2016]; root of context hierarchy\n[2016-12-20 11:55:36.489 CST] Thread-2 INFO support.DefaultListableBeanFactory: Destroying singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@54891f43: defining beans [org.springframework.beans.factory.config.PropertyPlaceholderConfigurer#0,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,mongo,org.springframework.beans.factory.config.CustomEditorConfigurer#0,org.springframework.beans.factory.config.CustomEditorConfigurer#1,org.springframework.beans.factory.config.CustomEditorConfigurer#2,mongoDbFactory,mongoTemplate,org.springframework.context.annotation.ConfigurationClassPostProcessor.importAwareProcessor]; root of factory hierarchy\n\n\u67e5\u770b\u78c1\u76d8\u6587\u4ef6\u5927\u5c0f\n[echo@EchoMa mongodb3]$ du -h -d 1 data/master\n140K data/master/admin\n1.3M data/master/diagnostic.data\n400M data/master/journal\n956M data/master/local\n694M data/master/logevents\n2.0G data/master\n</code></pre>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-20-mongodb-%25e7%25a3%2581%25e7%259b%2598%25e7%25a9%25ba%25e9%2597%25b4%25e9%2587%258d%25e7%2594%25a8%25e6%25b5%258b%25e8%25af%2595%25e5%25af%25b9%25e6%25af%2594-2-6-12-v-s-3-2-11.html/#test-codes","title":"Test codes","text":"MongoDbReuseDiskspaceTest.java <pre><code>import java.util.ArrayList;\nimport java.util.Collection;\n\nimport javax.annotation.Resource;\n\nimport org.apache.commons.logging.Log;\nimport org.apache.commons.logging.LogFactory;\nimport org.junit.Test;\nimport org.junit.runner.RunWith;\nimport org.springframework.data.mongodb.core.MongoTemplate;\nimport org.springframework.test.context.ContextConfiguration;\nimport org.springframework.test.context.junit4.SpringJUnit4ClassRunner;\n\n/**\n* MongoDB \u91cd\u7528\u78c1\u76d8\u7a7a\u95f4\u6d4b\u8bd5\n*/\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(\"classpath*:applicationContext-mongo.xml\")\npublic class MongoDbReuseDiskspaceTest {\n  static Log LOG = LogFactory.getLog(MongoDbReuseDiskspaceTest.class);\n  @Resource\n  MongoTemplate mongoTemplate;\n\n  @Test\n  public void testMultiInsert() {\n    for (int i = 0; i &lt; 8; i++) {// 800\u4e07\u8bb0\u5f55\n      // 100\u4e07\u8bb0\u5f55\n      this.testInsert(100 * 10000);\n    }\n  }\n\n  private void testInsert(int count) {\n    Collection&lt;Person2&gt; list = new ArrayList&lt;Person2&gt;();\n    String suffix = String.valueOf(Math.random());\n    for (int i = 0; i &lt; count; i++) {\n      Person2 p = new Person2();\n      p.setId(i + suffix);\n      // p.setId(\"1\"); \u91cd\u590d\u4f1a\u62a5\u9519\n      p.setAge((int) (Math.random() * 80));\n      p.setName(\"Tom\" + (int) (Math.random() * 1000));\n      list.add(p);\n    }\n\n    LOG.info(list.size() + \"\u6761\u8bb0\u5f55\u5df2\u5c31\u7eea\");\n    mongoTemplate.insertAll(list);\n    LOG.info(\"\u5199\u5165\" + list.size() + \"\u6761\u8bb0\u5f55\u81f3Person2\u6210\u529f\");\n\n    long records = mongoTemplate.count(null, Person2.class);\n    LOG.info(\"Person2 \u8bb0\u5f55\u6570: \" + records);\n  }\n}\n</code></pre>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-centos-7-2-redis-3-0-5-warning-solved.html/","title":"CentOS 7.2 redis-3.0.5 WARNING  solved","text":"<p>\u542f\u52a8redis\uff0c\u663e\u793a\u544a\u8b66\u5982\u4e0b\uff1a</p> <p>8589:M 05 Dec 14:28:58.509 # WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128. 8589:M 05 Dec 14:28:58.509 # Server started, Redis version 3.0.5 8589:M 05 Dec 14:28:58.509 # WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect. 8589:M 05 Dec 14:28:58.523 # WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command 'echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled' as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled.</p> <p>\u89e3\u51b3\u65b9\u6cd5:</p> <p># vi /etc/sysctl.conf \u8ffd\u52a0 ------------------------------------------- vm.overcommit_memory = 1 net.core.somaxconn = 4096 ------------------------------------------- \u4f7f\u4e0a\u8ff0\u914d\u7f6e\u751f\u6548 # /sbin/sysctl -p</p> <p># echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled # vi /etc/rc.local \u8ffd\u52a0 ------------------------------------------- echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled -------------------------------------------</p> <p># vi /etc/security/limits.conf \u8ffd\u52a0\u5982\u4e0b\u5185\u5bb9 \u6ce8\uff1aredis\u662f\u542f\u52a8redis\u7684\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237 ------------------------------------------- redis hard nofile 64000 redis soft nofile 64000 -------------------------------------------</p> <p>\u7136\u540e\u91cd\u542fredis.</p>","tags":["Redis","nosql","\u7f13\u5b58"]},{"location":"DevOps/2016-12-21-mongodb-3-2-11-%25e5%2589%25af%25e6%259c%25ac%25e9%259b%2586-%25e5%25ae%2589%25e8%25a3%2585%25e6%2597%25a5%25e5%25bf%2597-%25e4%25b8%25bb%25e4%25bb%258e%25e4%25bb%25b2%25e8%25a3%2581.html/","title":"mongodb 3.2.11 \u526f\u672c\u96c6 \u5b89\u88c5\u65e5\u5fd7 \u4e3b\u4ece\u4ef2\u88c1","text":"Environment <p>\u7cfb\u7edf\u73af\u5883: CentOS release 6.2+  \u5b89\u88c5\u8f6f\u4ef6: mongodb-linux-x86_64-rhel62-3.2.11.tgz</p>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-mongodb-3-2-11-%25e5%2589%25af%25e6%259c%25ac%25e9%259b%2586-%25e5%25ae%2589%25e8%25a3%2585%25e6%2597%25a5%25e5%25bf%2597-%25e4%25b8%25bb%25e4%25bb%258e%25e4%25bb%25b2%25e8%25a3%2581.html/#1-mongodb3","title":"1. mongodb3 \u526f\u672c\u96c6\u89c4\u5212","text":"<p>\u526f\u672c\u96c6\u540d\u79f0: testrs   \uff08\u9879\u76ee\u4e2d\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u4fee\u6539\uff09 </p> <p>\u4ee5 192.168.100.x \u4e3a\u4f8b.</p>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-mongodb-3-2-11-%25e5%2589%25af%25e6%259c%25ac%25e9%259b%2586-%25e5%25ae%2589%25e8%25a3%2585%25e6%2597%25a5%25e5%25bf%2597-%25e4%25b8%25bb%25e4%25bb%258e%25e4%25bb%25b2%25e8%25a3%2581.html/#11","title":"1.1 \u96c6\u7fa4\u89c4\u5212","text":"<pre><code>192.168.100.1:27017  \u4e3b\n192.168.100.2:27017  \u4ece\n192.168.100.3:27017  \u4ef2\u88c1 - \u4e0d\u4fdd\u5b58\u4e1a\u52a1\u6570\u636e\uff0c\u8282\u7ea6\u786c\u76d8\u7a7a\u95f4\n</code></pre>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-mongodb-3-2-11-%25e5%2589%25af%25e6%259c%25ac%25e9%259b%2586-%25e5%25ae%2589%25e8%25a3%2585%25e6%2597%25a5%25e5%25bf%2597-%25e4%25b8%25bb%25e4%25bb%258e%25e4%25bb%25b2%25e8%25a3%2581.html/#12","title":"1.2 \u670d\u52a1\u5668\u76ee\u5f55\u89c4\u5212","text":"<pre><code>/home/mongodb3 mongodb-home\u76ee\u5f55\n|_ bin    \u547d\u4ee4\u76ee\u5f55\n|_ conf   \u914d\u7f6e\u76ee\u5f55\n|_ data   \u6570\u636e\u76ee\u5f55 - \u53ef\u5efa\u7acb\u7b26\u53f7\u94fe\u63a5 \u6307\u5411nas/\u5176\u4ed6\u76ee\u5f55 \n  |_ master  \u4e3b     \n  |_ slaver  \u4ece   \n  |_ arbiter \u4ef2\u88c1     \n|_ log  mongodb\u8fd0\u884c\u65e5\u5fd7\u76ee\u5f55 - \u53ef\u5efa\u7acb\u7b26\u53f7\u94fe\u63a5 \u6307\u5411\u5176\u4ed6\u76ee\u5f55\n</code></pre>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-mongodb-3-2-11-%25e5%2589%25af%25e6%259c%25ac%25e9%259b%2586-%25e5%25ae%2589%25e8%25a3%2585%25e6%2597%25a5%25e5%25bf%2597-%25e4%25b8%25bb%25e4%25bb%258e%25e4%25bb%25b2%25e8%25a3%2581.html/#13","title":"1.3 \u7528\u6237","text":"<p>\u4ee5 mongodb3 \u7528\u6237\u540d\u4e3a\u4f8b\uff08\u9879\u76ee\u4e2d\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u5b9a\uff09\uff1a</p> <pre><code># useradd mongodb3\n</code></pre>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-mongodb-3-2-11-%25e5%2589%25af%25e6%259c%25ac%25e9%259b%2586-%25e5%25ae%2589%25e8%25a3%2585%25e6%2597%25a5%25e5%25bf%2597-%25e4%25b8%25bb%25e4%25bb%258e%25e4%25bb%25b2%25e8%25a3%2581.html/#2","title":"2. \u64cd\u4f5c\u7cfb\u7edf\u914d\u7f6e","text":"<p>\u4f7f\u7528 root \u7528\u6237\u767b\u5f55 </p>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-mongodb-3-2-11-%25e5%2589%25af%25e6%259c%25ac%25e9%259b%2586-%25e5%25ae%2589%25e8%25a3%2585%25e6%2597%25a5%25e5%25bf%2597-%25e4%25b8%25bb%25e4%25bb%258e%25e4%25bb%25b2%25e8%25a3%2581.html/#21-iptables27001","title":"2.1 \u5982\u679c\u542f\u7528\u4e86iptables\uff0c\u5c0627001\u7aef\u53e3\u52a0\u5165\u9632\u706b\u5899","text":"<p><code>vi /etc/sysconfig/iptables</code></p> <p>\u4e0b\u9762\u4e00\u884c\u5185\u5bb9\u52a0\u5728COMMIT\u4e4b\u524d</p> <pre><code>-A INPUT -p tcp --dport 27001 -j ACCEPT\n</code></pre> <p>\u91cd\u542f\u9632\u706b\u5899</p> <pre><code># service iptables restart\n</code></pre>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-mongodb-3-2-11-%25e5%2589%25af%25e6%259c%25ac%25e9%259b%2586-%25e5%25ae%2589%25e8%25a3%2585%25e6%2597%25a5%25e5%25bf%2597-%25e4%25b8%25bb%25e4%25bb%258e%25e4%25bb%25b2%25e8%25a3%2581.html/#22-redhat_transparent_hugepagenever","title":"2.2 \u5927\u5185\u5b58\u9875\u9762redhat_transparent_hugepage\u53c2\u6570\u8bbe\u7f6e\u4e3anever","text":"<p>\u5148\u67e5\u770b\u8be5\u53c2\u6570\u503c</p> <pre><code># cat /sys/kernel/mm/redhat_transparent_hugepage/enabled\n[always] madvise never\n# cat /sys/kernel/mm/redhat_transparent_hugepage/defrag\n[always] madvise never\n</code></pre> <p>\u914d\u7f6edisable-transparent-hugepages\u670d\u52a1</p> /etc/init.d/disable-transparent-hugepages<pre><code>#!/bin/bash\n### BEGIN INIT INFO\n# Provides: disable-transparent-hugepages\n# Required-Start: $local_fs\n# Required-Stop:\n# X-Start-Before: mongod mongodb-mms-automation-agent\n# Default-Start: 2 3 4 5\n# Default-Stop: 0 1 6\n# Short-Description: Disable Linux transparent huge pages\n# Description: Disable Linux transparent huge pages, to improve\n# database performance.\n### END INIT INFO\n\ncase $1 in\n  start)\n    if [ -d /sys/kernel/mm/transparent_hugepage ]; then\n      thp_path=/sys/kernel/mm/transparent_hugepage\n    elif [ -d /sys/kernel/mm/redhat_transparent_hugepage ]; then\n      thp_path=/sys/kernel/mm/redhat_transparent_hugepage\n    else\n      return 0\n    fi\n\n    echo 'never' &gt; ${thp_path}/enabled\n    echo 'never' &gt; ${thp_path}/defrag\n\n    re='^[0-1]+$'\n    if [[ $(cat ${thp_path}/khugepaged/defrag) =~ $re ]]\n    then\n      # RHEL 7\n      echo 0 &gt; ${thp_path}/khugepaged/defrag\n    else\n      # RHEL 6\n      echo 'no' &gt; ${thp_path}/khugepaged/defrag\n    fi\n\n    unset re\n    unset thp_path\n    ;;\nesac\n</code></pre> <p>\u5bf9\u8be5\u670d\u52a1\u5668\u6388\u6743\uff0c\u5e76\u8bbe\u7f6e \u5f00\u673a\u81ea\u542f\u52a8</p> <pre><code># chmod 755 /etc/init.d/disable-transparent-hugepages\n# chkconfig --add disable-transparent-hugepages\n</code></pre> <p>\u542f\u52a8\u5e76\u68c0\u67e5\u8be5\u53c2\u6570\u662f\u5426\u5df2\u7ecf\u751f\u6548</p> <pre><code># service disable-transparent-hugepages start\n# cat /sys/kernel/mm/redhat_transparent_hugepage/enabled\nalways madvise [never]\n# cat /sys/kernel/mm/redhat_transparent_hugepage/defrag\nalways madvise [never]\n</code></pre>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-mongodb-3-2-11-%25e5%2589%25af%25e6%259c%25ac%25e9%259b%2586-%25e5%25ae%2589%25e8%25a3%2585%25e6%2597%25a5%25e5%25bf%2597-%25e4%25b8%25bb%25e4%25bb%258e%25e4%25bb%25b2%25e8%25a3%2581.html/#23-mongodbulimit","title":"2.3 \u914d\u7f6emongodb\u7528\u6237\u7684ulimit","text":"<p><code>vi /etc/security/limits.conf</code></p> <p>\u4ee5\u7528\u6237\u540d\u4e3amongodb3\u4e3a\u4f8b\uff0c\u5728 # End of file \u524d\u6dfb\u52a0</p> <pre><code>mongodb3 hard nofile 64000\nmongodb3 soft nofile 64000\nmongodb3 hard nproc 64000\nmongodb3 soft nproc 64000\n</code></pre>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-mongodb-3-2-11-%25e5%2589%25af%25e6%259c%25ac%25e9%259b%2586-%25e5%25ae%2589%25e8%25a3%2585%25e6%2597%25a5%25e5%25bf%2597-%25e4%25b8%25bb%25e4%25bb%258e%25e4%25bb%25b2%25e8%25a3%2581.html/#24","title":"2.4 \u7cfb\u7edf\u53c2\u6570\u8c03\u4f18","text":"<p><code>vi /etc/sysctl.conf</code></p> <p>\u8ffd\u52a0\u5982\u4e0b\u5185\u5bb9</p> <pre><code>net.core.somaxconn = 4096\nnet.ipv4.tcp_fin_timeout = 30\nnet.ipv4.tcp_keepalive_intvl = 30\nnet.ipv4.tcp_keepalive_time = 120\nnet.ipv4.tcp_max_syn_backlog = 4096\n\nvm.dirty_ratio = 15\nvm.dirty_background_ratio = 5\nvm.swappiness = 1\n</code></pre> <p>\u4f7f\u4e0a\u8ff0\u914d\u7f6e\u751f\u6548</p> <pre><code># /sbin/sysctl -p\n</code></pre>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-mongodb-3-2-11-%25e5%2589%25af%25e6%259c%25ac%25e9%259b%2586-%25e5%25ae%2589%25e8%25a3%2585%25e6%2597%25a5%25e5%25bf%2597-%25e4%25b8%25bb%25e4%25bb%258e%25e4%25bb%25b2%25e8%25a3%2581.html/#3mongodb","title":"3.\u5b89\u88c5mongodb","text":"","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-mongodb-3-2-11-%25e5%2589%25af%25e6%259c%25ac%25e9%259b%2586-%25e5%25ae%2589%25e8%25a3%2585%25e6%2597%25a5%25e5%25bf%2597-%25e4%25b8%25bb%25e4%25bb%258e%25e4%25bb%25b2%25e8%25a3%2581.html/#31-mongodb-3211-rhel-6-linux","title":"3.1 \u83b7\u53d6 mongodb 3.2.11 RHEL 6 Linux \u8f6f\u4ef6\u5b89\u88c5\u5305","text":"<pre><code># su - mongodb3 \n# pwd\n/home/mongodb3\n</code></pre> <pre><code>$ wget  https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-rhel62-3.2.11.tgz\n</code></pre>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-mongodb-3-2-11-%25e5%2589%25af%25e6%259c%25ac%25e9%259b%2586-%25e5%25ae%2589%25e8%25a3%2585%25e6%2597%25a5%25e5%25bf%2597-%25e4%25b8%25bb%25e4%25bb%258e%25e4%25bb%25b2%25e8%25a3%2581.html/#32","title":"3.2 \u89e3\u538b\u5b89\u88c5\u5305 \u5e76 \u521b\u5efa\u54cd\u5e94\u76ee\u5f55\uff08\u6216\u8005\u5efa\u7acb\u76f8\u5e94\u7684\u7b26\u53f7\u94fe\u63a5\uff09","text":"<pre><code>$ tar -xvf mongodb-linux-x86_64-rhel62-3.2.11.tgz\n$ mv mongodb-linux-x86_64-rhel62-3.2.8 mongodb-3.2.11\n$ ln -s mongodb-3.2.11/bin bin\n$ mkdir conf log\n$ mkdir -p data/master data/slaver data/arbiter\n</code></pre>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-mongodb-3-2-11-%25e5%2589%25af%25e6%259c%25ac%25e9%259b%2586-%25e5%25ae%2589%25e8%25a3%2585%25e6%2597%25a5%25e5%25bf%2597-%25e4%25b8%25bb%25e4%25bb%258e%25e4%25bb%25b2%25e8%25a3%2581.html/#33-confmasterconf-confslaverconf-confarbiterconf","title":"3.3 \u521b\u5efa\u914d\u7f6e\u6587\u4ef6 conf/master.conf conf/slaver.conf conf/arbiter.conf","text":"conf/master.conf<pre><code>dbpath=/home/mongodb3/data/master\nlogpath=/home/mongodb3/log/master.log\npidfilepath=/home/mongodb3/log/master.pid\ndirectoryperdb=true\nlogappend=true\nreplSet=testrs\nbind_ip=192.168.100.1,localhost\nport=27017\n#oplogSize:10G\noplogSize=10240\nfork=true\n#keyFile = /home/mongodb3/conf/keyfile\n</code></pre> Note <ul> <li>conf/slaver.conf \u548c conf/arbiter.conf \u7c7b\u4f3c\uff0c\u9664\u4e86    bind_ip=192.168.100.1,localhost    \u8fd9\u4e00\u884c\uff0c\u5c06ip\u4fee\u6539\u4e3a\u670d\u52a1\u5668ip </li> <li>oplogSize \u4e00\u822c\u53d6\u786c\u76d8\u53ef\u7528\u7a7a\u95f4\u7684 5% </li> <li>replSet \u526f\u672c\u96c6\u540d\u79f0\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u5b9a\uff0c\u5168\u6587\u4fdd\u6301\u4e00\u81f4 </li> </ul>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-mongodb-3-2-11-%25e5%2589%25af%25e6%259c%25ac%25e9%259b%2586-%25e5%25ae%2589%25e8%25a3%2585%25e6%2597%25a5%25e5%25bf%2597-%25e4%25b8%25bb%25e4%25bb%258e%25e4%25bb%25b2%25e8%25a3%2581.html/#34-start-mastersh-start-slaversh-start-arbitersh","title":"3.4 \u521b\u5efa\u542f\u52a8\u811a\u672c start-master.sh start-slaver.sh start-arbiter.sh","text":"start-master.sh<pre><code># !/bin/sh\ncd `dirname $0`\nbin/mongod -f conf/master.conf\n</code></pre> start-slaver.sh<pre><code># !/bin/sh\ncd `dirname $0`\nbin/mongod -f conf/slaver.conf \n</code></pre> start-slaver.sh<pre><code># !/bin/sh\ncd `dirname $0`\nbin/mongod -f conf/arbiter.conf\n</code></pre> <p>\u8d4b\u4e88\u6267\u884c\u6743\u9650</p> <pre><code>$ chmod +x *.sh\n</code></pre>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-mongodb-3-2-11-%25e5%2589%25af%25e6%259c%25ac%25e9%259b%2586-%25e5%25ae%2589%25e8%25a3%2585%25e6%2597%25a5%25e5%25bf%2597-%25e4%25b8%25bb%25e4%25bb%258e%25e4%25bb%25b2%25e8%25a3%2581.html/#35","title":"3.5 \u542f\u52a8/\u505c\u6b62","text":"<p>\u5728\u4e3b\u8282\u70b9\u4e0a\u542f\u52a8\uff1a</p> <pre><code>$ ./start-master.sh \n</code></pre> <p>\u5728\u5907\u8282\u70b9\u4e0a\u542f\u52a8</p> <pre><code>$ ./start-slaver.sh \n</code></pre> <p>\u5728\u4ef2\u88c1\u670d\u52a1\u5668\u4e0a\u542f\u52a8</p> <pre><code>$ ./start-arbiter.sh \n</code></pre> <p>\u901a\u8fc7\u7aef\u53e3\u53f7\u67e5\u770b\u542f\u52a8\u662f\u5426\u6210\u529f</p> <pre><code>$ netstat -lanp | grep 27017\n</code></pre> <p>\u4f7f\u7528mongo\u5ba2\u6237\u7aef\u8bbf\u95ee\u4e00\u4e0b\u4e3b\u6570\u636e\u5e93</p> <pre><code>$ bin/mongo 192.168.100.1\n</code></pre> <p>\u505c\u6b62\u6570\u636e\u5e93</p> <pre><code>$ killall mongod\n</code></pre>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-mongodb-3-2-11-%25e5%2589%25af%25e6%259c%25ac%25e9%259b%2586-%25e5%25ae%2589%25e8%25a3%2585%25e6%2597%25a5%25e5%25bf%2597-%25e4%25b8%25bb%25e4%25bb%258e%25e4%25bb%25b2%25e8%25a3%2581.html/#36","title":"3.6 \u914d\u7f6e\u526f\u672c\u96c6","text":"<p>\u767b\u5f55\u4e3b\u8282\u70b9\uff0c\u914d\u7f6e\u5e76\u521d\u59cb\u5316\u526f\u672c\u96c6\u3002</p> <pre><code>$ bin/mongo\n\n&gt; cfg={ _id:\"testrs\", members:[ \n{_id:0, host:'192.168.100.1:27017', priority:20}, \n{_id:1, host:'192.168.100.2:27017', priority:10},   \n{_id:2, host:'192.168.100.3:27017', arbiterOnly:true}] }\n\n&gt; rs.initiate(cfg) \n\n&gt; rs.status()\n</code></pre>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-mongodb-3-2-11-%25e5%2589%25af%25e6%259c%25ac%25e9%259b%2586-%25e5%25ae%2589%25e8%25a3%2585%25e6%2597%25a5%25e5%25bf%2597-%25e4%25b8%25bb%25e4%25bb%258e%25e4%25bb%25b2%25e8%25a3%2581.html/#37","title":"3.7 \u542f\u7528\u5bc6\u7801\u9a8c\u8bc1\u529f\u80fd","text":"","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-mongodb-3-2-11-%25e5%2589%25af%25e6%259c%25ac%25e9%259b%2586-%25e5%25ae%2589%25e8%25a3%2585%25e6%2597%25a5%25e5%25bf%2597-%25e4%25b8%25bb%25e4%25bb%258e%25e4%25bb%25b2%25e8%25a3%2581.html/#371","title":"3.7.1 \u767b\u5f55\u4e3b\u8282\u70b9\uff0c\u5e76\u521b\u5efa\u7ba1\u7406\u5458","text":"<p>\u7528\u6237\u540d/\u5bc6\u7801: root/123456 </p> <pre><code>&gt; db.createUser(\n {\n user:\"root\",\n pwd:\"123456\",\n roles:[{role:\"userAdminAnyDatabase\",db:\"admin\"}]\n }\n )\n\n&gt; db.grantRolesToUser(\"root\",[{role:\"clusterManager\",db:\"admin\"}])\ndb.grantRolesToUser(\"root\",[{role:\"clusterAdmin\",db:\"admin\"}])\ndb.grantRolesToUser(\"root\",[{role:\"clusterMonitor\",db:\"admin\"}])\ndb.grantRolesToUser(\"root\",[{role:\"hostManager\",db:\"admin\"}])\ndb.grantRolesToUser(\"root\",[{role:\"userAdminAnyDatabase\",db:\"admin\"}])\ndb.grantRolesToUser(\"root\",[{role:\"readWrite\",db:\"admin\"}]);\ndb.grantRolesToUser(\"root\",[{role:\"backup\",db:\"admin\"}])\ndb.grantRolesToUser(\"root\",[{role:\"restore\",db:\"admin\"}])\n</code></pre> roles \u89d2\u8272 <ul> <li>\u6570\u636e\u5e93\u7528\u6237\u89d2\u8272\uff1aread\u3001readWrite </li> <li>\u6570\u636e\u5e93\u7ba1\u7406\u89d2\u8272\uff1adbAdmin\u3001dbOwner\u3001userAdmin </li> <li>\u96c6\u7fa4\u7ba1\u7406\u89d2\u8272\uff1aclusterAdmin\u3001clusterManager\u3001clusterMonitor\u3001hostManager </li> <li>\u5907\u4efd\u6062\u590d\u89d2\u8272\uff1abackup\u3001restore </li> <li>\u6240\u6709\u6570\u636e\u5e93\u89d2\u8272\uff1areadAnyDatabase\u3001readWriteAnyDatabase\u3001userAdminAnyDatabase\u3001dbAdminAnyDatabase </li> <li>\u8d85\u7ea7\u7528\u6237\u89d2\u8272\uff1aroot</li> </ul>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-mongodb-3-2-11-%25e5%2589%25af%25e6%259c%25ac%25e9%259b%2586-%25e5%25ae%2589%25e8%25a3%2585%25e6%2597%25a5%25e5%25bf%2597-%25e4%25b8%25bb%25e4%25bb%258e%25e4%25bb%25b2%25e8%25a3%2581.html/#372","title":"3.7.2 \u521b\u5efa\u666e\u901a\u7528\u6237","text":"<p>\u4f8b\u5982\u521b\u5efa user/123456  db:logevents \u6743\u9650:readWrite</p> <pre><code>&gt; use logevents\n&gt; db.createUser(\n {\n user:\"user\",\n pwd:\"123456\",\n roles:[{role:\"readWrite\",db:\"logevents\"}]\n }\n )\n</code></pre>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-mongodb-3-2-11-%25e5%2589%25af%25e6%259c%25ac%25e9%259b%2586-%25e5%25ae%2589%25e8%25a3%2585%25e6%2597%25a5%25e5%25bf%2597-%25e4%25b8%25bb%25e4%25bb%258e%25e4%25bb%25b2%25e8%25a3%2581.html/#373-keyfile","title":"3.7.3  \u521b\u5efaKeyfile\uff0c\u5e76\u5206\u522b\u590d\u5236\u5230\u5404\u8282\u70b9\u7684\u6307\u5b9a\u76ee\u5f55","text":"<p>\u521b\u5efa\u4e00\u6b21\uff0c\u7136\u540e\u590d\u5236\u5230\u5176\u4ed6\u8282\u70b9.</p> <pre><code># cd /home/mongodb3\n# openssl rand -base64 741 &gt; conf/keyfile\n# chmod 600 conf/keyfile\n</code></pre> <p>\u91cd\u65b0\u4fee\u6539 conf/*.conf \u6587\u4ef6\uff0c\u5c06\u4ee5\u4e0b\u8fd9\u4e2a\u53c2\u6570\u914d\u7f6e\u6ce8\u91ca\u53bb\u6389\uff0c\u4f7f\u5176\u751f\u6548\u3002</p> <pre><code>keyFile=/home/mongodb3/conf/keyfile\n</code></pre> <p>\u5173\u95ed\u6240\u6709\u8fdb\u7a0b\uff0c\u5e76\u91cd\u65b0\u542f\u52a8\u8fdb\u7a0b\u3002\u7136\u540e\u901a\u8fc7\u547d\u4ee4\u8fdb\u884c\u767b\u5f55\u9a8c\u8bc1\u3002</p> <pre><code>$ mongo localhost:27017/admin -u root -p \nMongoDB shell version: 3.2.11\nEnter password: \nconnecting to: localhost:27017/admin\n</code></pre>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-mongodb-3-2-11-%25e5%2589%25af%25e6%259c%25ac%25e9%259b%2586-%25e5%25ae%2589%25e8%25a3%2585%25e6%2597%25a5%25e5%25bf%2597-%25e4%25b8%25bb%25e4%25bb%258e%25e4%25bb%25b2%25e8%25a3%2581.html/#reference","title":"Reference","text":"<ul> <li>https://yq.aliyun.com/articles/63223</li> <li>https://docs.mongodb.com/v3.2/reference/ulimit/#recommended-ulimit-settings</li> <li>Tuning Linux for MongoDB</li> </ul>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2016-12-21-tuning-linux-for-mongodb-%25e8%25bd%25ac.html/","title":"Tuning Linux for MongoDB -- \u8f6c","text":"Tuning Linux for MongoDB <p>Tim Vaillancourt \u00a0|\u00a0August 12, 2016\u00a0|\u00a0 Posted In: MongoDB</p> <p>In this post, we\u2019ll discuss tuning Linux for MongoDB deployments.</p> <p>By far the most common operating system you\u2019ll see MongoDB running on is Linux 2.6 and 3.x. Linux flavors such as CentOS and Debian do a fantastic job of being a stable, general-purpose operating system. Linux runs software on hardware ranging from tiny computers like\u00a0the Raspberry Pi up to massive data center servers. To make this flexibility work, however, Linux defaults to some \u201clowest common denominator\u201d tunings so that the OS will boot\u00a0on anything.</p> <p>Working with databases, we often focus on the queries, patterns and tunings that happen inside the database process itself. This means we sometimes forget that the operating system below it is the life-support of database, the air that it breathes so-to-speak.\u00a0Of course, a highly-scalable database such as MongoDB runs fine on these general-purpose defaults without complaints, but the efficiency can be\u00a0equivalent to running in regular shoes\u00a0instead of\u00a0sleek\u00a0runners. At small scale, you might not notice the lost efficiency, but at large scale (especially when data exceeds RAM) improved\u00a0tunings equate\u00a0to fewer servers and less operational costs. For all use cases and scale, good OS tunings also provide some improvement in response times and removes extra \u201cwhat if\u2026?\u201d questions when troubleshooting.</p> <p>Overall, memory, network and disk are the system resources important to MongoDB. This article\u00a0covers how to optimize each of these areas. Of course, while we have successfully deployed\u00a0these tunings to many live systems, it\u2019s always best to test before applying changes to your\u00a0servers.</p> <p>If you plan on applying these changes, I suggest performing them\u00a0with one full reboot of the host. Some of these changes don\u2019t require a reboot, but test that they get re-applied if you reboot in the future. MongoDB\u2019s clustered nature should make this\u00a0relatively painless, plus it might be a good time to do that dreaded \u201cyum upgrade\u201d / \u201captitude upgrade\u201c, too.</p> Linux Ulimit <p>To prevent\u00a0a single user from impacting the entire\u00a0system, Linux has a facility to implement some system resource constraints on processes, file handles and other system resources on a per-user-basis. For medium-high-usage MongoDB deployments, the default limits are almost always too low. Considering MongoDB generally uses dedicated hardware, it makes sense to allow the Linux user running MongoDB (e.g., \u201cmongod\u201d) to use a majority of the available resources.</p> <p>Now you might be thinking: \u201cWhy not disable the limit (or set it to unlimited)?\u201d This is a common recommendation for database servers.\u00a0I think you should avoid this for two reasons:</p> <ul> <li>If you hit a problem, a lack of a limit on system resources can allow a relatively smaller problem to spiral out of control, often bringing down other services (such as SSH) crucial to solving the original problem.</li> <li>All systems DO\u00a0have an upper-limit, and understanding those limitations instead of masking them is an important exercise.</li> </ul> <p>In most cases, a limit of 64,000 \u201cmax user processes\u201d and 64,000 \u201copen files\u201d (both have defaults of 1024) will suffice. To be more exact you need to do some math on the number of applications/clients, the maximum size of their connection pools and some case-by-case tuning for the number of inter-node connections between replica set members and sharding processes. (We might address this in a future blog post.)</p> <p>You can deploy these limits by adding a file in \u201c/etc/security/limits.d\u201d\u00a0(or appending to \u201c/etc/security/limits.conf\u201d if there is no\u00a0\u201climits.d\u201d). Below is an example file for the Linux user \u201cmongod\u201d, raising open-file and max-user-process limits to 64,000:</p> /etc/security/limits.d/mongod.conf <p>Shell 1 2 3 4 mongod soft nproc 64000 mongod hard nproc 64000 mongod soft nofile 64000 mongod hard nofile 64000 <p>Note: this change only applies to new shells, meaning you must restart \u201cmongod\u201d or \u201cmongos\u201d to apply this change!</p> Virtual Memory Dirty Ratio <p>The \u201cdirty_ratio\u201d is the percentage of total system memory that can hold dirty pages. The default on most Linux hosts is\u00a0between 20-30%. When you exceed the limit the dirty pages are committed\u00a0to disk, creating a small pause. To avoid this hard pause there is a second ratio: \u201cdirty_background_ratio\u201d (default 10-15%) which tells the kernel to start flushing dirty pages to disk in the background without any pause.</p> <p>20-30% is a good general default for \u201cdirty_ratio\u201d, but on large-memory database servers this can be a lot of memory! For example, on a 128GB-memory host this can allow up to 38.4GB of dirty pages. The background ratio won\u2019t kick in until 12.8GB! We recommend that you\u00a0lower this setting and monitor the impact to query performance and disk IO. The goal is\u00a0reducing\u00a0memory usage without impacting query performance negatively. Reducing caches sizes also guarantees data gets written to disk in smaller batches more frequently, which increases disk throughput (than huge\u00a0bulk writes less often).</p> <p>A recommended setting for dirty ratios on large-memory (64GB+ perhaps) database servers is: \u201cvm.dirty_ratio = 15\u2033\u00a0and \u201cvm.dirty_background_ratio = 5\u2033, or possibly less. (Red Hat recommends lower ratios of 10 and 3 for high-performance/large-memory servers.)</p> <p>You\u00a0can set this\u00a0by adding the following lines to \u201c/etc/sysctl.conf\u201d:</p> <p>Shell 1 2 vm.dirty_ratio = 15 vm.dirty_background_ratio = 5 <p>To check these current running values:</p> <p>Shell 1 2 3 $ sysctl -a | egrep \"vm.dirty.*_ratio\" vm.dirty_background_ratio = 5 vm.dirty_ratio = 15 Swappiness <p>\u201cSwappiness\u201d is a Linux kernel setting that influences the behavior\u00a0of the Virtual Memory manager when it needs to allocate a swap, ranging from 0-100. A setting of \u201c0\u201c tells the kernel to swap only to avoid out-of-memory problems. A setting of 100 tells it to swap aggressively to disk. The Linux default is usually 60, which is not ideal for database usage.</p> <p>It is common to see a setting of \u201c0\u2033\u00a0(or sometimes \u201c10\u201d) on database servers, telling the kernel to prefer to swap to memory for\u00a0better response times. However, Ovais Tariq details a known bug (or feature) when using a setting of \u201c0\u201c\u00a0in this blog post:\u00a0https://www.percona.com/blog/2014/04/28/oom-relation-vm-swappiness0-new-kernel/.</p> <p>Due to this bug, we\u00a0recommended using\u00a0a setting of \u201c1\u2033\u00a0(or \u201c10\u201d if you \u00a0prefer some disk swapping) by adding the following to your \u201c/etc/sysctl.conf\u201d:</p> /etc/sysctl.conf <p>Shell 1 vm.swappiness = 1 <p>To check the current swappiness:</p> <p>Shell 1 2 $ sysctl vm.swappiness vm.swappiness = 1 <p>Note: you must run the\u00a0command \u201c/sbin/sysctl -p\u201d as root/sudo (or reboot) to\u00a0apply a dirty_ratio or swappiness change!</p> Transparent HugePages <p>*Does not apply to Debian/Ubuntu or CentOS/RedHat 5 and lower*</p> <p>Transparent HugePages is an optimization introduced in CentOS/RedHat 6.0, with the goal\u00a0of reducing\u00a0overhead on systems with large amounts of memory. However, due to the way MongoDB uses memory, this feature actually does more harm than good as memory access are rarely contiguous.</p> <p>Disabled THP entirely by adding the following flag below to your Linux kernel boot options:</p> <p>Shell 1 transparent_hugepage=never <p>Usually this requires changes to the GRUB boot-loader config in the directory \u201c/boot/grub\u201d\u00a0or \u201c/etc/grub.d\u201d\u00a0on newer systems. Red Hat covers this in more detail in this article (same method on CentOS):\u00a0https://access.redhat.com/solutions/46111.</p> <p>Note: We\u00a0recommended rebooting\u00a0the system to clear out any\u00a0previous huge pages and validate that the setting will persist on reboot.</p> <p>NUMA (Non-Uniform Memory Access) Architecture</p> <p>Non-Uniform Memory Access\u00a0is a recent\u00a0memory architecture that takes into account the locality of caches and CPUs for lower latency. Unfortunately, MongoDB is not \u201cNUMA-aware\u201d and leaving NUMA setup in the default behavior can cause severe memory in-balance.</p> <p>There are two ways to disable NUMA: one is via an on/off switch in the system BIOS config, the 2nd is using the \u201cnumactl\u201d\u00a0command to set NUMA-interleaved-mode (similar effect to disabling NUMA) when starting MongoDB. Both methods achieve the same result. I\u00a0lean towards using\u00a0the \u201cnumactl\u201d\u00a0command due to future-proofing yourself for the mostly inevitable addition of NUMA awareness.\u00a0On CentOS 7+ you may need to install the \u201cnumactl\u201d\u00a0yum/rpm package.</p> <p>To make mongod start using interleaved-mode, add \u201cnumactl \u2013interleave=all\u201d\u00a0before your regular \u201cmongod\u201d\u00a0command:</p> <p>Shell 1 $ numactl --interleave=all mongod &lt;options here&gt; <p>To check mongod\u2019s NUMA setting:</p> <p>Shell 1 2 3 4 5 6 7 8 9 10 11 $ sudo numastat -p $(pidof mongod) Per-node process memory usage (in MBs) for PID 7516 (mongod) Node 0 Total --------------- --------------- Huge 0.00 0.00 Heap 28.53 28.53 Stack 0.20 0.20 Private 7.55 7.55 ---------------- --------------- --------------- Total 36.29 36.29 <p>If you see only 1 x NUMA-node column (\u201cNode0\u201d) NUMA is disabled. If you see more than 1 x NUMA-node, make sure the metric numbers (\u201cHeap\u201d, etc.) are balanced between nodes. Otherwise, NUMA is NOT\u00a0in \u201cinterleave\u201d mode.</p> <p>Note: some MongoDB packages already ship logic to disable NUMA in the init/startup script. Check for this using \u201cgrep\u201d\u00a0first. Your hardware or BIOS manual should cover disabling NUMA via the system BIOS.</p> Block Device IO Scheduler and Read-Ahead <p>For tuning flexibility, we recommended that MongoDB data sits on its own disk volume, preferably with its own dedicated disks/RAID array. While it may complicate backups, for the best performance you can also dedicate a separate volume for the MongoDB journal to separate it\u2019s disk activity\u00a0noise\u00a0from the main data set. The journal does not yet have it\u2019s own config/command-line setting, so you\u2019ll need to mount a volume to the \u201cjournal\u201d\u00a0directory inside the dbPath. For example, \u201c/var/lib/mongo/journal\u201d\u00a0would be the journal mount-path if the dbPath was set to \u201c/var/lib/mongo\u201d.</p> <p>Aside from good hardware, the block device MongoDB stores its data on can benefit from 2 x major adjustments:</p> IO Scheduler <p>The IO scheduler is an algorithm the kernel will use to commit reads and writes to disk. By default most Linux installs use the CFQ (Completely-Fair Queue) scheduler. This is designed to work well for many general use cases, but with little latency guarantees. Two other popular schedulers are \u201cdeadline\u201d\u00a0and \u201cnoop\u201d. Deadline excels at latency-sensitive use cases (like databases) and noop\u00a0is closer to\u00a0no scheduling at all.</p> <p>We generally suggest using the \u201cdeadline\u201d\u00a0IO scheduler for cases where you have real, non-virtualised disks under MongoDB. (For example, a \u201cbare metal\u201d server.) In some cases I\u2019ve seen \u201cnoop\u201d\u00a0perform better with certain hardware RAID controllers, however. The difference between \u201cdeadline\u201d\u00a0and \u201ccfq\u201d\u00a0can be massive for disk-bound deployments.</p> <p>If you are running MongoDB inside a VM (which has it\u2019s own IO scheduler beneath it) it is best to use \u201cnoop\u201d\u00a0and let the virtualization layer take care of the IO scheduling itself.</p> Read-Ahead <p>Read-ahead is a per-block device performance tuning in Linux that causes data ahead of a requested block on disk\u00a0to be read and then cached\u00a0into the filesystem cache. Read-ahead assumes that there is a sequential read pattern and something will benefit from those extra blocks being cached. MongoDB tends to have very random disk\u00a0patterns and\u00a0often does not benefit from the default read-ahead setting, wasting memory that could be used for more hot data. Most Linux systems have a default setting of 128KB/256 sectors (128KB = 256 x\u00a0512-byte sectors). This means if MongoDB\u00a0fetches a 64kb document from disk, 128kb of filesystem cache is used and maybe the extra 64kb is never accessed later, wasting memory.</p> <p>For this setting, we suggest a starting-point of 32 sectors (=16KB) for most MongoDB workloads. From there you can test increasing/reducing this setting and then monitor a combination of query performance, cached memory usage and disk read activity to find a better balance. You should aim to use as little cached memory as possible without dropping the query performance or causing significant disk activity.</p> <p>Both the IO scheduler and read-ahead can be changed by adding a file to the udev configuration at \u201c/etc/udev/rules.d\u201d. In this example I am assuming the block device serving mongo data is named \u201c/dev/sda\u201d\u00a0and I am setting \u201cdeadline\u201d as the IO scheduler and 16kb/32-sectors as read-ahead:</p> /etc/udev/rules.d/60-sda.rules <p>Shell 1 2 # set deadline scheduler and 16kb read-ahead for /dev/sda ACTION==\"add|change\", KERNEL==\"sda\", ATTR{queue/scheduler}=\"deadline\", ATTR{bdi/read_ahead_kb}=\"16\" <p>To check the IO\u00a0scheduler was applied ([square-brackets] = enabled scheduler):</p> <p>Shell 1 2 $ cat /sys/block/sda/queue/scheduler  noop [deadline] cfq <p>To check the current read-ahead setting:</p> <p>Shell 1 2 $ sudo blockdev --getra /dev/sda 32 <p>Note: this change should be applied and tested with a full system reboot!</p> Filesystem and Options <p>It is recommended that MongoDB uses only the ext4 or XFS filesystems for on-disk database data.\u00a0ext3 should be avoided due to its poor pre-allocation performance. If you\u2019re using WiredTiger (MongoDB 3.0+) as a storage engine, it is strongly advised that you ONLY\u00a0use XFS due to serious stability issues on\u00a0ext4.</p> <p>Each time you read a file, the filesystems perform an access-time metadata update by default. However, MongoDB (and most applications) does not use\u00a0this access-time information. This means you can disable access-time updates on MongoDB\u2019s data volume. A small amount of\u00a0disk IO activity that the access-time updates cause stops in this case.</p> <p>You can disable access-time updates by adding the flag \u201cnoatime\u201d\u00a0to the filesystem options field\u00a0in the file \u201c/etc/fstab\u201d\u00a0(4th field) for the disk serving MongoDB data:</p> <p>Shell 1 /dev/mapper/data-mongodb /var/lib/mongo\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0ext4\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0defaults,noatime 0 0 <p>Use \u201cgrep\u201d to verify the volume is currently mounted:</p> <p>Shell 1 2 $ grep \"/var/lib/mongo\" /proc/mounts /dev/mapper/data-mongodb /var/lib/mongo ext4 rw,seclabel,noatime,data=ordered 0 0 <p>Note: to apply a filesystem-options change, you must remount (umount + mount) the volume\u00a0again after stopping MongoDB, or reboot.</p> Network Stack <p>Several defaults of the Linux kernel network tunings are either not optimal for MongoDB, limit a typical host with 1000mbps network interfaces (or better) or cause unpredictable\u00a0behavior with routers and load balancers.\u00a0We suggest some increases to the relatively low throughput settings (net.core.somaxconn and net.ipv4.tcp_max_syn_backlog) and a decrease in keepalive settings, seen below.</p> <p>Make these changes permanent by adding the following to \u201c/etc/sysctl.conf\u201d\u00a0(or a new file /etc/sysctl.d/mongodb-sysctl.conf \u2013 if /etc/sysctl.d exists):</p> /etc/sysctl.conf <p>Shell 1 2 3 4 5 net.core.somaxconn = 4096 net.ipv4.tcp_fin_timeout = 30 net.ipv4.tcp_keepalive_intvl = 30 net.ipv4.tcp_keepalive_time = 120 net.ipv4.tcp_max_syn_backlog = 4096 <p>To check the current values of any of these settings:</p> <p>Shell 1 2 $ sysctl net.core.somaxconn net.core.somaxconn = 4096 <p>Note: you must run the\u00a0command \u201c/sbin/sysctl -p\u201d as root/sudo (or reboot) to\u00a0apply this change!</p> NTP Daemon <p>All of these deeper tunings make it easy to forget about something as simple as your clock source.\u00a0As MongoDB is a cluster, it relies on a\u00a0consistent time across nodes. Thus the NTP Daemon should run permanently on all MongoDB hosts, mongos and arbiters included. Be sure to check the time syncing\u00a0won\u2019t fight\u00a0with any guest-based virtualization tools like \u201cVMWare tools\u201d and \u201cVirtualBox Guest Additions\u201d.</p> <p>This is installed on RedHat/CentOS with:</p> <p>Shell 1 $ sudo yum install ntp <p>And on Debian/Ubuntu:</p> <p>Shell 1 $ sudo apt-get install ntp <p>Note: Start and enable the NTP Daemon (for starting on reboots) after installation. The commands to do this vary by OS and OS version, so please consult your documentation.</p> Security-Enhanced Linux (SELinux) <p>Security-Enhanced Linux is a kernel-level security access control module that has an unfortunate tendency to be disabled or set to warn-only on Linux deployments. As SELinux is a strict access control system, sometimes it can cause unexpected errors (permission denied, etc.) with applications that were not configured properly for SELinux. Often people disable SELinux to resolve the issue and forget about it entirely. While implementing SELinux is not an end-all solution, it massively\u00a0reduces the local attack surface of the server. We recommend deploying MongoDB with SELinus\u00a0\u201cEnforcing\u201d\u00a0mode on.</p> <p>The modes of SELinux are:</p> <ol> <li>Enforcing \u2013 Block and log policy violations.</li> <li>Permissive \u2013 Log policy violations only.</li> <li>Disabled \u2013 Completely disabled.</li> </ol> <p>As database servers are usually dedicated to one purpose, such as running MongoDB, the work of setting up SELinux is a lot simpler than a multi-use\u00a0server with many processes and users (such as an application/web server, etc.). The OS access pattern of a database server\u00a0should be extremely predictable. Introducing \u201cEnforcing\u201d\u00a0mode at the very beginning of your testing/installation instead of after-the-fact avoids a lot of gotchas with SELinux. Logging for SELinux is directed to \u201c/var/log/audit/audit.log\u201d\u00a0and the configuration is at \u201c/etc/selinux\u201d.</p> <p>Luckily, Percona Server for MongoDB\u00a0RPM\u00a0packages (CentOS/RedHat) are SELinux \u201cEnforcing\u201d mode compatible\u00a0as they install/enable\u00a0an\u00a0SELinux policy at\u00a0RPM\u00a0install time! Debian/Ubuntu SELinux support is\u00a0still in planning.</p> <p>Here you can see the SELinux policy shipped in the Percona Server for MongoDB version 3.2 server package:</p> <p>Shell 1 2 $ rpm -ql Percona-Server-MongoDB-32-server | grep selinux /etc/selinux/targeted/modules/active/modules/mongod.pp <p>To change the SELinux mode to \u201cEnforcing\u201d:</p> <p>Shell 1 $ sudo setenforce Enforcing <p>To check the running\u00a0SELinux mode:</p> <p>Shell 1 2 $ sudo getenforce Enforcing Linux Kernel and Glibc Version <p>The version of the Linux kernel and Glibc itself may be more important than you think. Some community\u00a0benchmarks show a significant improvement on OLTP throughput benchmarks\u00a0with the recent Linux 3.x kernels versus the 2.6 still widely deployed. To avoid serious bugs, MongoDB\u00a0should at minimum use Linux 2.6.36 and Glibc 2.13 or newer.</p> <p>I hope to create a follow-up post on the specific differences seen under MongoDB workloads on Linux 3.2+ versus 2.6. Until then, I recommend you test the difference\u00a0using your own workloads and any results/feedback are\u00a0appreciated.</p> What\u2019s Next? <p>What\u2019s the next thing to tune? At this point, tuning becomes case-by-case and open-ended. I appreciate any comments on use-case/tunings pairings that worked for you. Also, look out for follow-ups to this article for a few tunings I excluded due to lack of\u00a0testing.</p> <p>Not knowing the next step might mean you\u2019re done tuning, or that you need more visibility into your stack to find the next bottleneck.\u00a0Good monitoring and data visibility are invaluable for this type of investigation. Look out for future posts regarding monitoring your MongoDB (or MySQL) deployment and consider using Percona Monitoring and Management\u00a0as an all-in-one monitoring solution. You could also try using\u00a0Percona-Lab/prometheus_mongodb_exporter,\u00a0prometheus/node_exporter\u00a0and\u00a0Percona-Lab/grafana_mongodb_dashboards for monitoring MongoDB/Linux with Prometheus\u00a0and\u00a0Grafana.</p> <p>The road to an efficient database stack requires patience, analysis and iteration. Tomorrow a new hardware architecture or change in kernel behavior could come, be the first to spot the next bottleneck! Happy hunting.</p> <p>\u539f\u6587\uff1ahttps://www.percona.com/blog/2016/08/12/tuning-linux-for-mongodb/</p>","tags":["mongodb","nosql","\u5927\u6570\u636e"]},{"location":"DevOps/2017-05-05-activemq5-x-x%25e4%25b8%25bb%25e4%25bb%258e%25e5%25ae%2589%25e8%25a3%2585%25e6%258c%2587%25e5%258d%2597.html/","title":"activemq5.x.x\u4e3b\u4ece\u5b89\u88c5\u6307\u5357","text":"","tags":["activemq","jms","\u4e2d\u95f4\u4ef6","\u6d88\u606f"]},{"location":"DevOps/2017-05-05-activemq5-x-x%25e4%25b8%25bb%25e4%25bb%258e%25e5%25ae%2589%25e8%25a3%2585%25e6%258c%2587%25e5%258d%2597.html/#1","title":"1. \u670d\u52a1\u5668\u89c4\u5212","text":"<p>\u4e0b\u9762\u7684\u670d\u52a1\u5668ip\u3001\u7528\u6237\u3001\u76ee\u5f55\u4e3a\u793a\u4f8b\uff0c\u6839\u636e\u5177\u4f53\u60c5\u51b5\u8bbe\u5b9a\u3002</p> <p>\u5b89\u88c5activemq\u524d\uff0c\u8bf7\u786e\u4fdd\u5df2\u7ecf\u5b89\u88c5jdk1.7\u6216jdk1.8\u3002</p>","tags":["activemq","jms","\u4e2d\u95f4\u4ef6","\u6d88\u606f"]},{"location":"DevOps/2017-05-05-activemq5-x-x%25e4%25b8%25bb%25e4%25bb%258e%25e5%25ae%2589%25e8%25a3%2585%25e6%258c%2587%25e5%258d%2597.html/#11","title":"1.1 \u670d\u52a1\u5668\u5217\u8868","text":"<p>\u64cd\u4f5c\u7cfb\u7edf: CentOS6.2+ \u6216 Redhat6.2+</p> <pre><code>192.168.10.1  serv-a1  \u4e3b\n192.168.10.2  serv-b1  \u4ece\n</code></pre>","tags":["activemq","jms","\u4e2d\u95f4\u4ef6","\u6d88\u606f"]},{"location":"DevOps/2017-05-05-activemq5-x-x%25e4%25b8%25bb%25e4%25bb%258e%25e5%25ae%2589%25e8%25a3%2585%25e6%258c%2587%25e5%258d%2597.html/#12","title":"1.2 \u7528\u6237\u89c4\u5212","text":"<ul> <li>mqusr activemq\u7528\u6237</li> </ul>","tags":["activemq","jms","\u4e2d\u95f4\u4ef6","\u6d88\u606f"]},{"location":"DevOps/2017-05-05-activemq5-x-x%25e4%25b8%25bb%25e4%25bb%258e%25e5%25ae%2589%25e8%25a3%2585%25e6%258c%2587%25e5%258d%2597.html/#13","title":"1.3 \u76ee\u5f55\u89c4\u5212","text":"\u76ee\u5f55 \u7528\u9014 \u5907\u6ce8 /opt \u5e94\u7528\u76ee\u5f55 owner: mqusr /opt/_archive \u5b89\u88c5\u7a0b\u5e8f\u5f52\u6863 /data \u6570\u636e\u76ee\u5f55 owner: mqusr /data/nas_data nas\u5171\u4eab\u76ee\u5f55","tags":["activemq","jms","\u4e2d\u95f4\u4ef6","\u6d88\u606f"]},{"location":"DevOps/2017-05-05-activemq5-x-x%25e4%25b8%25bb%25e4%25bb%258e%25e5%25ae%2589%25e8%25a3%2585%25e6%258c%2587%25e5%258d%2597.html/#2-activemq-serv-a1-serv-b1","title":"2. activemq \u5b89\u88c5\u81f3 serv-a1 \uff08\u4e3b\uff09, serv-b1\uff08\u4ece\uff09","text":"<p>\u4e0b\u9762\u4ee5serv-a1\u4e3a\u4f8b\u3002</p>","tags":["activemq","jms","\u4e2d\u95f4\u4ef6","\u6d88\u606f"]},{"location":"DevOps/2017-05-05-activemq5-x-x%25e4%25b8%25bb%25e4%25bb%258e%25e5%25ae%2589%25e8%25a3%2585%25e6%258c%2587%25e5%258d%2597.html/#21","title":"2.1 \u5efa\u7acb\u6570\u636e\u76ee\u5f55","text":"<pre><code>[root@serv-a1 ~]# mkdir /data/nas_data/activemq\n[root@serv-a1 ~]# mkdir /data/nas_data/activemq/serv-a1\n[root@serv-a1 ~]# mkdir /data/nas_data/activemq/serv-b1\n[root@serv-a1 ~]# chown -R mqusr:mqusr /data/nas_data/activemq/\n[root@serv-a1 ~]# su - mqusr\n</code></pre>","tags":["activemq","jms","\u4e2d\u95f4\u4ef6","\u6d88\u606f"]},{"location":"DevOps/2017-05-05-activemq5-x-x%25e4%25b8%25bb%25e4%25bb%258e%25e5%25ae%2589%25e8%25a3%2585%25e6%258c%2587%25e5%258d%2597.html/#22-activemq","title":"2.2 \u89e3\u538bactivemq\u7a0b\u5e8f\u5305","text":"<pre><code>[mqusr@serv-a1 ~]$ cd /opt/\n[mqusr@serv-a1 opt]$ tar -zxf apache-activemq-5.13.4-bin.tar.gz \n[mqusr@serv-a1 opt]$ mv apache-activemq-5.13.4/ activemq-5.13.4/\n</code></pre>","tags":["activemq","jms","\u4e2d\u95f4\u4ef6","\u6d88\u606f"]},{"location":"DevOps/2017-05-05-activemq5-x-x%25e4%25b8%25bb%25e4%25bb%258e%25e5%25ae%2589%25e8%25a3%2585%25e6%258c%2587%25e5%258d%2597.html/#23-data","title":"2.3 \u91cd\u5efadata\u76ee\u5f55 \uff08\u4e24\u53f0\u673a\u5171\u4eab\u76ee\u5f55\uff09","text":"<pre><code>[mqusr@serv-a1 opt]]$ cd activemq-5.13.4/\n[mqusr@serv-a1 activemq-5.13.4]$ rm -rf data/\n[mqusr@serv-a1 activemq-5.13.4]$ ln -s /data/nas_data/activemq/ data\n</code></pre>","tags":["activemq","jms","\u4e2d\u95f4\u4ef6","\u6d88\u606f"]},{"location":"DevOps/2017-05-05-activemq5-x-x%25e4%25b8%25bb%25e4%25bb%258e%25e5%25ae%2589%25e8%25a3%2585%25e6%258c%2587%25e5%258d%2597.html/#24","title":"2.4 \u914d\u7f6e","text":"","tags":["activemq","jms","\u4e2d\u95f4\u4ef6","\u6d88\u606f"]},{"location":"DevOps/2017-05-05-activemq5-x-x%25e4%25b8%25bb%25e4%25bb%258e%25e5%25ae%2589%25e8%25a3%2585%25e6%258c%2587%25e5%258d%2597.html/#241-confactivemqxml","title":"2.4.1 <code>conf/activemq.xml</code>","text":"<p><pre><code>[mqusr@serv-a1 activemq-5.13.4]$ vi conf/activemq.xml \n</code></pre> \u5b9a\u4f4d\u81f340\u884c\uff0c\u6dfb\u52a0 schedulerSupport=\"true\"\uff0c\u5e76\u4fdd\u5b58</p> <p>\u6ce8\uff1a\u4e24\u53f0\u673a\u5668\u7684brokerName\u4e0d\u4e00\u6837\uff0c\u914d\u7f6e\u4e3a\u673a\u5668\u540d\u5373\u53ef\u3002 <pre><code> 40 &lt;broker xmlns=\"http://activemq.apache.org/schema/core\" \n 41       brokerName=\"serv-a1\" dataDirectory=\"${activemq.data}\"\n 42       schedulerSupport=\"true\" &gt;\n</code></pre></p>","tags":["activemq","jms","\u4e2d\u95f4\u4ef6","\u6d88\u606f"]},{"location":"DevOps/2017-05-05-activemq5-x-x%25e4%25b8%25bb%25e4%25bb%258e%25e5%25ae%2589%25e8%25a3%2585%25e6%258c%2587%25e5%258d%2597.html/#242-binenv","title":"2.4.2 <code>bin/env</code>","text":"<p><pre><code>[mqusr@serv-a1 activemq-5.13.4]$ vi bin/env\n</code></pre> \u5206\u522b\u5b9a\u4f4d\u81f327\u3001102\u884c\uff0c\u8bbe\u7f6e ACTIVEMQ_OPTS_MEMORY\u3001ACTIVEMQ_PIDFILE</p> <p>\u6ce8\uff1a\u5176\u4e2d\u7684serv-a1\u53d6\u673a\u5668\u540d <pre><code> 27 ACTIVEMQ_OPTS_MEMORY=\"-Xms4G -Xmx4G\"\n 102 ACTIVEMQ_PIDFILE=\"$ACTIVEMQ_DATA/serv-a1/activemq.pid\"\n</code></pre></p>","tags":["activemq","jms","\u4e2d\u95f4\u4ef6","\u6d88\u606f"]},{"location":"DevOps/2017-05-05-activemq5-x-x%25e4%25b8%25bb%25e4%25bb%258e%25e5%25ae%2589%25e8%25a3%2585%25e6%258c%2587%25e5%258d%2597.html/#243-conflog4jproperties","title":"2.4.3 <code>conf/log4j.properties</code>","text":"<p><pre><code>[mqusr@serv-a1 activemq-5.13.4]$ vi conf/log4j.properties\n</code></pre> \u5206\u522b\u5b9a\u4f4d\u81f347\u300173\u884c\uff0c\u8bbe\u7f6elog\u6587\u4ef6</p> <p>\u6ce8\uff1a\u5176\u4e2d\u7684serv-a1\u53d6\u673a\u5668\u540d <pre><code> 47 log4j.appender.logfile.file=${activemq.base}/data/serv-a1/activemq.log\n 73 log4j.appender.audit.file=${activemq.base}/data/serv-a1/audit.log\n</code></pre></p>","tags":["activemq","jms","\u4e2d\u95f4\u4ef6","\u6d88\u606f"]},{"location":"DevOps/2017-05-05-activemq5-x-x%25e4%25b8%25bb%25e4%25bb%258e%25e5%25ae%2589%25e8%25a3%2585%25e6%258c%2587%25e5%258d%2597.html/#244-confcredentialsproperties","title":"2.4.4 <code>conf/credentials.properties</code>","text":"<p>\u8bbe\u7f6e activemq \u8fde\u63a5\u5bc6\u7801 \uff08\u5f00\u53d1\u73af\u5883\u53ef\u9009\uff09 <pre><code>[mqusr@serv-a1 activemq-5.13.4]$ vi conf/credentials.properties \n</code></pre> <pre><code>activemq.username=sys\nactivemq.password=changeMe\n</code></pre></p>","tags":["activemq","jms","\u4e2d\u95f4\u4ef6","\u6d88\u606f"]},{"location":"DevOps/2017-05-05-activemq5-x-x%25e4%25b8%25bb%25e4%25bb%258e%25e5%25ae%2589%25e8%25a3%2585%25e6%258c%2587%25e5%258d%2597.html/#245-confjetty-realmproperties","title":"2.4.5 <code>conf/jetty-realm.properties</code>","text":"<p>\u8bbe\u7f6eweb\u63a7\u5236\u53f0\u5bc6\u7801 \uff08\u5f00\u53d1\u73af\u5883\u53ef\u9009\uff09</p> <pre><code>[mqusr@serv-a1 activemq-5.13.4]$ vi conf/jetty-realm.properties \n</code></pre> <pre><code>admin: changeMe, admin\n</code></pre>","tags":["activemq","jms","\u4e2d\u95f4\u4ef6","\u6d88\u606f"]},{"location":"DevOps/2017-05-05-activemq5-x-x%25e4%25b8%25bb%25e4%25bb%258e%25e5%25ae%2589%25e8%25a3%2585%25e6%258c%2587%25e5%258d%2597.html/#25","title":"2.5 \u542f\u52a8","text":"<pre><code>[mqusr@serv-a1 activemq-5.13.4]$ ./bin/activemq start\n</code></pre> <p>\u6d4f\u89c8\u5668\u8bbf\u95eeweb\u63a7\u5236\u53f0 http://serv-a1:8161/admin/ \uff08\u7528\u6237\u5bc6\u7801 admin/changeMe\uff09 </p>","tags":["activemq","jms","\u4e2d\u95f4\u4ef6","\u6d88\u606f"]},{"location":"DevOps/2017-05-05-activemq5-x-x%25e4%25b8%25bb%25e4%25bb%258e%25e5%25ae%2589%25e8%25a3%2585%25e6%258c%2587%25e5%258d%2597.html/#3","title":"3. \u53c2\u8003\u8d44\u6599","text":"<ul> <li>activemq\u5b98\u7f51 http://activemq.apache.org/</li> <li>\u5b89\u88c5\u6587\u4ef6\u4e0b\u8f7d\u9875\u9762 http://activemq.apache.org/download.html</li> <li>activemq cluster http://activemq.apache.org/clustering.html</li> </ul>","tags":["activemq","jms","\u4e2d\u95f4\u4ef6","\u6d88\u606f"]},{"location":"DevOps/2017-05-21-%25e4%25bf%25ae%25e6%2594%25b9%25e4%25ba%2586ssh%25e9%25bb%2598%25e8%25ae%25a4%25e7%25ab%25af%25e5%258f%25a3%25e4%25b9%258b%25e5%2590%258e%25ef%25bc%258c%25e5%25a6%2582%25e4%25bd%2595%25e9%2585%258d%25e7%25bd%25aegit%25ef%25bc%259f.html/","title":"\u4fee\u6539\u4e86SSH\u9ed8\u8ba4\u7aef\u53e3\u4e4b\u540e\uff0c\u5982\u4f55\u914d\u7f6egit\uff1f","text":"<ul> <li>\u8f6c\u8f7d\u81ea\uff1a</li> <li>\u672c\u6587\u6807\u9898\uff1a\u4fee\u6539\u4e86SSH\u9ed8\u8ba4\u7aef\u53e3\u4e4b\u540e\uff0c\u5982\u4f55\u914d\u7f6egit\uff1f</li> <li>\u672c\u6587\u94fe\u63a5\uff1ahttp://zengrong.net/post/1544.htm</li> </ul> <p>\u7531\u4e8e\u5b89\u5168\u6216\u8005\u5176\u5b83\u539f\u56e0\uff0c\u6211\u4eec\u53ef\u80fd\u4f1a\u4fee\u6539\u9ed8\u8ba4\u7684SSH\u670d\u52a1\u7aef\u53e3\u53f7\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5df2\u6709\u7684git\u9879\u76ee\u5728pull\u6216\u8005push\u7684\u65f6\u5019\u4f1a\u62a5\u9519\u3002</p> <p>\u73b0\u5728\u5047\u8bbe\u539f\u6765\u7684\u9879\u76ee\u7684remote\u8bbe\u7f6e\u4e3a<code>git@domain.com:Projects/p1.git</code>\uff0c\u5c06\u670d\u52a1\u5668SSH\u9ed8\u8ba4\u7aef\u53e3\u4fee\u6539\u4e3a3022\u540e\uff0c\u5bfc\u81f4push\u51fa\u9519\u3002</p> <p>\u6709\u4e24\u4e2a\u89e3\u51b3\u529e\u6cd5\uff1a</p> \u4e00\u3001\u76f4\u63a5\u4fee\u6539URL\u4e3aSSH://\u5f00\u5934 <pre>git remote set-url origin ssh://git@domain.com:3022/~/Projects/p1.git\n</pre> \u4e8c\u3001 \u4fee\u6539\u672c\u5730\u914d\u7f6e\u6587\u4ef6 <pre>cat&gt;~/.ssh/config\n# \u6620\u5c04\u4e00\u4e2a\u522b\u540d\nhost newdomain\nhostname domain.com\nport 3022\n# ctrl+D\n</pre> <p>\u4fee\u6539p1.git\u9879\u76ee\u4e0b\u7684git\u914d\u7f6e\u6587\u4ef6</p> <pre>git remote set-url origin git@newdomain:Projects/p1.git</pre>","tags":["git"]},{"location":"DevOps/2017-07-01-understand-jmeter-apdex.html/","title":"Understand JMeter APDEX","text":"","tags":["jmeter","APDEX","performance","test","threshold"]},{"location":"DevOps/2017-07-01-understand-jmeter-apdex.html/#1-concept","title":"1. Concept","text":"<p>APDEX is explained here</p> <p>To compute it JMeter needs 2 values: - Satisfied count - Tolerating count</p> <p>Satisfied count is the Number of requests for which response time is lower than \"Toleration threshold\"</p> <p>Tolerating count is the Number of requests for which response time is higher than Toleration threshold but lower than \"Frustration threshold\"</p> <p>So JMeter let's you customize those 2 values as it depends on your SLR/SLA.</p> <p>APDEX = (SatisfiedCount + ToleratingCount / 2) / TotalSamples</p>","tags":["jmeter","APDEX","performance","test","threshold"]},{"location":"DevOps/2017-07-01-understand-jmeter-apdex.html/#2-how-to-set-apdex-thresholds","title":"2. How to set APDEX thresholds","text":"","tags":["jmeter","APDEX","performance","test","threshold"]},{"location":"DevOps/2017-07-01-understand-jmeter-apdex.html/#binuserproperties","title":"bin/user.properties","text":"<pre><code>$ pwd\n/Users/echo/apps/jmeter-3.2\n$ cat bin/user.properties | grep threshold\n# Change this parameter if you want to override the APDEX satisfaction threshold.\n#jmeter.reportgenerator.apdex_satisfied_threshold=500\n# Change this parameter if you want to override the APDEX tolerance threshold.\n#jmeter.reportgenerator.apdex_tolerated_threshold=1500\n</code></pre>","tags":["jmeter","APDEX","performance","test","threshold"]},{"location":"DevOps/2017-07-01-understand-jmeter-apdex.html/#command-line","title":"command line","text":"<p>For exampe: <pre><code>CASE=testcast1 &amp;&amp; ./bin/jmeter -n -t \"testcase/$CASE.jmx\" -l \"output/$CASE.log\"  -o \"output/$CASE\" -e -Jjmeter.reportgenerator.apdex_satisfied_threshold=400 -Jjmeter.reportgenerator.apdex_tolerated_threshold=1200\n</code></pre></p>","tags":["jmeter","APDEX","performance","test","threshold"]},{"location":"DevOps/2017-07-01-understand-jmeter-apdex.html/#references","title":"References","text":"<ul> <li>http://jmeter.apache.org/usermanual/generating-dashboard.html</li> <li>https://en.wikipedia.org/wiki/Apdex</li> <li>https://stackoverflow.com/questions/39696457/can-anyone-help-me-to-understand-the-terms-toleration-threshold-and-frustrati</li> </ul>","tags":["jmeter","APDEX","performance","test","threshold"]},{"location":"DevOps/2017-07-06-gradle-to-maven-conversion-and-vice-versa.html/","title":"Gradle to maven conversion and vice versa","text":"<p>A N M Bazlur Bazlur RahmanJuly 20, 2014Java,\u00a0Tips</p> <p>How to convert maven to gradle</p> <p>The first thing is, you have to install gradle. Its easy. I know you can do it.\u00a0 Go to the installing guide:\u00a0http://www.gradle.org/docs/current/userguide/installation.html</p> <p>Now the second step is to run \u2018gradle init\u2018 in the directory containing the POM file. This will\u00a0 convert the maven build to a gradle build generating a setting.gradle file and one or\u00a0 ore more build.gradle files.</p> <p>Thats all.</p> <p>How to convert gradle to maven</p> <p>You just need to add\u00a0 a maven plugin in your build.gradle.</p> <p>Your build gradle should be like this-</p> 1 2 3 4 5 6 7 8 9 10 <code>apply plugin: 'java'</code> <code>apply plugin: 'maven'</code> <code>group = 'com.bazlur.app'</code> <code>// artifactId is taken by default, from folder name</code> <code>version = '0.1-SNAPSHOT'</code> <code>dependencies {</code> <code>compile 'commons-lang:commons-lang:2.3'</code> <code>}</code> <p>Now run \u2018gradle install\u2018 in the build.gradle folder.</p> <p>Now you will find in the\u00a0build/poms\u00a0subfolder, a file called pom-default.xml which will contain the dependencies.</p> <p>Now its all yours, copy it, customise it add up new stuff.</p> Source:\u00a0https://codexplo.wordpress.com/2014/07/20/gradle-to-maven-conversion-and-vice-versa/","tags":["maven","gradle"]},{"location":"DevOps/2017-07-27-git-list-remote-branches.html/","title":"git list remote branches","text":"<p>Sometimes you may need to figure out what\u00a0branches\u00a0exist on a remote repository so you can pull them down and check them out, merge them into your local branches, etc. If you\u2019re using\u00a0GitHub\u00a0or\u00a0gitweb\u00a0to host your repository it\u2019s usually easy to determine the branch names, but if you need to get them in general or for scripts it\u2019s not exactly clear.</p> <p></p> <p>UPDATE:\u00a0The comments have enlightened me quite a bit\u2026there seems to always be more than one way to skin a cat using Git. The easiest way is just to use the\u00a0<code>git branch</code>\u00a0commands\u2019 various options.\u00a0<code>-a</code>\u00a0shows all local and remote branches, while\u00a0<code>-r</code>shows only remote branches.</p> <pre>$ git branch\n* master\n\n$ git branch -a\n* master\n  origin/1-2-stable\n  origin/2-0-stable\n  origin/2-1-stable\n  origin/2-2-stable\n  origin/3-0-unstable\n  origin/HEAD\n  origin/master\n\n$ git branch -r\n  origin/1-2-stable\n  origin/2-0-stable\n  origin/2-1-stable\n  origin/2-2-stable\n  origin/3-0-unstable\n  origin/HEAD\n  origin/master\n</pre> <p>So, once you know the name of the branch it\u2019s quite simple to\u00a0check them out.\u00a0If you have color options on it\u2019s also quite easy to tell which branches aren\u2019t pulled down since they\u2019re listed in red.</p> <p>There\u2019s also another way to do figure out what branches are on your remote by actually using the remote related commands,\u00a0<code>git remote</code>\u00a0and\u00a0<code>git ls-remote</code>. The former displays plenty of information about the remote in general and how it relates to your own repository, while the latter simply lists all references to branches and tags that it knows about.</p> <pre>$ git remote show origin\n* remote origin\n  URL: git://github.com/rails/rails.git\n  Remote branch merged with 'git pull' while on branch master\n    master\n  Tracked remote branches\n    1-2-stable 2-0-stable 2-1-stable 2-2-stable 3-0-unstable master\n\n$ git ls-remote --heads origin\n5b3f7563ae1b4a7160fda7fe34240d40c5777dcd  refs/heads/1-2-stable\n71926912a127da29530520d435c83c48778ac2b2  refs/heads/2-0-stable\n2b158543247a150e8ec568becf360e7376f8ab84  refs/heads/2-1-stable\nb0792a3e7be88e3060af19bab01cd3d26d347e4c  refs/heads/2-2-stable\nd6b9f8410c990b3d68d1970f1461a1d385d098d7  refs/heads/3-0-unstable\nf04346d8b999476113d5e5a30661e07899e3ff80  refs/heads/master\n</pre> <p>The\u00a0<code>ls-remote</code>\u00a0command returns the SHA1 hash of the latest commit for that reference, so it is quite easy to parse out and get to the exact commit you need if you\u2019re doing some scripting. The\u00a0<code>--heads</code>\u00a0option lists only branch names since the command can list tags too.</p> <p>If you have any other uses for these commands or an easier way to figure out branches that live on a remote, comment away!</p> <p>Source:\u00a0http://gitready.com/intermediate/2009/02/13/list-remote-branches.html</p>","tags":["git","ls-remote"]},{"location":"DevOps/2017-09-17-how-to-disable-console-logging-in-spring-boot.html/","title":"How to disable console logging in spring-boot?","text":"<p>It turned out if I set the following property empty, the console logging is disabled:</p> <p><code>logging.pattern.console=</code></p> <p> </p> <p>Reference</p> <p>https://stackoverflow.com/questions/43918414/how-to-disable-console-logging-in-spring-boot</p>","tags":[]},{"location":"DevOps/2017-09-17-spring-boot-slf4j-logging-example.html/","title":"Spring Boot SLF4J Logging example","text":"<p>By\u00a0mkyong\u00a0|\u00a0January 4, 2017\u00a0| Updated : April 17, 2017 | Viewed : 0 times\u00a0+-57,224 pv/w</p> <p>By default, the SLF4j Logging is included in the Spring Boot starter package.</p> application.properties <pre><code>spring-boot-web-project$ mvn dependency:tree\n\n+...\n+- org.springframework.boot:spring-boot-starter-logging:jar:1.4.2.RELEASE:compile\n[INFO] |  |  |  +- ch.qos.logback:logback-classic:jar:1.1.7:compile\n[INFO] |  |  |  |  \\- ch.qos.logback:logback-core:jar:1.1.7:compile\n[INFO] |  |  |  +- org.slf4j:jcl-over-slf4j:jar:1.7.21:compile\n[INFO] |  |  |  +- org.slf4j:jul-to-slf4j:jar:1.7.21:compile\n[INFO] |  |  |  \\- org.slf4j:log4j-over-slf4j:jar:1.7.21:compile\n+...</code></pre> Note Review this\u00a0Spring Boot Logback XML template\u00a0to understand the default logging pattern and configuration. 1. application.properties <p>To enable logging, create a\u00a0<code>application.properties</code>\u00a0file in the root of the\u00a0<code>resources</code>\u00a0folder.</p> <p>1.1\u00a0<code>logging.level</code>\u00a0\u2013 define logging level, the logging will be output to console.</p> application.properties <pre><code>logging.level.org.springframework.web=ERROR\nlogging.level.com.mkyong=DEBUG</code></pre> <p>1.2\u00a0<code>logging.file</code>\u00a0\u2013 define logging file, the logging will be output to a file and console.</p> application.properties <pre><code>logging.level.org.springframework.web=ERROR\nlogging.level.com.mkyong=DEBUG\n\n#output to a temp_folder/file\nlogging.file=${java.io.tmpdir}/application.log\n\n#output to a file\n#logging.file=/Users/mkyong/application.log</code></pre> <p>1.3\u00a0<code>logging.pattern</code>\u00a0\u2013 define a custom logging pattern.</p> application.properties <pre><code>logging.level.org.springframework.web=ERROR\nlogging.level.com.mkyong=DEBUG\n\n# Logging pattern for the console\nlogging.pattern.console= \"%d{yyyy-MM-dd HH:mm:ss} - %msg%n\"\n\n# Logging pattern for file\nlogging.pattern.file= \"%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n\"\n\nlogging.file=/Users/mkyong/application.log</code></pre> 2. application.yml <p>This is the equivalent in YAML format.</p> application.yml <pre><code>logging:\n  level:\n    org.springframework.web: ERROR\n    com.mkyong: DEBUG\n  pattern:\n    console: \"%d{yyyy-MM-dd HH:mm:ss} - %msg%n\"\n    file: \"%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n\"\n  file: /Users/mkyong/application.log</code></pre> 3. Classic Logback.xml <p>If you don\u2019t like the Spring Boot logging template, just create a standard\u00a0<code>logback.xml</code>\u00a0in the root of the\u00a0<code>resources</code>folder or root of the classpath. This will override the Spring Boot logging template.</p> logback.xml <pre><code>\n&lt;configuration&gt;\n\n    &lt;property name=\"DEV_HOME\" value=\"c:/logs\" /&gt;\n\n    &lt;appender name=\"FILE-AUDIT\"\n        class=\"ch.qos.logback.core.rolling.RollingFileAppender\"&gt;\n        &lt;file&gt;${DEV_HOME}/debug.logfile&gt;\n        &lt;encoder class=\"ch.qos.logback.classic.encoder.PatternLayoutEncoder\"&gt;\n            &lt;Pattern&gt;\n                %d{yyyy-MM-dd HH:mm:ss} - %msg%n\n            Pattern&gt;\n        encoder&gt;\n\n        &lt;rollingPolicy class=\"ch.qos.logback.core.rolling.TimeBasedRollingPolicy\"&gt;\n            \n            &lt;fileNamePattern&gt;${DEV_HOME}/archived/debug.%d{yyyy-MM-dd}.%i.log\n                        fileNamePattern&gt;\n            &lt;timeBasedFileNamingAndTriggeringPolicy\n                class=\"ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP\"&gt;\n                &lt;maxFileSize&gt;10MBmaxFileSize&gt;\n            timeBasedFileNamingAndTriggeringPolicy&gt;\n        rollingPolicy&gt;\n\n    appender&gt;\n\n    &lt;logger name=\"com.mkyong\" level=\"debug\"\n        additivity=\"false\"&gt;\n        &lt;appender-ref ref=\"FILE-AUDIT\" /&gt;\n    logger&gt;\n\n    &lt;root level=\"error\"&gt;\n        &lt;appender-ref ref=\"FILE-AUDIT\" /&gt;\n    root&gt;\n\nconfiguration&gt;\n4. Spring Boot logging by Profile\nNote\nRead this article \u2013\u00a0Profile-specific configuration\n<p>Create a\u00a0<code>logback-spring.xml</code>\u00a0in the root of the classpath, to take advantage of the\u00a0templating features\u00a0provided by Spring Boot.</p>\n<p>In below example :</p>\n<ol>\n<li>If the profile is\u00a0<code>dev</code>, logs to console and a rolling file.</li>\n<li>If the profile is\u00a0<code>prod</code>, logs to a rolling file only.</li>\n</ol>\nlogback-spring.xml\n<pre><code>\n&lt;configuration&gt;\n    &lt;include resource=\"org/springframework/boot/logging/logback/defaults.xml\"/&gt;\n    &lt;property name=\"LOG_FILE\" value=\"${LOG_FILE:-${LOG_PATH:-${LOG_TEMP:-${java.io.tmpdir:-/tmp}}/}spring.log}\"/&gt;\n\n    &lt;springProfile name=\"dev\"&gt;\n        &lt;include resource=\"org/springframework/boot/logging/logback/console-appender.xml\"/&gt;\n        &lt;appender name=\"ROLLING-FILE\"\n                  class=\"ch.qos.logback.core.rolling.RollingFileAppender\"&gt;\n            &lt;encoder&gt;\n                &lt;pattern&gt;${FILE_LOG_PATTERN}pattern&gt;\n            encoder&gt;\n            &lt;file&gt;${LOG_FILE}file&gt;\n            &lt;rollingPolicy class=\"ch.qos.logback.core.rolling.TimeBasedRollingPolicy\"&gt;\n                &lt;fileNamePattern&gt;${LOG_FILE}.%d{yyyy-MM-dd}.logfileNamePattern&gt;\n            rollingPolicy&gt;\n        appender&gt;\n        &lt;root level=\"ERROR\"&gt;\n            &lt;appender-ref ref=\"CONSOLE\"/&gt;\n            &lt;appender-ref ref=\"ROLLING-FILE\"/&gt;\n        root&gt;\n    springProfile&gt;\n\n    &lt;springProfile name=\"prod\"&gt;\n        &lt;appender name=\"ROLLING-FILE\"\n                  class=\"ch.qos.logback.core.rolling.RollingFileAppender\"&gt;\n            &lt;encoder&gt;\n                &lt;pattern&gt;${FILE_LOG_PATTERN}pattern&gt;\n            encoder&gt;\n            &lt;file&gt;${LOG_FILE}file&gt;\n            &lt;rollingPolicy class=\"ch.qos.logback.core.rolling.TimeBasedRollingPolicy\"&gt;\n                &lt;fileNamePattern&gt;${LOG_FILE}.%d{yyyy-MM-dd}.%i.gzfileNamePattern&gt;\n                &lt;timeBasedFileNamingAndTriggeringPolicy\n                        class=\"ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP\"&gt;\n                    &lt;maxFileSize&gt;10MBmaxFileSize&gt;\n                timeBasedFileNamingAndTriggeringPolicy&gt;\n            rollingPolicy&gt;\n        appender&gt;\n\n        &lt;root level=\"ERROR\"&gt;\n            &lt;appender-ref ref=\"ROLLING-FILE\"/&gt;\n        root&gt;\n    springProfile&gt;\n\nconfiguration&gt;\napplication.yml\n<pre><code>spring:\n  profiles:\n    active: prod\n\nlogging:\n  level:\n    ROOT: ERROR\n    org.springframework: ERROR\n    org.springframework.data: ERROR\n    com.mkyong: INFO\n    org.mongodb: ERROR\n  file: /Users/mkyong/application.log</code></pre>\n<p>For non-web boot app, you can override the log file output like this :</p>\nConsole\n<pre><code>$ java -Dlogging.file=/home/mkyong/app/logs/app.log -jar boot-app.jar</code></pre>\n5. Set Root Level\napplication.properties\n<pre><code># root logging level, warning : too much output\nlogging.level.=DEBUG</code></pre>\napplication.yml\n<pre><code>logging:\n  level:\n    ROOT: DEBUG</code></pre>\nDownload Source Code\nDownload It \u2013\u00a0spring-boot-web-slf4j-logging.zip\u00a0(16 KB)\nReferences\n<ol>\n<li>Spring Boot \u2013 How to Logging</li>\n<li>Spring Boot Logback XML template</li>\n<li>Spring Boot: How can I set the logging level with application.properties?</li>\n<li>logback.xml Examples</li>\n<li>Logback Home</li>\n</ol>\n\n<p>\u00a0</p>\n<p>Source: https://www.mkyong.com/spring-boot/spring-boot-slf4j-logging-example/</p>","tags":["springboot","logging","logback","log4j"]},{"location":"DevOps/2017-09-21-filter-and-rename-resources-with-maven.html/","title":"Filter and rename resources with Maven","text":"<p>Source:\u00a0http://roufid.com/filter-and-rename-resources-with-maven/\u00a017 DEC, 2016</p> <p>If you want to filter and copy your project resources to the output directory, the\u00a0Apache Maven Resources Plugin\u00a0is the best plugin to perform that. But sometimes you want to filter and\u00a0renameresources\u00a0with Maven and the last version of the\u00a0Maven\u00a0Resources\u00a0Plugin\u00a0(current 3.0.1) does not provide a direct way to do that.</p> <p>This tutorial will show a workaround to filter and rename resources with Maven.</p> Project example <p>Let\u2019s consider a file\u00a0file-to-rename.txt\u00a0located under\u00a0src/main/\u00a0which \u00a0we want to filter and rename to\u00a0renamed-file.txt.</p> <p>Below the project structure :</p> <p>Maven project structure</p> <p>The content of\u00a0file-to-rename.txt\u00a0:</p> 1 2 3 firstname=${user.firstname} lastname=${user.lastname} date=${maven.build.timestamp} <p>Content of\u00a0pom.xml\u00a0:</p> 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; 4.0.0 com.roufid.tutorial filter-copy-rename-resource-tutorial 0.0.1-SNAPSHOT pom Filter, copy and rename resource tutorial Radouane ROUFID org.apache.maven.plugins maven-resources-plugin 3.0.1 filter-resources process-resources copy-resources ${project.build.directory} true ${basedir}/src/main **/* com.coderplus.maven.plugins copy-rename-maven-plugin 1.0 copy-and-rename-file compile rename ${project.build.directory}/file-to-rename.txt ${project.build.directory}/renamed-file.txt Building the project <p>Run a\u00a0mvn\u00a0install\u00a0to build the project if you use command line or\u00a0Right-Click\u00a0-&gt;\u00a0Run As\u00a0-&gt;\u00a0Maven install\u00a0on Eclipse.</p> <p>After a refresh, below the new project structure\u00a0:</p> <p>Maven project output directory</p> <p>And the content of\u00a0renamed-file.txtis :</p> 1 2 3 firstname=Radouane lastname=ROUFID date=2016-12-06T10:19:19Z What happened ? <p>The project build is on two step. First\u00a0maven-resources-plugin\u00a0is used at the\u00a0copy-resources\u00a0lifecycle phase to filter the \u00a0resources located under\u00a0/src/main\u00a0and copy them to the\u00a0target\u00a0directory. Next,\u00a0copy-rename-maven-plugin\u00a0is used to rename the\u00a0filtered\u00a0output file\u00a0file-to-rename.txt\u00a0to\u00a0renamed-file.txt.</p> References <ul> <li>Apache Maven resources plugin</li> <li>Copy Rename Maven Plugin</li> </ul>","tags":["maven"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/","title":"Install CloudStack 4.11.1.0 on CentOS 7.5","text":"","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#1-preparation","title":"1 Preparation","text":"","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#11-selinux","title":"1.1 \u8bbe\u7f6eselinux","text":"<pre><code>sed -i s#'SELINUX=enforcing'#'SELINUX=permissive'#g /etc/selinux/config\nsetenforce 0\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#12-ntp","title":"1.2 \u5b89\u88c5NTP\uff08\u65f6\u95f4\u540c\u6b65\uff09","text":"<pre><code>yum -y install ntp\nsystemctl enable ntpd\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#13-cloudstackrepo","title":"1.3 \u5b89\u88c5cloudstack.repo","text":"<pre><code>cat &lt;&lt;EOF &gt; /etc/yum.repos.d/cloudstack.repo\n[cloudstack]\nname=cloudstack\nbaseurl=http://cloudstack.apt-get.eu/centos/7/4.11/\nenabled=1\ngpgcheck=0\n\nEOF\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#14","title":"1.4 \u8bbe\u7f6e\u9632\u706b\u5899","text":"<pre><code>firewall-cmd --permanent --add-port=111/tcp\nfirewall-cmd --permanent --add-port=111/udp\nfirewall-cmd --permanent --add-port=2049/tcp\nfirewall-cmd --permanent --add-port=32803/tcp\nfirewall-cmd --permanent --add-port=32769/udp\nfirewall-cmd --permanent --add-port=892/tcp\nfirewall-cmd --permanent --add-port=892/udp\nfirewall-cmd --permanent --add-port=875/tcp\nfirewall-cmd --permanent --add-port=875/udp\nfirewall-cmd --permanent --add-port=662/tcp\nfirewall-cmd --permanent --add-port=662/udp\nfirewall-cmd --permanent --add-port=8080/tcp\nfirewall-cmd --reload\nfirewall-cmd --list-all\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#2-installation","title":"2 Installation","text":"","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#21-cloudstack-management","title":"2.1 \u5b89\u88c5cloudstack-management","text":"<pre><code>yum -y install cloudstack-management \n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#22-mariadb","title":"2.2 \u5b89\u88c5MariaDB","text":"","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#221-install-config-mariadb","title":"2.2.1 Install &amp; config mariadb","text":"<pre><code>yum install mariadb mariadb-server \nvi /etc/my.cnf \n[mysqld]\ninnodb_rollback_on_timeout=1\ninnodb_lock_wait_timeout=600\nmax_connections=350\nlog-bin=mysql-bin\nbinlog-format = 'ROW'\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#222-data","title":"2.2.2 \u521b\u5efadata\u76ee\u5f55","text":"<pre><code>[root@panda lib]# mkdir -p /data/lib/mysql\n[root@panda lib]# chown mysql:mysql /data/lib/mysql/\n[root@panda lib]# rmdir /var/lib/mysql/\n[root@panda lib]# cd /var/lib &amp;&amp; ln -s /data/lib/mysql/ .\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#223","title":"2.2.3 \u542f\u52a8\u6570\u636e\u5e93\u5e76\u8bbe\u7f6e\u4e3a\u5f00\u673a\u542f\u52a8","text":"<pre><code>systemctl start mariadb      #\u542f\u52a8\u6570\u636e\u5e93\nsystemctl enable mariadb     #\u5f00\u673a\u81ea\u542f\u52a8\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#224","title":"2.2.4 \u521d\u59cb\u5316\u6570\u636e\u5e93","text":"<pre><code>mysql_secure_installation              \n#\u8bbe\u7f6e\u5bc6\u7801\u7136\u540e\u4e00\u8defyyyy \uff08yes\uff09\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#23-cloudstack-setup-databasescloudstack","title":"2.3 \u4f7f\u7528cloudstack-setup-databases\u521d\u59cb\u5316CloudStack\u6570\u636e\u5e93","text":"<pre><code>cloudstack-setup-databases cloud:cloud@localhost --deploy-as=root:123456 -i 192.168.10.3 \n## 192.168.10.3\u662f\u5f53\u524d\u7cfb\u7edf\u7684\u672c\u5730ip\n# \u91cd\u7f6e\u6570\u636e\u5e93\u5bc6\u7801123456\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#24-management","title":"2.4 \u5b89\u88c5management\u670d\u52a1\u5668","text":"<pre><code>cloudstack-setup-management \n# The --tomcat7 option is deprecated, CloudStack now uses embedded Jetty server.\n</code></pre> <p>\u542f\u52a8cloudstack</p> <pre><code>systemctl start cloudstack-management\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#25-nfs","title":"2.5 \u5b89\u88c5\u4e0e\u914d\u7f6eNFS\u5b58\u50a8","text":"<pre><code>yum -y install nfs-utils rpcbind\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#251","title":"2.5.1 \u914d\u7f6e\u57df\u540d","text":"<pre><code>vi /etc/idmapd.conf\nDomain = echoyun.edu\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#252-nfs","title":"2.5.2 \u51c6\u5907NFS\u76ee\u5f55","text":"<pre><code>mkdir -p /data/cloudstack/{primary,secondary}\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#253-nfs","title":"2.5.3 \u4fee\u6539NFS\u670d\u52a1\u53c2\u6570","text":"<pre><code># vim /etc/sysconfig/nfs\nMOUNTD_PORT=892\nSTATD_PORT=662\nSTATD_OUTGOING_PORT=2020\n</code></pre> <pre><code># vim /etc/modprobe.d/lockd.conf \noptions lockd nlm_tcpport=32803\noptions lockd nlm_udpport=32769\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#254-exports","title":"2.5.4 \u914d\u7f6eexports","text":"<pre><code>vim /etc/exports\n/data/cloudstack/primary *(rw,async,no_root_squash,no_subtree_check)\n/data/cloudstack/secondary *(rw,async,no_root_squash,no_subtree_check)\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#255-nfs","title":"2.5.5 \u8bbe\u7f6enfs\u6302\u8f7d","text":"<pre><code>vim /etc/nfsmount.conf\nNfsvers=4\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#256-nfsrpcbind","title":"2.5.6 \u542f\u52a8nfs\u548crpcbind","text":"<pre><code>systemctl enable rpcbind\nsystemctl enable nfs-server\nsystemctl start rpcbind\nsystemctl start nfs-server\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#257","title":"2.5.7 \u6d4b\u8bd5\u6302\u8f7d","text":"<pre><code>mount -t nfs 192.168.10.3:/data/cloudstack/primary /mnt\ndf -h    #\u67e5\u770b\u6709\u4e86\u4ee3\u8868\u6210\u529f\numount /mnt\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#26-vm","title":"2.6 \u4e0b\u8f7d\u7cfb\u7edfVM\u6a21\u677f","text":"<pre><code>/usr/share/cloudstack-common/scripts/storage/secondary/cloud-install-sys-tmplt -m /data/cloudstack/secondary -u http://cloudstack.apt-get.eu/systemvm/4.11/systemvmtemplate-4.11.1-kvm.qcow2.bz2 -h kvm -F\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#27-agentcloudstack","title":"2.7 \u5b89\u88c5agent\uff08cloudstack\u4e3b\u673a\uff09","text":"<p>\u5982\u679c\u90e8\u7f72\u96c6\u7fa4\uff0c\u5907\u673a\u53ea\u9700\u8981\u76f4\u63a5\u90e8\u7f72agent.</p> <pre><code>yum -y install cloudstack-agent\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#271","title":"2.7.1 \u914d\u7f6e\u6587\u4ef6\u4fee\u6539","text":"<pre><code># vi /etc/libvirt/qemu.conf  \u5e76\u53d6\u6d88\u5982\u4e0b\u884c\u7684\u6ce8\u91ca\nvnc_listen=0.0.0.0\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#272-kvm","title":"2.7.2 \u914d\u7f6eKVM","text":"<pre><code># vi /etc/libvirt/libvirtd.conf\nlisten_tls = 0\nlisten_tcp = 1\ntcp_port = \"16059\"\nauth_tcp = \"none\"\nmdns_adv = 0\n</code></pre> <pre><code># vi /etc/sysconfig/libvirtd\nLIBVIRTD_ARGS=\"--listen\"\n\nsystemctl restart libvirtd\nsystemctl enable libvirtd\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#273-agent","title":"2.7.3 \u914d\u7f6eagent","text":"<pre><code>vi /etc/cloudstack/agent/agent.properties\nhost=192.168.10.3\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#274","title":"2.7.4 \u914d\u7f6e\u7f51\u5361\uff08\u505a\u6865\u63a5\uff09","text":"<p>\u7f16\u8f91\u7b2c\u4e00\u5757\u7f51\u5361(em1)</p> <pre><code>cat &lt;&lt;EOF &gt; /etc/sysconfig/network-scripts/ifcfg-em1 \nDEVICE=em1\nTYPE=Ethernet\nHWADDR=8c:ec:4b:9a:9d:11\nBOOTPROTO=none\nONBOOT=yes\nNM_CONTROLLED=no\nBRIDGE=cloudbr0\nEOF\n</code></pre> <p>\u7f51\u5361\u6865\u63a5\uff08\u540d\u5b57\u4e5f\u53ef\u4ee5\u81ea\u5b9a\u4e49\uff0c\u8981\u548c\u91cc\u8fb9\u914d\u7f6e\u5bf9\u5e94\u4e0a\uff09</p> <pre><code>cat &lt;&lt;EOF &gt; /etc/sysconfig/network-scripts/ifcfg-cloudbr0\nTYPE=Bridge\nBOOTPROTO=static\nDEVICE=cloudbr0\nIPV6INIT=yes\nONBOOT=yes\nIPADDR=192.168.10.3\nNETMASK=255.255.255.0\nGATEWAY=192.168.10.1\nDNS1=223.5.5.5\nDNS2=223.6.6.6\nNM_CONTROLLED=no\nDELAY=0\nEOF\n</code></pre> <pre><code>[root@panda lib]# cat /etc/sysconfig/network\n# Created by anaconda\nGATEWAY=192.168.10.1\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#275-cloudstack-agent","title":"2.7.5 \u521d\u59cb\u5316cloudstack-agent","text":"<pre><code>cloudstack-setup-agent    #\u4e00\u8def\u56de\u8f66\n[root@panda ~]# cloudstack-setup-agent\nWelcome to the CloudStack Agent Setup:\nPlease input the Management Server Hostname/IP-Address:[192.168.10.3]\nPlease input the Zone Id:[default]\nPlease input the Pod Id:[default]\nPlease input the Cluster Id:[default]\nPlease input the Hypervisor type kvm/lxc:[kvm]\nPlease choose which network used to create VM:[cloudbr0]\nStarting to configure your system:\nConfigure SElinux ...         [OK]\nConfigure Network ...         [OK]\nConfigure Libvirt ...         [OK]\nConfigure Firewall ...        [OK]\nConfigure Nfs ...             [OK]\nConfigure cloudAgent ...      [OK]\nCloudStack Agent setup is done!\n</code></pre> <pre><code>systemctl restart cloudstack-agent\nsystemctl restart libvirtd\n</code></pre>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#3","title":"3 \u4e0b\u4e00\u6b65","text":"<p>\u67e5\u770b8080\u7aef\u53e3\u662f\u5426\u542f\u52a8</p> <pre><code>netstat -tunlp|grep 8080\n</code></pre> <p>\u6253\u5f00\u6d4f\u89c8\u5668\uff0c\u8fdb\u884c\u4e0b\u4e00\u6b65\u914d\u7f6e</p> <p>http://192.168.10.3:8080/client/   \u8d26\u53f7admin \u5bc6\u7801password</p>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2018-12-15-install-cloudstack-4-11-1-0-centos-7-5.html/#reference","title":"Reference","text":"<p>http://www.jackfan.top/posts/47209/</p>","tags":["cloudstack","iaas","cloudnative"]},{"location":"DevOps/2019-10-16-install-mariadb-10-4-apache2httpd-2-4-php-7-3-on-centos-7-6.html/","title":"Install MariaDB 10.4 + Apache2(httpd) 2.4 + PHP 7.3 on CentOS 7.6","text":"","tags":["MariaDB","apache2","httpd","PHP"]},{"location":"DevOps/2019-10-16-install-mariadb-10-4-apache2httpd-2-4-php-7-3-on-centos-7-6.html/#1","title":"1. \u51c6\u5907","text":"<pre><code>cat /etc/redhat-release\n# CentOS Linux release 7.6.1810 (Core)\n</code></pre>","tags":["MariaDB","apache2","httpd","PHP"]},{"location":"DevOps/2019-10-16-install-mariadb-10-4-apache2httpd-2-4-php-7-3-on-centos-7-6.html/#2-mariadb-104","title":"2. \u5b89\u88c5Mariadb 10.4","text":"<pre><code>cat | sudo tee /etc/yum.repos.d/mariadb.repo &lt;&lt;EOF\n[mariadb]\nname = MariaDB\nbaseurl = https://yum.mariadb.org/10.4/rhel7-amd64\ngpgkey=https://yum.mariadb.org/RPM-GPG-KEY-MariaDB\ngpgcheck=1\nEOF\n\nsudo yum install MariaDB-server MariaDB-client\nsudo systemctl start mariadb\nsudo systemctl enable mariadb\n\n#\u8868\u540d\u5927\u5c0f\u5199\u4e0d\u654f\u611f\nsudo sed -i 's/\\[mysqld\\]/[mysqld]\\nlower_case_table_names=1/' /etc/my.cnf\n\nsudo mysql_secure_installation\n</code></pre> <p>Create database. Let's take wordpress as an example:</p> <pre><code>$ mysql -u root -p\nMariaDB [(none)]&gt; CREATE DATABASE `wordpress` DEFAULT CHARACTER SET utf8 COLLATE utf8_bin;\n\nMariaDB [(none)]&gt; grant all on wordpress.* to wp@'localhost' identified by 'changeMe';\n</code></pre>","tags":["MariaDB","apache2","httpd","PHP"]},{"location":"DevOps/2019-10-16-install-mariadb-10-4-apache2httpd-2-4-php-7-3-on-centos-7-6.html/#3-apache2","title":"3. \u5b89\u88c5Apache2","text":"<pre><code>sudo yum install httpd\nsudo systemctl enable httpd\nsudo systemctl start httpd\n\nsudo firewall-cmd --permanent --add-port=80/tcp\nsudo firewall-cmd --permanent --add-port=443/tcp\nsudo firewall-cmd --reload\nsudo firewall-cmd --list-all\n\nsudo chown -R apache:apache /var/www/html\n# ls -Z /var/www/html/\nsudo chcon -R  -t  httpd_sys_rw_content_t /var/www/html/\n\n# For reverse proxy\nsudo setsebool -P httpd_can_network_connect on\n</code></pre>","tags":["MariaDB","apache2","httpd","PHP"]},{"location":"DevOps/2019-10-16-install-mariadb-10-4-apache2httpd-2-4-php-7-3-on-centos-7-6.html/#4-php-73","title":"4. \u5b89\u88c5php 7.3","text":"","tags":["MariaDB","apache2","httpd","PHP"]},{"location":"DevOps/2019-10-16-install-mariadb-10-4-apache2httpd-2-4-php-7-3-on-centos-7-6.html/#41-php","title":"4.1 \u5b89\u88c5php","text":"<pre><code>sudo yum remove php*\n\nsudo yum -y install https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\nsudo yum -y install http://rpms.remirepo.net/enterprise/remi-release-7.rpm\nsudo yum -y install yum-utils\nsudo yum-config-manager --enable remi-php73\n\nsudo yum --enablerepo remi,epel install php php-mysql php-gd php-imagick php-bcmath\n\nphp -v\n</code></pre>","tags":["MariaDB","apache2","httpd","PHP"]},{"location":"DevOps/2019-10-16-install-mariadb-10-4-apache2httpd-2-4-php-7-3-on-centos-7-6.html/#42-httpd-php","title":"4.2 httpd \u652f\u6301 php","text":"<p>sudo vi /etc/httpd/conf/httpd.conf <pre><code>......\nServerName your_domain:80\n\n......\n&lt;Directory /&gt;\n    AllowOverride none\n    #Require all denied\n    Require all granted\n&lt;/Directory&gt;\n\n......\n&lt;IfModule dir_module&gt;\n    DirectoryIndex index.html index.php\n&lt;/IfModule&gt;\nAddType application/x-httpd-php .php\n\n.......\n&lt;Directory /var/www/html&gt;\n    ......\n    AllowOverride All\n.......\n</code></pre></p> <p>\u68c0\u67e5httpd.conf\u8bed\u6cd5 &amp; \u91cd\u65b0\u52a0\u8f7d <pre><code>apachectl -t  &amp;&amp; sudo apachectl graceful\n</code></pre></p>","tags":["MariaDB","apache2","httpd","PHP"]},{"location":"DevOps/2019-10-16-install-mariadb-10-4-apache2httpd-2-4-php-7-3-on-centos-7-6.html/#43","title":"4.3 \u6d4b\u8bd5\u9875\u9762","text":"<pre><code>echo -e '&lt;?php\\necho \"Hello, PHP.\"\\n?&gt;' | sudo tee /var/www/html/1.php\n</code></pre>","tags":["MariaDB","apache2","httpd","PHP"]},{"location":"DevOps/2019-10-16-install-mariadb-10-4-apache2httpd-2-4-php-7-3-on-centos-7-6.html/#reference","title":"Reference","text":"<ul> <li>https://tecadmin.net/install-mariadb-10-centos-redhat/</li> <li>centos\u5b89\u88c5php https://my.oschina.net/codercpf/blog/1825069</li> <li>httpd\u652f\u6301php https://blog.51cto.com/shuzonglu/2074448</li> <li>selinux contexts https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/selinux_users_and_administrators_guide/sect-security-enhanced_linux-working_with_selinux-selinux_contexts_labeling_files</li> </ul>","tags":["MariaDB","apache2","httpd","PHP"]},{"location":"DevOps/2021-08-24-install-haproxy-1.8-keepalived-on-centos7/","title":"Install Haproxy v1.8 and Keepalived on CentOS 7","text":"","tags":["Haproxy","Keepalived","centos"]},{"location":"DevOps/2021-08-24-install-haproxy-1.8-keepalived-on-centos7/#1-preparation","title":"1. Preparation","text":"","tags":["Haproxy","Keepalived","centos"]},{"location":"DevOps/2021-08-24-install-haproxy-1.8-keepalived-on-centos7/#11-kvms","title":"1.1 KVMs","text":"<p>2 KVMs</p> Hostname vCPUs Memory Swap IP OS sudoer slb01.k8s 2 2G 0 192.168.10.201 CentOS 7 echo slb02.k8s 2 2G 0 192.168.10.202 CentOS 7 echo cluster.k8s - - - 192.168.10.200 - - <p>NOTE: 192.168.10.200 is a virtual (HA) IP which points to slb01 or slb02.</p>","tags":["Haproxy","Keepalived","centos"]},{"location":"DevOps/2021-08-24-install-haproxy-1.8-keepalived-on-centos7/#12-install-ansible-on-host-machine","title":"1.2 Install Ansible on Host machine","text":"<pre><code># Install ansible on host machine\nsudo yum install ansible\n</code></pre>","tags":["Haproxy","Keepalived","centos"]},{"location":"DevOps/2021-08-24-install-haproxy-1.8-keepalived-on-centos7/#13-password-free-configuration","title":"1.3 Password free Configuration","text":"<pre><code>cat &lt;&lt;EOF | sudo tee -a /etc/ansible/hosts\n[slb]\nslb01.k8s\nslb02.k8s\nEOF\n\n# Have a test \nansible slb --ask-pass -u echo -m shell -a 'echo ok'\n\n# Password free for login\nansible slb --ask-pass -u echo -m file -a \"path=.ssh state=directory mode=700\"\nansible slb --ask-pass -u echo -m copy -a \"src=~/.ssh/id_rsa.pub dest=.ssh/authorized_keys mode=600\"\n\n# Password free for sudo\nansible slb --ask-pass -u echo -b -m shell -a \"echo 'echo ALL=(ALL) NOPASSWD: ALL' &gt;&gt; /etc/sudoers\"\n\n# Now we can have a test as below\nansible slb -u echo -m shell -a 'echo ok'\n</code></pre>","tags":["Haproxy","Keepalived","centos"]},{"location":"DevOps/2021-08-24-install-haproxy-1.8-keepalived-on-centos7/#14-dns-via-hosts-file","title":"1.4 DNS via hosts file","text":"<pre><code>cat &lt;&lt;EOF &gt; /tmp/add-hosts.sh\ncat &lt;&lt;EEE &gt;&gt; /etc/hosts \n192.168.10.201 slb01.k8s\n192.168.10.202 slb02.k8s\n\n# A virtual IP which points slb01 or slb02\n192.168.10.200 cluster.k8s\nEEE\nEOF\n\nansible k8s -u echo -b -m script -a \"/tmp/add-hosts.sh\"\n</code></pre>","tags":["Haproxy","Keepalived","centos"]},{"location":"DevOps/2021-08-24-install-haproxy-1.8-keepalived-on-centos7/#2-basic-configurations-for-servers","title":"2. Basic Configurations for servers","text":"","tags":["Haproxy","Keepalived","centos"]},{"location":"DevOps/2021-08-24-install-haproxy-1.8-keepalived-on-centos7/#21-required-ports-firewall-configuration","title":"2.1 Required ports (Firewall Configuration)","text":"<pre><code>ansible slb -u echo -b -m shell -a \"firewall-cmd --permanent --add-port=80/tcp --add-port=443/tcp --add-port=8081/tcp\"\nansible slb -u echo -b -m shell -a \"firewall-cmd --reload\"\n</code></pre>","tags":["Haproxy","Keepalived","centos"]},{"location":"DevOps/2021-08-24-install-haproxy-1.8-keepalived-on-centos7/#22-set-selinux-in-permissive-mode-effectively-disabling-it","title":"2.2 Set SELinux in permissive mode (effectively disabling it)","text":"<pre><code>cat &lt;&lt;EOF &gt; /tmp/set-selinux.sh\nsudo setenforce 0\nsudo sed -i 's/^SELINUX=enforcing$/SELINUX=permissive/' /etc/selinux/config\nEOF\n\nansible slb -u echo -b -m script -a '/tmp/set-selinux.sh'\n</code></pre>","tags":["Haproxy","Keepalived","centos"]},{"location":"DevOps/2021-08-24-install-haproxy-1.8-keepalived-on-centos7/#3-install-haproxy-keepalived-on-slb-servers","title":"3. Install HAProxy + Keepalived on SLB servers","text":"","tags":["Haproxy","Keepalived","centos"]},{"location":"DevOps/2021-08-24-install-haproxy-1.8-keepalived-on-centos7/#31-install-haproxy","title":"3.1 Install HAProxy","text":"<pre><code>cat &lt;&lt;EOF &gt; /tmp/install-haproxy.sh\nsudo yum install centos-release-scl -y\nsudo yum install rh-haproxy18 -y\nsudo scl enable rh-haproxy18 bash -y\nsudo systemctl enable rh-haproxy18-haproxy\nsudo systemctl start rh-haproxy18-haproxy\nEOF\n\nansible slb -u echo -b -m script -a \"/tmp/install-haproxy.sh\"\n</code></pre>","tags":["Haproxy","Keepalived","centos"]},{"location":"DevOps/2021-08-24-install-haproxy-1.8-keepalived-on-centos7/#32-install-keepalived","title":"3.2 Install Keepalived","text":"<pre><code>ansible slb -u echo -b -m shell -a \"yum install -y keepalived\"\n</code></pre>","tags":["Haproxy","Keepalived","centos"]},{"location":"DevOps/2021-08-24-install-haproxy-1.8-keepalived-on-centos7/#4-configuraton-example","title":"4. Configuraton Example","text":"","tags":["Haproxy","Keepalived","centos"]},{"location":"DevOps/2021-08-24-install-haproxy-1.8-keepalived-on-centos7/#41-self-signed-cert","title":"4.1 Self-signed Cert","text":"<pre><code># e.g.\nopenssl req -newkey rsa:2048 -nodes -sha256 -keyout example.key \\\n  -x509 -days 3650 -out example.crt \\\n  -subj \"/CN=example.com\"\ncat example.crt example.key &gt; example.pem\n</code></pre>","tags":["Haproxy","Keepalived","centos"]},{"location":"DevOps/2021-08-24-install-haproxy-1.8-keepalived-on-centos7/#42-example-of-haproxycfg","title":"4.2 Example of haproxy.cfg","text":"<p>/etc/opt/rh/rh-haproxy18/haproxy/haproxy.cfg</p> <pre><code>cat &lt;&lt;EOF &gt; /tmp/haproxy.cfg\n#---------------------------------------------------------------------\n# Example configuration for a possible web application.  See the\n# full configuration options online.\n#\n#   http://haproxy.1wt.eu/download/1.8/doc/configuration.txt\n#\n#---------------------------------------------------------------------\n\n#---------------------------------------------------------------------\n# Global settings\n#---------------------------------------------------------------------\nglobal\n    # to have these messages end up in /var/opt/rh/rh-haproxy18/log/haproxy.log you will\n    # need to:\n    #\n    # 1) configure syslog to accept network log events.  This is done\n    #    by adding the '-r' option to the SYSLOGD_OPTIONS in\n    #    /etc/sysconfig/syslog\n    #\n    # 2) configure local2 events to go to the /var/opt/rh/rh-haproxy18/log/haproxy.log\n    #   file. A line like the following can be added to\n    #   /etc/sysconfig/syslog\n    #\n    #    local2.*                       /var/opt/rh/rh-haproxy18/log/haproxy.log\n    #\n    log         127.0.0.1 local2\n\n    chroot      /var/opt/rh/rh-haproxy18/lib/haproxy\n    pidfile     /var/run/rh-haproxy18-haproxy.pid\n    maxconn     4000\n    user        haproxy\n    group       haproxy\n    daemon\n\n    # turn on stats unix socket\n    stats socket /var/opt/rh/rh-haproxy18/lib/haproxy/stats\n\n    # utilize system-wide crypto-policies\n    #ssl-default-bind-ciphers PROFILE=SYSTEM\n    #ssl-default-server-ciphers PROFILE=SYSTEM\n\n#---------------------------------------------------------------------\n# common defaults that all the 'listen' and 'backend' sections will\n# use if not designated in their block\n#---------------------------------------------------------------------\ndefaults\n    mode                    http\n    log                     global\n    #option                  httplog\n    option                  dontlognull\n    option http-server-close\n    #option forwardfor       except 127.0.0.0/8\n    option                  redispatch\n    retries                 3\n    timeout http-request    10s\n    timeout queue           1m\n    timeout connect         10s\n    timeout client          1m\n    timeout server          1m\n    timeout http-keep-alive 10s\n    timeout check           10s\n    maxconn                 3000\n\n#---------------------------------------------------------------------\n# main frontend which proxys to the backends\n#---------------------------------------------------------------------\nfrontend main\n    #bind *:80\n    bind *:443 ssl crt /etc/ssl/certs/example.pem \n    acl url_static       path_beg       -i /static /images /javascript /stylesheets\n    acl url_static       path_end       -i .jpg .gif .png .css .js\n\n    #use_backend static          if url_static\n    default_backend            static\n\n    #acl root_path path_reg ^/$\n\n#---------------------------------------------------------------------\n# static backend for serving up images, stylesheets and such\n#---------------------------------------------------------------------\nbackend static\n    balance     roundrobin\n    server      static 127.0.0.1:4331 check\n\n#---------------------------------------------------------------------\n# round robin balancing between the various backends\n#---------------------------------------------------------------------\n# listen k8sapi\n    # bind *:6443\n    # mode tcp\n    # balance roundrobin\n    # option  tcp-check\n    # server  master01 master01.k8s:6443 check\n    # server  master02 master02.k8s:6443 check\n    # server  master03 master03.k8s:6443 check\n\n#---------------------------------------------------------------------\n# HAProxy Monitoring Config\n#---------------------------------------------------------------------\nlisten monitoring\n    bind *:8081                #Haproxy Monitoring run on port 8081    \n    mode http\n    option forwardfor\n    option httpclose\n    stats enable\n    stats show-legends\n    stats refresh 5s\n    stats uri /stats           #URL for HAProxy monitoring\n    #stats realm Haproxy Statistics\n    stats auth howtoforge:howtoforge        \n    stats admin if TRUE\nEOF\n\nansible slb -u echo -b -m copy -a \\\n \"src=/tmp/haproxy.cfg \n  dest=/etc/opt/rh/rh-haproxy18/haproxy/haproxy.cfg \n  mode=600 owner=haproxy group=haproxy\"\n\nansible slb -u echo -b -m copy -a \\\n \"src=example.pem \n  dest=/etc/ssl/certs/example.pem\n  mode=600 owner=haproxy group=haproxy\"\n\nansible slb -u echo -b -m shell -a \"systemctl restart rh-haproxy18-haproxy\"\n</code></pre>","tags":["Haproxy","Keepalived","centos"]},{"location":"DevOps/2021-08-24-install-haproxy-1.8-keepalived-on-centos7/#43-example-of-keepalivedconf","title":"4.3 Example of keepalived.conf","text":"<p>/etc/keepalived/keepalived.conf</p> <pre><code>cat &lt;&lt;EOF&gt; /tmp/keepalived.conf\nglobal_defs {\n   notification_email {\n     admin@example.k8s\n   }\n   notification_email_from noreply1@example.k8s\n   smtp_server localhost\n   smtp_connect_timeout 30\n}\n\nvrrp_script chk_haproxy {\n  script \"pkill -0 haproxy\" # check the haproxy process\n  interval 2 # every 2 seconds\n  weight 2 # add 2 points if OK\n}\n\nvrrp_instance VI_1 {\n  interface eth0 # interface to monitor\n  state MASTER # MASTER on slb01, BACKUP on slb02\n  virtual_router_id 51\n  priority 100 # 100 on slb01, 99 on slb02\n\n  #IP Address of local machine. \n  #NOTE: this is mandatory if multicast is forbidden in your network  \n  unicast_src_ip 192.168.122.201\n  unicast_peer {\n    #IP Address of other machine(s). \n    #NOTE1: this is mandatory if multicast is forbidden in your network. \n    #NOTE2: multiple values can be issued here\n    192.168.122.202\n  }\n\n  authentication {\n    auth_type PASS\n    auth_pass 1849\n  }\n  virtual_ipaddress {\n    192.168.10.200/24 # virtual ip address\n  }\n  track_script {\n    chk_haproxy\n  }\n}\nEOF\n\n\nansible slb -u echo -b -m copy -a \\\n \"src=/tmp/keepalived.conf \n  dest=/etc/keepalived/keepalived.conf\n  mode=644\"\n</code></pre> <p>Edit keepalived.conf on slb02.k8s</p> <pre><code># On slb02.k8s:\n#   state BACKUP \n#   priority 99\n#   unicast_src_ip 192.168.122.202\n#   unicast_peer {\n#     192.168.122.201 \n#   }\nvi /etc/keepalived/keepalived.conf\n</code></pre> <p>Enable &amp; Restart keepalived</p> <pre><code>ansible echoyun-slb -u echo -b -m shell -a \"systemctl enable keepalived\"\nansible echoyun-slb -u echo -b -m shell -a \"systemctl restart keepalived\"\n</code></pre>","tags":["Haproxy","Keepalived","centos"]},{"location":"DevOps/2021-08-24-install-haproxy-1.8-keepalived-on-centos7/#5-access-haproxy-stats-page","title":"5. Access HAProxy stats page","text":"<p>Now we can open HAProxy stats page in Browser</p> <pre><code># auth: howtoforge:howtoforge\nhttp://cluster.k8s:8081/stats/\n</code></pre>","tags":["Haproxy","Keepalived","centos"]},{"location":"DevOps/2021-08-24-install-haproxy-1.8-keepalived-on-centos7/#reference","title":"Reference","text":"<ul> <li>ansible/2.9/modules/list_of_commands_modules.html</li> <li>ansible/2.9/modules/copy_module.html</li> <li>lists.centos.org/pipermail/centos-announce/2018-June/022915.html</li> <li>thingsboard.io/docs/user-guide/install/pe/add-haproxy-rhel</li> <li>howtoforge.com/tutorial/how-to-setup-haproxy-as-load-balancer-for-nginx-on-centos-7</li> <li>red_hat_enterprise_linux/7/html/load_balancer_administration/keepalived_install_example1</li> <li>red_hat_enterprise_linux/7/html/load_balancer_administration/ch-initial-setup-VSA</li> <li>KeepAlived configuration for automatic switch of virtual IP</li> </ul>","tags":["Haproxy","Keepalived","centos"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/","title":"Install Kubernetes (k8s) v1.22 Highly Available Clusters on CentOS 7","text":"","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#1-preparation","title":"1. Preparation","text":"","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#11-kvms","title":"1.1 KVMs","text":"<p>8 KVMs</p> Hostname vCPUs Memory Swap IP OS sudoer master01.k8s 2 2G 0 192.168.10.191 CentOS 7 echo master02.k8s 2 2G 0 192.168.10.192 CentOS 7 echo master03.k8s 2 2G 0 192.168.10.193 CentOS 7 echo minion01.k8s 2 8G 0 192.168.10.101 CentOS 7 echo minion02.k8s 2 8G 0 192.168.10.102 CentOS 7 echo minion03.k8s 2 8G 0 192.168.10.103 CentOS 7 echo slb01.k8s 2 2G 0 192.168.10.201 CentOS 7 echo slb02.k8s 2 2G 0 192.168.10.202 CentOS 7 echo cluster.k8s - - - 192.168.10.200 - - <p>NOTE: 192.168.10.200 is a virtual (HA) IP which points to slb01 or slb02.</p>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#12-install-ansible-on-host-machine","title":"1.2 Install Ansible on Host machine","text":"<pre><code># Install ansible on host machine\nsudo yum install ansible\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#13-password-free-configuration","title":"1.3 Password free configuration","text":"<pre><code>cat &lt;&lt;EOF | sudo tee -a /etc/ansible/hosts\n[k8s]\nmaster01.k8s\nmaster02.k8s\nmaster03.k8s\nminion01.k8s\nminion02.k8s\nminion03.k8s\n\n[k8s-master]\nmaster01.k8s\nmaster02.k8s\nmaster03.k8s\n\n[k8s-minion]\nminion01.k8s\nminion02.k8s\nminion03.k8s\nEOF\n\n# Have a test \nansible k8s --ask-pass -u echo -m shell -a 'echo ok'\n\n# Password free for login\nansible k8s --ask-pass -u echo -m file -a \"path=.ssh state=directory mode=700\"\nansible k8s --ask-pass -u echo -m copy -a \"src=~/.ssh/id_rsa.pub dest=.ssh/authorized_keys mode=600\"\n\n# Password free for sudo\nansible k8s --ask-pass -u echo -b -m shell -a \"echo 'echo ALL=(ALL) NOPASSWD: ALL' &gt;&gt; /etc/sudoers\"\n\n# Now we can have a test as below\nansible k8s -u echo -m shell -a 'echo ok'\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#14-dns-via-hosts-file","title":"1.4 DNS via hosts file","text":"<pre><code>cat &lt;&lt;EOF &gt; /tmp/add-hosts.sh\ncat &lt;&lt;EEE &gt;&gt; /etc/hosts \n192.168.10.191 master01.k8s\n192.168.10.192 master02.k8s\n192.168.10.193 master03.k8s\n\n192.168.10.101 minion01.k8s\n192.168.10.102 minion02.k8s\n192.168.10.103 minion03.k8s\n\n192.168.10.201 slb01.k8s\n192.168.10.202 slb02.k8s\n\n# A virtual IP which points slb01 or slb02\n192.168.10.200 cluster.k8s\nEEE\nEOF\n\nansible k8s -u echo -b -m script -a \"/tmp/add-hosts.sh\"\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#2-basic-configurations-for-servers","title":"2. Basic configurations for servers","text":"","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#21-firewall-configuration-required-ports","title":"2.1 Firewall configuration (required ports)","text":"<p>NOTE: <code>eth0</code>, <code>192.168.10.0/24</code> may be changed according to your own environment.</p> <pre><code>cat &lt;&lt;EOF &gt; /tmp/required-ports.sh\n# Possible other interfaces instead of eth0\nfirewall-cmd --permanent --zone=trusted --add-interface=eth0\n# Your internal network\nfirewall-cmd --permanent --zone=trusted --add-source=192.168.10.0/24\n# Flannel\nfirewall-cmd --permanent --zone=trusted --add-interface=flannel.1\n# POD cidr\nfirewall-cmd --permanent --zone=trusted --add-source=10.244.0.0/16\n# Service cidr\nfirewall-cmd --permanent --zone=trusted --add-source=10.96.0.0/16\n\nfirewall-cmd --permanent --add-port=6443/tcp\nfirewall-cmd --permanent --add-port=2379-2380/tcp\nfirewall-cmd --permanent --add-port=10250-10252/tcp\nfirewall-cmd --permanent --add-port=30000-32767/tcp\nfirewall-cmd --reload\nEOF\n\nansible k8s -u echo -b -m script -a '/tmp/required-ports.sh'\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#22-set-selinux-in-permissive-mode-effectively-disabling-it","title":"2.2 Set SELinux in permissive mode (effectively disabling it)","text":"<pre><code>cat &lt;&lt;EOF &gt; /tmp/set-selinux.sh\nsudo setenforce 0\nsudo sed -i 's/^SELINUX=enforcing$/SELINUX=permissive/' /etc/selinux/config\nEOF\n\nansible k8s -u echo -b -m script -a '/tmp/set-selinux.sh\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#23-disable-swap","title":"2.3 Disable swap","text":"<p>You MUST disable swap in order for the kubelet to work properly.</p> <pre><code>ansible k8s -u echo -b -m shell -a 'swapoff -a'\nansible k8s -u echo -b -m shell -a 'sed -i -e \"s:/dev/mapper/centos-swap:#/dev/mapper/centos-swap:\" /etc/fstab'\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#24-verify-the-mac-address-and-product_uuid-are-unique-for-every-node","title":"2.4 Verify the MAC address and product_uuid are unique for every node","text":"<pre><code>ansible k8s -u echo -m shell -a '/usr/sbin/ip link | grep link/ether'\n\nansible k8s -u echo -b -m shell -a 'cat /sys/class/dmi/id/product_uuid'\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#25-letting-iptables-see-bridged-traffic","title":"2.5 Letting iptables see bridged traffic","text":"<pre><code># Make sure that the br_netfilter module is loaded\nansible k8s -u echo -m shell -a '/usr/sbin/lsmod | grep br_netfilter'\n\n# To load it explicitly\nansible k8s -u echo -b -m shell -a 'modprobe br_netfilter'\n\n# Ensure net.bridge.bridge-nf-call-iptables is set to 1 in your sysctl config\ncat &lt;&lt;EEE &gt; /tmp/ensure-bridge-nf.sh\ncat &lt;&lt;EOF | sudo tee /etc/modules-load.d/k8s.conf\nbr_netfilter\nEOF\n\ncat &lt;&lt;EOF | sudo tee /etc/sysctl.d/k8s.conf\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.bridge.bridge-nf-call-iptables = 1\nEOF\nsudo sysctl --system\nEEE\n\nansible k8s -u echo -b -m script -a '/tmp/ensure-bridge-nf.sh'\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#26-sysctl-for-kvm","title":"2.6 Sysctl for KVM","text":"<pre><code>cat &lt;&lt;EEE &gt; /tmp/set-sysctl.sh\ncat &lt;&lt;EOF | sudo tee /etc/sysctl.d/kvm.conf\nnet.ipv4.conf.default.rp_filter=0\nnet.ipv4.conf.all.rp_filter=0\nnet.ipv4.conf.all.proxy_arp = 1\nEOF\nsudo sysctl --system\nEEE\n\nansible k8s -u echo -b -m script -a '/tmp/set-sysctl.sh'\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#3-install-docker-ce-as-the-container-runtime","title":"3. Install docker-ce as the container runtime","text":"","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#31-install-container-selinux","title":"3.1 Install container-selinux","text":"<pre><code>ansible k8s -u echo -m shell -a \\\n'sudo yum --enablerepo=extras install -y container-selinux'\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#32-check-docker-ce-version","title":"3.2 Check docker-ce version","text":"<pre><code>yum --showduplicates list docker-ce\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#33-install-docker-ce","title":"3.3 Install docker-ce","text":"<p>NOTE: Use your mirror of dockerhub</p> <pre><code>cat &lt;&lt;EEE &gt; /tmp/install-docker.sh\n# Install Docker CE 18.06 from Docker's CentOS repositories:\n\n## Install prerequisites.\nyum -y install yum-utils device-mapper-persistent-data lvm2\n\n## Add docker repository.\nyum-config-manager \\\n    --add-repo \\\n    https://download.docker.com/linux/centos/docker-ce.repo\n\n## Install docker.\nyum -y install docker-ce-18.06.1.ce-3.el7\nsystemctl enable docker\n\n# Setup daemon.\nmkdir -p /etc/docker/\ncat &gt; /etc/docker/daemon.json &lt;&lt;EOF\n{\n  # NOTE: Use your mirror of dockerhub\n  \"registry-mirrors\": [\"https://z7sy3gme.mirror.aliyuncs.com\"],\n  \"exec-opts\": [\"native.cgroupdriver=systemd\"],\n  \"log-driver\": \"json-file\",\n  \"log-opts\": {\n    \"max-size\": \"100m\"\n  },\n  \"storage-driver\": \"overlay2\",\n  \"storage-opts\": [\n    \"overlay2.override_kernel_check=true\"\n  ]\n}\nEOF\n\nmkdir -p /etc/systemd/system/docker.service.d\n\n# Restart docker.\nsystemctl daemon-reload\nsystemctl restart docker\nEEE\n\nansible k8s -u echo -b -m script -a '/tmp/install-docker.sh'\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#4-install-haproxy-keepalived-as-the-load-balancer","title":"4. Install HAProxy + Keepalived as the Load Balancer","text":"<p>See Install Haproxy v1.8 and Keepalived on CentOS 7 for the installation.</p> <p>Config HAProxy, add a listen for k8sapi</p> <pre><code>cat &lt;&lt; EEE &gt; /tmp/k8sapi-proxy.sh\ncat &lt;&lt; EOF | sudo tee -a /etc/opt/rh/rh-haproxy18/haproxy/haproxy.cfg\n\nlisten k8sapi\n    bind *:6443\n    mode tcp\n    balance roundrobin\n    option  tcp-check\n    server  master01 master01.k8s:6443 check\n    server  master02 master02.k8s:6443 check\n    server  master03 master03.k8s:6443 check\nEOF\nEEE\n\nansible slb -u echo -b -m script -a '/tmp/k8sapi-proxy.sh'\n</code></pre> <p>Restart HAProxy</p> <pre><code>ansible slb -u echo -b -m shell -a \"systemctl restart rh-haproxy18-haproxy\"\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#5-install-kubeadm-kubelet-and-kubectl","title":"5. Install kubeadm, kubelet and kubectl","text":"<p>NOTE: Use your own <code>baseurl</code> and <code>gpgkey</code></p> <pre><code>cat &lt;&lt;EEE &gt; /tmp/install-kubeadm.sh \ncat &lt;&lt;EOF | sudo tee /etc/yum.repos.d/kubernetes.repo\n[kubernetes]\nname=Kubernetes\nbaseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64\nenabled=1\ngpgcheck=1\nrepo_gpgcheck=1\ngpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg\n\nexclude=kubelet kubeadm kubectl\nEOF\n\nyum install -y kubelet kubeadm kubectl --disableexcludes=kubernetes\nsystemctl enable --now kubelet\nEEE\n\nansible k8s -u echo -b -m script -a '/tmp/install-kubeadm.sh'\n</code></pre> <p>Check kubeadm version</p> <pre><code>ansible k8s -u echo -m shell -a 'kubeadm version | awk -F, \"{print \\$3}\"' \n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#6-creating-ha-clusters-with-kubeadm","title":"6. Creating HA clusters with kubeadm","text":"<p>Ping cluster.k8s</p> <pre><code>ping cluster.k8s -c 5\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#61-init-cluster-on-master01k8s","title":"6.1 Init cluster on master01.k8s","text":"<p>For flannel pod network (see 6.3),  the argument <code>--pod-network-cidr=10.244.0.0/16</code> should be provided.</p> <pre><code>sudo kubeadm init --control-plane-endpoint \"cluster.k8s:6443\" --upload-certs --pod-network-cidr=10.244.0.0/16\n</code></pre> <p>Output:</p> <pre><code>[init] Using Kubernetes version: v1.22.1\n......\n\nYour Kubernetes control-plane has initialized successfully!\n\nTo start using your cluster, you need to run the following as a regular user:\n\n  mkdir -p $HOME/.kube\n  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\n  sudo chown $(id -u):$(id -g) $HOME/.kube/config\n\nAlternatively, if you are the root user, you can run:\n\n  export KUBECONFIG=/etc/kubernetes/admin.conf\n\nYou should now deploy a pod network to the cluster.\nRun \"kubectl apply -f [podnetwork].yaml\" with one of the options listed at:\n  https://kubernetes.io/docs/concepts/cluster-administration/addons/\n\nYou can now join any number of the control-plane node running the following command on each as root:\n\n  kubeadm join cluster.k8s:6443 --token aswx9l.y6nmyeh3u3urvmgt \\\n    --discovery-token-ca-cert-hash sha256:246676b26c3215a836ea4b55d61437edd62cc7a3a6fceca8c4cb40070fad9d88 \\\n    --control-plane --certificate-key 5f6b55ca0aef4b76322dec1076313e0cb0ba19e1c3f1254cf68af3d3c8fabad6\n\nPlease note that the certificate-key gives access to cluster sensitive data, keep it secret!\nAs a safeguard, uploaded-certs will be deleted in two hours; If necessary, you can use\n\"kubeadm init phase upload-certs --upload-certs\" to reload certs afterward.\n\nThen you can join any number of worker nodes by running the following on each as root:\n\nkubeadm join cluster.k8s:6443 --token aswx9l.y6nmyeh3u3urvmgt \\\n    --discovery-token-ca-cert-hash sha256:246676b26c3215a836ea4b55d61437edd62cc7a3a6fceca8c4cb40070fad9d88 \n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#62-create-homekubeconfig-on-master01k8s","title":"6.2 Create <code>$HOME/.kube/config</code> on master01.k8s","text":"<pre><code>  mkdir -p $HOME/.kube\n  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\n  sudo chown $(id -u):$(id -g) $HOME/.kube/config\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#63-deploy-a-pod-network-flannel-to-the-cluster","title":"6.3 Deploy a pod network (flannel) to the cluster","text":"<p>On master01.k8s</p> <pre><code>kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#64-join-the-control-plane-node","title":"6.4 Join the control-plane node","text":"<p>On master02.k8s, master03.k8s</p> <pre><code># e.g.\nsudo kubeadm join cluster.k8s:6443 --token aswx9l.y6nmyeh3u3urvmgt \\\n--discovery-token-ca-cert-hash sha256:246676b26c3215a836ea4b55d61437edd62cc7a3a6fceca8c4cb40070fad9d88 \\\n--control-plane --certificate-key 5f6b55ca0aef4b76322dec1076313e0cb0ba19e1c3f1254cf68af3d3c8fabad6\n</code></pre> <p>Output:</p> <pre><code>[preflight] Running pre-flight checks\n[preflight] Reading configuration from the cluster...\n[preflight] FYI: You can look at this config file with 'kubectl -n kube-system get cm kubeadm-config -o yaml'\n......\nThis node has joined the cluster and a new control plane instance was created:\n\n* Certificate signing request was sent to apiserver and approval was received.\n* The Kubelet was informed of the new secure connection details.\n* Control plane (master) label and taint were applied to the new node.\n* The Kubernetes control plane instances scaled up.\n* A new etcd member was added to the local/stacked etcd cluster.\n\nTo start administering your cluster from this node, you need to run the following as a regular user:\n\n    mkdir -p $HOME/.kube\n    sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\n    sudo chown $(id -u):$(id -g) $HOME/.kube/config\n\nRun 'kubectl get nodes' to see this node join the cluster.\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#65-join-worker-nodes","title":"6.5 Join worker nodes","text":"<p>On minion01.k8s, minion02.k8s, minion03.k8s</p> <pre><code># e.g.\nsudo kubeadm join cluster.k8s:6443 --token aswx9l.y6nmyeh3u3urvmgt \\\n    --discovery-token-ca-cert-hash sha256:246676b26c3215a836ea4b55d61437edd62cc7a3a6fceca8c4cb40070fad9d88 \n</code></pre> <p>Output:</p> <pre><code>[preflight] Running pre-flight checks\n[preflight] Reading configuration from the cluster...\n[preflight] FYI: You can look at this config file with 'kubectl -n kube-system get cm kubeadm-config -o yaml'\n[kubelet-start] Writing kubelet configuration to file \"/var/lib/kubelet/config.yaml\"\n[kubelet-start] Writing kubelet environment file with flags to file \"/var/lib/kubelet/kubeadm-flags.env\"\n[kubelet-start] Starting the kubelet\n[kubelet-start] Waiting for the kubelet to perform the TLS Bootstrap...\n\nThis node has joined the cluster:\n* Certificate signing request was sent to apiserver and a response was received.\n* The Kubelet was informed of the new secure connection details.\n\nRun 'kubectl get nodes' on the control-plane to see this node join the cluster.\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#66-check-the-cluster","title":"6.6 Check the cluster","text":"<p>On master01.k8s. Check the nodes</p> <pre><code>kubectl get nodes\n</code></pre> <p>Output:</p> <pre><code>NAME           STATUS   ROLES                  AGE     VERSION\nmaster01.k8s   Ready    control-plane,master   3h52m   v1.22.1\nmaster02.k8s   Ready    control-plane,master   28m     v1.22.1\nmaster03.k8s   Ready    control-plane,master   4m35s   v1.22.1\nminion01.k8s   Ready    &lt;none&gt;                 39s     v1.22.1\nminion02.k8s   Ready    &lt;none&gt;                 75s     v1.22.1\nminion03.k8s   Ready    &lt;none&gt;                 2m51s   v1.22.1\n</code></pre> <p>Check the pods</p> <pre><code>kubectl get pod --all-namespaces\n</code></pre> <p>Output:</p> <pre><code>NAMESPACE     NAME                                   READY   STATUS    RESTARTS        AGE\nkube-system   coredns-78fcd69978-79fxq               1/1     Running   0               33m\nkube-system   coredns-78fcd69978-x65cm               1/1     Running   0               33m\nkube-system   etcd-master01.k8s                      1/1     Running   2               33m\nkube-system   etcd-master02.k8s                      1/1     Running   7               30m\nkube-system   etcd-master03.k8s                      1/1     Running   0               6m24s\nkube-system   kube-apiserver-master01.k8s            1/1     Running   3               33m\nkube-system   kube-apiserver-master02.k8s            1/1     Running   7               30m\nkube-system   kube-apiserver-master03.k8s            1/1     Running   3               30m\nkube-system   kube-controller-manager-master01.k8s   1/1     Running   1 (7m19s ago)   33m\nkube-system   kube-controller-manager-master02.k8s   1/1     Running   1               30m\nkube-system   kube-controller-manager-master03.k8s   1/1     Running   1               30m\nkube-system   kube-flannel-ds-88wbk                  1/1     Running   0               4m19s\nkube-system   kube-flannel-ds-fznsw                  1/1     Running   0               4m56s\nkube-system   kube-flannel-ds-kln22                  1/1     Running   0               3m39s\nkube-system   kube-flannel-ds-n2hfp                  1/1     Running   0               18m\nkube-system   kube-flannel-ds-n2qc4                  1/1     Running   0               18m\nkube-system   kube-flannel-ds-qhh5q                  1/1     Running   0               18m\nkube-system   kube-proxy-9hdxz                       1/1     Running   1               30m\nkube-system   kube-proxy-cptvt                       1/1     Running   0               3m39s\nkube-system   kube-proxy-hw4wm                       1/1     Running   0               4m18s\nkube-system   kube-proxy-rcj7c                       1/1     Running   0               4m56s\nkube-system   kube-proxy-tbq7p                       1/1     Running   1               32m\nkube-system   kube-proxy-vmrqc                       1/1     Running   0               33m\nkube-system   kube-scheduler-master01.k8s            1/1     Running   5 (7m19s ago)   33m\nkube-system   kube-scheduler-master02.k8s            1/1     Running   3               30m\nkube-system   kube-scheduler-master03.k8s            1/1     Running   2               30m\n</code></pre> <p>Cluster Info</p> <pre><code>kubectl cluster-info\n</code></pre> <p>Output:</p> <pre><code>Kubernetes control plane is running at https://cluster.k8s:6443\nCoreDNS is running at https://cluster.k8s:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy\n\nTo further debug and diagnose cluster problems, use 'kubectl cluster-info dump'.\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-26-install-k8s-1.22-ha-clusters-on-centos7/#reference","title":"Reference","text":"<ul> <li>docs/setup/production-environment/tools/kubeadm/install-kubeadm</li> <li>docs/setup/production-environment/tools/kubeadm/high-availability</li> <li>docs/ha-considerations.md</li> <li>docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/#pod-network</li> <li>docs/concepts/cluster-administration/networking/</li> <li>github.com/flannel-io/flannel</li> <li>Pods cannot resolve DNS</li> </ul>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2021-08-28-deploy-dashboard-on-k8s-1.22/","title":"Deploy dashboard on Kubernetes (k8s) v1.22","text":"","tags":["k8s","kubernetes","dashboard","cloudnative"]},{"location":"DevOps/2021-08-28-deploy-dashboard-on-k8s-1.22/#1-install-kubectl-on-control-server","title":"1. Install kubectl on control server","text":"","tags":["k8s","kubernetes","dashboard","cloudnative"]},{"location":"DevOps/2021-08-28-deploy-dashboard-on-k8s-1.22/#11-install-kubectl","title":"1.1 Install kubectl","text":"<pre><code>cat &lt;&lt;EOF | sudo tee /etc/yum.repos.d/kubernetes.repo\n[kubernetes]\nname=Kubernetes\nbaseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64\nenabled=1\ngpgcheck=1\nrepo_gpgcheck=1\ngpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg\n\nexclude=kubelet kubeadm kubectl\nEOF\n\nyum install -y kubectl --disableexcludes=kubernetes\n</code></pre>","tags":["k8s","kubernetes","dashboard","cloudnative"]},{"location":"DevOps/2021-08-28-deploy-dashboard-on-k8s-1.22/#12-create-kubeconfig-file","title":"1.2 Create <code>~/.kube/config</code> file","text":"<pre><code>mkdir -p ~/.kube\nscp echo@master01.k8s:~/.kube/config ~/.kube/config\n</code></pre>","tags":["k8s","kubernetes","dashboard","cloudnative"]},{"location":"DevOps/2021-08-28-deploy-dashboard-on-k8s-1.22/#13-check-the-kubectl-version","title":"1.3 Check the kubectl version","text":"<pre><code>kubectl version --short\n</code></pre> <p>Output:</p> <pre><code>Client Version: v1.22.1\nServer Version: v1.22.1\n</code></pre>","tags":["k8s","kubernetes","dashboard","cloudnative"]},{"location":"DevOps/2021-08-28-deploy-dashboard-on-k8s-1.22/#2-deploy-dashborad","title":"2. Deploy dashborad","text":"","tags":["k8s","kubernetes","dashboard","cloudnative"]},{"location":"DevOps/2021-08-28-deploy-dashboard-on-k8s-1.22/#21-deploy-dashborad","title":"2.1 Deploy dashborad","text":"<pre><code>kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.3.1/aio/deploy/recommended.yaml\n</code></pre> <p>Output:</p> <pre><code>namespace/kubernetes-dashboard created\nserviceaccount/kubernetes-dashboard created\nservice/kubernetes-dashboard created\nsecret/kubernetes-dashboard-certs created\nsecret/kubernetes-dashboard-csrf created\nsecret/kubernetes-dashboard-key-holder created\nconfigmap/kubernetes-dashboard-settings created\nrole.rbac.authorization.k8s.io/kubernetes-dashboard created\nclusterrole.rbac.authorization.k8s.io/kubernetes-dashboard created\nrolebinding.rbac.authorization.k8s.io/kubernetes-dashboard created\nclusterrolebinding.rbac.authorization.k8s.io/kubernetes-dashboard created\ndeployment.apps/kubernetes-dashboard created\nservice/dashboard-metrics-scraper created\nWarning: spec.template.metadata.annotations[seccomp.security.alpha.kubernetes.io/pod]: deprecated since v1.19; use the \"seccompProfile\" field instead\ndeployment.apps/dashboard-metrics-scraper created\n</code></pre>","tags":["k8s","kubernetes","dashboard","cloudnative"]},{"location":"DevOps/2021-08-28-deploy-dashboard-on-k8s-1.22/#22-check-the-pods-services","title":"2.2 Check the pods &amp; services","text":"<pre><code>kubectl get pod -n kubernetes-dashboard; echo; kubectl get svc -n kubernetes-dashboard \n</code></pre> <p>Output:</p> <pre><code>NAME                                         READY   STATUS    RESTARTS   AGE\ndashboard-metrics-scraper-856586f554-tgrhf   1/1     Running   0          5m25s\nkubernetes-dashboard-67484c44f6-zzc8m        1/1     Running   0          5m27s\n\nNAME                        TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)    AGE\ndashboard-metrics-scraper   ClusterIP   10.108.194.211   &lt;none&gt;        8000/TCP   5m29s\nkubernetes-dashboard        ClusterIP   10.109.50.222    &lt;none&gt;        443/TCP    5m33s\n</code></pre>","tags":["k8s","kubernetes","dashboard","cloudnative"]},{"location":"DevOps/2021-08-28-deploy-dashboard-on-k8s-1.22/#3-expose-dashboard-using-nodeport","title":"3. Expose dashboard using NodePort","text":"","tags":["k8s","kubernetes","dashboard","cloudnative"]},{"location":"DevOps/2021-08-28-deploy-dashboard-on-k8s-1.22/#31-reconfigure-kubernetes-dashboard-servcie","title":"3.1 Reconfigure <code>kubernetes-dashboard</code> servcie","text":"<p>Reconfigure <code>kubernetes-dashboard</code> servcie with fixed nodePort <code>32700</code></p> <pre><code>cat &lt;&lt; EOF | kubectl apply -f -\nkind: Service\napiVersion: v1\nmetadata:\n  labels:\n    k8s-app: kubernetes-dashboard\n  name: kubernetes-dashboard\n  namespace: kubernetes-dashboard\nspec:\n  type: NodePort\n  ports:\n    - port: 443\n      targetPort: 8443\n      nodePort: 32700\n  selector:\n    k8s-app: kubernetes-dashboard\nEOF\n</code></pre> <p>Output:</p> <pre><code>service/kubernetes-dashboard configured\n</code></pre>","tags":["k8s","kubernetes","dashboard","cloudnative"]},{"location":"DevOps/2021-08-28-deploy-dashboard-on-k8s-1.22/#32-check-the-services","title":"3.2 Check the services","text":"<pre><code>kubectl get svc -n kubernetes-dashboard \n</code></pre> <p>Output:</p> <pre><code>NAME                        TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)         AGE\ndashboard-metrics-scraper   ClusterIP   10.108.194.211   &lt;none&gt;        8000/TCP        141m\nkubernetes-dashboard        NodePort    10.109.50.222    &lt;none&gt;        443:32700/TCP   141m\n</code></pre>","tags":["k8s","kubernetes","dashboard","cloudnative"]},{"location":"DevOps/2021-08-28-deploy-dashboard-on-k8s-1.22/#4-create-a-serviceaccount","title":"4. Create a ServiceAccount","text":"<p>Create a <code>root</code> service account <code>my-dashboard-sa</code> like this</p> <pre><code># Create the service account in the current namespace \n# (we assume default)\nkubectl create serviceaccount my-dashboard-sa\n# Give that service account root on the cluster\nkubectl create clusterrolebinding my-dashboard-sa \\\n  --clusterrole=cluster-admin \\\n  --serviceaccount=default:my-dashboard-sa\n</code></pre> <p>Get the token in that service account</p> <pre><code># Find the secret that was created to hold the token for the SA\ntokenname=`kubectl get secrets | grep my-dashboard-sa-token | awk '{print $1}'`\n# Show the contents of the secret to extract the token\nkubectl describe secret $tokenname | awk '$1==\"token:\"{print $2}'\n</code></pre>","tags":["k8s","kubernetes","dashboard","cloudnative"]},{"location":"DevOps/2021-08-28-deploy-dashboard-on-k8s-1.22/#5-access-the-dashboard-in-a-web-browser","title":"5. Access the dashboard in a web browser","text":"<p>Now we can visit the dashboard via <code>https://master01.k8s:32700/</code> in a web browser. And put that token in the login screen for authentication.</p>","tags":["k8s","kubernetes","dashboard","cloudnative"]},{"location":"DevOps/2021-08-28-deploy-dashboard-on-k8s-1.22/#reference","title":"Reference","text":"<ul> <li>Install Kubernetes (k8s) v1.22 Highly Available Clusters on CentOS 7</li> <li>docs/tasks/access-application-cluster/web-ui-dashboard/</li> <li>blog.heptio.com/on-securing-the-kubernetes-dashboard</li> </ul>","tags":["k8s","kubernetes","dashboard","cloudnative"]},{"location":"DevOps/2021-09-04-create-a-self-hosted-helm-chart-and-deploy-it-to-k8s-1.22/","title":"Create a self-hosted helm chart and deploy it to kubernetes (v1.22)","text":"","tags":["k8s","kubernetes","cloudnative","helm","chart"]},{"location":"DevOps/2021-09-04-create-a-self-hosted-helm-chart-and-deploy-it-to-k8s-1.22/#1-concepts","title":"1. Concepts","text":"<p>Here are the descriptions from helm.sh:</p> <p>A <code>Chart</code> is a Helm package. It contains all of the resource definitions necessary to run an application, tool, or service inside of a Kubernetes cluster. Think of it like the Kubernetes equivalent of a Homebrew formula, an Apt dpkg, or a Yum RPM file.</p> <p>A <code>Repository</code> is the place where charts can be collected and shared. It's like Perl's CPAN archive or the Fedora Package Database, but for Kubernetes packages.</p> <p>A <code>Release</code> is an instance of a chart running in a Kubernetes cluster. One chart can often be installed many times into the same cluster. And each time it is installed, a new release is created. Consider a MySQL chart. If you want two databases running in your cluster, you can install that chart twice. Each one will have its own release, which will in turn have its own release name.</p> <p><code>Helm</code> installs charts into Kubernetes, creating a new release for each installation. And to find new charts, you can search Helm chart repositories.</p>","tags":["k8s","kubernetes","cloudnative","helm","chart"]},{"location":"DevOps/2021-09-04-create-a-self-hosted-helm-chart-and-deploy-it-to-k8s-1.22/#2-install-kubectl-helm","title":"2. Install kubectl &amp; helm","text":"","tags":["k8s","kubernetes","cloudnative","helm","chart"]},{"location":"DevOps/2021-09-04-create-a-self-hosted-helm-chart-and-deploy-it-to-k8s-1.22/#21-install-kubectl","title":"2.1 Install kubectl","text":"<p>See install-kubectl-on-control-server .</p>","tags":["k8s","kubernetes","cloudnative","helm","chart"]},{"location":"DevOps/2021-09-04-create-a-self-hosted-helm-chart-and-deploy-it-to-k8s-1.22/#22-install-helm","title":"2.2 Install helm","text":"<p>See github.com/helm/helm/releases for helm releases.</p> <p>For linux amd64 server:</p> <pre><code>wget https://get.helm.sh/helm-v3.6.3-linux-amd64.tar.gz\ntar -zxvf helm-v3.6.3-linux-amd64.tar.gz \nsudo mv linux-amd64/helm  /usr/local/bin/helm \n</code></pre> <p>For macOS:</p> <pre><code>brew install helm\n</code></pre> <p>Check version</p> <pre><code>helm version\n</code></pre> <p>Output:</p> <pre><code>version.BuildInfo{Version:\"v3.6.3\", GitCommit:\"d506314abfb5d21419df8c7e7e68012379db2354\", GitTreeState:\"clean\", GoVersion:\"go1.16.5\"}\n</code></pre>","tags":["k8s","kubernetes","cloudnative","helm","chart"]},{"location":"DevOps/2021-09-04-create-a-self-hosted-helm-chart-and-deploy-it-to-k8s-1.22/#3-create-a-helm-chart","title":"3. Create a helm chart","text":"<p>To get started with a new chart, the best way is to use <code>helm create</code> command to initialize a new chart.</p> <p>The following command create a chart named <code>hello</code>:</p> <pre><code>helm create hello\n</code></pre> <p>Let's take a look at the file structure of this chart by using <code>tree -a hello</code> command:</p> <pre><code>hello\n\u251c\u2500\u2500 .helmignore\n\u251c\u2500\u2500 Chart.yaml\n\u251c\u2500\u2500 charts\n\u251c\u2500\u2500 templates\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 NOTES.txt\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 _helpers.tpl\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 deployment.yaml\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 hpa.yaml\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 ingress.yaml\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 service.yaml\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 serviceaccount.yaml\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 tests\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 test-connection.yaml\n\u2514\u2500\u2500 values.yaml\n</code></pre> <p>Now we can continue to complete this chart by editing the files above or adding some other files (such as template file or <code>README.md</code> etc.).</p> <p>See the-chart-file-structure for more information about the chart file structure.</p> <p>See charts/hello for more information about this example chart.</p> <p>By now, we can:</p> <ul> <li>Locally render templates by using <code>helm template ./hello</code></li> <li>Deploy the example chart by using <code>helm install my-hello-1 ./hello</code></li> <li>And test the connection by using <code>helm test my-hello-1</code></li> </ul> <p>But we can go further:</p> <ul> <li>Add <code>README.md</code> for a chart</li> <li>Package a chart</li> <li>Host charts by creating a chart repository</li> <li>Publish a chart repository to artifacthub.io</li> </ul>","tags":["k8s","kubernetes","cloudnative","helm","chart"]},{"location":"DevOps/2021-09-04-create-a-self-hosted-helm-chart-and-deploy-it-to-k8s-1.22/#4-host-helm-charts-using-github-page","title":"4. Host helm charts using Github Page","text":"","tags":["k8s","kubernetes","cloudnative","helm","chart"]},{"location":"DevOps/2021-09-04-create-a-self-hosted-helm-chart-and-deploy-it-to-k8s-1.22/#41-create-a-github-repo-for-helm-charts","title":"4.1 Create a github repo for helm charts","text":"<p>First let's create a empty repo on Github, for example, named <code>charts</code>, take <code>main</code> as the default branch.</p> <p>And clone it to your local server. </p> <pre><code>git clone git@github.com:&lt;YOUR_GITHUB_USERNAME&gt;/charts.git\n\ncd charts\n</code></pre> <p>Then create a directory named <code>charts</code> under the root path of this repo, place chart <code>hello</code> under the new created directory.  Also create <code>LICENSE</code> and <code>README.md</code> files as you wish. By now the file structure of the repo like below:</p> <pre><code>.\n\u251c\u2500\u2500 LICENSE\n\u251c\u2500\u2500 README.md\n\u2514\u2500\u2500 charts\n    \u2514\u2500\u2500 hello\n        \u251c\u2500\u2500 .helmignore    \n        \u251c\u2500\u2500 Chart.yaml\n        \u251c\u2500\u2500 templates\n        \u2502\u00a0\u00a0 \u251c\u2500\u2500 NOTES.txt\n        \u2502\u00a0\u00a0 \u251c\u2500\u2500 _helpers.tpl\n        \u2502\u00a0\u00a0 \u251c\u2500\u2500 deployment.yaml\n        \u2502\u00a0\u00a0 \u251c\u2500\u2500 hpa.yaml\n        \u2502\u00a0\u00a0 \u251c\u2500\u2500 ingress.yaml\n        \u2502\u00a0\u00a0 \u251c\u2500\u2500 service.yaml\n        \u2502\u00a0\u00a0 \u251c\u2500\u2500 serviceaccount.yaml\n        \u2502\u00a0\u00a0 \u2514\u2500\u2500 tests\n        \u2502\u00a0\u00a0     \u2514\u2500\u2500 test-connection.yaml\n        \u2514\u2500\u2500 values.yaml\n</code></pre>","tags":["k8s","kubernetes","cloudnative","helm","chart"]},{"location":"DevOps/2021-09-04-create-a-self-hosted-helm-chart-and-deploy-it-to-k8s-1.22/#42-prepare-for-creating-readmemd-for-a-chart","title":"4.2 Prepare for creating <code>README.md</code> for a chart","text":"<p>There is a tool named <code>chart-doc-gen</code> used for generating <code>README.md</code> for a chart.</p> <p>First let's create a file named <code>doc.yml</code> and place it to <code>charts/hello</code> directory. </p> <p>e.g. </p> <pre><code>project:\n  name: Hello World\n  shortName: Hello\n  url: https://github.com/cloudecho/hello-world-go\n  description: A hello-world program written in go lang.\n  app: hello\nrepository:\n  url: https://cloudecho.github.io/charts/\n  name: cloudecho\nchart:\n  name: hello\n  version: 0.1.0\n  values: \"-- generate from values file --\"\n  valuesExample: \"-- generate from values file --\"\nprerequisites:\n- \"Kubernetes v1.14+\"\n\nrelease:\n  name: my-hello\n  namespace: default\n</code></pre> <p>Then append the text <code>doc.yml</code> into <code>charts/hello/.helmignore</code> file to avoid <code>doc.yml</code> to be packaged. </p> <p>Download the latest <code>chart-doc-gen</code> from github.com/kubepack/chart-doc-gen/releases and install it (e.g. copy it to <code>/usr/local/bin/</code>).</p>","tags":["k8s","kubernetes","cloudnative","helm","chart"]},{"location":"DevOps/2021-09-04-create-a-self-hosted-helm-chart-and-deploy-it-to-k8s-1.22/#43-create-gh-pages-branch-for-github-page","title":"4.3 Create <code>gh-pages</code> branch for Github Page","text":"<p>Create <code>gh-pages</code> branch and simultaneously switch to that branch.</p> <pre><code>git checkout -b gh-pages\n</code></pre> <p>Merge branch <code>main</code> into <code>gh-pages</code>:</p> <pre><code>git merge main\n</code></pre> <p>Now we can use <code>chart-doc-gen</code> to generate <code>README.md</code> file for chart <code>hello</code>:</p> <pre><code>cd charts\n\nchart-doc-gen \\\n    -d=hello/doc.yml \\\n    -v=hello/values.yaml \\\n    &gt; hello/README.md\n\ncd ..  \n</code></pre>","tags":["k8s","kubernetes","cloudnative","helm","chart"]},{"location":"DevOps/2021-09-04-create-a-self-hosted-helm-chart-and-deploy-it-to-k8s-1.22/#44-package-and-index-helm-charts","title":"4.4 Package and index helm charts","text":"<p>Use the following command to package <code>hello</code> chart and index all the charts: </p> <pre><code>helm package charts/hello\nhelm repo index . --url https://&lt;YOUR_GITHUB_USERNAME&gt;.github.io/charts/\n</code></pre> <p>Check the chart package file (<code>hello-0.1.0.tgz</code>) and <code>index.yaml</code> file by using <code>tree -L 1</code> :</p> <pre><code>.\n\u251c\u2500\u2500 LICENSE\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 charts\n\u251c\u2500\u2500 hello-0.1.0.tgz\n\u2514\u2500\u2500 index.yaml\n</code></pre> <p>We can also:</p> <ul> <li>check the content of <code>index.xml</code> by using <code>cat index.yml</code> command.</li> <li>check the content of <code>hello-0.1.0.tgz</code> by using <code>tar -tvf hello-0.1.0.tgz</code> command.</li> </ul>","tags":["k8s","kubernetes","cloudnative","helm","chart"]},{"location":"DevOps/2021-09-04-create-a-self-hosted-helm-chart-and-deploy-it-to-k8s-1.22/#45-make-it-simple-by-creating-a-makefile","title":"4.5 Make it simple by creating a Makefile","text":"<p>Here are some works to update the repo for charts:</p> <ol> <li>On <code>main</code> branch:</li> <li>editing existing chart, e.g. <code>charts/hello</code></li> <li>creating new chart, e.g. <code>helm create charts/another-chart</code></li> <li> <p>edit <code>doc.yml</code>/<code>.helmignore</code></p> </li> <li> <p>Merge branch <code>main</code> into <code>gh-pages</code></p> </li> <li> <p>On <code>gh-pages</code> branch:</p> </li> <li>generationg <code>README.md</code> file for each chart</li> <li>package each chart</li> <li>index all the charts</li> </ol> <p>Let's create a <code>Makefile</code> file on <code>gh-pages</code> branch to simplify some works above (point 2-3: merge, doc, package and index), then we can do those works by using a single <code>make</code> command:</p> <p>e.g. </p> <pre><code>CHARTS=$(shell ls charts)\n\ndefault: index\n\nmerge:\n    GIT_MERGE_AUTOEDIT=no git merge main\n\ndoc: \n    $(foreach c, $(CHARTS), chart-doc-gen \\\n      -d=charts/$(c)/doc.yml \\\n      -v=charts/$(c)/values.yaml \\\n      &gt; charts/$(c)/README.md)\n\npackage: merge doc\n    $(foreach c, $(CHARTS), helm package charts/$(c))\n\nindex: package\n    helm repo index . --url https://cloudecho.github.io/charts/\n</code></pre> <p>See cloudecho/charts for more information about this example.</p>","tags":["k8s","kubernetes","cloudnative","helm","chart"]},{"location":"DevOps/2021-09-04-create-a-self-hosted-helm-chart-and-deploy-it-to-k8s-1.22/#46-settings-for-chart-repository-on-github-site","title":"4.6 Settings for chart repository on Github site","text":"<p>After pushing all the changes to remote git server (github site),  let's have a look at the settings for chart repository on Github site.</p> <p>Open a web browser, go to  https://github.com///settings/pages <ul> <li>Select <code>gh-pages</code> branch and <code>/(root)</code> directory as the source.</li> <li>(suggesstion) Make <code>Enforce HTTPS</code> checked. </li> </ul> <pre><code>Source\nBranch: gh-pages /(root)\n\n[x] Enforce HTTPS \n</code></pre> <p>Please refer to docs.github.com/en/pages for more information about Github Page.</p>","tags":["k8s","kubernetes","cloudnative","helm","chart"]},{"location":"DevOps/2021-09-04-create-a-self-hosted-helm-chart-and-deploy-it-to-k8s-1.22/#5-publish-helm-charts-to-artifacthubio","title":"5. Publish helm charts to artifacthub.io","text":"<p>This is optional but very convenient for opensource charts as helping people to search and find your charts.</p> <p>Here are the steps:</p> <ul> <li>Go to https://artifacthub.io/ in a web browser</li> <li>Sign in, for example, with Github</li> <li>Go to the <code>Control Panel/Repositories</code> (artifacthub.io/control-panel/repositories )</li> <li>Click the <code>ADD</code> button on the right, select <code>Helm charts</code> as the kind, input the <code>Name</code> and <code>Url</code>, for example</li> </ul> <pre><code>Kind\nHelm charts\n\nName\n&lt;YOUR_GITHUB_USERNAME&gt;\n\nUrl\nhttps://&lt;YOUR_GITHUB_USERNAME&gt;.github.io/charts/\n</code></pre> <ul> <li>Click the <code>ADD</code> button on the bottom to complete.</li> </ul> <p>Now we'll get an <code>ID</code> for this chart repository. </p> <p>To tell Artifact Hub that you're the owner of this chart repository,  create a file named <code>artifacthub-repo.yml</code>  and place it to the root path of the github repo for charts.</p> <p>The content of the file is like this:</p> <pre><code># Artifact Hub repository metadata file\n#\n# Some settings like the verified publisher flag or the ignored packages won't\n# be applied until the next time the repository is processed. Please keep in\n# mind that the repository won't be processed if it has not changed since the\n# last time it was processed. Depending on the repository kind, this is checked\n# in a different way. For Helm http based repositories, we consider it has\n# changed if the `index.yaml` file changes. For git based repositories, it does\n# when the hash of the last commit in the branch you set up changes. This does\n# NOT apply to ownership claim operations, which are processed immediately.\n#\nrepositoryID: &lt;repositoryid_from_artifacthub&gt;\nowners: # (optional, used to claim repository ownership)\n  - name: &lt;your_username&gt;\n    email: &lt;your_email&gt;\n</code></pre> <p>Once the chart repositry is processed by Artifact Hub, we can search our charts on the site.</p> <p>Also We can use <code>helm search hub xxx</code> command to search our charts. </p> <p>e.g.</p> <pre><code>helm search hub hello\n</code></pre>","tags":["k8s","kubernetes","cloudnative","helm","chart"]},{"location":"DevOps/2021-09-04-create-a-self-hosted-helm-chart-and-deploy-it-to-k8s-1.22/#6-deploy-a-chart-into-kubernetes","title":"6. Deploy a chart into kubernetes","text":"<p>As an example, let's follow the instruction of <code>hello</code> chart to deploy <code>hello</code> chart to an existing kubernetes.</p> <p>First, add a chart repo:</p> <pre><code>helm repo add cloudecho https://cloudecho.github.io/charts/\nhelm repo update\nhelm install my-hello cloudecho/hello -n default --version=0.1.0\n</code></pre> <p>Here is the Output:</p> <pre><code>NAME: my-hello\nLAST DEPLOYED: Sat Sep  4 10:20:28 2021\nNAMESPACE: default\nSTATUS: deployed\nREVISION: 1\nNOTES:\n1. Get the application URL by running these commands:\n  export POD_NAME=$(kubectl get pods --namespace default -l \"app.kubernetes.io/name=hello,app.kubernetes.io/instance=my-hello\" -o jsonpath=\"{.items[0].metadata.name}\")\n  export CONTAINER_PORT=$(kubectl get pod --namespace default $POD_NAME -o jsonpath=\"{.spec.containers[0].ports[0].containerPort}\")\n  echo \"Visit http://127.0.0.1:8080 to use your application\"\n  kubectl --namespace default port-forward $POD_NAME 8080:$CONTAINER_PORT\n</code></pre> <p>After running those commands above (<code>NOTES/1</code>):</p> <pre><code>Forwarding from 127.0.0.1:8080 -&gt; 8080\nForwarding from [::1]:8080 -&gt; 8080\n</code></pre> <p>Open another terminal, and input <code>curl localhost:8080</code> command:</p> <pre><code>Hello, World!\n2021-09-04 02:28:56.8191115 +0000 UTC\n</code></pre>","tags":["k8s","kubernetes","cloudnative","helm","chart"]},{"location":"DevOps/2021-09-04-create-a-self-hosted-helm-chart-and-deploy-it-to-k8s-1.22/#reference","title":"Reference","text":"<ul> <li>helm.sh/docs/intro/quickstart</li> <li>helm.sh/docs/intro/using_helm/</li> <li>helm.sh/docs/topics/charts</li> <li>helm.sh/docs/topics/chart_repository/#store-charts-in-your-chart-repository</li> <li>github.com/kubepack/chart-doc-gen</li> </ul>","tags":["k8s","kubernetes","cloudnative","helm","chart"]},{"location":"DevOps/2021-11-01-javase17-gctuning/","title":"HotSpot Virtual Machine Garbage Collection Tuning Guide (Release 17)","text":"<p>Java Platform, Standard Edition</p> <p>HotSpot Virtual Machine Garbage Collection Tuning Guide</p> <p>Release 17</p> <p>F41050-01</p> <p>September 2021</p> <p>This guide describes the garbage collection methods included in the Java HotSpot Virtual Machine (Java HotSpot VM) and helps you determine which one is the best for your needs.</p> <p>See https://docs.oracle.com/en/java/javase/17/gctuning/</p> <p>PDF</p>","tags":["java","jvm","gc","tuning"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/","title":"Getting started with docker swarm mode","text":"","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/#1-preparation","title":"1. Preparation","text":"","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/#11-kvms","title":"1.1 KVMs","text":"<p>3 KVMs</p> Hostname vCPUs Memory Swap IP OS sudoer minion01.k8s 2 8G 0 192.168.122.101 CentOS 7 echo minion02.k8s 2 8G 0 192.168.122.102 CentOS 7 echo minion03.k8s 2 8G 0 192.168.122.103 CentOS 7 echo","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/#12-install-ansible-on-host-machine","title":"1.2 Install Ansible on Host machine","text":"<pre><code># Install ansible on host machine\nsudo yum install ansible\n</code></pre>","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/#13-password-free-configuration","title":"1.3 Password free configuration","text":"<pre><code>cat &lt;&lt;EOF | sudo tee -a /etc/ansible/hosts\n[swarm-nodes]\nminion01.k8s\nminion02.k8s\nminion03.k8s\nEOF\n\n# Have a test \nansible swarm-nodes --ask-pass -u echo -m shell -a 'echo ok'\n\n# Password free for login\nansible swarm-nodes --ask-pass -u echo -m file -a \"path=.ssh state=directory mode=700\"\nansible swarm-nodes --ask-pass -u echo -m copy -a \"src=~/.ssh/id_rsa.pub dest=.ssh/authorized_keys mode=600\"\n\n# Password free for sudo\nansible swarm-nodes --ask-pass -u echo -b -m shell -a \"echo 'echo ALL=(ALL) NOPASSWD: ALL' &gt;&gt; /etc/sudoers\"\n\n# Now we can have a test as below\nansible swarm-nodes -u echo -m shell -a 'echo ok'\n</code></pre>","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/#14-dns-via-hosts-file","title":"1.4 DNS via hosts file","text":"<pre><code>cat &lt;&lt;EOF &gt; /tmp/add-hosts.sh\ncat &lt;&lt;EEE &gt;&gt; /etc/hosts \n192.168.122.101 minion01.k8s\n192.168.122.102 minion02.k8s\n192.168.122.103 minion03.k8s\nEEE\nEOF\n\nansible swarm-nodes -u echo -b -m script -a \"/tmp/add-hosts.sh\"\n</code></pre>","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/#2-open-protocols-and-ports-between-the-hosts","title":"2. Open protocols and ports between the hosts","text":"<p>The following ports must be available. On some systems, these ports are open by default.</p> <ul> <li>TCP port 2377 for cluster management communications</li> <li>TCP and UDP port 7946 for communication among nodes</li> <li>UDP port 4789 for overlay network traffic</li> </ul> <p>If you plan on creating an overlay network with encryption (--opt encrypted), you also need to ensure ip protocol 50 (ESP) traffic is allowed</p> <pre><code>cat &lt;&lt;EOF &gt; /tmp/required-ports.sh\nfirewall-cmd --permanent --add-port=2377/tcp\nfirewall-cmd --permanent --add-port=7946/tcp --add-port=7946/udp\nfirewall-cmd --permanent --add-port=4789/udp\n# NOTE: published ports (for demo use)\nfirewall-cmd --permanent --add-port=30000-32767/tcp\nfirewall-cmd --reload\nEOF\n\nansible swarm-nodes -u echo -b -m script -a '/tmp/required-ports.sh'\n</code></pre>","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/#3-install-docker-ce-as-the-container-runtime","title":"3. Install docker-ce as the container runtime","text":"","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/#31-install-container-selinux","title":"3.1 Install container-selinux","text":"<pre><code>ansible swarm-nodes -u echo -m shell -a \\\n'sudo yum --enablerepo=extras install -y container-selinux'\n</code></pre>","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/#32-check-docker-ce-version","title":"3.2 Check docker-ce version","text":"<pre><code>yum --showduplicates list docker-ce\n</code></pre>","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/#33-install-docker-ce","title":"3.3 Install docker-ce","text":"<p>NOTE: Use your mirror of dockerhub</p> <pre><code>cat &lt;&lt;EEE &gt; /tmp/install-docker.sh\n# Install Docker CE 18.06 from Docker's CentOS repositories:\n\n## Install prerequisites.\nyum -y install yum-utils device-mapper-persistent-data lvm2\n\n## Add docker repository.\nyum-config-manager \\\n    --add-repo \\\n    https://download.docker.com/linux/centos/docker-ce.repo\n\n## Install docker.\nyum -y install docker-ce-18.06.1.ce-3.el7\nsystemctl enable docker\n\n# Setup daemon.\nmkdir -p /etc/docker/\ncat &gt; /etc/docker/daemon.json &lt;&lt;EOF\n{\n  # NOTE: Use your mirror of dockerhub\n  \"registry-mirrors\": [\"https://z7sy3gme.mirror.aliyuncs.com\"],\n  \"exec-opts\": [\"native.cgroupdriver=systemd\"],\n  \"log-driver\": \"json-file\",\n  \"log-opts\": {\n    \"max-size\": \"100m\"\n  },\n  \"storage-driver\": \"overlay2\",\n  \"storage-opts\": [\n    \"overlay2.override_kernel_check=true\"\n  ]\n}\nEOF\n\nmkdir -p /etc/systemd/system/docker.service.d\n\n# Restart docker.\nsystemctl daemon-reload\nsystemctl restart docker\nEEE\n\nansible swarm-nodes -u echo -b -m script -a '/tmp/install-docker.sh'\n</code></pre>","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/#4-getting-started-with-swarm-mode","title":"4 Getting started with swarm mode","text":"<p>Swarm mode overview</p> <p>Swarm mode key concepts</p>","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/#41-create-a-new-swarm","title":"4.1 Create a new swarm","text":"<p>On minon01.k8s:</p> <pre><code>$ sudo docker swarm init --advertise-addr 192.168.122.101\nSwarm initialized: current node (3zvaz0q6iz91oe92zsfn79rl9) is now a manager.\n\nTo add a worker to this swarm, run the following command:\n\n    docker swarm join --token SWMTKN-1-1vf3r7evq3f28kl0jmki57xdo6yfnwpnivyee53y1otjemeu5u-3mrpqzlbdyjiwgqehsjff5cfy 192.168.122.101:2377\n\nTo add a manager to this swarm, run 'docker swarm join-token manager' and follow the instructions.\n</code></pre> <p>On minon02.k8s, minon03.k8s:</p> <pre><code>$ sudo docker swarm join --token SWMTKN-1-1vf3r7evq3f28kl0jmki57xdo6yfnwpnivyee53y1otjemeu5u-3mrpqzlbdyjiwgqehsjff5cfy 192.168.122.101:2377\nThis node joined a swarm as a worker.\n</code></pre>","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/#411-view-the-current-state-of-the-swarm","title":"4.1.1 View the current state of the swarm","text":"<pre><code>[echo@minion01 ~]$ sudo docker info\n... ...\nServer Version: 18.06.1-ce\nStorage Driver: overlay2\n Backing Filesystem: xfs\n Supports d_type: true\n Native Overlay Diff: true\nLogging Driver: json-file\nCgroup Driver: systemd\nPlugins:\n Volume: local\n Network: bridge host macvlan null overlay\n Log: awslogs fluentd gcplogs gelf journald json-file logentries splunk syslog\nSwarm: active\n NodeID: 3zvaz0q6iz91oe92zsfn79rl9\n Is Manager: true\n ClusterID: 9yfajds9vesoci8h3y6kryftq\n Managers: 1\n Nodes: 3\n ... ...\n</code></pre>","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/#412-view-information-about-nodes","title":"4.1.2 View information about nodes","text":"<pre><code>[echo@minion01 ~]$ sudo docker node ls\nID                            HOSTNAME       STATUS              AVAILABILITY        MANAGER STATUS      ENGINE VERSION\n3zvaz0q6iz91oe92zsfn79rl9 *   minion01.k8s   Ready               Active              Leader              18.06.1-ce\nm4ppispuk9ssenwfb547vlfx7     minion02.k8s   Ready               Active                                  18.06.1-ce\nutczs0xf0k8asv5xhk53h8dhw     minion03.k8s   Ready               Active                                  18.06.1-ce\n</code></pre> <p>NOTE:  - The <code>*</code> next to the node ID indicates that you\u2019re currently connected on this node. - Swarm management commands like <code>docker node ls</code> only work on manager nodes.</p>","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/#42-deploy-a-service","title":"4.2 Deploy a service","text":"<p>e.g.</p> <pre><code>$ sudo docker service create --replicas 1 --name helloworld cloudecho/hello\nvct016qjdzf5vglo6zgjq0w79\noverall progress: 1 out of 1 tasks \n1/1: running   [==================================================&gt;] \nverify: Service converged \n</code></pre> <pre><code>[echo@minion01 ~]$ sudo docker service ls\nID                  NAME                MODE                REPLICAS            IMAGE                    PORTS\nvct016qjdzf5        helloworld          replicated          1/1                 cloudecho/hello:latest   \n</code></pre>","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/#43-inspect-a-service-on-the-swarm","title":"4.3 Inspect a service on the swarm","text":"<p>e.g. </p> <pre><code>sudo docker service inspect --pretty helloworld\nsudo docker service ps helloworld\nsudo docker ps\n</code></pre> <p>See docs.docker.com/engine/swarm/swarm-tutorial/inspect-service/ for more information.</p>","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/#44-scale-the-service-in-the-swarm","title":"4.4 Scale the service in the swarm","text":"<p>e.g. </p> <pre><code>[echo@minion01 ~]$ sudo docker service scale helloworld=3\nhelloworld scaled to 3\noverall progress: 3 out of 3 tasks \n1/3: running   [==================================================&gt;] \n2/3: running   [==================================================&gt;] \n3/3: running   [==================================================&gt;] \nverify: Service converged \n</code></pre> <pre><code>[echo@minion01 ~]$ sudo docker service ps helloworld\nID                  NAME                IMAGE                    NODE           DESIRED STATE       CURRENT STATE               ERROR               PORTS\npejk5rws46iu        helloworld.1        cloudecho/hello:latest   minion01.k8s   Running             Running about an hour ago                       \nayddx4mm23du        helloworld.2        cloudecho/hello:latest   minion02.k8s   Running             Running 8 minutes ago                           \noun32xdz6fi1        helloworld.3        cloudecho/hello:latest   minion03.k8s   Running             Running 7 minutes ago                           \n</code></pre> <p>See docs.docker.com/engine/swarm/swarm-tutorial/scale-service/ for more information.</p>","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/#45-delete-the-service-running-on-the-swarm","title":"4.5 Delete the service running on the swarm","text":"<p>e.g. </p> <pre><code>sudo docker service rm helloworld\n</code></pre>","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/#46-apply-rolling-updates-to-a-service","title":"4.6 Apply rolling updates to a service","text":"<p>See docs.docker.com/engine/swarm/swarm-tutorial/rolling-update/</p>","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/#47-drain-a-node-on-the-swarm","title":"4.7 Drain a node on the swarm","text":"<p>In earlier steps of the tutorial, all the nodes have been running with ACTIVE availability. The swarm manager can assign tasks to any ACTIVE node, so up to now all nodes have been available to receive tasks.</p> <p>Sometimes, such as planned maintenance times, you need to set a node to DRAIN availability. DRAIN availability prevents a node from receiving new tasks from the swarm manager. It also means the manager stops tasks running on the node and launches replica tasks on a node with ACTIVE availability.</p> <p>See docs.docker.com/engine/swarm/swarm-tutorial/drain-node/ for more information.</p>","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/#48-publish-a-port-for-a-service","title":"4.8 Publish a port for a service","text":"<p>e.g.</p> <pre><code>$ sudo docker service create --replicas 1 --name helloworld --publish published=30001,target=8080 cloudecho/hello\n</code></pre> <p>Publish a port for an existing service:</p> <p>e.g.</p> <pre><code>[echo@minion01 ~]$ sudo docker service update helloworld --publish-add published=30001,target=8080\nhelloworld\noverall progress: 3 out of 3 tasks \n1/3: running   [==================================================&gt;] \n2/3: running   [==================================================&gt;] \n3/3: running   [==================================================&gt;] \nverify: Service converged \n</code></pre> <pre><code>[echo@minion01 ~]$ sudo docker service ls\nID                  NAME                MODE                REPLICAS            IMAGE                    PORTS\nvct016qjdzf5        helloworld          replicated          3/3                 cloudecho/hello:latest   *:30001-&gt;8080/tcp\n</code></pre> <p>Have a test using <code>curl</code>:</p> <pre><code>[echo@minion01 ~]$ curl http://minion02.k8s:30001\nHello, World!\n2021-11-09 09:03:59.794006337 +0000 UTC\n</code></pre> <p>See https://docs.docker.com/engine/swarm/ingress/ for more information.</p>","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-09-getting-started-with-docker-swarm-mode/#reference","title":"Reference","text":"<ul> <li>docs.docker.com/engine/swarm/</li> <li>docs.docker.com/engine/swarm/key-concepts/</li> <li>docs.docker.com/engine/swarm/swarm-tutorial/</li> <li>docs.docker.com/engine/swarm/ingress/</li> </ul>","tags":["docker","swarm","cloudnative"]},{"location":"DevOps/2021-11-29-install-glusterfs-on-centos7/","title":"Install Glusterfs on Centos 7","text":"","tags":["glusterfs","centos"]},{"location":"DevOps/2021-11-29-install-glusterfs-on-centos7/#1-preparation","title":"1. Preparation","text":"","tags":["glusterfs","centos"]},{"location":"DevOps/2021-11-29-install-glusterfs-on-centos7/#11-kvms","title":"1.1 KVMs","text":"<p>3 KVMs</p> Hostname vCPUs Memory Swap IP OS sudoer Data Storage gluster01 2 2G 0 192.168.122.191 CentOS 7 echo 100G gluster02 2 2G 0 192.168.122.192 CentOS 7 echo 100G gluster03 2 2G 0 192.168.122.193 CentOS 7 echo 100G <p>Attach a disk image on those KVMs accordingly if needed. Here are the steps.</p> <ul> <li>STEP 1. Create the new disk images</li> </ul> <p>On the host server</p> <pre><code># Where your disk images store in\ncd /data/vm_storage/\n\n# Create the new disk image\nsudo qemu-img create -f raw gluster01-disk1-100G 100G\nsudo qemu-img create -f raw gluster02-disk1-100G 100G\nsudo qemu-img create -f raw gluster03-disk1-100G 100G\n\nsudo chown qemu:qemu gluster{01,02,03}-disk1-100G\n</code></pre> <ul> <li>STEP 2. Attach the disk to the virtual machine</li> </ul> <pre><code>sudo virsh attach-disk gluster01 /data/vm_storage/gluster01-disk1-100G vdb --cache none\nsudo virsh attach-disk gluster02 /data/vm_storage/gluster02-disk1-100G vdb --cache none\nsudo virsh attach-disk gluster03 /data/vm_storage/gluster03-disk1-100G vdb --cache none\n</code></pre> <p>NOTE: If you already have a <code>/dev/vdb</code> disk you need to change vdb to a free device like <code>/dev/vdc</code> and so on.</p> <p>NOTE: For attaching permanently the disk image to the VM, you should edit the VM configuration file, e.g.</p> <p><code>sudo virsh edit gluster01</code>, add the following XML fragment into the <code>&lt;devices&gt;</code> section:</p> <pre><code>    &lt;disk type='file' device='disk'&gt;\n      &lt;driver name='qemu' type='raw'/&gt;\n      &lt;source file='/data/vm_storage/gluster01-disk1-100G'/&gt;\n      &lt;target dev='vdb' bus='virtio'/&gt;\n      &lt;address type='pci' domain='0x0000' bus='0x00' slot='0x09' function='0x0'/&gt;\n    &lt;/disk&gt;\n</code></pre> <ul> <li>STEP 3. Partitioning the disk drive in VMs</li> </ul> <p>On KVM gluster{01,02,03}</p> <p>Login into KVM gluster{01,02,03}.</p> <pre><code>sudo fdisk -l | grep /dev/vd\n\nsudo fdisk /dev/vdb\n</code></pre> <ul> <li>Type n for a new partition. </li> <li>Type p for a primary partition. </li> <li>Choose an available partition number 1. </li> <li>Enter the default first cylinder by pressing Enter. </li> <li>Choose the entire disk is allocated by pressing Enter. </li> <li>Finally type p to verify new partition. </li> <li>Enter w to write changes and quit. </li> </ul>","tags":["glusterfs","centos"]},{"location":"DevOps/2021-11-29-install-glusterfs-on-centos7/#12-install-ansible-on-the-host-machine","title":"1.2 Install Ansible on the host machine","text":"<pre><code># Install ansible on host machine\nsudo yum install ansible\n</code></pre>","tags":["glusterfs","centos"]},{"location":"DevOps/2021-11-29-install-glusterfs-on-centos7/#13-password-free-configuration","title":"1.3 Password free configuration","text":"<pre><code>cat &lt;&lt;EOF | sudo tee -a /etc/hosts\n192.168.122.191 gluster01\n192.168.122.192 gluster02\n192.168.122.193 gluster03\nEOF\n\ncat &lt;&lt;EOF | sudo tee -a /etc/ansible/hosts\n[gluster]\ngluster01\ngluster02\ngluster03\nEOF\n\n# Have a test \nansible gluster --ask-pass -u echo -m shell -a 'echo ok'\n\n# Password free for login\nansible gluster --ask-pass -u echo -m file -a \"path=.ssh state=directory mode=700\"\nansible gluster --ask-pass -u echo -m copy -a \"src=~/.ssh/id_rsa.pub dest=.ssh/authorized_keys mode=600\"\n\n# Password free for sudo\nansible gluster --ask-pass -u echo -b -m shell -a \"echo 'echo ALL=(ALL) NOPASSWD: ALL' &gt;&gt; /etc/sudoers\"\n\n# Now we can have a test as below\nansible gluster -u echo -m shell -a 'echo ok'\n</code></pre>","tags":["glusterfs","centos"]},{"location":"DevOps/2021-11-29-install-glusterfs-on-centos7/#14-dns-via-hosts-file","title":"1.4 DNS via hosts file","text":"<pre><code>cat &lt;&lt;EOF &gt; /tmp/add-hosts.sh\ncat &lt;&lt;EEE &gt;&gt; /etc/hosts \n192.168.122.191 gluster01\n192.168.122.192 gluster02\n192.168.122.193 gluster03\nEEE\nEOF\n\nansible gluster -u echo -b -m script -a \"/tmp/add-hosts.sh\"\n</code></pre>","tags":["glusterfs","centos"]},{"location":"DevOps/2021-11-29-install-glusterfs-on-centos7/#2-configure-the-firewall","title":"2. Configure the firewall","text":"<p>Ensure that TCP and UDP ports 24007 and 24008 are open on all Gluster servers.  Apart from these ports, you need to open one port for each brick  starting from port 49152 (instead of 24009 onwards as with previous releases).</p> <pre><code>cat &lt;&lt;EOF &gt; /tmp/required-ports.sh\nfirewall-cmd --permanent --add-port=24007-24008/tcp --add-port=24007-24008/udp\nfirewall-cmd --permanent --add-port=49152-50151/tcp \nfirewall-cmd --reload\nEOF\n\nansible gluster -u echo -b -m script -a '/tmp/required-ports.sh'\n</code></pre>","tags":["glusterfs","centos"]},{"location":"DevOps/2021-11-29-install-glusterfs-on-centos7/#3-format-and-mount-the-device-of-gluster-brick","title":"3. Format and mount the device of gluster brick","text":"<p>NOTE: Assume that the brick will be residing on <code>/dev/vdb1</code>.</p> <p>On the host server:</p> <pre><code>cat &lt;&lt;EOF &gt; /tmp/mount-brick.sh\nmkfs.xfs -i size=512 /dev/vdb1\nmkdir -p /data/brick1\necho '/dev/vdb1 /data/brick1 xfs defaults 1 2' &gt;&gt; /etc/fstab\nmount -a\nEOF\n\nansible gluster -u echo -b -m script -a '/tmp/mount-brick.sh'\n</code></pre>","tags":["glusterfs","centos"]},{"location":"DevOps/2021-11-29-install-glusterfs-on-centos7/#4-installing-glusterfs","title":"4. Installing GlusterFS","text":"","tags":["glusterfs","centos"]},{"location":"DevOps/2021-11-29-install-glusterfs-on-centos7/#41-install-the-software","title":"4.1 Install the software","text":"<p>On the host server</p> <p>Lookup centos glusterfs software packages</p> <pre><code>yum search centos-release-gluster\n</code></pre> <p>Install Gluster 9 packages (<code>centos-release-gluster9</code>)</p> <pre><code>cat &lt;&lt;EOF &gt; /tmp/install-gluster.sh\nyum install centos-release-gluster9 -y\nyum install glusterfs gluster-cli glusterfs-libs glusterfs-server -y\nEOF\n\nansible gluster -u echo -b -m script -a '/tmp/install-gluster.sh'\n</code></pre> <p>Login into gluster01</p> <p>Check the installed software packages.</p> <pre><code>$ rpm -qa |grep gluster\nlibglusterfs0-9.4-1.el7.x86_64\nglusterfs-9.4-1.el7.x86_64\nglusterfs-server-9.4-1.el7.x86_64\ncentos-release-gluster9-1.0-1.el7.noarch\nglusterfs-client-xlators-9.4-1.el7.x86_64\nlibglusterd0-9.4-1.el7.x86_64\nglusterfs-fuse-9.4-1.el7.x86_64\nglusterfs-cli-9.4-1.el7.x86_64\n</code></pre>","tags":["glusterfs","centos"]},{"location":"DevOps/2021-11-29-install-glusterfs-on-centos7/#42-enable-start-the-glusterd-service","title":"4.2 Enable &amp; start the glusterd service","text":"<pre><code>cat &lt;&lt;EOF &gt; /tmp/start-glusterd.sh\nsystemctl enable glusterd.service\nsystemctl start glusterd.service\nEOF\n\nansible gluster -u echo -b -m script -a '/tmp/start-glusterd.sh'\n</code></pre>","tags":["glusterfs","centos"]},{"location":"DevOps/2021-11-29-install-glusterfs-on-centos7/#43-configure-the-trusted-pool","title":"4.3 Configure the trusted pool","text":"<p>From <code>gluster01</code></p> <pre><code>sudo gluster peer probe gluster02\nsudo gluster peer probe gluster03\n</code></pre> <p>Check the peer status</p> <pre><code>$ sudo gluster peer status\nNumber of Peers: 2\n\nHostname: gluster02\nUuid: 3313ad84-ca67-4b8b-8aa3-a0aaa104591e\nState: Peer in Cluster (Connected)\n\nHostname: gluster03\nUuid: 3ed0ee52-9af5-4f81-a15b-f841c5ab1754\nState: Peer in Cluster (Connected)\n</code></pre> <pre><code>$ sudo gluster pool list\nUUID                    Hostname    State\n3313ad84-ca67-4b8b-8aa3-a0aaa104591e    gluster02   Connected \n3ed0ee52-9af5-4f81-a15b-f841c5ab1754    gluster03   Connected \n49d29ad7-afe1-49e5-9fe4-497688f1426c    localhost   Connected \n</code></pre>","tags":["glusterfs","centos"]},{"location":"DevOps/2021-11-29-install-glusterfs-on-centos7/#5-set-up-a-glusterfs-volume","title":"5. Set up a GlusterFS volume","text":"","tags":["glusterfs","centos"]},{"location":"DevOps/2021-11-29-install-glusterfs-on-centos7/#51-set-up-a-volume-named-gv0","title":"5.1 Set up a volume named <code>gv0</code>","text":"<p>On the host server</p> <pre><code>ansible gluster -u echo -b -m shell -a 'mkdir -p /data/brick1/gv0'\n</code></pre> <p>From <code>gluster01</code></p> <p>Create a replicated volume by specifing the parameter <code>replica</code> to be 3:</p> <pre><code>sudo gluster volume create gv0 replica 3 \\\n gluster01:/data/brick1/gv0 \\\n gluster02:/data/brick1/gv0 \\\n gluster03:/data/brick1/gv0\n#OUTPUT: \n#volume create: gv0: success: please start the volume to access data\n\nsudo gluster volume start gv0\n#OUTPUT:\n#volume start: gv0: success\n</code></pre> <p>Confirm that the volume shows \"<code>Started</code>\":</p> <pre><code>$ sudo gluster volume info\n\nVolume Name: gv0\nType: Replicate\nVolume ID: cd783e4a-a569-4cf2-894e-98cf1a7f180b\nStatus: Started\nSnapshot Count: 0\nNumber of Bricks: 1 x 3 = 3\nTransport-type: tcp\nBricks:\nBrick1: gluster01:/data/brick1/gv0\nBrick2: gluster02:/data/brick1/gv0\nBrick3: gluster03:/data/brick1/gv0\nOptions Reconfigured:\ncluster.granular-entry-heal: on\nstorage.fips-mode-rchecksum: on\ntransport.address-family: inet\nnfs.disable: on\nperformance.client-io-threads: off\n</code></pre> <p>NOTE: If the volume does not show \"<code>Started</code>\",  \u00a0the files under <code>/var/log/glusterfs/glusterd.log</code>  \u00a0should be checked in order to debug and diagnose the situation.   \u00a0These logs can be looked at on one or, all the servers configured.</p>","tags":["glusterfs","centos"]},{"location":"DevOps/2021-11-29-install-glusterfs-on-centos7/#52-testing-the-volume","title":"5.2 Testing the volume","text":"<p>From <code>gluster01</code></p> <pre><code>sudo mkdir -p /mnt/gv0\nsudo mount -t glusterfs gluster01:/gv0 /mnt/gv0\n\nfor i in `seq -w 1 10`; do sudo cp -rp /etc/hosts /mnt/gv0/copy-test-$i; done\n</code></pre> <p>First, check the client mount point:</p> <pre><code>ls -lA /mnt/gv0/copy* | wc -l\n</code></pre> <p>You should see 10 files returned.  Next, check the GlusterFS brick mount points on each server (<code>gluster{01,02,03}</code>):</p> <pre><code>ls -lA /data/brick1/gv0/copy*\n</code></pre> <p>NOTE: Typically, you would do this from an external machine, known as a \"client\".  It requires additional packages to be installed on the client machine. e.g.</p> <pre><code>sudo yum install centos-release-gluster9 -y\nsudo yum install glusterfs glusterfs-fuse -y\n</code></pre>","tags":["glusterfs","centos"]},{"location":"DevOps/2021-11-29-install-glusterfs-on-centos7/#reference","title":"Reference","text":"<ul> <li>how-to-add-disk-image-to-kvm-virtual-machine-with-virsh-command</li> <li>Quick-Start-Guide/Quickstart</li> <li>Quick-Start-Guide/Architecture</li> <li>Administrator-Guide/Setting-Up-Clients</li> <li>Administrator-Guide/Split-brain-and-ways-to-deal-with-it</li> </ul>","tags":["glusterfs","centos"]},{"location":"DevOps/2021-11-30-glusterfs-for-persistent-docker-volumes/","title":"GlusterFS for Persistent Docker Volumes","text":"","tags":["glusterfs","docker"]},{"location":"DevOps/2021-11-30-glusterfs-for-persistent-docker-volumes/#1-preparation","title":"1. Preparation","text":"","tags":["glusterfs","docker"]},{"location":"DevOps/2021-11-30-glusterfs-for-persistent-docker-volumes/#11-kvms","title":"1.1 KVMs","text":"<p>6 KVMs</p> Hostname vCPUs Memory Swap IP OS sudoer Data Storage gluster01 2 2G 0 192.168.122.191 CentOS 7 echo 100G, /data/brick1 gluster02 2 2G 0 192.168.122.192 CentOS 7 echo 100G, /data/brick1 gluster03 2 2G 0 192.168.122.193 CentOS 7 echo 100G, /data/brick1 minion01.k8s 2 8G 0 192.168.122.101 CentOS 7 echo minion02.k8s 2 8G 0 192.168.122.102 CentOS 7 echo minion03.k8s 2 8G 0 192.168.122.103 CentOS 7 echo swarm-nodes /etc/ansible/hosts<pre><code>[swarm-nodes]\nminion01.k8s\nminion02.k8s\nminion03.k8s\n</code></pre>","tags":["glusterfs","docker"]},{"location":"DevOps/2021-11-30-glusterfs-for-persistent-docker-volumes/#12-installing-glusterfs-and-docker-swarm","title":"1.2 Installing GlusterFS and docker swarm","text":"<p>For installing GlusterFS, please refer to  Install Glusterfs on Centos 7.</p> <p>For getting started with docker warm, please refer to Getting started with docker swarm mode.</p>","tags":["glusterfs","docker"]},{"location":"DevOps/2021-11-30-glusterfs-for-persistent-docker-volumes/#13-dns-via-hosts-file","title":"1.3 DNS via hosts file","text":"<p>From the host server</p> <pre><code>cat &lt;&lt;EOF &gt; /tmp/add-hosts.sh\ncat &lt;&lt;EEE &gt;&gt; /etc/hosts \n192.168.122.191 gluster01\n192.168.122.192 gluster02\n192.168.122.193 gluster03\nEEE\nEOF\n\nansible swarm-nodes -u echo -b -m script -a \"/tmp/add-hosts.sh\"\n</code></pre>","tags":["glusterfs","docker"]},{"location":"DevOps/2021-11-30-glusterfs-for-persistent-docker-volumes/#2-creating-a-glusterfs-volume","title":"2. Creating a GlusterFS volume","text":"","tags":["glusterfs","docker"]},{"location":"DevOps/2021-11-30-glusterfs-for-persistent-docker-volumes/#21-create-and-start-a-glusterfs-volume","title":"2.1 Create and start a GlusterFS volume","text":"<p>From the host server</p> <pre><code>ansible gluster -u echo -b -m shell -a 'mkdir -p /data/brick1/gfs'\n</code></pre> <p>From <code>gluster01</code></p> <p>Create and start the replicated volume <code>gfs</code>:</p> <pre><code>sudo gluster volume create gfs replica 3 \\\n gluster01:/data/brick1/gfs \\\n gluster02:/data/brick1/gfs \\\n gluster03:/data/brick1/gfs\n\nsudo gluster volume start gfs\n\nsudo gluster volume info gfs\n</code></pre>","tags":["glusterfs","docker"]},{"location":"DevOps/2021-11-30-glusterfs-for-persistent-docker-volumes/#22-mount-the-gfs-volume-locally","title":"2.2 Mount the <code>gfs</code> volume locally","text":"<p>On all Gluster hosts, mount the <code>gfs</code> volume locally.</p> <p>From the host server</p> <pre><code>cat &lt;&lt;EOF &gt; /tmp/mount-gfs.sh\nmkdir -p /mnt/gfs\n\necho 'localhost:/gfs /mnt/gfs glusterfs defaults,_netdev 0 0' &gt;&gt; /etc/fstab\nmount -a\nEOF\n\nansible gluster -u echo -b -m script -a '/tmp/mount-gfs.sh'\n\n\ncat &lt;&lt;EOF &gt; /tmp/fix-mount.sh\nmkdir -p /usr/local/sbin\n\ncat &lt;&lt;EEE &gt; /usr/local/sbin/check-gfs.sh\n#!/bin/sh\nwhile true; do\n  df | grep /mnt/gfs &gt; /dev/null\n  if [[ \\\\\\$? -eq 0 ]]; then\n    exit 0\n  fi\n\n  sleep 3\n  mount -a -t glusterfs\ndone  \nEEE\n\nchmod +x /usr/local/sbin/check-gfs.sh\n\ncat &lt;&lt;EEE &gt; /etc/systemd/system/glusterfsmounts.service \n[Unit]\nDescription=Glustermounting\nRequires=glusterd.service\n\n[Service]\nType=simple\nRemainAfterExit=true\nExecStartPre=/usr/sbin/gluster volume status gfs\nExecStart=/usr/local/sbin/check-gfs.sh\nRestart=on-failure\nRestartSec=3\n\n[Install]\nWantedBy=multi-user.target\nEEE\n\nsystemctl daemon-reload\nsystemctl enable glusterfsmounts\nEOF\n\nansible gluster -u echo -b -m script -a '/tmp/fix-mount.sh'\n</code></pre> <p>On gluser01 server</p> <pre><code>$ df -h |grep gfs\nlocalhost:/gfs           100G  1.1G   99G    2% /mnt/gfs\n</code></pre>","tags":["glusterfs","docker"]},{"location":"DevOps/2021-11-30-glusterfs-for-persistent-docker-volumes/#3-install-the-glusterfs-volume-plugin-for-docker","title":"3. Install the GlusterFS volume plugin for Docker","text":"<p>The GlusterFS plugin for Docker must be installed across all Swarm nodes, one by one.</p> <pre><code>cat &lt;&lt;EOF &gt; /tmp/gfs-plugin.sh\ndocker plugin install --alias glusterfs \\\n  mochoa/glusterfs-volume-plugin \\\n  --grant-all-permissions --disable\n\ndocker plugin set glusterfs SERVERS=gluster01,gluster02,gluster03\ndocker plugin enable glusterfs\nEOF\n\nansible swarm-nodes -u echo -b -m script -a '/tmp/gfs-plugin.sh' \n</code></pre>","tags":["glusterfs","docker"]},{"location":"DevOps/2021-11-30-glusterfs-for-persistent-docker-volumes/#4-deploy-a-stack-consisting-of-1-simple-service-with-a-glusterfs-volume","title":"4. Deploy a stack consisting of 1 simple service with a GlusterFS volume","text":"","tags":["glusterfs","docker"]},{"location":"DevOps/2021-11-30-glusterfs-for-persistent-docker-volumes/#41-create-a-subdiectory-at-the-root-of-the-glusterfs-volume","title":"4.1 Create a subdiectory at the root of the GlusterFS volume","text":"<p>From <code>gluster01</code> server, create a subdirectory named <code>vol1</code> at the root of the GlusterFS volume.</p> <pre><code>sudo mkdir -p /mnt/gfs/vol1\n</code></pre>","tags":["glusterfs","docker"]},{"location":"DevOps/2021-11-30-glusterfs-for-persistent-docker-volumes/#42-deploy-a-stack","title":"4.2 Deploy a stack","text":"<p>From any Swarm node, create a stack file named <code>docker-compose.yml</code>.</p> <pre><code>cat &lt;&lt;EOF &gt; docker-compose.yml\nversion: \"3.7\"\n\nservices:\n  foo:\n    image: alpine\n    command: ping localhost\n    networks:\n      - net\n    volumes:\n      - vol1:/tmp\n\nnetworks:\n  net:\n    driver: overlay\n\nvolumes:\n  vol1:\n    driver: glusterfs\n    name: \"gfs/vol1\"\nEOF\n</code></pre> <p>Deploy the stack.</p> <pre><code>$ sudo docker stack deploy -c docker-compose.yml test\nCreating network test_net\nCreating service test_foo\n</code></pre> <p>Check the stack.</p> <pre><code>$ sudo docker stack list\nNAME                SERVICES            ORCHESTRATOR\ntest                1                   Swarm\n\n$ sudo docker stack services test\nID                  NAME                MODE                REPLICAS            IMAGE               PORTS\nzer9ypz8ghqo        test_foo            replicated          1/1                 alpine:latest       \n</code></pre>","tags":["glusterfs","docker"]},{"location":"DevOps/2021-11-30-glusterfs-for-persistent-docker-volumes/#43-write-some-test-data-to-the-docker-volume-backed-by-glusterfs","title":"4.3 Write some test data to the docker volume backed by GlusterFS","text":"<ul> <li>STEP1. Find out which of the Swarm nodes the <code>test_foo</code> service is running on.</li> </ul> <pre><code>$ sudo docker service ps test_foo\nID                  NAME                IMAGE               NODE           DESIRED STATE       CURRENT STATE           ERROR               PORTS\nbeqjzsj3yznd        test_foo.1          alpine:latest       minion01.k8s   Running             Running 5 minutes ago         \n</code></pre> <ul> <li>STEP2. Switch to the terminal for that Swarm node and find the container ID of the <code>test_foo</code> service.</li> </ul> <pre><code>container_id=$(sudo docker ps | grep test_foo | awk '{print $1}')\n</code></pre> <ul> <li>STEP3. Exec into the container\u2019s <code>/bin/sh</code> shell.</li> </ul> <pre><code>sudo docker exec -it $container_id /bin/sh\n</code></pre> <ul> <li>STEP4. Write some test data to <code>/tmp</code></li> </ul> <p>Write 1G of test data to <code>/tmp</code>.</p> <pre><code>/ # echo 'dd if=/dev/zero of=/tmp/test.bin bs=1024k count=1000' &gt; test.sh\n/ # time sh test.sh\n1000+0 records in\n1000+0 records out\nreal    0m 3.35s\nuser    0m 0.00s\nsys 0m 1.02s\n</code></pre> <p>From any Gluster server (e.g. <code>gluster01</code>), list out the test data.</p> <pre><code>$ ls -lh /mnt/gfs/vol1/\n-rw-r--r--. 1 root root 1000M Nov 30 12:26 test.bin\n</code></pre>","tags":["glusterfs","docker"]},{"location":"DevOps/2021-11-30-glusterfs-for-persistent-docker-volumes/#reference","title":"Reference","text":"<ul> <li>Install Glusterfs on Centos 7</li> <li>Getting started with docker swarm mode</li> <li>autoize.com/glusterfs-for-persistent-docker-volumes</li> <li>github.com/marcelo-ochoa/docker-volume-plugins</li> <li>serverfault.com/questions/800494/glusterfs-mount-on-boot-on-clustered-servers-rhel-7</li> </ul>","tags":["glusterfs","docker"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/","title":"Install Kubernetes (k8s) v1.23 Cluster on Ubuntu 18.04 LTS","text":"","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#1-preparation","title":"1. Preparation","text":"","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#11-vms-vagrant","title":"1.1 VMs (Vagrant)","text":"<p>4 VMs </p> Hostname vCPUs Memory Swap IP OS sudoer master01 2 8G 0 192.168.56.200 CentOS 7 vagrant minion01 2 8G 0 192.168.56.101 CentOS 7 vagrant minion02 2 8G 0 192.168.56.102 CentOS 7 vagrant minion03 2 8G 0 192.168.56.103 CentOS 7 vagrant /etc/hosts /etc/hosts<pre><code>192.168.56.200 master01\n\n192.168.56.101 minion01\n192.168.56.102 minion02\n192.168.56.103 minion03\n\n192.168.10.200 k8s-cluster\n</code></pre> <pre><code>$ vagrant status\nCurrent machine states:\n\nmaster01                  running (virtualbox)\nminion01                  running (virtualbox)\nminion02                  running (virtualbox)\nminion03                  running (virtualbox)\n</code></pre> Vagrantfile Vagrantfile<pre><code>Vagrant.configure(\"2\") do |config|\n\n  config.vm.provider :libvirt do |libvirt|\n    libvirt.cpu_mode = \"host-passthrough\"\n    libvirt.cpus = 2\n    libvirt.disk_bus = \"virtio\"\n    libvirt.disk_driver :cache =&gt; \"writeback\"\n    libvirt.driver = \"kvm\"\n    libvirt.memory = 8192\n    libvirt.memorybacking :access, :mode =&gt; \"shared\"\n    libvirt.nested = true\n    libvirt.nic_model_type = \"virtio\"\n    libvirt.storage :file, bus: \"virtio\", cache: \"writeback\"\n    libvirt.video_type = \"virtio\"\n  end\n\n  config.vm.provider :virtualbox do |virtualbox|\n    virtualbox.cpus = 2\n    virtualbox.memory = 8192\n    virtualbox.customize [\"modifyvm\", :id, \"--cpu-profile\", \"host\"]\n    virtualbox.customize [\"modifyvm\", :id, \"--nested-hw-virt\", \"on\"]\n  end\n\n\n  config.vm.define \"master01\" do |master01|\n    master01.vm.hostname = \"master01\"\n    master01.vm.box = \"hashicorp/bionic64\"\n    master01.vm.network \"private_network\", ip: \"192.168.56.200\"\n    master01.vm.provider \"virtualbox\" do |vb|\n      vb.customize ['modifyvm', :id, '--natnet1', '20.0.51.0/24']\n    end\n  end\n\n  config.vm.define \"minion01\" do |minion01|\n    minion01.vm.hostname = \"minion01\"\n    minion01.vm.box = \"hashicorp/bionic64\"\n    minion01.vm.network \"private_network\", ip: \"192.168.56.101\"\n    minion01.vm.provider \"virtualbox\" do |vb|\n      vb.customize ['modifyvm', :id, '--natnet1', '20.0.52.0/24']\n    end\n  end\n\n  config.vm.define \"minion02\" do |minion02|\n    minion02.vm.hostname = \"minion02\"\n    minion02.vm.box = \"hashicorp/bionic64\"\n    minion02.vm.network \"private_network\", ip: \"192.168.56.102\"\n    minion02.vm.provider \"virtualbox\" do |vb|\n      vb.customize ['modifyvm', :id, '--natnet1', '20.0.53.0/24']\n    end\n  end\n\n  config.vm.define \"minion03\" do |minion03|\n    minion03.vm.hostname = \"minion03\"\n    minion03.vm.box = \"hashicorp/bionic64\"\n    minion03.vm.network \"private_network\", ip: \"192.168.56.103\"\n    minion03.vm.provider \"virtualbox\" do |vb|\n      vb.customize ['modifyvm', :id, '--natnet1', '20.0.54.0/24']\n    end\n  end\n\nend\n</code></pre> <p>Please refer to Introduction to Vagrant for more information about Vagrant.</p>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#12-ssh-config","title":"1.2 SSH config","text":"<pre><code>vagrant ssh-config | tee -a ~/.ssh/config\n</code></pre> <p>Create a script <code>foreach-node.sh</code>.</p> foreach-node.sh foreach-node.sh<pre><code>#/bin/sh\nNODES=\"master01 minion01 minion02 minion03\"\nCMD=\"exec\"\n\nif [[ \"$1\" == \"-h\" ]]; then\n  echo \"$0 -n [NODES] -m [exec|script] [command_or_scriptfile]\"\n  exit 0\nfi\n\nwhile [[ $# &gt; 0 ]]; do\n  if [[ \"$1\" == \"-n\" ]]; then\n    NODES=\"$2\"\n    shift 2\n  elif [[ \"$1\" == \"-m\" ]]; then\n    CMD=\"$2\"\n    shift 2\n  else\n    break\n  fi\ndone\n\nSUBCMD=\"$*\" \n\nif [[ -z \"$SUBCMD\" ]]; then\n  SUBCMD=\"echo OK\"\nfi\n\nfor node in $NODES; do\n  if [[ \"$CMD\" == \"exec\" ]]; then\n    echo -n \"$node \"\n    ssh $node $SUBCMD\n  elif [[ \"$CMD\" == \"script\" ]]; then\n    echo \"$node ...\"\n    if [[ ! -f $SUBCMD ]]; then\n      echo \"$SUBCMD not exists\"\n      exit 1\n    fi  \n    scp $SUBCMD $node:/tmp/a.sh\n    ssh $node \"chmod +x /tmp/a.sh &amp;&amp; sudo /tmp/a.sh\" \n  fi\ndone\n</code></pre> <pre><code>chmod +x foreach-node.sh\n# have a check\n./foreach-node.sh\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#13-dns-via-hosts-file","title":"1.3 DNS via hosts file","text":"<pre><code>cat &lt;&lt;EOF &gt; /tmp/add-hosts.sh\ncat &lt;&lt;EEE &gt;&gt; /etc/hosts \n192.168.56.200 master01\n\n192.168.56.101 minion01\n192.168.56.102 minion02\n192.168.56.103 minion03\n\n192.168.56.200 k8s-cluster\nEEE\nEOF\n\n./foreach-node.sh \"sudo sed -ie s/127.0.2.1/#127.0.2.1/ /etc/hosts\"\n./foreach-node.sh -m script /tmp/add-hosts.sh\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#2-basic-configurations-for-servers","title":"2. Basic configurations for servers","text":"","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#21-check-firewall-configuration","title":"2.1 Check firewall configuration","text":"<pre><code>$ ./foreach-node.sh sudo ufw status\nmaster01 Status: inactive\nminion01 Status: inactive\nminion02 Status: inactive\nminion03 Status: inactive\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#22-set-selinux-in-permissive-mode-effectively-disabling-it","title":"2.2 Set SELinux in permissive mode (effectively disabling it)","text":"<pre><code>$ ./foreach-node.sh 'sudo sestatus' \nmaster01 sudo: sestatus: command not found\nminion01 sudo: sestatus: command not found\nminion02 sudo: sestatus: command not found\nminion03 sudo: sestatus: command not found\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#23-disable-swap","title":"2.3 Disable swap","text":"<p>You MUST disable swap in order for the kubelet to work properly.</p> <pre><code>./foreach-node.sh sudo swapoff -a\n./foreach-node.sh 'sudo sed -ie \"s:/dev/disk/by-uuid/\\(.*\\) none swap sw 0 0:#/dev/disk/by-uuid/\\1 none swap sw 0 0:\" /etc/fstab'\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#24-verify-the-mac-address-and-product_uuid-are-unique-for-every-node","title":"2.4 Verify the MAC address and product_uuid are unique for every node","text":"<pre><code>./foreach-node.sh 'ip link | grep link/ether'\n./foreach-node.sh sudo cat /sys/class/dmi/id/product_uuid\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#25-letting-iptables-see-bridged-traffic","title":"2.5 Letting iptables see bridged traffic","text":"<pre><code># Make sure that the br_netfilter module is loaded\n./foreach-node.sh 'lsmod | grep br_netfilter'\n\n# To load it explicitly\n./foreach-node.sh 'sudo modprobe br_netfilter'\n\n# Ensure net.bridge.bridge-nf-call-iptables is set to 1 in your sysctl config\ncat &lt;&lt;EEE &gt; /tmp/ensure-bridge-nf.sh\ncat &lt;&lt;EOF | sudo tee /etc/modules-load.d/k8s.conf\nbr_netfilter\nEOF\n\ncat &lt;&lt;EOF | sudo tee /etc/sysctl.d/k8s.conf\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.bridge.bridge-nf-call-iptables = 1\nEOF\nsudo sysctl --system\nEEE\n\n./foreach-node.sh -m script /tmp/ensure-bridge-nf.sh\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#26-sysctl-for-kvm","title":"2.6 Sysctl for KVM","text":"<pre><code>cat &lt;&lt;EEE &gt; /tmp/set-sysctl.sh\ncat &lt;&lt;EOF | sudo tee /etc/sysctl.d/kvm.conf\nnet.ipv4.conf.default.rp_filter=0\nnet.ipv4.conf.all.rp_filter=0\nnet.ipv4.conf.all.proxy_arp = 1\nEOF\nsudo sysctl --system\nEEE\n\n./foreach-node.sh -m script /tmp/set-sysctl.sh\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#3-install-docker-ce-as-the-container-runtime","title":"3. Install docker-ce as the container runtime","text":"","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#31-install-docker-engine","title":"3.1 Install Docker Engine","text":"<pre><code>cat &lt;&lt;EOF &gt; /tmp/install-docker.sh\n##Set up the repository\nsudo apt-get update\nsudo apt-get install -y \\\n    ca-certificates \\\n    curl \\\n    gnupg \\\n    lsb-release\n\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg\necho \\\n  \"deb [arch=\\$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \\\n  \\$(lsb_release -cs) stable\" | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null\n\n\n##Install Docker Engine\nsudo apt-get update\nsudo apt-get install -y docker-ce docker-ce-cli containerd.io\nEOF\n\n./foreach-node.sh -m script /tmp/install-docker.sh\n</code></pre> <pre><code>cat &lt;&lt;EOF &gt; /tmp/patch.sh\nmkdir -p /etc/docker/\nmkdir -p /etc/systemd/system/docker.service.d\n\ncat &gt; /etc/docker/daemon.json &lt;&lt;EEE\n{\n  \"exec-opts\": [\"native.cgroupdriver=systemd\"],\n  \"log-driver\": \"json-file\",\n  \"log-opts\": {\n    \"max-size\": \"100m\"\n  },\n  \"storage-driver\": \"overlay2\",\n  \"storage-opts\": [\n    \"overlay2.override_kernel_check=true\"\n  ]\n}\nEEE\n\n# Restart docker.\nsystemctl daemon-reload\nsystemctl restart docker\nEOF\n\n./foreach-node.sh -m script /tmp/patch.sh\n</code></pre> <p>See:  - https://github.com/schoolofdevops/kubernetes-labguide/issues/10 - https://docs.docker.com/engine/install/ubuntu/</p>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#32-verify-that-docker-engine-is-installed-correctly","title":"3.2 Verify that Docker Engine is installed correctly","text":"<p>Running the hello-world image.</p> <pre><code>./foreach-node.sh sudo docker run hello-world\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#4-install-kubeadm-kubelet-and-kubectl","title":"4. Install kubeadm, kubelet and kubectl","text":"<p>NOTE: Use your own url for <code>apt-key.gpg</code> and apt repository</p> <pre><code>cat &lt;&lt;EEE &gt; /tmp/install-kubeadm.sh \nsudo apt-get update\nsudo apt-get install -y apt-transport-https ca-certificates curl\n\nsudo curl -fsSLo /usr/share/keyrings/kubernetes-archive-keyring.gpg https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg\n\n# Add the Kubernetes apt repository\necho \"deb [signed-by=/usr/share/keyrings/kubernetes-archive-keyring.gpg] https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main\" | sudo tee /etc/apt/sources.list.d/kubernetes.list\n\n# Install kubelet, kubeadm and kubectl, and pin their version\nsudo apt-get update\nsudo apt-get install -y kubelet kubeadm kubectl\nsudo apt-mark hold kubelet kubeadm kubectl\nEEE\n\n./foreach-node.sh -m script /tmp/install-kubeadm.sh\n</code></pre> <p>Check kubeadm version</p> <pre><code>$ ./foreach-node.sh 'kubeadm version | awk -F, \"{print \\$3}\"' \nmaster01  GitVersion:\"v1.23.6\"\nminion01  GitVersion:\"v1.23.6\"\nminion02  GitVersion:\"v1.23.6\"\nminion03  GitVersion:\"v1.23.6\"\n</code></pre> <p>See: https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/</p>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#5-creating-k8s-cluster-with-kubeadm","title":"5. Creating k8s cluster with kubeadm","text":"<p>Ping k8s-cluster</p> <pre><code>./foreach-node.sh ping k8s-cluster -c 1\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#51-pull-images","title":"5.1 Pull images","text":"<p>Pull the following images:</p> <pre><code>$ sudo kubeadm config images list\nk8s.gcr.io/kube-apiserver:v1.23.6\nk8s.gcr.io/kube-controller-manager:v1.23.6\nk8s.gcr.io/kube-scheduler:v1.23.6\nk8s.gcr.io/kube-proxy:v1.23.6\nk8s.gcr.io/pause:3.6\nk8s.gcr.io/etcd:3.5.1-0\nk8s.gcr.io/coredns/coredns:v1.8.6\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#52-init-cluster-on-master01","title":"5.2 Init cluster on master01","text":"<p>For flannel pod network (see 5.4),  the argument <code>--pod-network-cidr=10.244.0.0/16</code> should be provided.</p> <pre><code>sudo kubeadm init \\\n  --control-plane-endpoint \"k8s-cluster:6443\" \\\n  --apiserver-advertise-address \"192.168.56.200\" \\\n  --pod-network-cidr=10.244.0.0/16\n</code></pre> Output <pre><code>[init] Using Kubernetes version: v1.23.6\n[preflight] Running pre-flight checks\n[preflight] Pulling images required for setting up a Kubernetes cluster\n[preflight] This might take a minute or two, depending on the speed of your internet connection\n[preflight] You can also perform this action in beforehand using 'kubeadm config images pull'\n[certs] Using certificateDir folder \"/etc/kubernetes/pki\"\n[certs] Generating \"ca\" certificate and key\n[certs] Generating \"apiserver\" certificate and key\n[certs] apiserver serving cert is signed for DNS names [k8s-cluster kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local master01] and IPs [10.96.0.1 192.168.56.200]\n[certs] Generating \"apiserver-kubelet-client\" certificate and key\n[certs] Generating \"front-proxy-ca\" certificate and key\n[certs] Generating \"front-proxy-client\" certificate and key\n[certs] Generating \"etcd/ca\" certificate and key\n[certs] Generating \"etcd/server\" certificate and key\n[certs] etcd/server serving cert is signed for DNS names [localhost master01] and IPs [192.168.56.200 127.0.0.1 ::1]\n[certs] Generating \"etcd/peer\" certificate and key\n[certs] etcd/peer serving cert is signed for DNS names [localhost master01] and IPs [192.168.56.200 127.0.0.1 ::1]\n[certs] Generating \"etcd/healthcheck-client\" certificate and key\n[certs] Generating \"apiserver-etcd-client\" certificate and key\n[certs] Generating \"sa\" key and public key\n[kubeconfig] Using kubeconfig folder \"/etc/kubernetes\"\n[kubeconfig] Writing \"admin.conf\" kubeconfig file\n[kubeconfig] Writing \"kubelet.conf\" kubeconfig file\n[kubeconfig] Writing \"controller-manager.conf\" kubeconfig file\n[kubeconfig] Writing \"scheduler.conf\" kubeconfig file\n[kubelet-start] Writing kubelet environment file with flags to file \"/var/lib/kubelet/kubeadm-flags.env\"\n[kubelet-start] Writing kubelet configuration to file \"/var/lib/kubelet/config.yaml\"\n[kubelet-start] Starting the kubelet\n[control-plane] Using manifest folder \"/etc/kubernetes/manifests\"\n[control-plane] Creating static Pod manifest for \"kube-apiserver\"\n[control-plane] Creating static Pod manifest for \"kube-controller-manager\"\n[control-plane] Creating static Pod manifest for \"kube-scheduler\"\n[etcd] Creating static Pod manifest for local etcd in \"/etc/kubernetes/manifests\"\n[wait-control-plane] Waiting for the kubelet to boot up the control plane as static Pods from directory \"/etc/kubernetes/manifests\". This can take up to 4m0s\n[apiclient] All control plane components are healthy after 5.001770 seconds\n[upload-config] Storing the configuration used in ConfigMap \"kubeadm-config\" in the \"kube-system\" Namespace\n[kubelet] Creating a ConfigMap \"kubelet-config-1.23\" in namespace kube-system with the configuration for the kubelets in the cluster\nNOTE: The \"kubelet-config-1.23\" naming of the kubelet ConfigMap is deprecated. Once the UnversionedKubeletConfigMap feature gate graduates to Beta the default name will become just \"kubelet-config\". Kubeadm upgrade will handle this transition transparently.\n[upload-certs] Skipping phase. Please see --upload-certs\n[mark-control-plane] Marking the node master01 as control-plane by adding the labels: [node-role.kubernetes.io/master(deprecated) node-role.kubernetes.io/control-plane node.kubernetes.io/exclude-from-external-load-balancers]\n[mark-control-plane] Marking the node master01 as control-plane by adding the taints [node-role.kubernetes.io/master:NoSchedule]\n[bootstrap-token] Using token: eu2pzh.mbow7h16pv2bnl4i\n[bootstrap-token] Configuring bootstrap tokens, cluster-info ConfigMap, RBAC Roles\n[bootstrap-token] configured RBAC rules to allow Node Bootstrap tokens to get nodes\n[bootstrap-token] configured RBAC rules to allow Node Bootstrap tokens to post CSRs in order for nodes to get long term certificate credentials\n[bootstrap-token] configured RBAC rules to allow the csrapprover controller automatically approve CSRs from a Node Bootstrap Token\n[bootstrap-token] configured RBAC rules to allow certificate rotation for all node client certificates in the cluster\n[bootstrap-token] Creating the \"cluster-info\" ConfigMap in the \"kube-public\" namespace\n[kubelet-finalize] Updating \"/etc/kubernetes/kubelet.conf\" to point to a rotatable kubelet client certificate and key\n[addons] Applied essential addon: CoreDNS\n[addons] Applied essential addon: kube-proxy\n\nYour Kubernetes control-plane has initialized successfully!\n\nTo start using your cluster, you need to run the following as a regular user:\n\n  mkdir -p $HOME/.kube\n  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\n  sudo chown $(id -u):$(id -g) $HOME/.kube/config\n\nAlternatively, if you are the root user, you can run:\n\n  export KUBECONFIG=/etc/kubernetes/admin.conf\n\nYou should now deploy a pod network to the cluster.\nRun \"kubectl apply -f [podnetwork].yaml\" with one of the options listed at:\n  https://kubernetes.io/docs/concepts/cluster-administration/addons/\n\nYou can now join any number of control-plane nodes by copying certificate authorities\nand service account keys on each node and then running the following as root:\n\n  kubeadm join k8s-cluster:6443 --token eu2pzh.mbow7h16pv2bnl4i \\\n  --discovery-token-ca-cert-hash sha256:021b945cecea1f592acf107b27fc7aba098b58a4bba0295aa96118a13b81e19f \\\n  --control-plane \n\nThen you can join any number of worker nodes by running the following on each as root:\n\nkubeadm join k8s-cluster:6443 --token eu2pzh.mbow7h16pv2bnl4i \\\n  --discovery-token-ca-cert-hash sha256:021b945cecea1f592acf107b27fc7aba098b58a4bba0295aa96118a13b81e19f \n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#53-create-homekubeconfig-on-master01-or-any-server-with-kubectl-installed","title":"5.3 Create <code>$HOME/.kube/config</code> on master01 (or any server with kubectl installed)","text":"<pre><code>  mkdir -p $HOME/.kube\n  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\n  sudo chown $(id -u):$(id -g) $HOME/.kube/config\n</code></pre> <p>See also Install and Set Up kubectl on Linux</p>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#54-deploy-a-pod-network-flannel-to-the-cluster","title":"5.4 Deploy a pod network (flannel) to the cluster","text":"<p>On master01</p> <pre><code>kubectl apply -f https://raw.githubusercontent.com/flannel-io/flannel/v0.17.0/Documentation/kube-flannel.yml\n</code></pre> <p>Check cluster status</p> <pre><code>kubectl get pod -A\nkubectl get node\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#55-join-the-control-plane-node","title":"5.5 Join the control-plane node","text":"<p>(omit..) </p> <p>Please refer to the output of <code>kubeadm init</code> .</p> <p>See also Install Kubernetes (k8s) v1.22 Highly Available Clusters on CentOS 7</p>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#56-join-worker-nodes","title":"5.6 Join worker nodes","text":"<p>On minion01, minion02, minion03</p> <pre><code># e.g.\n./foreach-node.sh -n \"minion01 minion02 minion03\" \\\n  sudo kubeadm join k8s-cluster:6443 --token eu2pzh.mbow7h16pv2bnl4i \\\n    --discovery-token-ca-cert-hash sha256:021b945cecea1f592acf107b27fc7aba098b58a4bba0295aa96118a13b81e19f \n</code></pre> Output <pre><code>[preflight] Running pre-flight checks\n[preflight] Reading configuration from the cluster...\n[preflight] FYI: You can look at this config file with 'kubectl -n kube-system get cm kubeadm-config -o yaml'\nW0425 13:33:32.424506   24882 utils.go:69] The recommended value for \"resolvConf\" in \"KubeletConfiguration\" is: /run/systemd/resolve/resolv.conf; the provided value is: /run/systemd/resolve/resolv.conf\n[kubelet-start] Writing kubelet configuration to file \"/var/lib/kubelet/config.yaml\"\n[kubelet-start] Writing kubelet environment file with flags to file \"/var/lib/kubelet/kubeadm-flags.env\"\n[kubelet-start] Starting the kubelet\n[kubelet-start] Waiting for the kubelet to perform the TLS Bootstrap...\n\nThis node has joined the cluster:\n* Certificate signing request was sent to apiserver and a response was received.\n* The Kubelet was informed of the new secure connection details.\n\nRun 'kubectl get nodes' on the control-plane to see this node join the cluster.\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#57-check-the-cluster","title":"5.7 Check the cluster","text":"<p>On master01.k8s. Check the nodes</p> <pre><code>kubectl get nodes\n</code></pre> <p>Output:</p> <pre><code>NAME       STATUS   ROLES                  AGE    VERSION\nmaster01   Ready    control-plane,master   30m    v1.23.6\nminion01   Ready    &lt;none&gt;                 109s   v1.23.6\nminion02   Ready    &lt;none&gt;                 102s   v1.23.6\nminion03   Ready    &lt;none&gt;                 95s    v1.23.6\n</code></pre> <p>Check the pods</p> <pre><code>kubectl get pod -A\n</code></pre> <p>Output:</p> <pre><code>NAMESPACE     NAME                               READY   STATUS    RESTARTS   AGE\nkube-system   coredns-64897985d-cts4b            1/1     Running   0          30m\nkube-system   coredns-64897985d-fvqrg            1/1     Running   0          30m\nkube-system   etcd-master01                      1/1     Running   1          31m\nkube-system   kube-apiserver-master01            1/1     Running   1          31m\nkube-system   kube-controller-manager-master01   1/1     Running   1          31m\nkube-system   kube-flannel-ds-mm65t              1/1     Running   0          2m33s\nkube-system   kube-flannel-ds-sf85z              1/1     Running   0          2m26s\nkube-system   kube-flannel-ds-vr67h              1/1     Running   0          13m\nkube-system   kube-flannel-ds-xg8qb              1/1     Running   0          2m40s\nkube-system   kube-proxy-2xlqw                   1/1     Running   0          2m33s\nkube-system   kube-proxy-66n5q                   1/1     Running   0          30m\nkube-system   kube-proxy-vxv4c                   1/1     Running   0          2m40s\nkube-system   kube-proxy-wvvgs                   1/1     Running   0          2m26s\nkube-system   kube-scheduler-master01            1/1     Running   1          31m\n</code></pre> <p>Cluster Info</p> <pre><code>kubectl cluster-info\n</code></pre> <p>Output:</p> <pre><code>Kubernetes control plane is running at https://k8s-cluster:6443\nCoreDNS is running at https://k8s-cluster:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy\n\nTo further debug and diagnose cluster problems, use 'kubectl cluster-info dump'.\n</code></pre>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#58-no-route-to-host","title":"5.8 \"No route to host\"","text":"<p>If you met \"No route to host\" in the k8s cluster, try to fix the route as below, and then redeploy the flannel pod network.</p> <pre><code>./foreach-node.sh -n master01 \\\n'sudo ip route del default ; sudo ip route add default via 192.168.56.200 dev eth1'\n\n./foreach-node.sh -n minion01 \\\n'sudo ip route del default ; sudo ip route add default via 192.168.56.101 dev eth1'\n\n./foreach-node.sh -n minion02 \\\n'sudo ip route del default ; sudo ip route add default via 192.168.56.102 dev eth1'\n\n./foreach-node.sh -n minion03 \\\n'sudo ip route del default ; sudo ip route add default via 192.168.56.103 dev eth1'\n\n./foreach-node.sh ip route\n</code></pre> <p>Reset the IP route.</p> <pre><code>./foreach-node.sh -n master01 \\\n'sudo ip route del default ; sudo ip route add default via 20.0.51.2 dev eth0 proto dhcp src 20.0.51.15 metric 100'\n\n./foreach-node.sh -n minion01 \\\n'sudo ip route del default ; sudo ip route add default via 20.0.52.2 dev eth0 proto dhcp src 20.0.52.15 metric 100'\n\n./foreach-node.sh -n minion02 \\\n'sudo ip route del default ; sudo ip route add default via 20.0.53.2 dev eth0 proto dhcp src 20.0.53.15 metric 100'\n\n./foreach-node.sh -n minion03 \\\n'sudo ip route del default ; sudo ip route add default via 20.0.54.2 dev eth0 proto dhcp src 20.0.54.15 metric 100'\n</code></pre> <p>See also: https://serverfault.com/questions/123553/how-to-set-the-preferred-network-interface-in-linux</p>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2022-04-25-install-k8s-1.23-cluster-on-ubuntu-18lts/#reference","title":"Reference","text":"<ul> <li>docs/setup/production-environment/tools/kubeadm/install-kubeadm</li> <li>docs/setup/production-environment/tools/kubeadm/high-availability</li> <li>docs/ha-considerations.md</li> <li>docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/#pod-network</li> <li>docs/concepts/cluster-administration/networking/</li> <li>github.com/flannel-io/flannel</li> <li>Pods cannot resolve DNS</li> </ul>","tags":["k8s","kubernetes","centos","cloudnative"]},{"location":"DevOps/2023-10-30-Serverless-Architectures/","title":"Serverless Architectures","text":"<p>Serverless architectures are application designs that incorporate third-party \u201cBackend as a Service\u201d (BaaS) services, and/or that include custom code run in managed, ephemeral containers on a \u201cFunctions as a Service\u201d (FaaS) platform. By using these ideas, and related ones like single-page applications, such architectures remove much of the need for a traditional always-on server component. Serverless architectures may benefit from significantly reduced operational cost, complexity, and engineering lead time, at a cost of increased reliance on vendor dependencies and comparatively immature supporting services.</p> <p>See more: https://martinfowler.com/articles/serverless.html</p>","tags":["\u67b6\u6784","Architecture","Serverless"]},{"location":"FRONTEND/2015-12-20-jquery%25e8%25a1%25a8%25e5%258d%2595%25e9%25aa%258c%25e8%25af%2581validate%25e6%258f%2592%25e4%25bb%25b6%25e5%2585%25a8%25e6%2594%25bb%25e7%2595%25a5.html/","title":"jquery\u8868\u5355\u9a8c\u8bc1validate\u63d2\u4ef6\u5168\u653b\u7565","text":"\u4e00\u3001\u51c6\u5907\u5de5\u4f5c \u9700\u8981JQuery\u7248\u672c\uff1a1.2.6+, \u517c\u5bb9 1.3.2 \u4e8c\u3001\u9ed8\u8ba4\u6821\u9a8c\u89c4\u5219 (1)required:true\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u5fc5\u8f93\u5b57\u6bb5 (2)remote:\"check.php\"\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u4f7f\u7528ajax\u65b9\u6cd5\u8c03\u7528check.php\u9a8c\u8bc1\u8f93\u5165\u503c (3)email:true\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u5fc5\u987b\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u7535\u5b50\u90ae\u4ef6 (4)url:true\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u5fc5\u987b\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u7f51\u5740 (5)date:true\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u5fc5\u987b\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u65e5\u671f (6)dateISO:true\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u5fc5\u987b\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u65e5\u671f(ISO)\uff0c\u4f8b\u5982\uff1a2009-06-23\uff0c1998/01/22 \u53ea\u9a8c\u8bc1\u683c\u5f0f\uff0c\u4e0d\u9a8c\u8bc1\u6709\u6548\u6027 (7)number:true\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u5fc5\u987b\u8f93\u5165\u5408\u6cd5\u7684\u6570\u5b57(\u8d1f\u6570\uff0c\u5c0f\u6570) (8)digits:true\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u5fc5\u987b\u8f93\u5165\u6574\u6570 (9)creditcard:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u5fc5\u987b\u8f93\u5165\u5408\u6cd5\u7684\u4fe1\u7528\u5361\u53f7 (10)equalTo:\"#field\"\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u8f93\u5165\u503c\u5fc5\u987b\u548c#field\u76f8\u540c (11)accept:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u8f93\u5165\u62e5\u6709\u5408\u6cd5\u540e\u7f00\u540d\u7684\u5b57\u7b26\u4e32\uff08\u4e0a\u4f20\u6587\u4ef6\u7684\u540e\u7f00\uff09 (12)maxlength:5\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u8f93\u5165\u957f\u5ea6\u6700\u591a\u662f5\u7684\u5b57\u7b26\u4e32(\u6c49\u5b57\u7b97\u4e00\u4e2a\u5b57\u7b26) (13)minlength:10\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u8f93\u5165\u957f\u5ea6\u6700\u5c0f\u662f10\u7684\u5b57\u7b26\u4e32(\u6c49\u5b57\u7b97\u4e00\u4e2a\u5b57\u7b26) (14)rangelength:[5,10]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u8f93\u5165\u957f\u5ea6\u5fc5\u987b\u4ecb\u4e8e 5 \u548c 10 \u4e4b\u95f4\u7684\u5b57\u7b26\u4e32\")(\u6c49\u5b57\u7b97\u4e00\u4e2a\u5b57\u7b26) (15)range:[5,10]\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u8f93\u5165\u503c\u5fc5\u987b\u4ecb\u4e8e 5 \u548c 10 \u4e4b\u95f4 (16)max:5\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u8f93\u5165\u503c\u4e0d\u80fd\u5927\u4e8e5 (17)min:10\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u8f93\u5165\u503c\u4e0d\u80fd\u5c0f\u4e8e10 \u4e09\u3001\u9ed8\u8ba4\u7684\u63d0\u793a messages: { required: \"This field is required.\", remote: \"Please fix this field.\", email: \"Please enter a valid email address.\", url: \"Please enter a valid URL.\", date: \"Please enter a valid date.\", dateISO: \"Please enter a valid date (ISO).\", dateDE: \"Bitte geben Sie ein g\u7709ltiges Datum ein.\", number: \"Please enter a valid number.\", numberDE: \"Bitte geben Sie eine Nummer ein.\", digits: \"Please enter only digits\", creditcard: \"Please enter a valid credit card number.\", equalTo: \"Please enter the same value again.\", accept: \"Please enter a value with a valid extension.\", maxlength: $.validator.format(\"Please enter no more than {0} characters.\"), minlength: $.validator.format(\"Please enter at least {0} characters.\"), rangelength: $.validator.format(\"Please enter a value between {0} and {1} characters long.\"), range: $.validator.format(\"Please enter a value between {0} and {1}.\"), max: $.validator.format(\"Please enter a value less than or equal to {0}.\"), min: $.validator.format(\"Please enter a value greater than or equal to {0}.\") }, \u5982\u9700\u8981\u4fee\u6539\uff0c\u53ef\u5728js\u4ee3\u7801\u4e2d\u52a0\u5165\uff1a jQuery.extend(jQuery.validator.messages, { required: \"\u5fc5\u9009\u5b57\u6bb5\", remote: \"\u8bf7\u4fee\u6b63\u8be5\u5b57\u6bb5\", email: \"\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u7535\u5b50\u90ae\u4ef6\", url: \"\u8bf7\u8f93\u5165\u5408\u6cd5\u7684\u7f51\u5740\", date: \"\u8bf7\u8f93\u5165\u5408\u6cd5\u7684\u65e5\u671f\", dateISO: \"\u8bf7\u8f93\u5165\u5408\u6cd5\u7684\u65e5\u671f (ISO).\", number: \"\u8bf7\u8f93\u5165\u5408\u6cd5\u7684\u6570\u5b57\", digits: \"\u53ea\u80fd\u8f93\u5165\u6574\u6570\", creditcard: \"\u8bf7\u8f93\u5165\u5408\u6cd5\u7684\u4fe1\u7528\u5361\u53f7\", equalTo: \"\u8bf7\u518d\u6b21\u8f93\u5165\u76f8\u540c\u7684\u503c\", accept: \"\u8bf7\u8f93\u5165\u62e5\u6709\u5408\u6cd5\u540e\u7f00\u540d\u7684\u5b57\u7b26\u4e32\", maxlength: jQuery.validator.format(\"\u8bf7\u8f93\u5165\u4e00\u4e2a\u957f\u5ea6\u6700\u591a\u662f {0} \u7684\u5b57\u7b26\u4e32\"), minlength: jQuery.validator.format(\"\u8bf7\u8f93\u5165\u4e00\u4e2a\u957f\u5ea6\u6700\u5c11\u662f {0} \u7684\u5b57\u7b26\u4e32\"), rangelength: jQuery.validator.format(\"\u8bf7\u8f93\u5165\u4e00\u4e2a\u957f\u5ea6\u4ecb\u4e8e {0} \u548c {1} \u4e4b\u95f4\u7684\u5b57\u7b26\u4e32\"), range: jQuery.validator.format(\"\u8bf7\u8f93\u5165\u4e00\u4e2a\u4ecb\u4e8e {0} \u548c {1} \u4e4b\u95f4\u7684\u503c\"), max: jQuery.validator.format(\"\u8bf7\u8f93\u5165\u4e00\u4e2a\u6700\u5927\u4e3a {0} \u7684\u503c\"), min: jQuery.validator.format(\"\u8bf7\u8f93\u5165\u4e00\u4e2a\u6700\u5c0f\u4e3a {0} \u7684\u503c\") }); \u63a8\u8350\u505a\u6cd5\uff0c\u5c06\u6b64\u6587\u4ef6\u653e\u5165messages_cn.js\u4e2d\uff0c\u5728\u9875\u9762\u4e2d\u5f15\u5165 \u56db\u3001\u4f7f\u7528\u65b9\u5f0f 1.\u5c06\u6821\u9a8c\u89c4\u5219\u5199\u5230\u63a7\u4ef6\u4e2d $().ready(function() { $(\"#signupForm\").validate(); }); <p> Firstname </p> <p> E-Mail </p> <p> Password </p> <p> \u786e\u8ba4\u5bc6\u7801 </p> <p> </p> \u4f7f\u7528class=\"{}\"\u7684\u65b9\u5f0f\uff0c\u5fc5\u987b\u5f15\u5165\u5305\uff1ajquery.metadata.js \u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u7684\u65b9\u6cd5\uff0c\u4fee\u6539\u63d0\u793a\u5185\u5bb9\uff1a class=\"{required:true,minlength:5,messages:{required:'\u8bf7\u8f93\u5165\u5185\u5bb9'}}\" \u5728\u4f7f\u7528equalTo\u5173\u952e\u5b57\u65f6\uff0c\u540e\u9762\u7684\u5185\u5bb9\u5fc5\u987b\u52a0\u4e0a\u5f15\u53f7\uff0c\u5982\u4e0b\u4ee3\u7801\uff1a class=\"{required:true,minlength:5,equalTo:'#password'}\" \u53e6\u5916\u4e00\u4e2a\u65b9\u5f0f\uff0c\u4f7f\u7528\u5173\u952e\u5b57\uff1ameta\uff08\u4e3a\u4e86\u5143\u6570\u636e\u4f7f\u7528\u5176\u4ed6\u63d2\u4ef6\u4f60\u8981\u5305\u88c5 \u4f60\u7684\u9a8c\u8bc1\u89c4\u5219 \u5728\u4ed6\u4eec\u81ea\u5df1\u7684\u9879\u76ee\u4e2d\u53ef\u4ee5\u7528\u8fd9\u4e2a\u7279\u6b8a\u7684\u9009\u9879\uff09 Tell the validation plugin to look inside a validate-property in metadata for validation rules. \u4f8b\u5982\uff1a meta: \"validate\" \u518d\u6709\u4e00\u79cd\u65b9\u5f0f\uff1a $.metadata.setType(\"attr\", \"validate\"); \u8fd9\u6837\u53ef\u4ee5\u4f7f\u7528validate=\"{required:true}\"\u7684\u65b9\u5f0f\uff0c\u6216\u8005class=\"required\"\uff0c\u4f46class=\"{required:true,minlength:5}\"\u5c06\u4e0d\u8d77\u4f5c\u7528 2.\u5c06\u6821\u9a8c\u89c4\u5219\u5199\u5230\u4ee3\u7801\u4e2d $().ready(function() { $(\"#signupForm\").validate({ rules: { firstname: \"required\", email: { required: true, email: true }, password: { required: true, minlength: 5 }, confirm_password: { required: true, minlength: 5, equalTo: \"#password\" } }, messages: { firstname: \"\u8bf7\u8f93\u5165\u59d3\u540d\", email: { required: \"\u8bf7\u8f93\u5165Email\u5730\u5740\", email: \"\u8bf7\u8f93\u5165\u6b63\u786e\u7684email\u5730\u5740\" }, password: { required: \"\u8bf7\u8f93\u5165\u5bc6\u7801\", minlength: jQuery.format(\"\u5bc6\u7801\u4e0d\u80fd\u5c0f\u4e8e{0}\u4e2a\u5b57\u7b26\") }, confirm_password: { required: \"\u8bf7\u8f93\u5165\u786e\u8ba4\u5bc6\u7801\", minlength: \"\u786e\u8ba4\u5bc6\u7801\u4e0d\u80fd\u5c0f\u4e8e5\u4e2a\u5b57\u7b26\", equalTo: \"\u4e24\u6b21\u8f93\u5165\u5bc6\u7801\u4e0d\u4e00\u81f4\u4e0d\u4e00\u81f4\" } } }); }); //messages\u5904\uff0c\u5982\u679c\u67d0\u4e2a\u63a7\u4ef6\u6ca1\u6709message\uff0c\u5c06\u8c03\u7528\u9ed8\u8ba4\u7684\u4fe1\u606f <p> Firstname </p> <p> E-Mail </p> <p> Password </p> <p> \u786e\u8ba4\u5bc6\u7801 </p> <p> </p> required:true \u5fc5\u987b\u6709\u503c required:\"#aa:checked\"\u8868\u8fbe\u5f0f\u7684\u503c\u4e3a\u771f\uff0c\u5219\u9700\u8981\u9a8c\u8bc1 required:function(){}\u8fd4\u56de\u4e3a\u771f\uff0c\u8868\u65f6\u9700\u8981\u9a8c\u8bc1 \u540e\u8fb9\u4e24\u79cd\u5e38\u7528\u4e8e\uff0c\u8868\u5355\u4e2d\u9700\u8981\u540c\u65f6\u586b\u6216\u4e0d\u586b\u7684\u5143\u7d20 \u4e94\u3001\u5e38\u7528\u65b9\u6cd5\u53ca\u6ce8\u610f\u95ee\u9898 1.\u7528\u5176\u4ed6\u65b9\u5f0f\u66ff\u4ee3\u9ed8\u8ba4\u7684SUBMIT $().ready(function() { $(\"#signupForm\").validate({ submitHandler:function(form){ alert(\"submitted\"); form.submit(); } }); }); \u53ef\u4ee5\u8bbe\u7f6evalidate\u7684\u9ed8\u8ba4\u503c\uff0c\u5199\u6cd5\u5982\u4e0b\uff1a $.validator.setDefaults({ submitHandler: function(form) { alert(\"submitted!\");form.submit(); } }); \u5982\u679c\u60f3\u63d0\u4ea4\u8868\u5355, \u9700\u8981\u4f7f\u7528form.submit()\u800c\u4e0d\u8981\u4f7f\u7528$(form).submit() 2.debug\uff0c\u5982\u679c\u8fd9\u4e2a\u53c2\u6570\u4e3atrue\uff0c\u90a3\u4e48\u8868\u5355\u4e0d\u4f1a\u63d0\u4ea4\uff0c\u53ea\u8fdb\u884c\u68c0\u67e5\uff0c\u8c03\u8bd5\u65f6\u5341\u5206\u65b9\u4fbf $().ready(function() { $(\"#signupForm\").validate({ debug:true }); }); \u5982\u679c\u4e00\u4e2a\u9875\u9762\u4e2d\u6709\u591a\u4e2a\u8868\u5355\uff0c\u7528 $.validator.setDefaults({ debug: true }) 3.ignore\uff1a\u5ffd\u7565\u67d0\u4e9b\u5143\u7d20\u4e0d\u9a8c\u8bc1 ignore: \".ignore\" 4.errorPlacement\uff1aCallback\u00a0 Default: \u628a\u9519\u8bef\u4fe1\u606f\u653e\u5728\u9a8c\u8bc1\u7684\u5143\u7d20\u540e\u9762 \u6307\u660e\u9519\u8bef\u653e\u7f6e\u7684\u4f4d\u7f6e\uff0c\u9ed8\u8ba4\u60c5\u51b5\u662f\uff1aerror.appendTo(element.parent());\u5373\u628a\u9519\u8bef\u4fe1\u606f\u653e\u5728\u9a8c\u8bc1\u7684\u5143\u7d20\u540e\u9762 errorPlacement: function(error, element) { error.appendTo(element.parent()); } //\u793a\u4f8b\uff1a First Name 14/02/07 02/14/07 &amp;nbsp; I have read and accept the Terms of Use. errorPlacement: function(error, element) { if ( element.is(\":radio\") ) error.appendTo( element.parent().next().next() ); else if ( element.is(\":checkbox\") ) error.appendTo ( element.next() ); else error.appendTo( element.parent().next() ); } \u4ee3\u7801\u7684\u4f5c\u7528\u662f\uff1a\u4e00\u822c\u60c5\u51b5\u4e0b\u628a\u9519\u8bef\u4fe1\u606f\u663e\u793a\u5728  <p>\u4e2d\uff0c\u5982\u679c\u662fradio\u663e\u793a\u5728  <p>\u4e2d\uff0c\u5982\u679c\u662fcheckbox\u663e\u793a\u5728\u5185\u5bb9\u7684\u540e\u9762</p> errorClass\uff1aString\u00a0 Default: \"error\" \u6307\u5b9a\u9519\u8bef\u63d0\u793a\u7684css\u7c7b\u540d\uff0c\u53ef\u4ee5\u81ea\u5b9a\u4e49\u9519\u8bef\u63d0\u793a\u7684\u6837\u5f0f errorElement\uff1aString\u00a0 Default: \"label\" \u7528\u4ec0\u4e48\u6807\u7b7e\u6807\u8bb0\u9519\u8bef\uff0c\u9ed8\u8ba4\u7684\u662flabel\u4f60\u53ef\u4ee5\u6539\u6210em errorContainer\uff1aSelector \u663e\u793a\u6216\u8005\u9690\u85cf\u9a8c\u8bc1\u4fe1\u606f\uff0c\u53ef\u4ee5\u81ea\u52a8\u5b9e\u73b0\u6709\u9519\u8bef\u4fe1\u606f\u51fa\u73b0\u65f6\u628a\u5bb9\u5668\u5c5e\u6027\u53d8\u4e3a\u663e\u793a\uff0c\u65e0\u9519\u8bef\u65f6\u9690\u85cf\uff0c\u7528\u5904\u4e0d\u5927 errorContainer: \"#messageBox1, #messageBox2\" errorLabelContainer\uff1aSelector \u628a\u9519\u8bef\u4fe1\u606f\u7edf\u4e00\u653e\u5728\u4e00\u4e2a\u5bb9\u5668\u91cc\u9762\u3002 wrapper\uff1aString \u7528\u4ec0\u4e48\u6807\u7b7e\u518d\u628a\u4e0a\u8fb9\u7684errorELement\u5305\u8d77\u6765 \u4e00\u822c\u8fd9\u4e09\u4e2a\u5c5e\u6027\u540c\u65f6\u4f7f\u7528\uff0c\u5b9e\u73b0\u5728\u4e00\u4e2a\u5bb9\u5668\u5185\u663e\u793a\u6240\u6709\u9519\u8bef\u63d0\u793a\u7684\u529f\u80fd\uff0c\u5e76\u4e14\u6ca1\u6709\u4fe1\u606f\u65f6\u81ea\u52a8\u9690\u85cf errorContainer: \"div.error\", errorLabelContainer: $(\"#signupForm div.error\"), wrapper: \"li\" \u8bbe\u7f6e\u9519\u8bef\u63d0\u793a\u7684\u6837\u5f0f\uff0c\u53ef\u4ee5\u589e\u52a0\u56fe\u6807\u663e\u793a input.error { border: 1px solid red; } label.error { background:url(\"./demo/images/unchecked.gif\") no-repeat 0px 0px; \u00a0 padding-left: 16px; \u00a0 padding-bottom: 2px; \u00a0 font-weight: bold; \u00a0 color: #EA5200; } label.checked { background:url(\"./demo/images/checked.gif\") no-repeat 0px 0px; } success\uff1aString,Callback \u8981\u9a8c\u8bc1\u7684\u5143\u7d20\u901a\u8fc7\u9a8c\u8bc1\u540e\u7684\u52a8\u4f5c\uff0c\u5982\u679c\u8ddf\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u4f1a\u5f53\u505a\u4e00\u4e2acss\u7c7b\uff0c\u4e5f\u53ef\u8ddf\u4e00\u4e2a\u51fd\u6570 success: function(label) { // set &amp;nbsp; as text for IE label.html(\"&amp;nbsp;\").addClass(\"checked\"); //label.addClass(\"valid\").text(\"Ok!\") } \u6dfb\u52a0\"valid\" \u5230\u9a8c\u8bc1\u5143\u7d20, \u5728CSS\u4e2d\u5b9a\u4e49\u7684\u6837\u5f0f <p>success: \"valid\"</p> nsubmit\uff1a Boolean\u00a0 Default: true \u63d0\u4ea4\u65f6\u9a8c\u8bc1. \u8bbe\u7f6e\u552ffalse\u5c31\u7528\u5176\u4ed6\u65b9\u6cd5\u53bb\u9a8c\u8bc1 onfocusout\uff1aBoolean\u00a0 Default: true \u5931\u53bb\u7126\u70b9\u662f\u9a8c\u8bc1(\u4e0d\u5305\u62eccheckboxes/radio buttons) onkeyup\uff1aBoolean\u00a0 Default: true \u5728keyup\u65f6\u9a8c\u8bc1. onclick\uff1aBoolean\u00a0 Default: true \u5728checkboxes \u548c radio \u70b9\u51fb\u65f6\u9a8c\u8bc1 focusInvalid\uff1aBoolean\u00a0 Default: true \u63d0\u4ea4\u8868\u5355\u540e\uff0c\u672a\u901a\u8fc7\u9a8c\u8bc1\u7684\u8868\u5355(\u7b2c\u4e00\u4e2a\u6216\u63d0\u4ea4\u4e4b\u524d\u83b7\u5f97\u7126\u70b9\u7684\u672a\u901a\u8fc7\u9a8c\u8bc1\u7684\u8868\u5355)\u4f1a\u83b7\u5f97\u7126\u70b9 focusCleanup\uff1aBoolean\u00a0 Default: false \u5982\u679c\u662ftrue\u90a3\u4e48\u5f53\u672a\u901a\u8fc7\u9a8c\u8bc1\u7684\u5143\u7d20\u83b7\u5f97\u7126\u70b9\u65f6\uff0c\u79fb\u9664\u9519\u8bef\u63d0\u793a\u3002\u907f\u514d\u548c focusInvalid \u4e00\u8d77\u7528 // \u91cd\u7f6e\u8868\u5355 $().ready(function() { var validator = $(\"#signupForm\").validate({ submitHandler:function(form){ alert(\"submitted\"); form.submit(); } }); $(\"#reset\").click(function() { validator.resetForm(); }); }); remote\uff1aURL \u4f7f\u7528ajax\u65b9\u5f0f\u8fdb\u884c\u9a8c\u8bc1\uff0c\u9ed8\u8ba4\u4f1a\u63d0\u4ea4\u5f53\u524d\u9a8c\u8bc1\u7684\u503c\u5230\u8fdc\u7a0b\u5730\u5740\uff0c\u5982\u679c\u9700\u8981\u63d0\u4ea4\u5176\u4ed6\u7684\u503c\uff0c\u53ef\u4ee5\u4f7f\u7528data\u9009\u9879 remote: \"check-email.php\" remote: { url: \"check-email.php\",\u00a0\u00a0\u00a0\u00a0 //\u540e\u53f0\u5904\u7406\u7a0b\u5e8f type: \"post\",\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 //\u6570\u636e\u53d1\u9001\u65b9\u5f0f dataType: \"json\",\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 //\u63a5\u53d7\u6570\u636e\u683c\u5f0f data: {\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 //\u8981\u4f20\u9012\u7684\u6570\u636e username: function() { return $(\"#username\").val(); } } } \u8fdc\u7a0b\u5730\u5740\u53ea\u80fd\u8f93\u51fa \"true\" \u6216 \"false\"\uff0c\u4e0d\u80fd\u6709\u5176\u5b83\u8f93\u51fa addMethod\uff1aname, method, message \u81ea\u5b9a\u4e49\u9a8c\u8bc1\u65b9\u6cd5 // \u4e2d\u6587\u5b57\u4e24\u4e2a\u5b57\u8282 jQuery.validator.addMethod(\"byteRangeLength\", function(value, element, param) { var length = value.length; for(var i = 0; i &lt; value.length; i++){ if(value.charCodeAt(i) &gt; 127){ length++; } } return this.optional(element) || ( length &gt;= param[0] &amp;&amp; length &lt;= param[1] ); }, $.validator.format(\"\u8bf7\u786e\u4fdd\u8f93\u5165\u7684\u503c\u5728{0}-{1}\u4e2a\u5b57\u8282\u4e4b\u95f4(\u4e00\u4e2a\u4e2d\u6587\u5b57 \u6458\u81ea\u300ehttp://dcbjavaeye.iteye.com/blog/1125866\u300f","tags":["ui","jquery","validate"]},{"location":"FRONTEND/2022-10-23-articles-about-pwa-for-beginners/","title":"Articles about  SPA/PWA for beginners","text":"<p>Building a Single Page App without frameworks</p> <p>A Simple Progressive Web App Tutorial</p>","tags":["SPA","PWA","beginners","tutorial"]},{"location":"FRONTEND/2023-11-23-SPA-SEO/","title":"SPA SEO: A Single-Page App Guide","text":"","tags":["Frontend","SEO","SPA"]},{"location":"FRONTEND/2023-11-23-SPA-SEO/#digest","title":"Digest","text":"<p>You should at least use prerendering or server-side rendering to make SPA content easier to discover, understand, and index for search engines.</p> <p>That\u2019s the gist of it. There are other considerations, though, and this guide will cover most of them:</p> <ul> <li> <p>Fundamental SEO ranking factors (basics)</p> </li> <li> <p>Issues with single-page application SEO</p> </li> <li> <p>Best practices for SPA SEO in 2019</p> </li> <li> <p>Actionable tips and tools for React, Vue, and Angular SEO</p> </li> </ul> <p>SEO basics</p>","tags":["Frontend","SEO","SPA"]},{"location":"FRONTEND/2023-11-23-SPA-SEO/#discoverable-quality-content","title":"Discoverable, quality content","text":"","tags":["Frontend","SEO","SPA"]},{"location":"FRONTEND/2023-11-23-SPA-SEO/#meta-tags","title":"Meta tags","text":"<p>The following meta tags will help search engines better understand your content:</p> <ul> <li> <p>Meta content type\u2014declares your character set for the page.</p> </li> <li> <p>Viewport\u2014enhances mobile user experience.</p> </li> <li> <p>Title tag</p> <ul> <li> <p>Include 1 main keyword</p> </li> <li> <p>Keep it &lt; 70 characters</p> </li> <li> <p>Differentiate it from competing titles on SERP</p> </li> <li> <p>Always add your brand at the end (<code>[...]</code> - Your Brand)</p> </li> </ul> </li> <li> <p>Meta description</p> <ul> <li> <p>Include 1-2 main keywords</p> </li> <li> <p>Keep it &lt; 140 characters</p> </li> <li> <p>Include a call-to-action to click on the page</p> </li> <li> <p>Demonstrate you understand the searcher's intent (i.e. people who land on the SERP)</p> </li> </ul> </li> <li> <p>Social tags\u2014increases social shareability of content.</p> <ul> <li>Define at least Open Graph tags (Facebook) and Twitter Cards</li> </ul> </li> </ul>","tags":["Frontend","SEO","SPA"]},{"location":"FRONTEND/2023-11-23-SPA-SEO/#protips","title":"Protips","text":"<ul> <li> <p>Target keywords should appear in Title tag, URL, H1, and, with moderation, page content.</p> </li> <li> <p>Image titles and ALT tags should be descriptively named.</p> </li> <li> <p>Sitemap should always be defined\u2014the XML sitemap helps search bots understand and index your site.</p> </li> </ul>","tags":["Frontend","SEO","SPA"]},{"location":"FRONTEND/2023-11-23-SPA-SEO/#original","title":"Original","text":"<p>See: https://snipcart.com/blog/spa-seo</p>","tags":["Frontend","SEO","SPA"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/","title":"How to create a 2048 Game in Flutter","text":"","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#1-foreword","title":"1. Foreword","text":"<p>I want to develop a little game. It's amazing, right? Nowadays, we have several options for developing rich clients or apps. Cross-platform is an amazing feature that every developer dreams of, I guess. Among the multiple options, flutter and react-native stand out with no doubt. I chose Flutter as I am very familiar with Java which is similar to Dart, the programming language for Flutter. </p> <p>In this article, I'll show you how to develop a 2048 game in Flutter step by step.</p>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#2-introduction-to-2048","title":"2. Introduction to 2048","text":"<p>2048 is a popular sliding tile puzzle game. The rule is simple: each time you can swipe left, right, up, or down; try your best to get the tile with the number 2048.</p> <p></p>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#3-preparation","title":"3. Preparation","text":"<p>First, we need a computer, of course. It's a laptop for me. We also need to know enough about Dart programming language.</p> <p>Second, set up the development environment. Refer to Install Flutter.</p> <p>Third, choose your favorite IDE, I prefer <code>Visual Studio Code</code> (VSCode).</p>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#4-programming","title":"4. Programming","text":"","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#41-create-a-flutter-project","title":"4.1 Create a Flutter project","text":"<p>Open a terminal, use the following command to create the project</p> <pre><code>flutter create -e g2048\n</code></pre> <p>Here, <code>g2048</code> is the project name.</p> <p>We can also create it using VSCode. Go <code>View &gt; Command Palette</code>, type <code>flutter</code>, then click <code>Flutter: New Project</code>, and then click <code>Empty Application</code>. </p> <p>Now we have a <code>Hello World</code> app. Great! Run <code>flutter run</code> and we'll see it.</p>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#42-graphic-user-interface-gui","title":"4.2 Graphic User Interface (GUI)","text":"<p>We're going to implement a simple GUI like</p> <pre><code>2048  | Score\n          0\n -----------\n|           |               \n|   Board   |  \n|   (4x4)   |  \n|           |  \n -----------\n</code></pre> <p>Let's say it in Flutter language:</p> <p></p> <p></p> <p>For basic UI concepts of Flutter, please refer to Building user interfaces with Flutter.</p>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#421-libsrcstatus_panedart-draft","title":"4.2.1 lib/src/status_pane.dart (draft)","text":"<p>Let's create the first Widget <code>StatusPane</code> which is stateless.</p> <pre><code>import 'package:flutter/material.dart';\n\nclass StatusPane extends StatelessWidget {\n  const StatusPane({\n    super.key,\n  });\n\n  @override\n  Widget build(BuildContext context) {\n    var theme = Theme.of(context).textTheme;\n    return Row(\n      mainAxisAlignment: MainAxisAlignment.spaceAround,\n      children: [\n        Text('2048', style: _textStyle(theme.displayLarge!)),\n        Column(\n          children: [\n            Text('SCORE', style: _textStyle(theme.bodyMedium!)),\n            // TODO score\n            Text('0', style: _textStyle(theme.displayMedium!)),\n          ],\n        ),\n      ],\n    );\n  }\n\n  TextStyle _textStyle(TextStyle style) {\n    return style.copyWith(\n      color: Colors.brown,\n      fontWeight: FontWeight.bold,\n    );\n  }\n}\n</code></pre>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#422-libsrcboarddart-draft","title":"4.2.2 lib/src/board.dart (draft)","text":"<p>Next, let's create another Widget <code>Board</code> which is also stateless.</p> <pre><code>import 'package:flutter/material.dart';\n\nclass Board extends StatelessWidget {\n  const Board({super.key});\n\n  @override\n  Widget build(BuildContext context) {\n    var theme = Theme.of(context);\n    return Container(\n      width: 374,\n      height: 374,\n      decoration: const BoxDecoration(\n        color: Colors.brown,\n        borderRadius: BorderRadius.all(Radius.circular(4 * 4)),\n      ),\n      child: _board(theme),\n    );\n  }\n\n  Widget _board(ThemeData theme) {\n    return Column(\n      mainAxisAlignment: MainAxisAlignment.center,\n      children: [\n        for (var i = 0; i &lt; 4; i++)\n          Row(\n            mainAxisAlignment: MainAxisAlignment.center,\n            children: [\n              for (var j = 0; j &lt; 4; j++)\n                Tile(\n                  num: 0, // TODO\n                  theme: theme,\n                )\n            ],\n          )\n      ],\n    );\n  }\n}\n\nclass Tile extends StatelessWidget {\n  const Tile({\n    super.key,\n    required this.num,\n    required this.theme,\n  });\n\n  final int num;\n  final ThemeData theme;\n\n  @override\n  Widget build(BuildContext context) {\n    return Container(\n      width: 81,\n      height: 81,\n      margin: const EdgeInsets.all(4),\n      decoration: BoxDecoration(\n        color: Colors.brown.shade400,\n        borderRadius: const BorderRadius.all(Radius.circular(4)),\n      ),\n      child: Align(\n        alignment: Alignment.center,\n        child: Text(\n          num &gt; 0 ? '$num' : '',\n          style: theme.textTheme.displayMedium!.copyWith(\n            fontWeight: FontWeight.bold,\n            color: Colors.black54,\n            fontSize: theme.textTheme.displayMedium!.fontSize!,\n          ),\n        ),\n      ),\n    );\n  }\n}\n</code></pre>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#423-libmaindart-draft","title":"4.2.3 lib/main.dart (draft)","text":"<p>Let's update <code>main.dart</code>. And then run <code>flutter run</code> or click <code>Run &gt; Run Without Debugging</code> in VSCode.</p> <pre><code>import 'package:flutter/material.dart';\nimport 'package:g2048/src/board.dart';\nimport 'package:g2048/src/status_pane.dart';\n\nvoid main() {\n  runApp(const MyApp());\n}\n\nclass MyApp extends StatelessWidget {\n  const MyApp({super.key});\n\n  // This widget is the root of your application.\n  @override\n  Widget build(BuildContext context) {\n    return MaterialApp(\n      title: '2048',\n      theme: ThemeData(\n        colorScheme: ColorScheme.fromSeed(seedColor: Colors.brown),\n        useMaterial3: true,\n      ),\n      home: const HomeScreen(),\n    );\n  }\n}\n\nclass HomeScreen extends StatelessWidget {\n  const HomeScreen({super.key});\n\n  @override\n  Widget build(BuildContext context) {\n    return const Scaffold(\n      body: Center(\n        child: Column(\n          mainAxisAlignment: MainAxisAlignment.center,\n          children: [\n            StatusPane(),\n            SizedBox(height: 81 / 2),\n            Board(),\n          ],\n        ),\n      ),\n    );\n  }\n}\n</code></pre>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#424-first-refactor","title":"4.2.4 First refactor","text":"<p>We have created three files now:</p> <ul> <li><code>lib/main.dart</code></li> <li><code>lib/src/status_pane.dart</code></li> <li><code>lib/src/board.dart</code></li> </ul> <p>And there are several common constant values among these files. Why don't we define them in a file that other files can include? This way, we have at least the benefit of avoiding hard-code.</p> lib/src/constants.dart <pre><code>import 'package:flutter/material.dart';\n\nconst kTileSize = 81.0;\nconst kMainColor = Colors.brown;\nconst kMargin = 4.0;\n</code></pre> lib/src/status_pane.dart <pre><code>import 'package:flutter/material.dart';\nimport 'package:g2048/src/constants.dart';\n\nclass StatusPane extends StatelessWidget {\n  const StatusPane({\n    super.key,\n  });\n\n  @override\n  Widget build(BuildContext context) {\n    var theme = Theme.of(context).textTheme;\n    return Row(\n      mainAxisAlignment: MainAxisAlignment.spaceAround,\n      children: [\n        Text('2048', style: _textStyle(theme.displayLarge!)),\n        Column(\n          children: [\n            Text('SCORE', style: _textStyle(theme.bodyMedium!)),\n            // TODO score\n            Text('0', style: _textStyle(theme.displayMedium!)),\n          ],\n        ),\n      ],\n    );\n  }\n\n  TextStyle _textStyle(TextStyle style) {\n    return style.copyWith(\n      color: kMainColor,\n      fontWeight: FontWeight.bold,\n    );\n  }\n}\n</code></pre> lib/src/board.dart <pre><code>import 'package:flutter/material.dart';\nimport 'package:g2048/src/constants.dart';\n\nclass Board extends StatelessWidget {\n  const Board({super.key});\n\n  @override\n  Widget build(BuildContext context) {\n    var theme = Theme.of(context);\n    return Container(\n      width: 374,\n      height: 374,\n      decoration: const BoxDecoration(\n        color: kMainColor,\n        borderRadius: BorderRadius.all(Radius.circular(4 *  kMargin)),\n      ),\n      child: _board(theme),\n    );\n  }\n\n  Widget _board(ThemeData theme) {\n    return Column(\n      mainAxisAlignment: MainAxisAlignment.center,\n      children: [\n        for (var i = 0; i &lt; 4; i++)\n          Row(\n            mainAxisAlignment: MainAxisAlignment.center,\n            children: [\n              for (var j = 0; j &lt; 4; j++)\n                Tile(\n                  num: 0, // TODO\n                  theme: theme,\n                )\n            ],\n          )\n      ],\n    );\n  }\n}\n\nclass Tile extends StatelessWidget {\n  const Tile({\n    super.key,\n    required this.num,\n    required this.theme,\n  });\n\n  final int num;\n  final ThemeData theme;\n\n  @override\n  Widget build(BuildContext context) {\n    return Container(\n      width: kTileSize,\n      height: kTileSize,\n      margin: const EdgeInsets.all(kMargin),\n      decoration: BoxDecoration(\n        color: Colors.brown.shade400,\n        borderRadius: const BorderRadius.all(Radius.circular(kMargin)),\n      ),\n      child: Align(\n        alignment: Alignment.center,\n        child: Text(\n          num &gt; 0 ? '$num' : '',\n          style: theme.textTheme.displayMedium!.copyWith(\n            fontWeight: FontWeight.bold,\n            color: Colors.black54,\n            fontSize: theme.textTheme.displayMedium!.fontSize!,\n          ),\n        ),\n      ),\n    );\n  }\n}\n</code></pre> lib/main.dart <pre><code>import 'package:flutter/material.dart';\nimport 'package:g2048/src/board.dart';\nimport 'package:g2048/src/constants.dart';\nimport 'package:g2048/src/status_pane.dart';\n\nvoid main() {\n  runApp(const MyApp());\n}\n\nclass MyApp extends StatelessWidget {\n  const MyApp({super.key});\n\n  // This widget is the root of your application.\n  @override\n  Widget build(BuildContext context) {\n    return MaterialApp(\n      title: '2048',\n      theme: ThemeData(\n        colorScheme: ColorScheme.fromSeed(seedColor: kMainColor),\n        useMaterial3: true,\n      ),\n      home: const HomeScreen(),\n    );\n  }\n}\n\nclass HomeScreen extends StatelessWidget {\n  const HomeScreen({super.key});\n\n  @override\n  Widget build(BuildContext context) {\n    return const Scaffold(\n      body: Center(\n        child: Column(\n          mainAxisAlignment: MainAxisAlignment.center,\n          children: [\n            StatusPane(),\n            SizedBox(height: kTileSize / 2),\n            Board(),\n          ],\n        ),\n      ),\n    );\n  }\n}\n</code></pre>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#43-game-state","title":"4.3 Game State","text":"<p>We've just finished a draft version of GUI. It's time to consider the game state, which is the model of this app. </p>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#431-libsrctypesdart","title":"4.3.1 lib/src/types.dart","text":"<p>For convenience, let's define types first.</p> <pre><code>typedef Model = List&lt;List&lt;int&gt;&gt;;\ntypedef Point = ({int x, int y});\n</code></pre>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#432-whats-the-state-of-this-app","title":"4.3.2 What's the state of this app?","text":"<p>Now let's think about what the state of this app is.</p> <ul> <li>Data<ul> <li>score</li> <li>(4x4) numbers (Model)</li> </ul> </li> <li>Behaviors(methods) that'll change the above data<ul> <li>Swipe left/right/up/down</li> <li>Restart</li> </ul> </li> <li>Functions(methods) for UI<ul> <li>The number at row <code>i</code>, column <code>j</code> </li> </ul> </li> </ul> <p>It comes out with the following diagram.</p> <pre><code>classDiagram\n  class GameState{\n    -Model model\n    +int score\n    +bool done\n    +num(int i, int j)\n    +swipeLeft()\n    +swipeRight()\n    +swipeUp()\n    +swipeDown()\n    +restart() \n  }\n\n  class ChangeNotifier {\n    +notifyListeners()\n  }\n\n  ChangeNotifier &lt;|-- GameState\n  GameState &lt;-- StatusPane : context.watch()\n  GameState &lt;-- Board : context.watch()\n\n  Widget &lt;|-- StatelessWidget\n  StatelessWidget &lt;|-- StatusPane\n  StatelessWidget &lt;|-- Board</code></pre>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#433-libsrcgame_statedart-draft","title":"4.3.3 lib/src/game_state.dart (draft)","text":"<pre><code>import 'package:flutter/material.dart';\nimport 'package:g2048/src/constants.dart';\nimport 'package:g2048/src/types.dart';\n\nconst _rank = 4;\n\nclass GameState extends ChangeNotifier {\n  GameState()\n      : _model = List.generate(\n          _rank,\n          (_) =&gt; List.filled(_rank, 0, growable: false),\n          growable: false,\n        ) {\n    _init();\n  }\n\n  int get size =&gt; _rank;\n  double get boardSize =&gt; size * (kTileSize + 3 * kMargin);\n\n  final Model _model;\n  int score = 0;\n  bool done = false;\n\n  void _init() {\n    _model[size - 1][0] = 2;\n    _model[size - 2][0] = 2;\n  }\n\n  void _reset() {\n    for (var i = 0; i &lt; size; i++) {\n      for (var j = 0; j &lt; size; j++) {\n        _model[i][j] = 0;\n      }\n    }\n    score = 0;\n    done = false;\n  }\n\n  void restart() {\n    _reset();\n    _init();\n    notifyListeners();\n  }\n\n  int num(int i, int j) =&gt; _model[i][j];\n\n  void swipeLeft() {\n    // TODO\n  }\n\n  void swipeRight() {\n    // TODO\n  }\n\n  void swipeUp() {\n    // TODO\n  }\n\n  void swipeDown() {\n    // TODO\n  }\n}\n</code></pre>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#434-inject-the-gamestate-into-widgets","title":"4.3.4 Inject the <code>GameState</code> into Widgets","text":"<p>We're going to use <code>provider</code> to manage object dependencies. Please read the article Simple app state management to know more.</p> <p>Run the following command to add the <code>provider</code> package.</p> <pre><code>flutter pub add provider\n</code></pre> lib/main.dart <pre><code>import 'package:flutter/material.dart';\nimport 'package:g2048/src/board.dart';\nimport 'package:g2048/src/constants.dart';\nimport 'package:g2048/src/game_state.dart';\nimport 'package:g2048/src/status_pane.dart';\nimport 'package:provider/provider.dart';\n\nvoid main() {\n  runApp(const MyApp());\n}\n\nclass MyApp extends StatelessWidget {\n  const MyApp({super.key});\n\n  // This widget is the root of your application.\n  @override\n  Widget build(BuildContext context) {\n    return MaterialApp(\n      title: '2048',\n      theme: ThemeData(\n          colorScheme: ColorScheme.fromSeed(seedColor:     kMainColor),\n          useMaterial3: true,\n          bottomSheetTheme: const BottomSheetThemeData(\n            backgroundColor: Colors.transparent,\n          )),\n      home: ChangeNotifierProvider(\n        create: (context) =&gt; GameState(),\n        child: const HomeScreen(),\n      ),\n    );\n  }\n}\n\n// class HomeScreen extends StatelessWidget {\n// ... ...\n</code></pre> lib/src/status_pane.dart <pre><code>import 'package:flutter/material.dart';\nimport 'package:g2048/src/constants.dart';\nimport 'package:g2048/src/game_state.dart';\nimport 'package:provider/provider.dart';\n\nclass StatusPane extends StatelessWidget {\n  const StatusPane({\n    super.key,\n  });\n\n  @override\n  Widget build(BuildContext context) {\n    var state = context.watch&lt;GameState&gt;();\n    var theme = Theme.of(context).textTheme;\n    return Row(\n      mainAxisAlignment: MainAxisAlignment.spaceAround,\n      children: [\n        Text('2048', style: _textStyle(theme.displayLarge!)),\n        Column(\n          children: [\n            Text('SCORE', style: _textStyle(theme.    bodyMedium!)),\n            Text('${state.score}', style: _textStyle(theme.    displayMedium!)),\n          ],\n        ),\n      ],\n    );\n  }\n\n  TextStyle _textStyle(TextStyle style) {\n    return style.copyWith(\n      color: kMainColor,\n      fontWeight: FontWeight.bold,\n    );\n  }\n}\n</code></pre> lib/src/board.dart <pre><code>import 'package:flutter/material.dart';\nimport 'package:g2048/src/constants.dart';\nimport 'package:g2048/src/game_state.dart';\nimport 'package:provider/provider.dart';\n\nclass Board extends StatelessWidget {\n  const Board({super.key});\n\n  @override\n  Widget build(BuildContext context) {\n    var state = context.watch&lt;GameState&gt;();\n    var theme = Theme.of(context);\n    return Container(\n        width: state.boardSize,\n        height: state.boardSize,\n        decoration: const BoxDecoration(\n          color: kMainColor,\n          borderRadius: BorderRadius.all(Radius.circular(4 *     kMargin)),\n        ),\n        child: _board(state, theme));\n  }\n\n  Widget _board(GameState state, ThemeData theme) {\n    return Column(\n      mainAxisAlignment: MainAxisAlignment.center,\n      children: [\n        for (var i = 0; i &lt; state.size; i++)\n          Row(\n            mainAxisAlignment: MainAxisAlignment.center,\n            children: [\n              for (var j = 0; j &lt; state.size; j++)\n                Tile(\n                  num: state.num(i, j),\n                  theme: theme,\n                ),\n            ],\n          )\n      ],\n    );\n  }\n}\n\n// class Tile extends StatelessWidget {\n// ... ...  \n</code></pre>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#44-the-core-logic","title":"4.4 The core logic","text":"<p>The core logic is implemented by the following methods.</p> <pre><code>classDiagram\n  class GameState{\n    +swipeLeft()\n    +swipeRight()\n    +swipeUp()\n    +swipeDown()\n  }</code></pre> <p>Take the method <code>swipeLeft()</code> as an example, there are at least five things we need to do:</p> <ul> <li><code>_moveZeros</code>: Move all the non-zero numbers to the left side</li> <li><code>_mergeNumbers</code>: Merge the adjacent non-zero number into a bigger one, if they are the same value, from left to right</li> <li>Accumulate the score</li> <li><code>_nextNum</code>: Generate the next number (2 or 4)</li> <li><code>_checkDone</code>: Check if game over</li> </ul>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#441-helper-class-nums","title":"4.4.1 Helper class <code>Nums</code>","text":"<p>Before implementing the <code>swipeXxx</code> methods, let's define a helper class <code>Nums</code> first.</p> <pre><code>classDiagram\n  class Nums{\n    -final Model model\n    -final int which\n    -final bool column \n    +int get length\n    +int operator [ ]\n    +operator [ ]=\n  }</code></pre> <pre><code>/// The view of the numbers in a row or a column \nclass Nums {\n  Nums(this.model, this.which, {this.column = false});\n  final Model model;\n\n  /// Which row or column\n  final int which;\n  final bool column;\n\n  int get length =&gt; column ? model[0].length : model.length;\n\n  int operator [](int k) =&gt; column ? model[k][which] : model[which][k];\n\n  operator []=(int k, int value) {\n    if (column) {\n      model[k][which] = value;\n    } else {\n      model[which][k] = value;\n    }\n  }\n}\n</code></pre>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#442-method-_nums","title":"4.4.2 Method <code>_nums</code>","text":"<pre><code>  Nums _numsAtColumn(int j) =&gt; _nums(j, column: true);\n\n  Nums _nums(int which, {bool column = false}) =&gt;\n      Nums(_model, which, column: column);\n</code></pre>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#443-method-_movezeros","title":"4.4.3 Method <code>_moveZeros</code>","text":"<p>For instance,</p> <pre><code>0 2 0 4  swipeLeft --&gt;  2 4 0 0\n\n\n0 2 0 4  swipeRight --&gt;  0 0 2 4\n\n\n0           4\n4  swipeUp  8\n0   ----&gt;   0  \n8           0\n\n\n0             0\n4  swipeDown  0\n0   ----&gt;     4  \n8             8\n</code></pre> <pre><code>  /// Move the non-zero numbers to the left side if [reverse] is false,\n  /// or to the right side if [reverse] is true\n  List&lt;int&gt; _moveZeros(Nums nums, {bool reverse = false}) {\n    var moves = List.filled(nums.length, 0, growable: false);\n    if (reverse) {\n      // TODO \n    } else {\n      for (var k = 1; k &lt; nums.length; k++) {\n        if (nums[k] == 0) continue;\n        var i = k - 1;\n        for (; i &gt;= 0 &amp;&amp; nums[i] == 0; i--) {}\n        var count = (k - 1) - i;\n        if (count &gt; 0) {\n          nums[i + 1] = nums[k];\n          nums[k] = 0;\n          moves[i + 1] = count;\n        }\n      }\n    }\n    return moves;\n  }\n</code></pre>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#444-method-_mergenumbers","title":"4.4.4 Method <code>_mergeNumbers</code>","text":"<p>For instance,</p> <pre><code>2  2  2  4  swipeLeft --&gt; 4 2 4 0 \n\n\n2  2  2  4  swipeRight --&gt; 0 2 4 4 \n\n\n0           8\n4  swipeUp  0\n0   ----&gt;   0  \n4           0\n\n\n0             0\n4  swipeDown  0\n0   ----&gt;     0  \n4             8\n</code></pre> <pre><code>  /// Merge the adjacent non-zero number into a bigger one,\n  /// from left to right if [reserve] is false,\n  /// or from right to left if [reserve] is true.\n  /// Return the score to be accumulated.\n  int _mergeNumbers(Nums nums, {bool reserve = false}) {\n    var gotScore = 0;\n    if (reserve) {\n      // TODO\n    } else {\n      for (var k = 0; k &lt; nums.length - 1; k++) {\n        if (nums[k] == 0) continue;\n        if (nums[k] == nums[k + 1]) {\n          nums[k] *= 2;\n          nums[k + 1] = 0;\n          gotScore += nums[k];\n        }\n      }\n    }\n    return gotScore;\n  }\n</code></pre>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#445-method-_nextnum","title":"4.4.5 Method <code>_nextNum</code>","text":"<pre><code>  // import 'dart:math' as math;\n  static final _rand = math.Random();\n\n  Point? _newPostion;\n\n  void _nextNum() {\n    List&lt;Point&gt; points = [];\n    for (var i = 0; i &lt; size; i++) {\n      for (var j = 0; j &lt; size; j++) {\n        if (0 == _model[i][j]) points.add((x: i, y: j));\n      }\n    }\n    if (points.isEmpty) return;\n\n    var p = points[_rand.nextInt(points.length)];\n    _model[p.x][p.y] = _rand.nextDouble() &lt; 0.1 ? 4 : 2;\n    _newPostion = p;\n  }\n</code></pre>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#446-method-_checkdone","title":"4.4.6 Method <code>_checkDone</code>","text":"<pre><code>  void _checkDone() {\n    for (var k = 0; k &lt; size; k++) {\n      if (!_isDone(_nums(k)) || !_isDone(_numsAtColumn(k))) {\n        return;\n      }\n    }\n    done = true;\n  }\n\n  bool _isDone(Nums nums) {\n    for (var k = 0; k &lt; nums.length; k++) {\n      if (0 == nums[k] || (k &gt; 0 &amp;&amp; nums[k - 1] == nums[k])) {\n        return false;\n      }\n    }\n    return true;\n  }\n</code></pre>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#447-method-swipeleft","title":"4.4.7 Method <code>swipeLeft</code>","text":"<pre><code>  void swipeLeft() {\n    _swipe(_swipeLeft);\n  }\n\n  bool _swipeLeft(final int i) {\n    var hasMoved = false;\n    var moves = _moveZeros(_nums(i));\n    for (var k = 0; k &lt; size; k++) {\n      hasMoved |= moves[k] &gt; 0;\n    }\n    return hasMoved;\n  }\n\n  void _swipe(bool Function(int) swipeAction) async {\n    // move zeros\n    _resetNewPosition();\n    var hasMoved = false;\n    for (var i = 0; i &lt; size; i++) {\n      hasMoved |= swipeAction(i);\n    }\n    if (hasMoved) notifyListeners();\n\n    // merge numbers\n    var gotScore = 0;\n    for (var k = 0; k &lt; size; k++) {\n      final vertical = swipeAction == _swipeUp || swipeAction == _swipeDown;\n      var nums = _nums(k, column: vertical);\n      gotScore += _mergeNumbers(\n        nums,\n        reserve: swipeAction == _swipeRight || swipeAction == _swipeDown,\n      );\n      swipeAction(k);\n    }\n\n    // score &amp; next number\n    if (hasMoved || gotScore &gt; 0) {\n      score += gotScore;\n      _nextNum();\n      _checkDone();\n      notifyListeners();\n    }\n  }\n\n  void _resetNewPosition() {\n    _newPostion = null;\n  }\n</code></pre>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#448-other-swipe-methods","title":"4.4.8 Other <code>swipe</code> methods","text":"<p>We use the same approach as <code>swipeLeft</code> to implement:</p> <ul> <li><code>swipeRight</code></li> <li><code>swipeUp</code></li> <li><code>swipeDown</code></li> </ul> <p>See 4.5.6 Put all together</p>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#45-back-to-the-gui","title":"4.5 Back to the GUI","text":"<p>There are some functions or widgets we need to implement for the GUI.</p> <ul> <li><code>Swipeable</code>: A widget that helps swipe left/right/up/down, which is essential</li> <li><code>SlideWidget</code>: A widget that implements the slide animation for sliding tiles (numbers)</li> <li><code>TwinkleWidget</code>: A widget that implements the animation function for the newly generated number</li> <li><code>GameOver</code>: A widget that only shows when the game is over, which contains a <code>Restart</code> button</li> <li>The font color, font size, and background color of the tiles (numbers) </li> </ul> <pre><code>classDiagram\n  class Swipeable {\n    +final VoidCallback? onSwipeLeft\n    +final VoidCallback? onSwipeRight\n    +final VoidCallback? onSwipeUp\n    +final VoidCallback? onSwipeDown\n    +final double size\n    +final Widget child\n  }\n\n  class SlideWidget {\n    +final Duration duration;\n    +final Offset offset;\n    +final Widget child\n  }\n\n  class TwinkleWidget {\n    +final double begin;\n    +final double end;\n    +final Duration speed;\n    +final bool repeat;\n    +final Widget child;\n  }\n\n  StatelessWidget &lt;|-- Swipeable\n  StatelessWidget &lt;|-- GameOver\n  StatefulWidget &lt;|-- SlideWidget\n  StatefulWidget &lt;|-- TwinkleWidget\n\n  Widget &lt;|-- StatelessWidget\n  Widget &lt;|-- StatefulWidget</code></pre>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#451-widget-swipeable","title":"4.5.1 Widget <code>Swipeable</code>","text":"lib/src/style/swipeable.dart <pre><code>import 'package:flutter/material.dart';\nimport 'package:flutter/widgets.dart';\n\nclass Swipeable extends StatelessWidget {\n  const Swipeable({\n    super.key,\n    required this.child,\n    required this.size,\n    this.onSwipeLeft,\n    this.onSwipeRight,\n    this.onSwipeUp,\n    this.onSwipeDown,\n  });\n\n  final Widget child;\n  final double size;\n\n  final VoidCallback? onSwipeLeft;\n  final VoidCallback? onSwipeRight;\n  final VoidCallback? onSwipeUp;\n  final VoidCallback? onSwipeDown;\n\n  @override\n  Widget build(BuildContext context) {\n    return Stack(\n      alignment: Alignment.center,\n      children: [\n        child,\n        Dismissible(\n          key: Key('${key?.toString()}-Dismissible-horizontal'),\n          direction: DismissDirection.horizontal,\n          confirmDismiss: (direction) {\n            switch (direction) {\n              case DismissDirection.endToStart:\n                onSwipeLeft?.call();\n              case DismissDirection.startToEnd:\n                onSwipeRight?.call();\n              case _:\n                ;\n            }\n            return Future.value(false);\n          },\n          child: Dismissible(\n            key: Key('${key?.toString()}-Dismissible-vertical'),\n            direction: DismissDirection.vertical,\n            confirmDismiss: (direction) {\n              switch (direction) {\n                case DismissDirection.up:\n                  onSwipeUp?.call();\n                case DismissDirection.down:\n                  onSwipeDown?.call();\n                case _:\n                  ;\n              }\n              return Future.value(false);\n            },\n            child: SizedBox.square(dimension: size),\n          ),\n        ),\n      ],\n    );\n  }\n}\n</code></pre>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#452-widget-slidewidget","title":"4.5.2 Widget <code>SlideWidget</code>","text":"lib/src/style/slide_widget.dart <pre><code>import 'package:flutter/material.dart';\n\nclass SlideWidget extends StatefulWidget {\n  const SlideWidget({\n    super.key,\n    required this.child,\n    this.offset = const Offset(1, 0.0),\n    this.duration = const Duration(milliseconds: 500),\n  });\n\n  final Widget child;\n  final Duration duration;\n  final Offset offset;\n\n  @override\n  State&lt;SlideWidget&gt; createState() =&gt; _SlideWidgetState();\n}\n\nclass _SlideWidgetState extends State&lt;SlideWidget&gt;\n    with SingleTickerProviderStateMixin {\n  late AnimationController _controller;\n  late Animation&lt;Offset&gt; _offsetAnimation;\n\n  @override\n  void initState() {\n    _controller = AnimationController(\n      duration: widget.duration,\n      vsync: this,\n    )..forward();\n    _offsetAnimation = Tween(\n      begin: widget.offset,\n      end: Offset.zero,\n    ).animate(_controller);\n    super.initState();\n  }\n\n  @override\n  void dispose() {\n    _controller.dispose();\n    super.dispose();\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return AnimatedBuilder(\n        animation: _controller,\n        builder: (context, child) {\n          return SlideTransition(\n            position: _offsetAnimation,\n            child: widget.child,\n          );\n        });\n  }\n}\n</code></pre>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#453-widget-twinklewidget","title":"4.5.3 Widget <code>TwinkleWidget</code>","text":"lib/src/style/twinkle_widget.dart <pre><code>import 'package:flutter/material.dart';\n\nclass TwinkleWidget extends StatefulWidget {\n  const TwinkleWidget({\n    super.key,\n    this.begin = 1,\n    this.end = 0.5,\n    this.speed = const Duration(milliseconds: 1000),\n    this.repeat = true,\n    required this.child,\n  });\n\n  final double begin;\n  final double end;\n  final Duration speed;\n  final Widget child;\n  final bool repeat;\n\n  @override\n  State&lt;TwinkleWidget&gt; createState() =&gt; _TwinkleWidgetState();\n}\n\nclass _TwinkleWidgetState extends State&lt;TwinkleWidget&gt;\n    with SingleTickerProviderStateMixin {\n  late AnimationController controller;\n  late Animation&lt;double&gt; opacity;\n\n  @override\n  void initState() {\n    super.initState();\n    controller = AnimationController(\n      duration: widget.speed,\n      vsync: this,\n    );\n    if (widget.repeat) {\n      controller.repeat(reverse: true);\n    } else {\n      controller.forward();\n    }\n\n    opacity = Tween(\n      begin: widget.begin,\n      end: widget.end,\n    ).animate(controller);\n  }\n\n  @override\n  void dispose() {\n    controller.dispose();\n    super.dispose();\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    return AnimatedBuilder(\n      animation: controller,\n      builder: (context, child) =&gt; Opacity(\n        opacity: opacity.value,\n        child: widget.child,\n      ),\n    );\n  }\n}\n</code></pre>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#454-widget-gameover","title":"4.5.4 Widget <code>GameOver</code>","text":"lib/src/game_over.dart <pre><code>import 'package:flutter/material.dart';\nimport 'package:g2048/src/constants.dart';\nimport 'package:g2048/src/game_state.dart';\nimport 'package:provider/provider.dart';\n\nclass GameOver extends StatelessWidget {\n  const GameOver({super.key});\n\n  @override\n  Widget build(BuildContext context) {\n    var state = context.watch&lt;GameState&gt;();\n    var theme = Theme.of(context).textTheme;\n    return Visibility(\n      visible: state.done,\n      child: SizedBox(\n        width: state.boardSize,\n        height: state.boardSize,\n        child: Container(\n          color: Colors.black38,\n          child: Column(\n            mainAxisAlignment: MainAxisAlignment.center,\n            children: [\n              Text(\n                'GAME OVER',\n                style: theme.displaySmall!.copyWith(\n                  fontWeight: FontWeight.bold,\n                  color: Colors.white70,\n                ),\n              ),\n              IconButton(\n                icon: const Icon(Icons.restart_alt_outlined),\n                iconSize: kTileSize,\n                onPressed: () =&gt; state.restart(),\n                color: Colors.white70,\n              )\n            ],\n          ),\n        ),\n      ),\n    );\n  }\n}\n</code></pre>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#455-widget-tile","title":"4.5.5 Widget <code>Tile</code>","text":"<p>Let's fix the font color, font size, and background color of the tiles.</p> Widget <code>Tile</code> <pre><code>class Tile extends StatelessWidget {\n  const Tile({\n    super.key,\n    required this.num,\n    required this.isNew,\n    required this.offset,\n    required this.theme,\n  });\n\n  final int num;\n  final bool isNew;\n  final Offset offset;\n  final ThemeData theme;\n\n  @override\n  Widget build(BuildContext context) {\n    var w = Container(\n      width: kTileSize,\n      height: kTileSize,\n      margin: const EdgeInsets.all(kMargin),\n      decoration: BoxDecoration(\n        color: _bgColor,\n        borderRadius: const BorderRadius.all(Radius.circular(kMargin)),\n      ),\n      child: Align(\n        alignment: Alignment.center,\n        child: Text(\n          num &gt; 0 ? '$num' : '',\n          style: theme.textTheme.displayMedium!.copyWith(\n            fontWeight: FontWeight.bold,\n            color: _fontColor,\n            fontSize: _fontSize,\n          ),\n        ),\n      ),\n    );\n    if (num &lt;= 0) return w;\n    return SlideWidget(\n      key: Key('${key?.toString()}-${DateTime.now().microsecond}'),\n      offset: offset,\n      duration: const Duration(milliseconds: kSlideMilliseconds),\n      child: TwinkleWidget(\n        begin: isNew ? 0.5 : 1.0,\n        end: 1.0,\n        repeat: false,\n        speed: const Duration(milliseconds: kTwinkleMilliseconds),\n        child: w,\n      ),\n    );\n  }\n\n  Color get _bgColor =&gt; switch (num) {\n        -1 =&gt; kMainColor.shade400,\n        0 =&gt; Colors.transparent,\n        2 =&gt; kMainColor.shade200,\n        4 =&gt; Colors.indigoAccent.shade100,\n        8 =&gt; Colors.lightBlue.shade500,\n        16 =&gt; Colors.cyan.shade500,\n        32 =&gt; Colors.deepOrange.shade500,\n        64 =&gt; Colors.deepPurple.shade500,\n        128 =&gt; Colors.green.shade500,\n        256 =&gt; Colors.indigo.shade500,\n        512 =&gt; Colors.lime.shade500,\n        1024 =&gt; Colors.orangeAccent.shade400,\n        2048 =&gt; Colors.pinkAccent.shade200,\n        4096 =&gt; Colors.tealAccent.shade400,\n        8192 =&gt; Colors.yellow.shade500,\n        _ =&gt; kMainColor.shade600,\n      };\n\n  Color get _fontColor =&gt; num &gt; 4 ? Colors.white70 : Colors.black54;\n\n  double? get _fontSize {\n    if (num &lt; 100) return null;\n    var s = theme.textTheme.displayMedium!.fontSize!;\n    return 2.5 * s / '$num'.length;\n  }\n}   \n</code></pre>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#456-put-all-together","title":"4.5.6 Put all together","text":"lib/src/constants.dart <pre><code>import 'package:flutter/material.dart';\n\nconst kTwinkleMilliseconds = 400;\nconst kSlideMilliseconds = 100;\nconst kTileSize = 81.0;\nconst kMainColor = Colors.brown;\nconst kMargin = 4.0;\n</code></pre> lib/src/board.dart <pre><code>import 'package:flutter/material.dart';\nimport 'package:g2048/src/constants.dart';\nimport 'package:g2048/src/game_state.dart';\nimport 'package:g2048/src/style/slide_widget.dart';\nimport 'package:g2048/src/style/twinkle_widget.dart';\nimport 'package:g2048/src/style/swipeable.dart';\nimport 'package:provider/provider.dart';\n\nclass Board extends StatelessWidget {\n  const Board({super.key});\n\n  @override\n  Widget build(BuildContext context) {\n    var state = context.watch&lt;GameState&gt;();\n    var theme = Theme.of(context);\n    return Container(\n        width: state.boardSize,\n        height: state.boardSize,\n        decoration: const BoxDecoration(\n          color: kMainColor,\n          borderRadius: BorderRadius.all(Radius.circular(4 * kMargin)),\n        ),\n        child: Stack(children: [\n          _boardBackground(state, theme),\n          _board(state, theme),\n        ]));\n  }\n\n  Widget _board(GameState state, ThemeData theme) {\n    return Column(\n      mainAxisAlignment: MainAxisAlignment.center,\n      children: [\n        for (var i = 0; i &lt; state.size; i++)\n          Row(\n            mainAxisAlignment: MainAxisAlignment.center,\n            children: [\n              for (var j = 0; j &lt; state.size; j++)\n                Swipeable(\n                  key: Key('tile-$i-$j'),\n                  onSwipeLeft: state.swipeLeft,\n                  onSwipeRight: state.swipeRight,\n                  onSwipeUp: state.swipeUp,\n                  onSwipeDown: state.swipeDown,\n                  size: kTileSize,\n                  child: Tile(\n                    num: state.num(i, j),\n                    isNew: state.isNewPosition(i, j),\n                    offset: state.slideOffset(i, j),\n                    theme: theme,\n                  ),\n                )\n            ],\n          )\n      ],\n    );\n  }\n\n  Widget _boardBackground(GameState state, ThemeData theme) {\n    return Column(\n      mainAxisAlignment: MainAxisAlignment.center,\n      children: [\n        for (var i = 0; i &lt; state.size; i++)\n          Row(\n            mainAxisAlignment: MainAxisAlignment.center,\n            children: [\n              for (var j = 0; j &lt; state.size; j++)\n                Tile(\n                  key: Key('backgroud-$i-$j'),\n                  num: -1,\n                  isNew: false,\n                  offset: Offset.zero,\n                  theme: theme,\n                )\n            ],\n          )\n      ],\n    );\n  }\n}\n\n// class Tile extends StatelessWidget {\n// ... ...   \n</code></pre> lib/main.dart <pre><code>import 'package:flutter/material.dart';\nimport 'package:g2048/src/board.dart';\nimport 'package:g2048/src/constants.dart';\nimport 'package:g2048/src/game_over.dart';\nimport 'package:g2048/src/game_state.dart';\nimport 'package:g2048/src/status_pane.dart';\nimport 'package:provider/provider.dart';\n\nvoid main() {\n  runApp(const MyApp());\n}\n\nclass MyApp extends StatelessWidget {\n  const MyApp({super.key});\n\n  // This widget is the root of your application.\n  @override\n  Widget build(BuildContext context) {\n    return MaterialApp(\n      title: '2048',\n      theme: ThemeData(\n          colorScheme: ColorScheme.fromSeed(seedColor:     kMainColor),\n          useMaterial3: true,\n          bottomSheetTheme: const BottomSheetThemeData(\n            backgroundColor: Colors.transparent,\n          )),\n      home: ChangeNotifierProvider(\n        create: (context) =&gt; GameState(),\n        child: const HomeScreen(),\n      ),\n    );\n  }\n}\n\nclass HomeScreen extends StatelessWidget {\n  const HomeScreen({super.key});\n\n  @override\n  Widget build(BuildContext context) {\n    return const Scaffold(\n      body: Center(\n        child: Column(\n          mainAxisAlignment: MainAxisAlignment.center,\n          children: [\n            StatusPane(),\n            SizedBox(height: kTileSize / 2),\n            Stack(children: [\n              Board(),\n              GameOver(),\n            ]),\n          ],\n        ),\n      ),\n    );\n  }\n}\n</code></pre>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#456-implements-the-missing-methods","title":"4.5.6 Implements the missing methods","text":"<p>As you can see, the methods <code>GameState.slideOffset(i,j)</code> and  <code>GameState.isNewPosition(x,y)</code> haven't been created yet. So the IDE is hinting at something wrong. Let's fix it.</p> <pre><code>// ... ...\nclass GameState extends ChangeNotifier {\n  GameState()\n    : _model = List.generate(\n        _rank,\n        (_) =&gt; List.filled(_rank, 0, growable: false),\n        growable: false,\n      ),\n      _offsets = List.generate(\n        _rank,\n        (_) =&gt; List.filled(_rank, Offset.zero, growable  false),\n        growable: false,\n      ) {\n    _init();\n  }\n\n  final List&lt;List&lt;Offset&gt;&gt; _offsets;\n\n  Offset slideOffset(int i, int j) =&gt; _offsets[i][j];\n\n  bool _swipeLeft(final int i) {\n    var hasMoved = false;\n    var moves = _moveZeros(_nums(i));\n    for (var k = 0; k &lt; size; k++) {\n      hasMoved |= moves[k] &gt; 0;\n      _offsets[i][k] = Offset(moves[k].toDouble(), 0);\n    }\n    return hasMoved;\n  }\n\n  bool isNewPosition(int x, int y) {\n    return _newPostion == (x: x, y: y);\n  }\n\n  // ... ...\n}  \n</code></pre> lib/src/game_state.dart <pre><code>import 'package:flutter/material.dart';\nimport 'package:g2048/src/constants.dart';\nimport 'package:g2048/src/types.dart';\nimport 'dart:math' as math;\n\nconst _rank = 4;\n\nclass GameState extends ChangeNotifier {\n  GameState()\n      : _model = List.generate(\n          _rank,\n          (_) =&gt; List.filled(_rank, 0, growable: false),\n          growable: false,\n        ),\n        _offsets = List.generate(\n          _rank,\n          (_) =&gt; List.filled(_rank, Offset.zero, growable:     false),\n          growable: false,\n        ) {\n    _init();\n  }\n\n  int get size =&gt; _rank;\n  double get boardSize =&gt; size * (kTileSize + 3 * kMargin);\n\n  final Model _model;\n  final List&lt;List&lt;Offset&gt;&gt; _offsets;\n  int score = 0;\n  bool done = false;\n\n  void _init() {\n    _model[size - 1][0] = 2;\n    _model[size - 2][0] = 2;\n  }\n\n  void _reset() {\n    for (var i = 0; i &lt; size; i++) {\n      for (var j = 0; j &lt; size; j++) {\n        _model[i][j] = 0;\n        _offsets[i][j] = Offset.zero;\n      }\n    }\n    score = 0;\n    done = false;\n  }\n\n  void restart() {\n    _reset();\n    _init();\n    notifyListeners();\n  }\n\n  int num(int i, int j) =&gt; _model[i][j];\n  Offset slideOffset(int i, int j) =&gt; _offsets[i][j];\n\n  void swipeLeft() {\n    _swipe(_swipeLeft);\n  }\n\n  void swipeRight() {\n    _swipe(_swipeRight);\n  }\n\n  void swipeUp() {\n    _swipe(_swipeUp);\n  }\n\n  void swipeDown() {\n    _swipe(_swipeDown);\n  }\n\n  void _swipe(bool Function(int) swipeAction) async {\n    // move zeros\n    _resetNewPosition();\n    var hasMoved = false;\n    for (var i = 0; i &lt; size; i++) {\n      hasMoved |= swipeAction(i);\n    }\n    if (hasMoved) notifyListeners();\n\n    // merge numbers\n    await _sleep(kSlideMilliseconds);\n    var gotScore = 0;\n    for (var k = 0; k &lt; size; k++) {\n      final vertical = swipeAction == _swipeUp || swipeAction     == _swipeDown;\n      var nums = _nums(k, column: vertical);\n      gotScore += _mergeNumbers(\n        nums,\n        reserve: swipeAction == _swipeRight || swipeAction ==     _swipeDown,\n      );\n      swipeAction(k);\n    }\n\n    // score &amp; next number\n    if (hasMoved || gotScore &gt; 0) {\n      score += gotScore;\n      _nextNum();\n      _checkDone();\n      notifyListeners();\n    }\n  }\n\n  void _checkDone() {\n    for (var k = 0; k &lt; size; k++) {\n      if (!_isDone(_nums(k)) || !_isDone(_numsAtColumn(k))) {\n        return;\n      }\n    }\n    done = true;\n  }\n\n  bool _isDone(Nums nums) {\n    for (var k = 0; k &lt; nums.length; k++) {\n      if (0 == nums[k] || (k &gt; 0 &amp;&amp; nums[k - 1] == nums[k])) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  void _resetNewPosition() {\n    _newPostion = null;\n  }\n\n  Future&lt;void&gt; _sleep(int milliseconds) async {\n    await Future.delayed(Duration(milliseconds: milliseconds));\n  }\n\n  bool _swipeLeft(final int i) {\n    var hasMoved = false;\n    var moves = _moveZeros(_nums(i));\n    for (var k = 0; k &lt; size; k++) {\n      hasMoved |= moves[k] &gt; 0;\n      _offsets[i][k] = Offset(moves[k].toDouble(), 0);\n    }\n    return hasMoved;\n  }\n\n  bool _swipeRight(final int i) {\n    var hasMoved = false;\n    var moves = _moveZeros(_nums(i), reverse: true);\n    for (var k = 0; k &lt; size; k++) {\n      hasMoved |= moves[k] &gt; 0;\n      _offsets[i][k] = Offset(-moves[k].toDouble(), 0);\n    }\n    return hasMoved;\n  }\n\n  bool _swipeUp(final int j) {\n    var hasMoved = false;\n    var nums = _numsAtColumn(j);\n    var moves = _moveZeros(nums);\n    for (var k = 0; k &lt; size; k++) {\n      hasMoved |= moves[k] &gt; 0;\n      _offsets[k][j] = Offset(0, moves[k].toDouble());\n    }\n    return hasMoved;\n  }\n\n  bool _swipeDown(final int j) {\n    var hasMoved = false;\n    var nums = _numsAtColumn(j);\n    var moves = _moveZeros(nums, reverse: true);\n    for (var k = 0; k &lt; size; k++) {\n      hasMoved |= moves[k] &gt; 0;\n      _offsets[k][j] = Offset(0, -moves[k].toDouble());\n    }\n    return hasMoved;\n  }\n\n  /// Merge the adjacent non-zero number into a bigger one,\n  /// from left to right if [reserve] is `false`,\n  /// or from right to left if [reserve] is `true`.\n  /// Return the score to be accumulated.\n  int _mergeNumbers(Nums nums, {bool reserve = false}) {\n    var gotScore = 0;\n    if (reserve) {\n      for (var k = nums.length - 1; k &gt; 0; k--) {\n        if (nums[k] == 0) continue;\n        if (nums[k] == nums[k - 1]) {\n          nums[k] *= 2;\n          nums[k - 1] = 0;\n          gotScore += nums[k];\n        }\n      }\n    } else {\n      for (var k = 0; k &lt; nums.length - 1; k++) {\n        if (nums[k] == 0) continue;\n        if (nums[k] == nums[k + 1]) {\n          nums[k] *= 2;\n          nums[k + 1] = 0;\n          gotScore += nums[k];\n        }\n      }\n    }\n    return gotScore;\n  }\n\n  /// Move the non-zero numbers to the left side if [reverse]     is false,\n  /// or to the right side if [reverse] is `true`\n  List&lt;int&gt; _moveZeros(Nums nums, {bool reverse = false}) {\n    var moves = List.filled(nums.length, 0, growable: false);\n    if (reverse) {\n      for (var k = nums.length - 2; k &gt;= 0; k--) {\n        if (nums[k] == 0) continue;\n        var i = k + 1;\n        for (; i &lt; nums.length &amp;&amp; nums[i] == 0; i++) {}\n        var count = i - (k + 1);\n        if (count &gt; 0) {\n          nums[i - 1] = nums[k];\n          nums[k] = 0;\n          moves[i - 1] = count;\n        }\n      }\n    } else {\n      for (var k = 1; k &lt; nums.length; k++) {\n        if (nums[k] == 0) continue;\n        var i = k - 1;\n        for (; i &gt;= 0 &amp;&amp; nums[i] == 0; i--) {}\n        var count = (k - 1) - i;\n        if (count &gt; 0) {\n          nums[i + 1] = nums[k];\n          nums[k] = 0;\n          moves[i + 1] = count;\n        }\n      }\n    }\n    return moves;\n  }\n\n  static final _rand = math.Random();\n\n  Point? _newPostion;\n\n  void _nextNum() {\n    List&lt;Point&gt; points = [];\n    for (var i = 0; i &lt; size; i++) {\n      for (var j = 0; j &lt; size; j++) {\n        if (0 == _model[i][j]) points.add((x: i, y: j));\n      }\n    }\n    if (points.isEmpty) return;\n\n    var p = points[_rand.nextInt(points.length)];\n    _model[p.x][p.y] = _rand.nextDouble() &lt; 0.1 ? 4 : 2;\n    _newPostion = p;\n  }\n\n  bool isNewPosition(int x, int y) {\n    return _newPostion == (x: x, y: y);\n  }\n\n  Nums _numsAtColumn(int j) =&gt; _nums(j, column: true);\n\n  Nums _nums(int which, {bool column = false}) =&gt;\n      Nums(_model, which, column: column);\n}\n\n/// The view of the numbers in a row or a column\nclass Nums {\n  Nums(this.model, this.which, {this.column = false});\n  final Model model;\n\n  /// Which row or column\n  final int which;\n  final bool column;\n\n  int get length =&gt; column ? model[0].length : model.length;\n\n  int operator [](int k) =&gt; column ? model[k][which] : model    [which][k];\n\n  operator []=(int k, int value) {\n    if (column) {\n      model[k][which] = value;\n    } else {\n      model[which][k] = value;\n    }\n  }\n}\n</code></pre> <p>That's all.    </p>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#5-conclusion","title":"5. Conclusion","text":"<p>It's not easy to master a new programming language or framework (development tool kit). It's a good start to write a little game, through which we can understand some basic concepts better. The game 2048 is easy to understand. That's why I chose it as an example of practicing programming in Flutter. To help me express my ideas better, I drew some diagrams, which I hope will help you understand the codes in this article better.</p> <p>Here is the full source code g2048.</p>","tags":["game","2048","flutter"]},{"location":"FRONTEND/2024-06-06-how-to-create-a-2048-game-in-flutter/#reference","title":"Reference","text":"<ul> <li> <p>Dart overview</p> </li> <li> <p>Building user interfaces with Flutter</p> </li> <li> <p>Flutter Simple app state management</p> </li> <li> <p>Flutter Animations tutorial</p> </li> </ul>","tags":["game","2048","flutter"]},{"location":"GAME/holder/","title":"Holder","text":"<p>placeholder</p>"},{"location":"Misc/2015-09-25-fdiskmountfstab-%25e5%2591%25bd%25e4%25bb%25a4%25e8%25af%25b4%25e6%2598%258e.html/","title":"fdisk+mount+fstab \u547d\u4ee4\u8bf4\u660e","text":"\u4e00\u3001fdisk \u64cd\u4f5c\u786c\u76d8\u7684\u547d\u4ee4 <p>[root@localhost]# fdisk \u8bbe\u5907</p> <p>\u4f8b\u5982\u6211\u4eec\u901a\u8fc7 fdisk -l \u5f97\u77e5 \u00a0/dev/sda\u8bbe\u5907\uff1b\u6211\u4eec\u5982\u679c\u60f3\u518d\u6dfb\u52a0\u6216\u8005\u5220\u9664\u4e00\u4e9b\u5206\u533a\uff0c\u53ef\u4ee5\u7528</p> <p>[root@localhost]# fdisk /dev/sda</p> 1\u3001fdisk \u7684\u8bf4\u660e <p>\u5f53\u6211\u4eec\u901a\u8fc7 fdisk \u8bbe\u5907\uff0c\u8fdb\u5165\u76f8\u5e94\u8bbe\u5907\u7684\u64cd\u4f5c\u65f6\uff0c\u4f1a\u53d1\u73b0\u6709\u5982\u4e0b\u7684\u63d0\u793a</p> <p>[root@localhost]# fdisk /dev/sda Command (m for help): \u5728\u8fd9\u91cc\u6309m \uff0c\u5c31\u4f1a\u8f93\u51fa\u5e2e\u52a9\uff1b Command action a toggle a bootable flag b edit bsd disklabel c toggle the dos compatibility flag d delete a partition \u6ce8\uff1a\u8fd9\u662f\u5220\u9664\u4e00\u4e2a\u5206\u533a\u7684\u52a8\u4f5c\uff1b l list known partition types \u6ce8\uff1al\u662f\u5217\u51fa\u5206\u533a\u7c7b\u578b\uff0c\u4ee5\u4f9b\u6211\u4eec\u8bbe\u7f6e\u76f8\u5e94\u5206\u533a\u7684\u7c7b\u578b\uff1b m print this menu \u6ce8\uff1am \u662f\u5217\u51fa\u5e2e\u52a9\u4fe1\u606f\uff1b n add a new partition \u6ce8\uff1a\u6dfb\u52a0\u4e00\u4e2a\u5206\u533a\uff1b o create a new empty DOS partition table p print the partition table \u6ce8\uff1ap\u5217\u51fa\u5206\u533a\u8868\uff1b q quit without saving changes \u6ce8\uff1a\u4e0d\u4fdd\u5b58\u9000\u51fa\uff1b s create a new empty Sun disklabel t change a partition's system id \u6ce8\uff1at \u6539\u53d8\u5206\u533a\u7c7b\u578b\uff1b u change display/entry units v verify the partition table w write table to disk and exit \u6ce8\uff1a\u628a\u5206\u533a\u8868\u5199\u5165\u786c\u76d8\u5e76\u9000\u51fa\uff1b x extra functionality (experts only) \u6ce8\uff1a\u6269\u5c55\u5e94\u7528\uff0c\u4e13\u5bb6\u529f\u80fd\uff1b</p> 2\u3001\u5217\u51fa\u5f53\u524d\u64cd\u4f5c\u786c\u76d8\u7684\u5206\u533a\u60c5\u51b5\uff0c\u7528p <p>Command (m for help): p Disk /dev/sda: 1035 MB, 1035730944 bytes 256 heads, 63 sectors/track, 125 cylinders Units = cylinders of 16128 * 512 = 8257536 bytes Device Boot Start End Blocks Id System /dev/sda1 1 25 201568+ c W95 FAT32 (LBA) /dev/sda2 26 125 806400 5 Extended /dev/sda5 26 50 201568+ 83 Linux /dev/sda6 51 76 200781 83 Linux</p> 3\u3001\u901a\u8fc7fdisk\u7684d\u6307\u4ee4\u6765\u5220\u9664\u4e00\u4e2a\u5206\u533a <p>Command (m for help): p \u6ce8\uff1a\u5217\u51fa\u5206\u533a\u60c5\u51b5\uff1b Disk /dev/sda: 1035 MB, 1035730944 bytes 256 heads, 63 sectors/track, 125 cylinders Units = cylinders of 16128 * 512 = 8257536 bytes Device Boot Start End Blocks Id System /dev/sda1 1 25 201568+ c W95 FAT32 (LBA) /dev/sda2 26 125 806400 5 Extended /dev/sda5 26 50 201568+ 83 Linux /dev/sda6 51 76 200781 83 Linux Command (m for help): d \u6ce8\uff1a\u6267\u884c\u5220\u9664\u5206\u533a\u6307\u5b9a\uff1b Partition number (1-6): 6 \u6ce8\uff1a\u6211\u60f3\u5220\u9664 sda6 \uff0c\u5c31\u5728\u8fd9\u91cc\u8f93\u5165 6 \uff1b Command (m for help): p \u6ce8\uff1a\u518d\u67e5\u770b\u4e00\u4e0b\u786c\u76d8\u5206\u533a\u60c5\u51b5\uff0c\u770b\u662f\u5426\u5220\u9664\u4e86\uff1f Disk /dev/sda: 1035 MB, 1035730944 bytes 256 heads, 63 sectors/track, 125 cylinders Units = cylinders of 16128 * 512 = 8257536 bytes Device Boot Start End Blocks Id System /dev/sda1 1 25 201568+ c W95 FAT32 (LBA) /dev/sda2 26 125 806400 5 Extended /dev/sda5 26 50 201568+ 83 Linux Command (m for help):</p> <p>\u8b66\u544a\uff1a\u5220\u9664\u5206\u533a\u65f6\u8981\u5c0f\u5fc3\uff0c\u8bf7\u770b\u597d\u5206\u533a\u7684\u5e8f\u53f7\uff0c\u5982\u679c\u60a8\u5220\u9664\u4e86\u6269\u5c55\u5206\u533a\uff0c\u6269\u5c55\u5206\u533a\u4e4b\u4e0b\u7684\u903b\u8f91\u5206\u533a\u90fd\u4f1a\u5220\u9664\uff1b\u6240\u4ee5\u64cd\u4f5c\u65f6\u4e00\u5b9a\u8981\u5c0f\u5fc3\uff1b\u5982\u679c\u77e5\u9053\u81ea\u5df1\u64cd\u4f5c\u9519\u4e86\uff0c\u8bf7\u4e0d\u8981\u60ca\u614c\uff0c\u7528q\u4e0d\u4fdd\u5b58\u9000\u51fa\uff1b\u5207\u8bb0\u5207\u8bb0\uff01\uff01\uff01\uff01\u5728\u5206\u533a\u64cd\u4f5c\u9519\u4e86\u4e4b\u65f6\uff0c\u5343\u4e07\u4e0d\u8981\u8f93\u5165w\u4fdd\u5b58\u9000\u51fa\uff01\uff01\uff01</p> 4\u3001\u901a\u8fc7fdisk\u7684n\u6307\u4ee4\u589e\u52a0\u4e00\u4e2a\u5206\u533a <p>Command (m for help): p Disk /dev/sda: 1035 MB, 1035730944 bytes 256 heads, 63 sectors/track, 125 cylinders Units = cylinders of 16128 * 512 = 8257536 bytes Device Boot Start End Blocks Id System /dev/sda1 1 25 201568+ c W95 FAT32 (LBA) /dev/sda2 26 125 806400 5 Extended /dev/sda5 26 50 201568+ 83 Linux Command (m for help): n \u6ce8\uff1a\u589e\u52a0\u4e00\u4e2a\u5206\u533a\uff1b Command action l logical (5 or over) \u6ce8\uff1a\u589e\u52a0\u903b\u8f91\u5206\u533a\uff0c\u5206\u533a\u7f16\u53f7\u8981\u5927\u4e8e5\uff1b\u4e3a\u4ec0\u4e48\u8981\u5927\u4e8e5\uff0c\u56e0\u4e3a\u5df2\u7ecf\u6709sda5\u4e86\uff1b p primary partition (1-4) \u6ce8\uff1a\u589e\u52a0\u4e00\u4e2a\u4e3b\u5206\u533a\uff1b\u7f16\u53f7\u4ece 1-4 \uff1b\u4f46sda1 \u548csda2\u90fd\u88ab\u5360\u7528\uff0c\u6240\u4ee5\u53ea\u80fd\u4ece3\u5f00\u59cb\uff1b p Partition number (1-4): 3 No free sectors available \u6ce8\uff1a\u5931\u8d25\u4e2d\uff0c\u4e3a\u4ec0\u4e48\u5931\u8d25\uff1f</p> <p>\u6ce8\uff1a\u6211\u8bd5\u56fe\u589e\u52a0\u4e00\u4e2a\u4e3b\u5206\u533a\uff0c\u770b\u6765\u662f\u5931\u8d25\u4e86\uff0c\u4e3a\u4ec0\u4e48\u5931\u8d25\uff1f\u56e0\u4e3a\u6211\u4eec\u770b\u5230\u4e3b\u5206\u533a+\u6269\u5c55\u5206\u533a\u628a\u6574\u4e2a\u78c1\u76d8\u90fd\u7528\u5149\u4e86\uff0c\u770b\u6269\u5c55\u5206\u533a\u7684End\u7684\u503c\uff0c\u518d\u770b\u4e00\u4e0b p\u8f93\u51fa\u4fe1\u606f\u4e2d\u6709125 cylinders\uff1b</p> <p>\u6240\u4ee5\u6211\u4eec\u53ea\u80fd\u589e\u52a0\u903b\u8f91\u5206\u533a\u4e86</p> <p>Command (m for help): n Command action l logical (5 or over) p primary partition (1-4) l \u6ce8\uff1a\u5728\u8fd9\u91cc\u8f93\u5165l\uff0c\u5c31\u8fdb\u5165\u5212\u5206\u903b\u8f91\u5206\u533a\u9636\u6bb5\u4e86\uff1b First cylinder (51-125, default 51): \u6ce8\uff1a\u8fd9\u4e2a\u5c31\u662f\u5206\u533a\u7684Start \u503c\uff1b\u8fd9\u91cc\u6700\u597d\u76f4\u63a5\u6309\u56de\u8f66\uff0c\u5982\u679c\u60a8\u8f93\u5165\u4e86\u4e00\u4e2a\u975e\u9ed8\u8ba4\u7684\u6570\u5b57\uff0c\u4f1a\u9020\u6210\u7a7a\u95f4\u6d6a\u8d39\uff1b Using default value 51 Last cylinder or +size or +sizeM or +sizeK (51-125, default 125): +200M \u6ce8\uff1a\u8fd9\u4e2a\u662f\u5b9a\u4e49\u5206\u533a\u5927\u5c0f\u7684\uff0c+200M \u5c31\u662f\u5927\u5c0f\u4e3a200M \uff1b\u5f53\u7136\u60a8\u4e5f\u53ef\u4ee5\u6839\u636ep\u63d0\u793a\u7684\u5355\u4f4dcylinder\u7684\u5927\u5c0f\u6765\u7b97\uff0c\u7136\u540e\u6765\u6307\u5b9a End\u7684\u6570\u503c\u3002\u56de\u5934\u770b\u770b\u662f\u600e\u4e48\u7b97\u7684\uff1b\u8fd8\u662f\u7528+200M\u8fd9\u4e2a\u529e\u6cd5\u6765\u6dfb\u52a0\uff0c\u8fd9\u6837\u80fd\u76f4\u89c2\u4e00\u70b9\u3002\u5982\u679c\u60a8\u60f3\u6dfb\u52a0\u4e00\u4e2a10G\u5de6\u53f3\u5927\u5c0f\u7684\u5206\u533a\uff0c\u8bf7\u8f93\u5165 +10000M \uff1b Command (m for help):</p> 5\u3001\u901a\u8fc7fdisk\u7684t\u6307\u4ee4\u6307\u5b9a\u5206\u533a\u7c7b\u578b <p>Command (m for help): t \u6ce8\uff1a\u901a\u8fc7t\u6765\u6307\u5b9a\u5206\u533a\u7c7b\u578b\uff1b Partition number (1-6): 6 \u6ce8\uff1a\u8981\u6539\u53d8\u54ea\u4e2a\u5206\u533a\u7c7b\u578b\u5462\uff1f\u6211\u6307\u5b9a\u4e866\uff0c\u5176\u5b9e\u4e5f\u5c31\u662fsda6 Hex code (type L to list codes):L \u6ce8\uff1a\u5728\u8fd9\u91cc\u8f93\u5165L\uff0c\u5c31\u53ef\u4ee5\u67e5\u770b\u5206\u533a\u7c7b\u578b\u7684id\u4e86\uff1b Hex code (type L to list codes): b \u6ce8\uff1a\u5982\u679c\u6211\u60f3\u8ba9\u8fd9\u4e2a\u5206\u533a\u662f W95 FAT32 \u7c7b\u578b\u7684\uff0c\u901a\u8fc7L\u67e5\u770b\u5f97\u77e5 b\u662f\u8868\u793a\u7684\u662f\uff0c\u6240\u4ee5\u8f93\u5165\u4e86b\uff1b Changed system type of partition 6 to b (W95 FAT32) \u6ce8\uff1a\u7cfb\u7edf\u4fe1\u606f\uff0c\u6539\u53d8\u6210\u529f\uff1b\u662f\u5426\u662f\u6539\u53d8\u4e86\uff0c\u8bf7\u7528p\u67e5\u770b\uff1b Command (m for help): p Disk /dev/sda: 1035 MB, 1035730944 bytes 256 heads, 63 sectors/track, 125 cylinders Units = cylinders of 16128 * 512 = 8257536 bytes Device Boot Start End Blocks Id System /dev/sda1 1 25 201568+ c W95 FAT32 (LBA) /dev/sda2 26 125 806400 5 Extended /dev/sda5 26 50 201568+ 83 Linux /dev/sda6 51 75 201568+ b W95 FAT32</p> 6\u3001fdisk \u7684\u9000\u51fa\uff0c\u7528q\u6216\u8005 w <p>\u5176\u4e2d q\u662f \u4e0d\u4fdd\u5b58\u9000\u51fa\uff0cw\u662f\u4fdd\u5b58\u9000\u51fa</p> <p>Command (m for help): w \u6216 Command (m for help): q</p> \u4e8c\u3001\u4e00\u4e2a\u6dfb\u52a0\u5206\u533a\u7684\u4f8b\u5b50 <p>\u672c\u4f8b\u4e2d\u6211\u4eec\u4f1a\u6dfb\u52a0\u4e24\u4e2a200M\u7684\u4e3b\u5206\u533a\uff0c\u5176\u5b83\u4e3a\u6269\u5c55\u5206\u533a\uff0c\u5728\u6269\u5c55\u5206\u533a\u4e2d\u6211\u4eec\u6dfb\u52a0\u4e24\u4e2a200M\u5927\u5c0f\u7684\u903b\u8f91\u5206\u533a</p> <p>Command (m for help): p \u6ce8\uff1a\u5217\u51fa\u5206\u533a\u8868\uff1b Disk /dev/sda: 1035 MB, 1035730944 bytes 256 heads, 63 sectors/track, 125 cylinders Units = cylinders of 16128 * 512 = 8257536 bytes Device Boot Start End Blocks Id System Command (m for help): n \u6ce8\uff1a\u6dfb\u52a0\u5206\u533a\uff1b Command action e extended p primary partition (1-4) p \u6ce8\uff1a\u6dfb\u52a0\u4e3b\u5206\u533a\uff1b Partition number (1-4): 1 \u6ce8\uff1a\u6dfb\u52a0\u4e3b\u5206\u533a1\uff1b First cylinder (1-125, default 1): \u6ce8\uff1a\u76f4\u63a5\u56de\u8f66\uff0c\u4e3b\u5206\u533a1\u7684\u8d77\u59cb\u4f4d\u7f6e\uff1b\u9ed8\u8ba4\u4e3a1,\u9ed8\u8ba4\u5c31\u597d\uff1b Using default value 1 Last cylinder or +size or +sizeM or +sizeK (1-125, default 125): +200M \u6ce8\uff1a\u6307\u5b9a\u5206\u533a\u5927\u5c0f\uff0c\u7528+200M\u6765\u6307\u5b9a\u5927\u5c0f\u4e3a200M Command (m for help): n \u6ce8\uff1a\u6dfb\u52a0\u65b0\u5206\u533a\uff1b Command action e extended p primary partition (1-4) p \u6ce8\uff1a\u6dfb\u52a0\u4e3b\u5206\u533a Partition number (1-4): 2 \u6ce8\uff1a\u6dfb\u52a0\u4e3b\u5206\u533a2\uff1b First cylinder (26-125, default 26): Using default value 26 Last cylinder or +size or +sizeM or +sizeK (26-125, default 125): +200M \u6ce8\uff1a\u6307\u5b9a\u5206\u533a\u5927\u5c0f\uff0c\u7528+200M\u6765\u6307\u5b9a\u5927\u5c0f\u4e3a200M Command (m for help): n Command action e extended p primary partition (1-4) e \u6ce8\uff1a\u6dfb\u52a0\u6269\u5c55\u5206\u533a\uff1b Partition number (1-4): 3 \u6ce8\uff1a\u6307\u5b9a\u4e3a3 \uff0c\u56e0\u4e3a\u4e3b\u5206\u533a\u5df2\u7ecf\u5206\u4e86\u4e24\u4e2a\u4e86\uff0c\u8fd9\u4e2a\u4e5f\u7b97\u4e3b\u5206\u533a\uff0c\u4ece3\u5f00\u59cb\uff1b First cylinder (51-125, default 51): \u6ce8\uff1a\u76f4\u63a5\u56de\u8f66\uff1b Using default value 51 Last cylinder or +size or +sizeM or +sizeK (51-125, default 125): \u6ce8\uff1a\u76f4\u63a5\u56de\u8f66\uff0c\u628a\u5176\u4f59\u7684\u6240\u6709\u7a7a\u95f4\u90fd\u7ed9\u6269\u5c55\u5206\u533a\uff1b Using default value 125 Command (m for help): p Disk /dev/sda: 1035 MB, 1035730944 bytes 256 heads, 63 sectors/track, 125 cylinders Units = cylinders of 16128 * 512 = 8257536 bytes Device Boot Start End Blocks Id System /dev/sda1 1 25 201568+ 83 Linux /dev/sda2 26 50 201600 83 Linux /dev/sda3 51 125 604800 5 Extended Command (m for help): n Command action l logical (5 or over) p primary partition (1-4) l \u6ce8\uff1a\u6dfb\u52a0\u903b\u8f91\u5206\u533a\uff1b First cylinder (51-125, default 51): Using default value 51 Last cylinder or +size or +sizeM or +sizeK (51-125, default 125): +200M \u6ce8\uff1a\u6dfb\u52a0\u4e00\u4e2a\u5927\u5c0f\u4e3a200M\u5927\u5c0f\u7684\u5206\u533a\uff1b Command (m for help): n Command action l logical (5 or over) p primary partition (1-4) l \u6ce8\uff1a\u6dfb\u52a0\u4e00\u4e2a\u903b\u8f91\u5206\u533a\uff1b First cylinder (76-125, default 76): Using default value 76 Last cylinder or +size or +sizeM or +sizeK (76-125, default 125): +200M \u6ce8\uff1a\u6dfb\u52a0\u4e00\u4e2a\u5927\u5c0f\u4e3a200M\u5927\u5c0f\u7684\u5206\u533a\uff1b Command (m for help): p \u5217\u51fa\u5206\u533a\u8868\uff1b Disk /dev/sda: 1035 MB, 1035730944 bytes 256 heads, 63 sectors/track, 125 cylinders Units = cylinders of 16128 * 512 = 8257536 bytes Device Boot Start End Blocks Id System /dev/sda1 1 25 201568+ 83 Linux /dev/sda2 26 50 201600 83 Linux /dev/sda3 51 125 604800 5 Extended /dev/sda5 51 75 201568+ 83 Linux /dev/sda6 76 100 201568+ 83 Linux</p> <p>\u7136\u540e\u6211\u4eec\u6839\u636e\u524d\u9762\u6240\u8bf4\u901a\u8fc7t\u6307\u4ee4\u6765\u6539\u53d8\u5206\u533a\u7c7b\u578b\uff1b</p> <p>\u6700\u540e\u4e0d\u8981\u5fd8\u8bb0w\u4fdd\u5b58\u9000\u51fa</p> <p>\u683c\u5f0f\u5316\u5206\u533a&amp;\u6302\u8f7d</p> \u4e09\u3001\u5bf9\u5206\u533a\u8fdb\u884c\u683c\u5f0f\u5316\uff0c\u4ee5\u53ca\u52a0\u8f7d <p>\u5148\u63d0\u793a\u4e00\u4e0b\uff1b\u7528 mkfs.bfs mkfs.ext2 mkfs.jfs mkfs.msdos mkfs.vfatmkfs.cramfs mkfs.ext3 mkfs.ext4 \u00a0mkfs.minix mkfs.reiserfs mkfs.xfs \u7b49\u547d\u4ee4\u6765\u683c\u5f0f\u5316\u5206\u533a\uff0c\u6bd4\u5982\u6211\u60f3\u683c\u5f0f\u5316 sda6\u4e3aext4\u6587\u4ef6\u7cfb\u7edf\uff0c\u5219\u8f93\u5165\uff1b</p> <p>[root@localhost]# mkfs.ext4 /dev/sda6</p> <p>\u5982\u679c\u6211\u60f3\u52a0\u8f7d sda6\u5230\u76ee\u524d\u7cfb\u7edf\u6765\u5b58\u53d6\u6587\u4ef6\uff0c\u5e94\u8be5\u6709mount \u547d\u4ee4\uff0c\u4f46\u9996\u5148\u60a8\u5f97\u5efa\u4e00\u4e2a\u6302\u8f7d\u76ee\u5f55\uff1b\u6bd4\u5982 /mnt/sda6 \uff1b</p> <p>[root@localhost]# mkdir /mnt/sda6 [root@localhost]# mount /dev/sda6 /mnt/sda6 [root@localhost]# df -lh Filesystem \u5bb9\u91cf \u5df2\u7528 \u53ef\u7528 \u5df2\u7528% \u6302\u8f7d\u70b9 /dev/hda8 11G 8.4G 2.0G 81% / /dev/shm 236M 0 236M 0% /dev/shm /dev/hda10 16G 6.9G 8.3G 46% /mnt/hda10 /dev/sda6 191M 5.6M 176M 4% /mnt/sda6</p> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u80fd\u8fdb\u5165 /mnt/sda6\u76ee\u5f55\uff0c\u7136\u540e\u5b58\u53d6\u6587\u4ef6\u4e86\u3002</p> \u56db\u3001\u6302\u8f7d\u548c\u5378\u8f7d Linux\u7cfb\u7edf\u5728\u4f7f\u7528\u5149\u76d8\u3001\u8f6f\u76d8\u6216U\u76d8\u65f6\uff0c\u5fc5\u987b\u5148\u6267\u884c\u6302\u8f7d\uff08mount\uff09\u547d\u4ee4\u3002\u6302\u8f7d\u547d\u4ee4\u4f1a\u5c06\u8fd9\u4e9b\u5b58\u50a8\u4ecb\u8d28\u6307\u5b9a\u6210\u7cfb\u7edf\u4e2d\u7684\u67d0\u4e2a\u76ee\u5f55\uff0c\u4ee5\u540e\u76f4\u63a5\u8bbf\u95ee\u76f8\u5e94\u76ee\u5f55\u5373\u53ef\u8bfb\u5199\u5b58\u50a8\u4ecb\u8d28\u4e0a\u7684\u6570\u636e\u3002 1.\u6302\u8f7d\u5149\u76d8 <p>\u6302\u8f7d\u5149\u76d8\u7684\u547d\u4ee4\u5982\u4e0b\uff1a</p> <p># mount -t is09660 /dev/cdrom /mnt/cdrom</p> <p>\u8be5\u547d\u4ee4\u5c06\u5149\u76d8\u6302\u8f7d\u5230/mnt/cdrom\u76ee\u5f55\uff0c\u4f7f\u7528\u201cls /mnt/cdrom\u201d\u547d\u4ee4\u5373\u53ef\u663e\u793a\u5149\u76d8\u4e2d\u6570\u636e\u548c\u6587\u4ef6\u3002</p> <p>\u5378\u8f7d\u5149\u76d8\u7684\u547d\u4ee4\u5982\u4e0b\uff1a</p> <p># umount /mnt/cdrom</p> 2.\u6302\u8f7d\u8f6f\u76d8 <p>\u5c06\u8f6f\u76d8\u6302\u8f7d\u5230/mnt/floppy\u76ee\u5f55\u7684\u547d\u4ee4\u5982\u4e0b\uff1a</p> <p># mount /dev/fd0 /mnt/floppy</p> <p>\u5378\u8f7d\u8f6f\u76d8\u7684\u547d\u4ee4\u5982\u4e0b\uff1a</p> <p>#umount /mnt/floppy</p> 3.\u6302\u8f7dU\u76d8 <p>\u6302\u8f7dU\u76d8\u76f8\u5bf9\u590d\u6742\u4e00\u4e9b\u3002</p> <p>\u9996\u5148\u4f7f\u7528\u201cfdisk -l\u201d\u547d\u4ee4\u67e5\u770b\u5916\u6302\u95ea\u5b58\u7684\u8bbe\u5907\u53f7\uff0c\u4e00\u822c\u4e3a/dev/sda1\u3002\u7136\u540e\u7528\u201cmkdir /mnt/usb\u201d\u547d\u4ee4\u5efa\u7acb\u4e00\u4e2a\u6302\u8f7dU\u76d8\u7528\u7684\u76ee\u5f55\u3002\u4e4b\u540e\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u6302\u8f7dFAT\u683c\u5f0f\u7684U\u76d8\uff1a</p> <p># mount -t msdos /dev/sda1 /mnt/usb</p> <p>\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u6302\u8f7dFAT32\u683c\u5f0f\u7684U\u76d8\uff1a</p> <p># mount -t vfat /dev/sda1 /mnt/usb</p> 4.\u6302\u8f7d\u5916\u6302\u786c\u76d8\u5206\u533a <p>\u6302\u8f7d\u5916\u6302\u786c\u76d8\u5206\u533a\uff08FAT32\u683c\u5f0f\uff09\u540c\u6837\u9700\u8981\u5148\u7528\u201cfdisk -1\u201d\u67e5\u770b\u5916\u6302\u7684\u786c\u76d8\u5206\u533a\u8bbe\u5907\u53f7\uff0c\u5047\u8bbe\u4e3a/dev/hda1\u3002\u5efa\u7acb/mnt/vfat\u6302\u8f7d\u76ee\u5f55\u540e\uff0c\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u8fdb\u884c\u6302\u8f7d\uff1a</p> <p># mount -t vfat /dev/hda1 /mnt/vfat</p> <p>\u6ce8\u610f\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0bLinux\u53ea\u5141\u8bb8root\u7528\u6237\u6267\u884cmount\u547d\u4ee4\u3002\u5982\u679c\u60f3\u8ba9\u4e00\u822c\u7528\u6237\u4e5f\u80fd\u6302\u8f7d\uff0c\u5e76\u4e14\u5e0c\u671b\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\u81ea\u52a8\u6302\u8f7d\u5149\u76d8\u6216\u8f6f\u76d8\uff0c\u9700\u8981\u4fee\u6539/etc/fstab\u914d\u7f6e\u6587\u4ef6\uff0c\u52a0\u5165\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <p>LABEL=/ /\u3000ext3\u3000\u3000\u3000defaults\u3000\u30001 1 /dev/cdrom/mnt/cdrom iSo9660 auto,owner,kudzu,ro,user 0 0 /dev/fdo\u3000/mnt/floppy auto\u3000auto,owner,kudzu,ro,user 0 0</p> <p>\u5176\u4e2d\uff0c\u201cuser\u201d\u8868\u793a\u5c06mount\u547d\u4ee4\u8d4b\u4e88\u4e00\u822c\u7528\u6237\u4f7f\u7528\u3002</p> <p>/etc/fstab\u6587\u4ef6\u5728Linux\u7684\u5e2e\u52a9\u624b\u518c\u4e2d\u8bb2\u5f97\u5f88\u8be6\u7ec6\uff0c\u8bfb\u8005\u4e0d\u59a8\u770b\u4e00\u770b\u3002</p> \u4e94\u3001fstab\u8bf4\u660e <p>fstab\u4e2d\u5b58\u653e\u4e86\u4e0e\u5206\u533a\u6709\u5173\u7684\u91cd\u8981\u4fe1\u606f\uff0c\u5176\u4e2d\u6bcf\u4e00\u884c\u4e3a\u4e00\u4e2a\u5206\u533a\u8bb0\u5f55\uff0c\u6bcf\u4e00\u884c\u53c8\u53ef\u5206\u4e3a\u516d\u4e2a\u90e8\u4efd\uff0c\u4e0b\u9762\u4ee5/dev/hda7 / ext2 defaults 1 1\u4e3a\u4f8b\u9010\u4e2a\u8bf4\u660e\uff1a 1. \u7b2c\u4e00\u9879\u662f\u60a8\u60f3\u8981mount\u7684\u50a8\u5b58\u88c5\u7f6e\u7684\u5b9e\u4f53\u4f4d\u7f6e\uff0c\u5982hdb\u6216\u5982\u4e0a\u4f8b\u7684/dev/hda7\u3002</p> <p>2. \u7b2c\u4e8c\u9879\u5c31\u662f\u60a8\u60f3\u8981\u5c06\u5176\u52a0\u5165\u81f3\u54ea\u4e2a\u76ee\u5f55\u4f4d\u7f6e\uff0c\u5982/home\u6216\u5982\u4e0a\u4f8b\u7684/,\u8fd9\u5176\u5b9e\u5c31\u662f\u5728\u5b89\u88c5\u65f6\u63d0\u793a\u7684\u6302\u5165\u70b9\u3002</p> <p>3. \u7b2c\u4e09\u9879\u5c31\u662f\u6240\u8c13\u7684local filesystem\uff0c\u5176\u5305\u542b\u4e86\u4ee5\u4e0b\u683c\u5f0f\uff1a\u5982ext\u3001ext2\u3001msdos\u3001iso9660\u3001nfs\u3001swap\u7b49\uff0c\u6216\u5982\u4e0a\u4f8b\u7684ext2\uff0c\u53ef\u4ee5\u53c2\u89c1/proc/filesystems\u8bf4\u660e\u3002</p> <p>4. \u7b2c\u56db\u9879\u5c31\u662f\u60a8mount\u65f6\uff0c\u6240\u8981\u8bbe\u5b9a\u7684\u72b6\u6001\uff0c\u5982ro\uff08\u53ea\u8bfb\uff09\u6216\u5982\u4e0a\u4f8b\u7684defaults\uff08\u5305\u62ec\u4e86\u5176\u5b83\u53c2\u6570\u5982rw\u3001suid\u3001exec\u3001auto\u3001nouser\u3001async\uff09\uff0c\u53ef\u4ee5\u53c2\u89c1\u300cmount nfs\u300d\u3002</p> <p>5. \u7b2c\u4e94\u9879\u662f\u63d0\u4f9bDUMP\u529f\u80fd\uff0c\u5728\u7cfb\u7edfDUMP\u65f6\u662f\u5426\u9700\u8981BACKUP\u7684\u6807\u5fd7\u4f4d\uff0c\u5176\u5185\u5b9a\u503c\u662f0\u3002</p> <p>6. \u7b2c\u516d\u9879\u662f\u8bbe\u5b9a\u6b64filesystem\u662f\u5426\u8981\u5728\u5f00\u673a\u65f6\u505acheck\u7684\u52a8\u4f5c\uff0c\u9664\u4e86root\u7684filesystem\u5176\u5fc5\u8981\u7684check\u4e3a1\u4e4b\u5916\uff0c\u5176\u5b83\u7686\u53ef\u89c6\u9700\u8981\u8bbe\u5b9a\uff0c\u5185\u5b9a\u503c\u662f0\u3002</p> <p>\u9644\u5b8c\u6574\u7684fstab\u793a\u4f8b\uff1a [root@localhost ~]# cat /etc/fstab # # /etc/fstab # Created by anaconda on Thu Aug 14 21:16:42 2014 # # Accessible filesystems, by reference, are maintained under '/dev/disk' # See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info # UUID=94e4e384-0ace-437f-bc96-057dd64f42ee / ext4 defaults,barrier=0 1 1 tmpfs /dev/shm tmpfs defaults 0 0 devpts /dev/pts devpts gid=5,mode=620 0 0 sysfs /sys sysfs defaults 0 0 proc /proc proc defaults 0 0 /dev/xvdb1 /data ext4 defaults 0 0</p> <p>\u300e\u6458\u81ea\u300f\u4e92\u8054\u7f51</p>","tags":[]},{"location":"Misc/2015-09-26-turn-any-linux-computer-into-socks5-proxy-in-one-command.html/","title":"Turn any Linux computer into SOCKS5 proxy in one command","text":"I thought I'd do a shorter article on catonmat this time. It goes hand in hand with my upcoming article series on \"100% technical guide to anonymity\" and it's much easier to write larger articles in smaller pieces. Then I can edit them together and produce the final article. <p>This article will be interesting for those who didn't know it already -- you can turn any Linux computer into a SOCKS5 (and SOCKS4) proxy in just one command:</p> <pre>ssh -N -D 0.0.0.0:1080 localhost</pre> <p>And it doesn't require root privileges. The\u00a0<code>ssh</code>\u00a0command starts up dynamic\u00a0<code>-D</code>\u00a0port forwarding on port<code>1080</code>\u00a0and talks to the clients via SOCSK5 or SOCKS4 protocols, just like a regular SOCKS5 proxy would! The\u00a0<code>-N</code>\u00a0option makes sure ssh stays idle and doesn't execute any commands on localhost.</p> <p>If you also wish the command to go into background as a daemon, then add\u00a0<code>-f</code>\u00a0option:</p> <pre>ssh -f -N -D 0.0.0.0:1080 localhost</pre> <p>To use it, just make your software use SOCKS5 proxy on your Linux computer's IP, port 1080, and you're done, all your requests now get proxied.</p> <p>Access control can be implemented via\u00a0<code>iptables</code>. For example, to allow only people from the ip<code>1.2.3.4</code>\u00a0to use the SOCKS5 proxy, add the following\u00a0<code>iptables</code>\u00a0rules:</p> <pre>iptables -A INPUT --src 1.2.3.4 -p tcp --dport 1080 -j ACCEPT\niptables -A INPUT -p tcp --dport 1080 -j REJECT\n</pre> <p>The first rule says, allow anyone from\u00a0<code>1.2.3.4</code>\u00a0to connect to port\u00a0<code>1080</code>, and the other rule says, deny everyone else from connecting to port\u00a0<code>1080</code>.</p> <p>Surely, executing\u00a0<code>iptables</code>\u00a0requires root privileges. If you don't have root privileges, and you don't want to leave your proxy open (and you really don't want to do that), you'll have to use some kind of a simple TCP proxy wrapper to do access control.</p> <p>Here, I wrote one in Perl. It's called\u00a0<code>tcp-proxy.pl</code>\u00a0and it uses\u00a0<code>IO::Socket::INET</code>\u00a0to abstract sockets, and\u00a0<code>IO::Select</code>\u00a0to do connection multiplexing.</p> <pre>#!/usr/bin/perl # use warnings; use strict; use IO::Socket::INET; use IO::Select; my @allowed_ips = ('1.2.3.4', '5.6.7.8', '127.0.0.1', '192.168.1.2'); my $ioset = IO::Select-&gt;new; my %socket_map; my $debug = 1; sub new_conn { my ($host, $port) = @_; return IO::Socket::INET-&gt;new( PeerAddr =&gt; $host, PeerPort =&gt; $port ) || die \"Unable to connect to $host:$port: $!\"; } sub new_server { my ($host, $port) = @_; my $server = IO::Socket::INET-&gt;new( LocalAddr =&gt; $host, LocalPort =&gt; $port, ReuseAddr =&gt; 1, Listen =&gt; 100 ) || die \"Unable to listen on $host:$port: $!\"; } sub new_connection { my $server = shift; my $client = $server-&gt;accept; my $client_ip = client_ip($client); unless (client_allowed($client)) { print \"Connection from $client_ip denied.\\n\" if $debug; $client-&gt;close; return; } print \"Connection from $client_ip accepted.\\n\" if $debug; my $remote = new_conn('localhost', 55555); $ioset-&gt;add($client); $ioset-&gt;add($remote); $socket_map{$client} = $remote; $socket_map{$remote} = $client; } sub close_connection { my $client = shift; my $client_ip = client_ip($client); my $remote = $socket_map{$client}; $ioset-&gt;remove($client); $ioset-&gt;remove($remote); delete $socket_map{$client}; delete $socket_map{$remote}; $client-&gt;close; $remote-&gt;close; print \"Connection from $client_ip closed.\\n\" if $debug; } sub client_ip { my $client = shift; return inet_ntoa($client-&gt;sockaddr); } sub client_allowed { my $client = shift; my $client_ip = client_ip($client); return grep { $_ eq $client_ip } @allowed_ips; } print \"Starting a server on 0.0.0.0:1080\\n\"; my $server = new_server('0.0.0.0', 1080); $ioset-&gt;add($server); while (1) { for my $socket ($ioset-&gt;can_read) { if ($socket == $server) { new_connection($server); } else { next unless exists $socket_map{$socket}; my $remote = $socket_map{$socket}; my $buffer; my $read = $socket-&gt;sysread($buffer, 4096); if ($read) { $remote-&gt;syswrite($buffer); } else { close_connection($socket); } } } }</pre> <p>To use it, you'll have to make a change to the previous configuration. Instead of running ssh SOCKS5 proxy on\u00a0<code>0.0.0.0:1080</code>, you'll need to run it on\u00a0<code>localhost:55555</code>,</p> <pre>ssh -f -N -D 55555 localhost</pre> <p>After that, run the\u00a0<code>tcp-proxy.pl</code>,</p> <pre>perl tcp-proxy.pl &amp;</pre> <p>The TCP proxy will start listening on\u00a0<code>0.0.0.0:1080</code>\u00a0and will redirect only the allowed IPs in<code>@allowed_ips</code>\u00a0list to\u00a0<code>localhost:55555</code>.</p> <p>Another possibility is to use another computer instead of your own as exit node. What I mean is you can do the following:</p> <pre>ssh -f -N -D 1080 other_computer.com</pre> <p>This will set up a SOCKS5 proxy on\u00a0<code>localhost:1080</code>\u00a0but when you use it, ssh will automatically tunnel your requests (encrypted) via\u00a0<code>other_computer.com</code>. This way you can hide what you're doing on the Internet from anyone who might be sniffing your link. They will see that you're doing something but the traffic will be encrypted so they won't be able to tell what you're doing.</p> <p>That's it. You're now the proxy king!</p> <p>Download tcp-proxy.pl</p> <p>Download link:\u00a0tcp proxy (tcp-proxy.pl) Download URL:\u00a0<code>http://www.catonmat.net/download/tcp-proxy.pl</code> Downloaded: 6262 times</p> <p>I also pushed the tcp-proxy.pl to GitHub:\u00a0tcp-proxy.pl on GitHub. This project is also pretty nifty to generalize and make a program that redirects between any number of hosts:ports, not just two.</p> <p>PS. I will probably also write \"A definitive guide to ssh port forwarding\" some time in the future because it's an interesting but little understood topic.</p> \u300e\u6458\u81ea\u300fhttp://blog.urfix.com/25-ssh-commands-tricks/ <p> </p>","tags":[]},{"location":"Misc/2015-11-27-ubuntu-%25e6%2596%2587%25e4%25bb%25b6%25e5%2585%25b1%25e4%25ba%25ab-samba%25e6%259c%258d%25e5%258a%25a1.html/","title":"Ubuntu \u6587\u4ef6\u5171\u4eab samba\u670d\u52a1","text":"<p>\u6587\u4ef6\u5171\u4eab samba\u670d\u52a1\uff0c\u5b83\u662f\u4e00\u4e2a\u5728linux\u548cunix\u4e0a\u5b9e\u73b0SMB\u534f\u8bae\u7684\u4e00\u4e2a\u514d\u8d39\u8f6f\u4ef6\uff0cSMB\u534f\u8bae\u5168\u79f0\u53eb\u505aServer Message Block\uff08\u4fe1\u606f\u670d\u52a1\u5757\uff09\uff0c\u5b83\u53ef\u4ee5\u5728\u5c40\u57df\u7f51\u4e0a\u5171\u4eab\u6587\u4ef6\u548c\u6253\u5370\u673a\u7684\u4e00\u79cd\u534f\u8bae\uff0c\u529f\u80fd\u5f88\u5f3a\u5927\u3002\u6211\u91c7\u7528\u7684\u662f\u8fd9\u79cd\u65b9\u6cd5\u3002</p> <p>\u9996\u5148\uff0c\u5b89\u88c5smb\uff1a\u6267\u884c\u4e0b\u5217\u547d\u4ee4</p> <p>sudo apt-get install samba</p> <p>sudo apt-get install smbfs</p> <p>\u5982\u679c\u63d0\u793a\u627e\u4e0d\u5230\u8f6f\u4ef6\u7684\u8bdd\uff0cupdate,upgrade\u4e00\u6b21\u5e94\u8be5\u5c31\u884c\u3002</p> <p>\u7136\u540e\uff0c\u7ec8\u7aef\u4e2d\u6267\u884cshares-admin\u547d\u4ee4\uff0c\u53ef\u80fd\u4e5f\u4f1a\u63d0\u793a\u5148\u88c5\u76f8\u5e94\u7684tools\uff0c\u6309\u63d0\u793a\u88c5\u5c31\u884c</p> <p>\u5728\u754c\u9762\u4e2d\uff0c\u5148\u6267\u884cunlock\u64cd\u4f5c\uff0c\u518d\u6dfb\u52a0\u4e00\u4e2a\u5171\u4eab\u6587\u4ef6\u5939\uff0c\u5982\u56fe\u6240\u793a</p> <p></p> <p>\u5171\u4eab\u4e4b\u540e\uff0c\u5982\u679c\u4e0d\u505a\u4efb\u4f55\u8bbe\u7f6e\uff0c\u5219mac os\u53ef\u4ee5\u8fde\u63a5\u5230ubuntu\u865a\u62df\u673a\uff0c\u4f46\u8981\u63d0\u793a\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u6b64\u65f6\u4e0d\u8bba\u8f93\u5165\u4ec0\u4e48\u90fd\u65e0\u6cd5\u8bbf\u95ee\u5171\u4eab\u7684\u5185\u5bb9\u3002</p> <p>\u5b9e\u73b0\u533f\u540d\u8bbf\u95ee\u9700\u8981\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u3002</p> <p>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6smb.conf\uff1a\u6267\u884c\u547d\u4ee4 sudo nano /etc/samba/smb.conf</p> <p>\u5728\u5176\u4e2d\u641c\u7d22\u5230\"security=user\" \u6539\u4e3a \"securtiy=share\"\uff0c\u5e76\u5c06\u8be5\u884c\u5934 # \u6ce8\u91ca\u53bb\u6389\u3002</p> <p>\u91cd\u542fsamba\uff08sudo /etc/init.d/samba restart\uff09\u6216\u91cd\u542f\u865a\u62df\u673a\u3002</p> <p>\u8fd9\u65f6\u5df2\u7ecf\u80fd\u5728mac os\u7684\u6587\u4ef6\u76ee\u5f55\u4e0b\u770b\u5230 \u5171\u4eab\u7684... \u6761\u76ee\uff0c\u5982\u56fe\u6240\u793a</p> <p></p> <p>\u4e0d\u8fc7\uff0c\u8fd9\u4e2a\u65f6\u5019\u53ea\u80fd\u8bfb\uff0c\u4e0d\u80fd\u5199\uff0c\u5982\u679c\u8fd8\u8981\u5199\u5165\u7684\u8bdd\uff0c\u6267\u884c\u547d\u4ee4</p> <p>chmod 777 /home/lemon/Downloads \uff08\u8fd9\u91cc\u7684\u8def\u5f84\u662f\u6211\u5171\u4eab\u6587\u4ef6\u7684\u8def\u5f84\uff09\uff0c\u5230\u8fd9\u91cc\u5df2\u7ecf\u53ef\u4ee5\u4efb\u610f\u7684\u8bfb\u53d6\u5199\u5165\u4e86\u3002</p> <p>\u6458\u81ea\u300c\u4e92\u8054\u7f51\u300d</p>","tags":["ubuntu","samba"]},{"location":"Misc/2015-11-29-iptables%25e7%25ab%25af%25e5%258f%25a3%25e6%2598%25a0%25e5%25b0%2584%25e8%25af%25a6%25e8%25a7%25a3.html/","title":"iptables\u7aef\u53e3\u6620\u5c04\u8be6\u89e3","text":"<p>\u672c\u6587\u4f5c\u8005\uff1a\u5f20\u5929\u6210\u00a0 \u00a0 zhangtiancheng#gmail.com \u8f6c\u53d1\u8bf7\u6ce8\u660e\u51fa\u5904\u3002</p> <p>iptables\u662f\u4e00\u4e2aLinux\u4e0b\u4f18\u79c0\u7684nat+\u9632\u706b\u5899\u5de5\u5177\uff0c\u6211\u4f7f\u7528\u8be5\u5de5\u5177\u4ee5\u8f83\u4f4e\u914d\u7f6e\u7684\u4f20\u7edfpc\u914d\u7f6e\u4e86\u4e00\u4e2a\u7075\u6d3b\u5f3a\u52b2\u7684\u9632\u706b\u5899+nat\u7cfb\u7edf,\u5c0f\u6709\u5fc3\u5f97\uff0c\u770b\u4e86\u7f51\u4e0a\u4e5f\u6709\u5f88\u591a\u8fd9\u65b9\u9762\u7684\u6587\u7ae0\uff0c\u4f46\u662f\u4f3c\u4e4e\u8981\u4e48\u8bf4\u7684\u6bd4\u8f83\u5c11\uff0c\u8981\u4e48\u5c31\u662f\u6bd4\u8f83\u504f\uff0c\u5185\u5bb9\u4e0d\u5168\uff0c\u5bb9\u6613\u8bef\u5bfc\uff0c\u6211\u7814\u7a76\u4e86\u4e00\u6bb5\u65f6\u95f4\u7684iptables\u540c\u65f6\u4e5f\u7528\u4e86\u5f88\u4e45\uff0c\u6709\u70b9\u6ef4\u7ecf\u9a8c\uff0c\u5199\u6765\u4f9b\u5927\u5bb6\u53c2\u8003\uff0c\u540c\u65f6\u4e5f\u5907\u65e5\u540e\u81ea\u5df1\u7ffb\u9605\u3002 \u9996\u5148\u8981\u8bf4\u660e\u7684\u662f\uff0ciptables\u64cd\u4f5c\u7684\u662f2.4\u4ee5\u4e0a\u5185\u6838\u7684netfilter.\u6240\u4ee5\u9700\u8981linux\u7684\u5185\u6838\u57282.4\u4ee5\u4e0a\u3002\u5176\u529f\u80fd\u4e0e\u5b89\u5168\u6027\u8fdc\u8fdc\u6bd4\u5176\u524d\u8f88 ipfwadm,ipchains\u5f3a\u5927\uff0ciptables\u5927\u81f4\u662f\u5de5\u4f5c\u5728OSI\u4e03\u5c42\u7684\u4e8c\u3001\u4e09\u3001\u56db\u5c42\uff0c\u5176\u524d\u8f88ipchains\u4e0d\u80fd\u5355\u72ec\u5b9e\u73b0\u5bf9tcp/udp port\u4ee5\u53ca\u5bf9mac\u5730\u5740\u7684\u7684\u5b9a\u4e49\u4e0e\u64cd\u4f5c\uff0c\u6240\u4ee5\u6211\u60f3ipchains\u5e94\u8be5\u662f\u4ec5\u4ec5\u5de5\u4f5c\u5728\u4e09\u5c42\u4e0a\u7684\u3002</p> <p>\u6211\u4eec\u5148\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0bnetfilter\u7684\u5927\u81f4\u5de5\u4f5c\u6d41\u7a0b\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2a\u6570\u636e\u5305\uff08\u6216\u8005\u53eb\u5206\u7ec4\u3001packet,\u6211\u4e2a\u4eba\u4e60\u60ef\u53eb\u5305\uff09\u5728\u5230\u8fbelinux\u7684\u7f51\u7edc\u63a5\u53e3\u7684\u65f6\u5019\uff08\u7f51\u5361\uff09\u5982\u4f55\u5904\u7406\u8fd9\u4e2a\u5305\uff0c\u7136\u540e\u518d\u4ecb\u7ecd\u4e00\u4e0b\u5982\u4f55\u7528iptables\u6539\u53d8\u6216\u8005\u8bf4\u63a7\u5236\u5bf9\u8fd9\u4e2a\u6570\u636e\u5305\u8fdb\u884c\u64cd\u4f5c\u3002netfilter\u5185\u90e8\u5206\u4e3a\u4e09\u4e2a\u8868\uff0c\u5206\u522b\u662f filter,nat,mangle\uff0c\u6bcf\u4e2a\u8868\u53c8\u6709\u4e0d\u540c\u7684\u64cd\u4f5c\u94fe\uff08Chains\uff09\u3002\u5728filter\uff08\u8fc7\u6ee4\uff09\u8868\u4e2d\uff0c\u4e5f\u5c31\u662f\u4ed6\u7684\u9632\u706b\u5899\u529f\u80fd\u7684\u8fd9\u4e2a\u8868\uff0c\u5b9a\u4e49\u4e86\u4e09\u4e2a Chain\u3002\u5206\u522b\u662fINPUT,FORWARD,OUTPUT\u3002\u4e5f\u5c31\u662f\u5bf9\u5305\u7684\u5165\u3001\u8f6c\u53d1\u3001\u51fa\u8fdb\u884c\u5b9a\u4e49\u7684\u4e09\u4e2a\u8fc7\u6ee4\u94fe\u3002\u5bf9\u4e8e\u8fd9\u4e2afilter\u8868\u7684\u64cd\u4f5c\u548c\u63a7\u5236\u4e5f\u662f\u6211\u4eec\u5b9e\u73b0\u9632\u706b\u5899\u529f\u80fd\u7684\u4e00\u4e2a\u91cd\u8981\u624b\u6bb5\uff1b\u5728nat(Network Address Translation\u3001\u7f51\u7edc\u5730\u5740\u7ffb\u8bd1)\u8868\u4e2d\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u7528\u4ee5\u5b9e\u73b0\u5730\u5740\u8f6c\u6362\u548c\u7aef\u53e3\u8f6c\u53d1\u529f\u80fd\u7684\u8fd9\u4e2a\u8868\uff0c\u5b9a\u4e49\u4e86PREROUTING, POSTROUTING,OUTPUT\u4e09\u4e2a\u94fe,\u4e0b\u9762\u6211\u4eec\u4f1a\u5bf9\u8fd9\u4e09\u4e2a\u94fe\u4f5c\u8be6\u7ec6\u7684\u8bf4\u660e\uff1b\u800cnetfilter\u7684mangle\u8868\u5219\u662f\u4e00\u4e2a\u81ea\u5b9a\u4e49\u8868\uff0c\u91cc\u9762\u5305\u62ec\u4e0a\u9762\u7684filter\u4ee5\u53canat\u8868\u4e2d\u7684\u5404\u79cdchains,\u5b83\u53ef\u4ee5\u8ba9\u6211\u4eec\u8fdb\u884c\u4e00\u4e9b\u81ea\u5b9a\u4e49\u7684\u64cd\u4f5c\uff0c\u540c\u65f6\u8fd9\u4e2amangle\u8868\u4e2d\u7684chains\u5728netfilter\u5bf9\u5305\u7684\u5904\u7406\u6d41\u7a0b\u4e2d\u5904\u5728\u4e00\u4e2a\u6bd4\u8f83\u4f18\u5148\u7684\u4f4d\u7f6e\uff0c\u4e0b\u9762\u6709\u4e00\u5f20\u56fe\u6e05\u6670\u7684\u63cf\u7ed8\u4e86netfilter\u5bf9\u5305\u7684\u5904\u7406\u6d41\u7a0b\uff08\u8be5\u56fe\u6458\u81ea\u7f51\u4e0a\uff0c\u4e0d\u77e5\u4f5c\u8005\u662f\u8c01\uff0c\u5728\u6b64\u6df1\u8868\u656c\u610f\uff01\uff09\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u7528\u4e0d\u5230\u8fd9\u4e2amangle\u8868\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u5c31\u4e0d\u505a\u4ecb\u7ecd\u4e86\u3002 </p> <p>\u5927\u5bb6\u53ef\u4ee5\u770b\u5230\uff0cPREROUTING\u8fd9\u4e2achain\u5728\u6700\u524d\u9762\uff0c\u5f53\u4e00\u4e2a\u5305\u6765\u5230linux\u7684\u7f51\u7edc\u63a5\u53e3\u7684\u65f6\u5019\u5148\u8fc7mangle\u7684PREROUTING,\u7136\u540e\u662f nat\u7684PREROUTING,\u4ece\u8fd9\u4e2achain\u7684\u540d\u5b57\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\uff0c\u8fd9\u4e2achain\u662f\u5728\u8def\u7531\u4e4b\u524d(pre-routing)\u8981\u8fc7\u7684\u3002\u4e3a\u4ec0\u4e48\u8981\u5728\u8def\u7531\u4e4b\u524d\u8fc7\u5462\uff1f\u5927\u5bb6\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u56fe\u4e0a\uff0c\u4e0a\u9762\u6709\u4e00\u4e2a\u83f1\u5f62\u7684\u90e8\u5206\u53ebROUTING,\u8fd9\u4e2aROUTING\u90e8\u5206\u5c31\u662fLinux\u7684route box,\u4e5f\u5c31\u662f\u8def\u7531\u7cfb\u7edf\uff0c\u5b83\u540c\u6837\u6709\u5f88\u9ad8\u6df1\u7684\u529f\u80fd\uff0c\u53ef\u4ee5\u5b9e\u73b0\u7b56\u7565\u8def\u7531\u7b49\u7b49\u4e00\u4e9b\u9ad8\u7ea7\u7279\u6027\uff0c\u6b64\u5904\u6211\u4eec\u4e0d\u505a\u8be6\u7ec6\u89e3\u91ca\u3002\u5355\u8bf4\u8fd9\u4e2aPREROUTING\u94fe\uff0c\u56e0\u4e3a\u5728\u8fd9\u4e2a\u94fe\u91cc\u9762\u6211\u4eec\u5bf9\u5305\u7684\u64cd\u4f5c\u662fDNAT,\u4e5f\u5c31\u662f\u6539\u53d8\u76ee\u7684\u5730\u5740\u548c\uff08\u6216\u7aef\u53e3\uff09\uff0c\u901a\u5e38\u7528\u5728\u7aef\u53e3\u8f6c\u53d1\uff0c\u6216\u8005nat\u5230\u5185\u7f51\u7684DMZ\u533a\uff0c\u4e5f\u5c31\u662f\u8bf4\u5f53\u4e00\u4e2a\u5305\u8fc7\u6765\u7684\u65f6\u5019\u6211\u4eec\u8981\u6539\u53d8\u5b83\u7684\u76ee\u7684\u5730\u5740\uff0c\u5927\u5bb6\u53ef\u4ee5\u60f3\u60f3,\u5982\u679c\u4e00\u4e2a\u5305\u5728\u6539\u53d8\u76ee\u7684\u5730\u5740\u4e4b\u524d\u5c31\u88ab\u6254\u8fdb\u4e86route box,\u8ba9\u7cfb\u7edf\u9009\u597d\u8def\u4e4b\u540e\u518d\u6539\u53d8\u76ee\u7684\u5730\u5740\uff0c\u90a3\u4e48\u9009\u8def\u5c31\u53ef\u80fd\u662f\u9519\u7684\uff0c\u6216\u8005\u8bf4\u6beb\u65e0\u610f\u4e49\u4e86\uff0c\u6240\u4ee5\uff0cPREROUTING\u8fd9\u4e2aChain\u4e00\u5b9a\u8981\u5728\u8fdbRouting \u4e4b\u524d\u505a\u3002\u6bd4\u5982\u8bf4\uff0c\u6211\u4eec\u7684\u516c\u7f51ip\u662f60.1.1.1/24,\u4f4d\u4e8elinux\u4e2d\u7684eth0,\u5185\u7f51ip\u662f10.1.1.1/24\u4f4d\u4e8elinux\u4e2d\u7684eth1, \u6211\u4eec\u7684\u5185\u7f51\u6709\u4e00\u53f0web\u670d\u52a1\u5668\uff0c\u5730\u5740\u662f10.1.1.2/24,\u6211\u4eec\u600e\u4e48\u6837\u80fd\u8ba9internet\u7528\u6237\u901a\u8fc7\u8fd9\u4e2a\u516c\u7f51ip\u8bbf\u95ee\u6211\u4eec\u5185\u90e8\u7684\u8fd9\u4e2aweb\u670d\u52a1\u5668\u5462\uff1f\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u8fd9\u4e2aPREROUTING\u94fe\u4e0a\u9762\u5b9a\u4e49\u4e00\u4e2a\u89c4\u5219\uff0c\u628a\u8bbf\u95ee60.1.1.1:80\u7684\u7528\u6237\u7684\u76ee\u7684\u5730\u5740\u6539\u53d8\u4e00\u4e0b\uff0c\u6539\u53d8\u4e3a10.1.1.2:80,\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86internet\u7528\u6237\u5bf9\u5185\u7f51\u670d\u52a1\u5668\u7684\u8bbf\u95ee\u4e86\uff0c\u5f53\u7136\u4e86\uff0c\u8fd9\u4e2a\u7aef\u53e3\u662f\u6bd4\u8f83\u7075\u6d3b\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u4efb\u4f55\u4e00\u4e2a\u7aef\u53e3\u7684\u8f6c\u53d1\uff0c\u4e0d\u4e00\u5b9a\u662f80--&gt;80\uff0c\u5177\u4f53\u7684\u547d\u4ee4\u6211\u4eec\u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\u4ecb\u7ecd\uff0c\u8fd9\u91cc\u6211\u4eec\u53ea\u8c08\u6d41\u7a0b\u4e0e\u6982\u5ff5\u4e0a\u7684\u5b9e\u73b0\u65b9\u6cd5\u3002</p> <p>\u597d\u4e86\uff0c\u6211\u4eec\u63a5\u7740\u5f80\u4e0b\u8d70\uff0c\u8fd9\u4e2a\u5305\u5df2\u7ecf\u8fc7\u4e86\u4e24\u4e2aPREROUTING\u94fe\u4e86\uff0c\u8fd9\u4e2a\u65f6\u5019\uff0c\u51fa\u73b0\u4e86\u4e00\u4e2a\u5206\u652f\u8f6c\u6298\u7684\u5730\u65b9\uff0c\u4e5f\u5c31\u662f\u56fe\u4e2d\u4e0b\u65b9\u7684\u90a3\u4e2a\u83f1\u5f62\uff08FORWARD\uff09,\u8f6c\u53d1\uff01\u8fd9\u91cc\u6709\u4e00\u4e2a\u5bf9\u76ee\u7684\u5730\u5740\u7684\u5224\u65ad\uff08\u8fd9\u91cc\u540c\u6837\u8bf4\u660e\u4e86PREROUTING\u4e00\u5b9a\u8981\u5728\u6700\u5148\uff0c\u4e0d\u4ec5\u8981\u5728route box\u4e4b\u524d\uff0c\u751a\u81f3\u662f\u8fd9\u4e2a\u5bf9\u76ee\u7684\u5730\u5740\u7684\u5224\u65ad\u4e4b\u524d\uff0c\u56e0\u4e3a\u6211\u4eec\u53ef\u80fd\u505a\u4e00\u4e2a\u53bb\u67d0\u67d0\u67d0ip\u7684\u5730\u65b9\u8f6c\u5230\u81ea\u5df1\u7684ip\u7684\u89c4\u5219\uff0c\u6240\u4ee5PREROUTING\u662f\u6700\u5148\u5904\u7406\u8fd9\u4e2a\u5305\u7684 Chain\uff09\uff01\u5982\u679c\u5305\u7684\u76ee\u7684\u5730\u662f\u672c\u673aip,\u90a3\u4e48\u5305\u5411\u4e0a\u8d70\uff0c\u8d70\u5165INPUT\u94fe\u5904\u7406\uff0c\u7136\u540e\u8fdb\u5165LOCAL PROCESS,\u5982\u679c\u975e\u672c\u5730\uff0c\u90a3\u4e48\u5c31\u8fdb\u5165FORWARD\u94fe\u8fdb\u884c\u8fc7\u6ee4\uff0c\u6211\u4eec\u5728\u8fd9\u91cc\u5c31\u4e0d\u4ecb\u7ecdINPUT,OUTPUT\u7684\u5904\u7406\u4e86\uff0c\u56e0\u4e3a\u90a3\u4e3b\u8981\u662f\u5bf9\u4e8e\u672c\u673a\u5b89\u5168\u7684\u4e00\u79cd\u5904\u7406\uff0c\u6211\u4eec\u8fd9\u91cc\u4e3b\u8981\u8bf4\u5bf9\u8f6c\u53d1\u7684\u8fc7\u6ee4\u548cnat\u7684\u5b9e\u73b0\u3002</p> <p>\u8fd9\u91cc\u7684FORWARD\u6211\u7b80\u5355\u8bf4\u4e00\u4e0b\uff0c\u5f53linux\u6536\u5230\u4e86\u4e00\u4e2a\u76ee\u7684ip\u5730\u5740\u4e0d\u662f\u672c\u5730\u7684\u5305\uff0cLinux\u4f1a\u628a\u8fd9\u4e2a\u5305\u4e22\u5f03\uff0c\u56e0\u4e3a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cLinux\u7684\u4e09\u5c42\u5305\u8f6c\u53d1\u529f\u80fd\u662f\u5173\u95ed\u7684\uff0c\u5982\u679c\u8981\u8ba9\u6211\u4eec\u7684linux\u5b9e\u73b0\u8f6c\u53d1\uff0c\u5219\u9700\u8981\u6253\u5f00\u8fd9\u4e2a\u8f6c\u53d1\u529f\u80fd\uff0c\u53ef\u4ee5\u6539\u53d8\u5b83\u7684\u4e00\u4e2a\u7cfb\u7edf\u53c2\u6570\uff0c\u4f7f\u7528sysctl net.ipv4.ip_forward=1\u6216\u8005echo \"1\" &gt; /proc/sys/net/ipv4/ip_forward\u547d\u4ee4\u6253\u5f00\u8f6c\u53d1\u529f\u80fd\u3002\u597d\u4e86\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u8ba9linux\u5141\u8bb8\u8f6c\u53d1\uff0c\u8fd9\u4e2a\u5305\u7684\u76ee\u7684\u5730\u5740\u4e5f\u4e0d\u662f\u672c\u673a\uff0c\u90a3\u4e48\u5b83\u5c06\u63a5\u7740\u8d70\u5165FORWARD\u94fe\uff0c\u5728FORWARD\u94fe\u91cc\u9762\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5b9a\u4e49\u8be6\u7ec6\u7684\u89c4\u5219\uff0c\u4e5f\u5c31\u662f\u662f\u5426\u5141\u8bb8\u4ed6\u901a\u8fc7\uff0c\u6216\u8005\u5bf9\u8fd9\u4e2a\u5305\u7684\u65b9\u5411\u6d41\u7a0b\u8fdb\u884c\u4e00\u4e9b\u6539\u53d8\uff0c\u8fd9\u4e5f\u662f\u6211\u4eec\u5b9e\u73b0\u8bbf\u95ee\u63a7\u5236\u7684\u5730\u65b9\uff0c\u8fd9\u91cc\u540c\u6837\u4e5f\u662fMangle_FORWARD\u7136\u540efilter_FORWARD,\u6211\u4eec\u64cd\u4f5c\u4efb\u4f55\u4e00\u4e2a\u94fe\u90fd\u4f1a\u5f71\u54cd\u5230\u8fd9\u4e2a\u5305\u7684\u547d\u8fd0\uff0c\u5728\u4e0b\u9762\u7684\u4ecb\u7ecd\u4e2d\uff0c\u6211\u4eec\u5c31\u5ffd\u7565\u6389mangle\u8868\uff0c\u6211\u4eec\u57fa\u672c\u7528\u4e0d\u5230\u64cd\u4f5c\u5b83\uff0c\u6240\u4ee5\u6211\u4eec\u5047\u8bbe\u5b83\u662f\u900f\u660e\u7684\u3002\u5047\u8bbe\u8fd9\u4e2a\u5305\u88ab\u6211\u4eec\u7684\u89c4\u5219\u653e\u8fc7\u53bb\u4e86\uff0c\u4e5f\u5c31\u662fACCEPT\u4e86\uff0c\u5b83\u5c06\u8fdb\u5165POSTROUTING\u90e8\u5206\uff0c\u6ce8\u610f\uff01\u8fd9\u91cc\u6211\u6ce8\u610f\u5230\u4e00\u4e2a\u7ec6\u8282\u95ee\u9898\uff0c\u4e5f\u5c31\u662f\u4e0a\u9762\u7684\u56fe\u4e2d\u6570\u636e\u5305\u8fc7\u4e86FORWARD\u94fe\u4e4b\u540e\u76f4\u63a5\u8fdb\u5165\u4e86POSTROUITNG \u94fe\uff0c\u6211\u89c9\u5f97\u8fd9\u4e2d\u95f4\u7f3a\u5c11\u4e00\u4e2a\u73af\u8282\uff0c\u4e5f\u5c31\u662froute box,\u5bf9\u4e8e\u8f6c\u53d1\u7684\u5305\u6765\u8bf4\uff0clinux\u540c\u6837\u9700\u8981\u5728\u9009\u8def\uff08\u8def\u7531\uff09\u4e4b\u540e\u624d\u80fd\u5c06\u5b83\u9001\u51fa\uff0c\u8fd9\u4e2a\u56fe\u5374\u6ca1\u6709\u6807\u660e\u8fd9\u4e00\u70b9\uff0c\u6211\u8ba4\u4e3a\u5b83\u662f\u5728\u8fc7\u4e86route box\u4e4b\u540e\u624d\u8fdb\u5165\u7684POSTROUITNG,\u5f53\u7136\u4e86\uff0c\u8fd9\u5bf9\u4e8e\u6211\u4eec\u8ba8\u8bbaiptables\u7684\u8fc7\u6ee4\u8f6c\u53d1\u6765\u8bf4\u4e0d\u662f\u5f88\u91cd\u8981\uff0c\u53ea\u662f\u6211\u89c9\u5f97\u6d41\u7a0b\u4e0a\u6709\u8fd9\u4e2a\u95ee\u9898\uff0c\u8fd8\u662f\u8981\u8bf4\u660e\u4e00\u4e0b\u3002</p> <p>\u540c\u6837\u7684\uff0c\u6211\u4eec\u5728\u8fd9\u91cc\u4ece\u540d\u5b57\u5c31\u53ef\u4ee5\u770b\u51fa\uff0c\u8fd9\u4e2aPOSTROUTING\u94fe\u5e94\u8be5\u662f\u8def\u7531\u4e4b\u540e\u7684\u4e00\u4e2a\u94fe\uff0c\u4e5f\u5c31\u662f\u8fd9\u4e2a\u5305\u8981\u9001\u51fa\u8fd9\u53f0Linux\u7684\u6700\u540e\u4e00\u4e2a\u73af\u8282\u4e86\uff0c\u8fd9\u4e5f\u662f\u6781\u5176\u91cd\u8981\u7684\u4e00\u4e2a\u73af\u8282\uff01\uff01\u8fd9\u4e2a\u65f6\u5019linux\u5df2\u7ecf\u5b8c\u6210(has done..^_^)\u4e86\u5bf9\u8fd9\u4e2a\u5305\u7684\u8def\u7531\uff08\u9009\u8def\u5de5\u4f5c\uff09\uff0c\u5df2\u7ecf\u627e\u5230\u4e86\u5408\u9002\u7684\u63a5\u53e3\u9001\u51fa\u8fd9\u4e2a\u5305\u4e86\uff0c\u5728\u8fd9\u4e2a\u94fe\u91cc\u9762\u6211\u4eec\u8981\u8fdb\u884c\u91cd\u8981\u7684\u64cd\u4f5c\uff0c\u5c31\u662f\u88abLinux\u79f0\u4e3a SNAT\u7684\u4e00\u4e2a\u52a8\u4f5c\uff0c\u4fee\u6539\u6e90ip\u5730\u5740\uff01\u4e3a\u4ec0\u4e48\u4fee\u6539\u6e90ip\u5730\u5740\uff1f\u5f88\u591a\u60c5\u51b5\u9700\u8981\u4fee\u6539\u6e90\u5730\u5740\u963f\uff0c\u6700\u5e38\u89c1\u7684\u5c31\u662f\u6211\u4eec\u5185\u7f51\u591a\u53f0\u673a\u5668\u9700\u8981\u5171\u4eab\u4e00\u4e2a\u6216\u51e0\u4e2a\u516c\u7f51ip\u8bbf\u95ee internet,\u56e0\u4e3a\u6211\u4eec\u7684\u5185\u7f51\u5730\u5740\u662f\u79c1\u6709\u7684\uff0c\u5047\u5982\u5c31\u8ba9linux\u7ed9\u8def\u7531\u51fa\u53bb\uff0c\u6e90\u5730\u5740\u4e5f\u4e0d\u53d8\uff0c\u8fd9\u4e2a\u5305\u5e94\u8be5\u80fd\u8bbf\u95ee\u5230\u76ee\u7684\u5730\uff0c\u4f46\u662f\u5374\u56de\u4e0d\u6765\uff0c\u56e0\u4e3a internet\u4e0a\u7684N\u591a\u4e2a\u8def\u7531\u8282\u70b9\u4e0d\u4f1a\u8f6c\u53d1\u79c1\u6709\u5730\u5740\u7684\u6570\u636e\u5305\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e0d\u7528\u5408\u6cd5ip,\u6211\u4eec\u7684\u6570\u636e\u5305\u6709\u53bb\u65e0\u56de\u3002\u6709\u4eba\u4f1a\u8bf4\uff1a\u201c\u65e2\u7136\u662f\u8fd9\u6837\uff0c\u6211\u5c31\u4e0d\u7528\u79c1\u6709 ip\u4e86\uff0c\u6211\u81ea\u5df1\u5206\u914d\u81ea\u5df1\u5408\u6cd5\u7684\u5730\u5740\u4e0d\u884c\u5417\uff1f\u90a3\u6837\u5305\u5c31\u4f1a\u56de\u6765\u4e86\u5427\uff1f\u201d\u7b54\u6848\u662f\u5426\u5b9a\u7684\uff0cip\u5730\u5740\u662fICANN\u6765\u5206\u914d\u7684\uff0c\u4f60\u7684\u6570\u636e\u5305\u6216\u8bb8\u80fd\u53d1\u5230\u76ee\u7684\u5730\uff0c\u4f46\u662f\u56de\u6765\u7684\u65f6\u5019\u4eba\u5bb6\u53ef\u4e0d\u4f1a\u8f6c\u5230\u4f60\u90a3\u91cc\uff0cinternet\u4e0a\u7684\u8def\u7531\u5668\u4e2d\u7684\u8def\u7531\u4fe1\u606f\u4f1a\u628a\u8fd9\u4e2a\u8fd4\u56de\u5305\u9001\u5230\u90a3\u4e2a\u5408\u6cd5\u7684\u83b7\u5f97ip\u7684\u5730\u65b9\u53bb\uff0c\u4f60\u540c\u6837\u6536\u4e0d\u5230,\u800c\u4f60\u8fd9\u79cd\u884c\u4e3a\u6709\u53ef\u80fd\u88ab\u5b9a\u4e49\u4e3a\u4e00\u79cdip\u6b3a\u9a97\uff0c\u5f88\u591a\u8bbe\u5907\u4f1a\u628a\u8fd9\u6837\u7684\u5305\u5728\u63a5\u5165\u7aef\u5c31\u7ed9\u6ee4\u6389\u4e86\uff0c\u53ef\u80fd\u90fd\u5230\u4e0d\u4e86\u4f60\u8981\u8bbf\u95ee\u7684\u90a3\u4e2a\u670d\u52a1\u5668\uff0c\u5475\u5475\u3002</p> <p>\u90a3\u4e48Linux\u5982\u4f55\u505aSNAT\u5462\uff1f\u6bd4\u5982\u4e00\u4e2a\u5185\u7f51\u768410.1.1.11\u7684pc\u8bbf\u95ee202.2.2.2\u7684\u4e00\u4e2aweb\u670d\u52a1\u5668\uff0clinux\u7684\u5185\u7f51\u63a5\u53e310.1.1.1\u5728\u6536\u5230\u8fd9\u4e2a\u5305\u4e4b\u540e\u628a\u539f\u6765\u7684PC\u7684 ip10.1.1.11\u6539\u53d8\u4e3a60.1.1.1\u7684\u5408\u6cd5\u5730\u5740\u7136\u540e\u9001\u51fa\uff0c\u540c\u65f6\u5728\u81ea\u5df1\u7684ip_conntrack\u8868\u91cc\u9762\u505a\u4e00\u4e2a\u8bb0\u5f55,\u8bb0\u4f4f\u662f\u5185\u7f51\u7684\u54ea\u4e00\u4e2aip\u7684\u54ea\u4e2a\u7aef\u53e3\u8bbf\u95ee\u7684\u8fd9\u4e2aweb\u670d\u52a1\u5668\uff0c\u81ea\u5df1\u628a\u5b83\u7684\u6e90\u5730\u5740\u6539\u6210\u591a\u5c11\u4e86\uff0c\u7aef\u53e3\u6539\u6210\u591a\u5c11\u4e86\uff0c\u4ee5\u4fbf\u8fd9\u4e2aweb\u670d\u52a1\u5668\u8fd4\u56de\u6570\u636e\u5305\u7684\u65f6\u5019linux\u5c06\u5b83\u51c6\u786e\u7684\u9001\u56de\u7ed9\u53d1\u9001\u8bf7\u6c42\u7684\u8fd9\u4e2apc.</p> <p>\u5927\u4f53\u7684\u6570\u636e\u8f6c\u53d1\u6d41\u7a0b\u6211\u4eec\u8bf4\u5b8c\u4e86,\u6211\u4eec\u770b\u770biptables\u4f7f\u7528\u4ec0\u4e48\u6837\u7684\u53c2\u6570\u6765\u5b8c\u6210\u8fd9\u4e9b\u64cd\u4f5c\u3002 \u5728\u63cf\u8ff0\u8fd9\u4e9b\u5177\u4f53\u7684\u64cd\u4f5c\u4e4b\u524d\uff0c\u6211\u8fd8\u8981\u8bf4\u51e0\u4e2a\u6211\u5bf9iptables\u7684\u6982\u5ff5\u7684\u7406\u89e3\uff08\u672a\u5fc5\u5b8c\u5168\u6b63\u786e\uff09\uff0c\u8fd9\u5c06\u6709\u52a9\u4e8e\u5927\u5bb6\u7406\u89e3\u8fd9\u4e9b\u89c4\u5219\uff0c\u4ee5\u5b9e\u73b0\u66f4\u7cbe\u786e\u7684\u63a7\u5236\u3002\u4e0a\u6587\u4e2d\u6211\u4eec\u63d0\u5230\u8fc7\uff0c\u5bf9\u5305\u7684\u63a7\u5236\u662f\u7531\u6211\u4eec\u5728\u4e0d\u540c\u7684Chain(\u94fe)\u4e0a\u9762\u6dfb\u52a0\u4e0d\u540c\u7684\u89c4\u5219\u6765\u5b9e\u73b0\u7684\uff0c\u6bd4\u5982\u6211\u4eec\u5bf9\u8fc7\u6ee4\u8868\uff08filter table\uff09\u6dfb\u52a0\u89c4\u5219\u6765\u6267\u884c\u5bf9\u5305\u7684\u64cd\u63a7\u3002\u90a3\u4e48\u65e2\u7136\u53eb\u94fe\uff0c\u4e00\u5b9a\u5c31\u662f\u4e00\u6761\u6216\u8005\u591a\u6761\u89c4\u5219\u7ec4\u6210\u7684\u4e86\uff0c\u8fd9\u65f6\u5c31\u6709\u4e00\u4e2a\u95ee\u9898\u4e86\uff0c\u5982\u679c\u591a\u4e2a\u89c4\u5219\u5bf9\u540c\u4e00\u79cd\u5305\u8fdb\u884c\u4e86\u5b9a\u4e49\uff0c\u4f1a\u53d1\u751f\u4ec0\u4e48\u4e8b\u60c5\u5462\uff1f\u5728Chain\u4e2d\uff0c\u6240\u6709\u7684\u89c4\u5219\u90fd\u662f\u4ece\u4e0a\u5411\u4e0b\u6765\u6267\u884c\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u5339\u914d\u4e86\u7b2c\u4e00\u884c\uff0c\u90a3\u4e48\u5c31\u6309\u7167\u7b2c\u4e00\u884c\u7684\u89c4\u5219\u6267\u884c\uff0c\u4e00\u884c\u4e00\u884c\u7684\u5f80\u4e0b\u627e\uff0c\u76f4\u5230\u627e\u5230\u7b26\u5408\u8fd9\u4e2a\u7c7b\u578b\u7684\u5305\u7684\u89c4\u5219\u4e3a\u6b62\u3002\u5982\u679c\u627e\u4e86\u4e00\u904d\u6ca1\u6709\u627e\u5230\u7b26\u5408\u8fd9\u4e2a\u5305\u7684\u89c4\u5219\u600e\u4e48\u529e\u5462\uff1fitpables\u91cc\u9762\u6709\u4e00\u4e2a\u6982\u5ff5\uff0c\u5c31\u662fPolicy,\u4e5f\u5c31\u662f\u7b56\u7565\u3002\u4e00\u8bf4\u8fd9\u4e2a\u4e1c\u897f\u5927\u5bb6\u53ef\u80fd\u5c31\u4f1a\u89c9\u5f97\u6bd4\u8f83\u9ebb\u70e6\uff0c\u4ec0\u4e48\u7b56\u7565\u963f\uff0c\u6211\u5bf9\u4e8e\u5b83\u7684\u7406\u89e3\u5c31\u662f\u6240\u8c13\u8fd9\u4e2a\u7b56\u7565\u5c31\u662fchain\u4e2d\u7684\u6700\u540e\u4e00\u6761\u89c4\u5219\uff0c\u4e5f\u5c31\u662f\u8bf4\u5982\u679c\u627e\u4e86\u4e00\u904d\u627e\u4e0d\u5230\u7b26\u5408\u5904\u7406\u8fd9\u4e2a\u5305\u7684\u89c4\u5219\uff0c\u5c31\u6309\u7167policy\u6765\u529e\u3002\u8fd9\u6837\u7406\u89e3\u8d77\u6765\u5c31\u5bb9\u6613\u591a\u4e86\u3002iptables \u4f7f\u7528-P\u6765\u8bbe\u7f6eChain\u7684\u7b56\u7565\u3002</p> <p>\u597d\u4e86\uff0c\u6211\u4eec\u8a00\u5f52\u6b63\u4f20\uff0c\u6765\u8bf4\u8bf4iptables\u5230\u5e95\u600e\u6837\u5b9e\u73b0\u5bf9\u5305\u7684\u63a7\u5236</p> <p>\u5148\u4ecb\u7ecd\u4e00\u4e0biptables\u5982\u4f55\u64cd\u4f5c\u94fe \u5bf9\u94fe\u7684\u64cd\u4f5c\u5c31\u90a3\u4e48\u51e0\u79cd\uff0c-I(\u63d2\u5165) -A(\u8ffd\u52a0) -R(\u66ff\u6362) -D\uff08\u5220\u9664\uff09 -L\uff08\u5217\u8868\u663e\u793a\uff09 \u8fd9\u91cc\u8981\u8bf4\u660e\u7684\u5c31\u662f-I\u5c06\u4f1a\u628a\u89c4\u5219\u653e\u5728\u7b2c\u4e00\u884c\uff0c-A\u5c06\u4f1a\u653e\u5728\u6700\u540e\u4e00\u884c\u3002 \u6bd4\u5982\u6211\u4eec\u8981\u6dfb\u52a0\u4e00\u4e2a\u89c4\u5219\u5230filter\u8868\u7684FORWARD\u94fe iptables -t filter -A FORWARD -s 10.1.1.11 -d 202.1.1.1 -j ACCEPT \u4e0a\u9762\u7684\u547d\u4ee4\u610f\u601d\u4e3a\uff1a\u8ffd\u52a0\u4e00\u4e2a\u89c4\u5219\u81f3filter\u8868\u4e2d\u7684FORWARD\u94fe\u5c3e\uff0c\u5141\u8bb8\uff08-j ACCEPT\uff09\u6e90\u5730\u5740\u4e3a10.1.1.11\u76ee\u7684\u5730\u5740\u4e3a202.1.1.1\u7684\u6570\u636e\u5305\u901a\u8fc7\u3002\u5176\u4e2d-t\u540e\u9762\u8ddf\u7684\u662f\u8868\u540d\uff0c\u5728-A\u540e\u9762\u8ddfChain\u540d\uff0c\u540e\u9762\u7684\u5c0f\u5199\u7684 -s\u4e3a\u6e90\u5730\u5740\uff0c-d\u4e3a\u76ee\u7684\u5730\u5740\uff0c-j\u4e3a\u5904\u7406\u65b9\u5411\u3002 \u5728iptables\u4e2d\uff0c\u9ed8\u8ba4\u7684\u8868\u540d\u5c31\u662ffilter\uff0c\u6240\u4ee5\u8fd9\u91cc\u53ef\u4ee5\u7701\u7565-t filter\u76f4\u63a5\u5199\u6210:iptables -A FORWARD -s 10.1.1.11 -d 202.1.1.1 -j ACCEPT</p> <p>iptables\u4e2d\u7684\u5339\u914d\u53c2\u6570\uff1a \u6211\u4eec\u5728\u8fd9\u91cc\u5c31\u4ecb\u7ecd\u51e0\u79cd\u5e38\u7528\u7684\u53c2\u6570\uff0c\u8be6\u7ec6\u5730\u7528\u6cd5\u53ef\u4ee5man iptables\u770b\u5b83\u7684\u8054\u673a\u6587\u6863\uff0c\u4f60\u4f1a\u6709\u610f\u5916\u7684\u6536\u83b7\u3002 -s\u5339\u914d\u6e90\u5730\u5740 -d\u5339\u914d\u76ee\u7684\u5730\u5740 -p\u534f\u8bae\u5339\u914d -i\u5165\u63a5\u53e3\u5339\u914d -o\u51fa\u63a5\u53e3\u5339\u914d --sport\uff0c--dport\u6e90\u548c\u76ee\u7684\u7aef\u53e3\u5339\u914d -j\u8df3\u8f6c,\u4e5f\u5c31\u662f\u5305\u7684\u65b9\u5411 \u5176\u4e2d\u8fd8\u6709\u4e00\u4e2a!\u53c2\u6570\uff0c\u4f7f\u7528!\u5c31\u662f\u53d6\u53cd\u7684\u610f\u601d\u3002\u4e0b\u9762\u6211\u4eec\u7b80\u5355\u4e3e\u51e0\u4e2a\u4f8b\u5b50\u4ecb\u7ecd\u4e00\u4e0b\u3002 -s\u8fd9\u4e2a\u53c2\u6570\u5462\u5c31\u662f\u6307\u5b9a\u6e90\u5730\u5740\u7684\uff0c\u5982\u679c\u4f7f\u7528\u8fd9\u4e2a\u53c2\u6570\u4e5f\u5c31\u662f\u544a\u8bc9netfilter\uff0c\u5bf9\u4e8e\u7b26\u5408\u8fd9\u6837\u4e00\u4e2a\u6e90\u5730\u5740\u7684\u5305\u600e\u4e48\u53bb\u5904\u7406\uff0c\u53ef\u4ee5\u6307\u5b9a\u67d0\u4e00\u4e2a\u5355\u64adip\u5730\u5740\uff0c\u4e5f\u53ef\u4ee5\u6307\u5b9a\u4e00\u4e2a\u7f51\u7edc\uff0c\u5982\u679c\u5355\u4e2a\u7684ip\u5730\u5740\u5176\u5b9e\u9690\u542b\u4e86\u4e00\u4e2a32\u4f4d\u7684\u5b50\u7f51\u63a9\u7801\uff0c\u6bd4\u5982-s 10.1.1.11 \u5176\u5b9e\u5c31\u662f-s 10.1.1.11/32 \u540c\u6837\u6211\u4eec\u53ef\u4ee5\u6307\u5b9a\u4e0d\u540c\u7684\u63a9\u7801\u7528\u4ee5\u5b9e\u73b0\u6e90\u7f51\u7edc\u5730\u5740\u7684\u89c4\u5219\uff0c\u6bd4\u5982\u4e00\u4e2aC\u7c7b\u5730\u5740\u6211\u4eec\u53ef\u4ee5\u7528-s 10.1.1.0/24\u6765\u6307\u5b9a\u3002 -d\u53c2\u6570\u4e0e-s\u683c\u5f0f\u4e00\u6837\u3002 -i\u53c2\u6570\u662f\u6307\u5b9a\u5165\u63a5\u53e3\u7684\u7f51\u7edc\u63a5\u53e3\uff0c\u6bd4\u5982\u6211\u4ec5\u4ec5\u5141\u8bb8\u4eceeth3\u63a5\u53e3\u8fc7\u6765\u7684\u5305\u901a\u8fc7FORWARD\u94fe\uff0c\u5c31\u53ef\u4ee5\u8fd9\u6837\u6307\u5b9aiptables -A FORWARD -i eth3 -j ACCEPT -o\u662f\u51fa\u63a5\u53e3,\u4e0e\u4e0a\u540c.</p> <p>\u6211\u4eec\u4e0b\u9762\u7528\u4e00\u4e9b\u7b80\u5355\u7684\u5b9e\u4f8b\u6765step by step\u770b\u770biptables\u7684\u5177\u4f53\u914d\u7f6e\u65b9\u6cd5\u3002</p> <p>\u5b9e\u4f8b\u4e00\uff1a\u7b80\u5355\u7684nat\u8def\u7531\u5668 \u73af\u5883\u4ecb\u7ecd\uff1a linux 2.4 + 2\u4e2a\u7f51\u7edc\u63a5\u53e3 Lan\u53e3:10.1.1.254/24 eth0 Wan\u53e3:60.1.1.1/24 eth1 \u76ee\u7684\uff1a\u5b9e\u73b0\u5185\u7f51\u4e2d\u7684\u8282\u70b9\uff0810.1.1.0/24\uff09\u53ef\u63a7\u7684\u8bbf\u95eeinternet\u3002</p> <p>\u9996\u5148\u5c06Lan\u7684\u8282\u70b9pc\u7684\u7f51\u5173\u6307\u541110.1.1.254 \u786e\u5b9a\u4f60\u7684linux\u7684ip\u914d\u7f6e\u65e0\u8bef\uff0c\u53ef\u4ee5\u6b63\u786e\u7684ping\u901a\u5185\u5916\u7684\u5730\u5740\u3002\u540c\u65f6\u7528route\u547d\u4ee4\u67e5\u770blinux\u7684\u672c\u5730\u8def\u7531\u8868\uff0c\u786e\u8ba4\u6307\u5b9a\u4e86\u53ef\u7528\u7684ISP\u63d0\u4f9b\u7684\u9ed8\u8ba4\u7f51\u5173\u3002 \u4f7f\u7528sysctl net.ipv4.ip_forward=1\u6253\u5f00linux\u7684\u8f6c\u53d1\u529f\u80fd\u3002</p> <p>iptables -P FORWARD DROP \u5c06FORWARD\u94fe\u7684\u7b56\u7565\u8bbe\u7f6e\u4e3aDROP\uff0c\u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\u505a\u5230\u5bf9\u5185\u7f51ip\u7684\u63a7\u5236\uff0c\u4f60\u5141\u8bb8\u54ea\u4e00\u4e2a\u8bbf\u95eeinternet\u5c31\u53ef\u4ee5\u589e\u52a0\u4e00\u4e2a\u89c4\u5219\uff0c\u4e0d\u5728\u89c4\u5219\u4e2d\u7684ip\u5c06\u65e0\u6cd5\u8bbf\u95eeinternet.</p> <p>iptables -A FORWARD -m state --state ESTABLISHED,RELATED -j ACCEPT \u8fd9\u6761\u89c4\u5219\u89c4\u5b9a\u5141\u8bb8\u4efb\u4f55\u5730\u5740\u5230\u4efb\u4f55\u5730\u5740\u7684\u786e\u8ba4\u5305\u548c\u5173\u8054\u5305\u901a\u8fc7\u3002\u4e00\u5b9a\u8981\u52a0\u8fd9\u4e00\u6761\uff0c\u5426\u5219\u4f60\u53ea\u5141\u8bb8lan IP\u8bbf\u95ee\u6ca1\u6709\u7528\uff0c\u81f3\u4e8e\u4e3a\u4ec0\u4e48\uff0c\u4e0b\u9762\u6211\u4eec\u518d\u8be6\u7ec6\u8bf4\u3002</p> <p>iptables -t nat -A POSTROUTING -s 10.1.1.0/24 -j SNAT --to 60.1.1.1 \u8fd9\u6761\u89c4\u5219\u505a\u4e86\u4e00\u4e2aSNAT\uff0c\u4e5f\u5c31\u662f\u6e90\u5730\u5740\u8f6c\u6362\uff0c\u5c06\u6765\u81ea10.1.1.0/24\u7684\u5730\u5740\u8f6c\u6362\u4e3a60.1.1.1</p> <p>\u6709\u8fd9\u51e0\u6761\u89c4\u5219\uff0c\u4e00\u4e2a\u7b80\u5355\u7684nat\u8def\u7531\u5668\u5c31\u5b9e\u73b0\u4e86\u3002\u8fd9\u65f6\u4f60\u53ef\u4ee5\u5c06\u5141\u8bb8\u8bbf\u95ee\u7684ip\u6dfb\u52a0\u81f3FORWARD\u94fe\uff0c\u4ed6\u4eec\u5c31\u80fd\u8bbf\u95eeinternet\u4e86\u3002</p> <p>\u6bd4\u5982\u6211\u60f3\u8ba910.1.1.9\u8fd9\u4e2a\u5730\u5740\u8bbf\u95eeinternet,\u90a3\u4e48\u4f60\u5c31\u52a0\u5982\u4e0b\u7684\u547d\u4ee4\u5c31\u53ef\u4ee5\u4e86\u3002 iptables -A FORWARD -s 10.1.1.9 -j ACCEPT</p> <p>\u4e5f\u53ef\u4ee5\u7cbe\u786e\u63a7\u5236\u4ed6\u7684\u8bbf\u95ee\u5730\u5740,\u6bd4\u5982\u6211\u5c31\u5141\u8bb810.1.1.99\u8bbf\u95ee3.3.3.3\u8fd9\u4e2aip iptables -A FORWARD -s 10.1.1.99 -d 3.3.3.3 -j ACCEPT</p> <p>\u6216\u8005\u53ea\u5141\u8bb8\u4ed6\u4eec\u8bbf\u95ee80\u7aef\u53e3\u3002 iptables -A FORWARD -s 10.1.1.0/24 -p tcp --dport http -j ACCEPT \u66f4\u591a\u7684\u63a7\u5236\u53ef\u4ee5\u81ea\u5df1\u7075\u6d3b\u53bb\u505a,\u6216\u8005\u67e5\u9605iptables\u7684\u8054\u673a\u6587\u6863\u3002</p> <p>\u5b9e\u4f8b\u4e8c\uff1a\u7aef\u53e3\u8f6c\u53d1</p> <p>\u73af\u5883\u4ecb\u7ecd\uff1a linux 2.4 + 2\u4e2a\u7f51\u7edc\u63a5\u53e3 Lan\u53e3:10.1.1.254/24 eth0 Lan\u5185web server: 10.1.1.1:80 Lan\u5185ftp server: 10.1.1.2:21 Wan\u53e3:60.1.1.1/24 eth1 \u76ee\u7684\uff1a\u5bf9\u5185\u90e8server\u8fdb\u884c\u7aef\u53e3\u8f6c\u53d1\u5b9e\u73b0internet\u7528\u6237\u8bbf\u95ee\u5185\u7f51\u670d\u52a1\u5668</p> <p>\u540c\u6837\u786e\u8ba4\u4f60\u7684linux\u7684\u5404\u9879\u914d\u7f6e\u6b63\u5e38\uff0c\u80fd\u591f\u8bbf\u95ee\u5185\u5916\u7f51\u3002 iptables -P FORWARD DROP iptables -A FORWARD -m state --state ESTABLISHED,RELATED -j ACCEPT \u4e5f\u9700\u8981\u52a0\u5165\u786e\u8ba4\u5305\u548c\u5173\u8054\u5305\u7684\u5141\u8bb8\u901a\u8fc7</p> <p>\u5982\u679c\u4f60\u8981\u628a\u8bbf\u95ee60.1.1.1:80\u7684\u6570\u636e\u5305\u8f6c\u53d1\u5230Lan\u5185web server,\u7528\u4e0b\u9762\u7684\u547d\u4ee4 iptables -t nat -A PREROUTING -d 60.1.1.1 -p tcp --dport 80 -j DNAT --to 10.1.1.1:80 ftp\u670d\u52a1\u4e5f\u540c\u6837\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a iptables -t nat -A PREROUTING -d 60.1.1.1 -p tcp --dport 21 -j DNAT --to 10.1.1.2:21</p> <p>\u597d\u4e86\uff0c\u547d\u4ee4\u5b8c\u6210\u4e86\uff0c\u7aef\u53e3\u8f6c\u53d1\u4e5f\u505a\u5b8c\u4e86\uff0c\u672c\u4f8b\u80fd\u4e0d\u80fd\u8f6c\u53d1\u5462\uff1f\u4e0d\u80fd\uff0c\u4e3a\u4ec0\u4e48\u5462\uff1f\u6211\u4e0b\u9762\u8be6\u7ec6\u5206\u6790\u4e00\u4e0b\u3002\u5bf9\u4e8eiptables\u597d\u50cf\u5f80\u5916\u8bbf\u95ee\u7684\u914d\u7f6e\u6bd4\u8f83\u5bb9\u6613\uff0c\u800c\u5bf9\u5185\u7684\u8f6c\u53d1\u4f3c\u4e4e\u5c31\u6709\u4e00\u4e9b\u95ee\u9898\u4e86\uff0c\u5728\u4e00\u5f00\u59cb\u7684\u65f6\u5019\u6211\u5c31\u5148\u8bf4\u4e86\u4e00\u4e9b\u5173\u4e8enetfilter\u7684\u6d41\u7a0b\u95ee\u9898\uff0c\u90a3\u4e48\u6211\u5c31\u7b80\u5355\u8bf4\u8bf4\u505a\u4e86\u8fd9\u4e9b\u914d\u7f6e\u4e4b\u540e\u4e3a\u4ec0\u4e48\u6709\u53ef\u80fd\u8fd8\u4e0d\u884c\u5462\uff1f</p> <p>\u80fd\u5f15\u8d77\u8fd9\u4e2a\u914d\u7f6e\u5931\u8d25\u7684\u539f\u56e0\u6709\u5f88\u591a\uff0c\u6211\u4eec\u4e00\u4e2a\u4e2a\u7684\u6765\u8bf4\uff1a \u7b2c\u4e00\uff0c\u672c\u4f8b\u4e2d\uff0c\u6211\u4eec\u7684FORWARD\u7b56\u7565\u662fDROP,\u90a3\u4e48\u4e5f\u5c31\u662f\u8bf4\uff0c\u6ca1\u6709\u7b26\u5408\u89c4\u5219\u7684\u5305\u5c06\u88ab\u4e22\u5f03\uff0c\u4e0d\u7ba1\u5185\u5230\u5916\u8fd8\u662f\u5916\u5230\u5185\uff0c\u6211\u4eec\u5728\u8fd9\u91cc\u4f9d\u7136\u4e0d\u8ba8\u8bba\u90a3\u4e2a\u786e\u8ba4\u5305\u548c\u5173\u8054\u5305\u7684\u95ee\u9898\uff0c\u6211\u4eec\u4e0d\u7528\u8003\u8651\u4ed6\u7684\u95ee\u9898\uff0c\u4e0b\u9762\u6211\u4f1a\u8be6\u7ec6\u8bf4\u4e00\u4e0b\u8fd9\u4e2a\u4e1c\u897f\uff0c\u90a3\u4e48\u5982\u4f55\u8ba9\u672c\u4f8b\u53ef\u4ee5\u6210\u529f\u5462\uff1f\u52a0\u5165\u4e0b\u9762\u7684\u89c4\u5219\u3002 iptables -A FORWARD -d 10.1.1.1 -p tcp --dport 80 -j ACCEPT iptables -A FORWARD -d 10.1.1.2 -p tcp --dport 21 -j ACCEPT \u6709\u6ca1\u6709\u89c9\u5f97\u6709\u4e00\u4e9b\u6655\uff1f\u4e3a\u4ec0\u4e48\u76ee\u7684\u5730\u5740\u662f10.xxx\u800c\u4e0d\u662f60.xxx\u4eba\u5bb6internet\u7528\u6237\u4e0d\u662f\u8bbf\u95ee\u768460.xxx\u5417\uff1f\u5475\u5475\uff0c\u56de\u5230\u4e0a\u9762\u770b\u770b\u90a3\u4e2a\u56fe\u5427\uff0c FORWARD\u94fe\u5728\u4ec0\u4e48\u4f4d\u7f6e\u4e0a\uff0c\u5b83\u662f\u5728PREROUTING\u4e4b\u540e\uff0c\u4e5f\u5c31\u662f\u8bf4\u5f53\u8fd9\u4e2a\u5305\u5230\u8fbeFORWARD\u94fe\u7684\u65f6\u5019\uff0c\u76ee\u7684\u5730\u5740\u5df2\u7ecf\u53d8\u621010.xxx\u4e86\uff0c\u5047\u5982 internet\u7528\u6237\u7684\u8bf7\u6c42\u662f\u8fd9\u6837202.1.1.1:1333--&gt;60.1.1.1:80\uff0c\u5728\u7ecf\u8fc7\u4e86\u6211\u4eec\u7684PREROUTING\u94fe\u4e4b\u540e\u5c06\u53d8\u6210 202.1.1.1:1333--&gt;10.1.1.1:80,\u8fd9\u4e2a\u65f6\u5019\u5982\u679c\u4f60\u8bbe\u7f6e\u4e00\u4e2a\u76ee\u7684\u5730\u5740\u4e3a60.xxx\u7684\u89c4\u5219\u6709\u7528\u5417\uff1f\u5475\u5475\uff0c\u8fd9\u662f\u95ee\u9898\u4e00\u3002\u8fd9\u4e2a\u65f6\u5019\u5e94\u8be5\u53ef\u4ee5\u5b8c\u6210\u7aef\u53e3\u8f6c\u53d1\u7684\u8bbf\u95ee\u4e86\uff0c\u4f46\u662f\u6709\u4e00\u4e9b\u65f6\u5019\u8fd8\u662f\u4e0d\u884c\uff1f\u4e3a\u4ec0\u4e48\uff1f\u770b\u95ee\u9898\u4e8c\u3002 \u7b2c\u4e8c\uff0c\u5185\u7f51server\u7684ip\u914d\u7f6e\u95ee\u9898\uff0c\u8fd9\u91cc\u6211\u4eec\u4ee5web server\u4e3a\u4f8b\u8bf4\u660e\u4e00\u4e0b\uff08ftp\u60c5\u51b5\u6709\u4e00\u4e9b\u7279\u6b8a\uff0c\u4e0b\u9762\u6211\u4eec\u518d\u8be6\u7ec6\u8ba8\u8bba\uff0c\u8bf4\u786e\u8ba4\u5305\u548c\u5173\u8054\u5305\u7684\u65f6\u5019\u8ba8\u8bba\u8fd9\u4e2a\u95ee\u9898\uff09\uff0c\u4e0a\u9762\u8bf4\u5230\uff0c\u6709\u7684\u65f6\u5019\u53ef\u4ee5\u8bbf\u95ee\u4e86\uff0c\u6709\u7684\u65f6\u5019\u5374\u4e0d\u884c\uff0c\u5c31\u662f\u8fd9\u4e2aweb server\u7684ip\u8bbe\u7f6e\u95ee\u9898\u4e86\uff0c\u5982\u679cweb server\u6ca1\u6709\u6307\u5b9a\u9ed8\u8ba4\u7684\u7f51\u5173\uff0c\u90a3\u4e48\u5728\u4f5c\u4e86\u4e0a\u9762\u7684\u914d\u7f6e\u4e4b\u540e\uff0cweb server\u4f1a\u6536\u5230internet\u7684\u8bf7\u6c42\uff0c\u4f46\u662f\uff0c\u4ed6\u4e0d\u77e5\u9053\u5f80\u54ea\u91cc\u56de\u554a\uff0c\u4eba\u5bb6\u7684\u672c\u5730\u8def\u7531\u8868\u4e0d\u77e5\u9053\u4f60\u90a3\u4e2ainternet\u7684ip,202.1.1.1\u8be5\u600e\u4e48\u8d70\u3002\u5982\u679c\u4f60\u4f7f\u7528\u622a\u5305\u5de5\u5177\u5728web server\u4e0a\u9762\u5bdf\u770b\uff0c\u4f60\u4f1a\u53d1\u73b0server\u6536\u5230\u4e86\u6765\u81ea202.1.1.1:1333--&gt;10.1.1.1:80\u7684\u8bf7\u6c42\uff0c\u7531\u4e8e\u4f60\u6ca1\u6709\u7ed9web server\u914d\u7f6e\u9ed8\u8ba4\u7f51\u5173\uff0c\u5b83\u4e0d\u77e5\u9053\u600e\u4e48\u56de\u53bb\uff0c\u6240\u4ee5\u5c31\u51fa\u73b0\u4e86\u4e0d\u901a\u7684\u60c5\u51b5\u3002\u600e\u4e48\u529e\u5462\uff1f\u4e24\u4e2a\u89e3\u51b3\u65b9\u6cd5\uff1a\u4e00\u5c31\u662f\u7ed9\u8fd9\u4e2aserver\u914d\u7f6e\u4e00\u4e2a\u9ed8\u8ba4\u7f51\u5173\uff0c\u5f53\u7136\u8981\u6307\u5411\u8fd9\u4e2a\u914d\u7f6e\u7aef\u53e3\u8f6c\u53d1\u7684linux,\u672c\u4f8b\u662f10.1.1.254,\u914d\u7f6e\u597d\u4e86\uff0c\u5c31\u4e00\u5b9a\u80fd\u8bbf\u95ee\u4e86\u3002\u6709\u4e00\u4e2a\u7591\u95ee\uff1f\u96be\u9053\u4e0d\u9700\u8981\u5728FORWARD\u94fe\u4e0a\u9762\u8bbe\u7f6e\u4e00\u4e2a\u5141\u8bb8 web server\u7684ip\u5730\u5740\u8bbf\u95ee\u5916\u7f51\u7684\u89c4\u5219\u5417\uff1f\u5b83\u7684\u5305\u80fd\u51fa\u53bb\uff1f\u7b54\u6848\u662f\u80af\u5b9a\u7684\uff0c\u80fd\u51fa\u53bb\u3002\u56e0\u4e3a\u6211\u4eec\u90a3\u4e00\u6761\u5141\u8bb8\u786e\u8ba4\u5305\u4e0e\u5173\u8054\u5305\u7684\u89c4\u5219\uff0c\u5426\u5219\u5b83\u662f\u51fa\u4e0d\u53bb\u7684\u3002\u7b2c\u4e8c\u79cd\u65b9\u6cd5\uff0c\u6bd4\u8f83\u9ebb\u70e6\u4e00\u4e9b\uff0c\u4f46\u662f\u5bf9\u670d\u52a1\u5668\u6765\u8bf4\u8fd9\u6837\u4f3c\u4e4e\u66f4\u5b89\u5168\u4e00\u4e9b\u3002\u65b9\u6cd5\u5c31\u662f\u5bf9\u8fd9\u4e2a\u5305\u518d\u4f5c\u4e00\u6b21SNAT\uff0c\u4e5f\u5c31\u662f\u5728POSTROUTING\u94fe\u4e0a\u6dfb\u52a0\u89c4\u5219\u3002\u547d\u4ee4\u5982\u4e0b\uff1a iptables -t nat -A POSTROUTING -d 10.1.1.1 -p tcp --dport 80 -j SNAT --to 10.1.1.254 ftp\u7684\u65b9\u6cd5\u76f8\u540c\u3002\u8fd9\u6761\u547d\u4ee4\u4e0d\u592a\u597d\u61c2\uff1f\uff1f\u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u5982\u679c\u4f7f\u7528\u8fd9\u6761\u547d\u4ee4\uff0c\u90a3\u4e48\u4f60\u7684web server\u4e0d\u9700\u8981\u518d\u8bbe\u7f6e\u9ed8\u8ba4\u7f51\u5173\uff0c\u5c31\u80fd\u6536\u5230\u8fd9\u4e2a\u8bf7\u6c42\uff0c\u53ea\u8981\u4ed6\u548clinux\u7684lan ip\u5730\u5740\u662f\u80fd\u4e92\u8bbf\u7684\uff08\u4e5f\u5c31\u662f\u8bf4web server\u548cLinux\u7684Lan ip\u5728\u4e00\u4e2a\u5e7f\u64ad\u57df\uff09\uff0c\u6211\u4eec\u5728\u6839\u636e\u4e0a\u9762\u7684netfilter\u6d41\u7a0b\u56fe\u6765\u5206\u6790\u8fd9\u4e2a\u5305\u5230\u5e95\u88ab\u6211\u4eec\u600e\u4e48\u6837\u4e86\uff0c\u9996\u5148\u4e00\u4e2a\u8bf7\u6c42202.1.1.1:1333--&gt; 60.1.1.1:80\u88ablinux\u6536\u5230\u4e86\uff0c\u8fdb\u5165PREROUTING,\u53d1\u73b0\u4e00\u4e2a\u89c4\u5219\uff08iptables -t nat -A PREROUTING -d 60.1.1.1 -p tcp --dport 80 -j DNAT --to 10.1.1.1:80\uff09\u7b26\u5408\uff0c\u597d\u4e86\uff0c\u6539\u4f60\u7684\u76ee\u7684\u5730\u5740\uff0c\u4e8e\u662f\u8fd9\u4e2a\u5305\u53d8\u6210\u4e86202.1.1.1:1333--&gt;10.1.1.1:80\uff0c\u7ee7\u7eed\u5f80\u524d\u8d70\uff0c\u8fdb\u5165FORWARD\u94fe\uff0cokay,\u4e5f\u6709\u4e00\u6761\u89c4\u5219\u5141\u8bb8\u901a\u8fc7(iptables -A FORWARD -d 10.1.1.1 -p tcp --dport 80 -j ACCEPT)\uff0c\u8fdb\u5165route box\u9009\u8def\uff0c\u627e\u5230\u5408\u9002\u7684\u8def\u5f84\u4e86\uff0c\u7ee7\u7eed\u8fdb\u5165POSTROUTING\u94fe\uff0c\u8036\uff1f\u53c8\u53d1\u73b0\u4e00\u4e2a\u7b26\u5408\u7684\u89c4\u5219(iptables -t nat -A POSTROUTING -d 10.1.1.1 -p tcp --dport 80 -j SNAT --to 10.1.1.254),\u539f\u6765\u662f\u4e00\u4e2aSNAT,\u6539\u4f60\u7684\u6e90\u5730\u5740\uff0c\u4e8e\u662f\u8fd9\u4e2a\u5305\u53d8\u6210\u4e8610.1.1.254:xxxx--&gt;10.1.1.1:80\u3002\u4e3a\u4ec0\u4e48\u7528xxxx\u4e86\uff0c\u8fd9\u91cc\u7684\u7aef\u53e3\u662f\u968f\u673a\u7684\uff0c\u6211\u4e5f\u4e0d\u77e5\u9053\u4f1a\u662f\u4ec0\u4e48\u3002\u800c\u6574\u4e2a\u7684\u4e24\u6b21\u53d8\u5316\u7684\u8fc7\u7a0b\u90fd\u4f1a\u8bb0\u5f55\u5728linux\u7684ip_conntrack\u4e2d\uff0c\u5f53web server\u6536\u5230\u8fd9\u4e2a\u5305\u7684\u65f6\u5019\uff0c\u53d1\u73b0\uff0c\u539f\u6765\u662f\u4e00\u4e2a\u5185\u7f51\u81ea\u5df1\u5144\u5f1f\u6765\u7684\u8bf7\u6c42\u963f\uff0c\u53c8\u5728\u4e00\u4e2a\u5e7f\u64ad\u57df\uff0c\u4e0d\u7528\u627e\u7f51\u5173\uff0c\u628a\u8fd4\u56de\u5305\u76f4\u63a5\u6254\u7ed9\u4ea4\u6362\u673a\u4e86\uff0clinux\u5728\u6536\u5230\u8fd4\u56de\u5305\u4e4b\u540e\uff0c\u4f1a\u6839\u636e\u4ed6\u7684ip_conntrack\u4e2d\u7684\u6761\u76ee\u8fdb\u884c\u4e24\u6b21\u53d8\u6362\uff0c\u8fd4\u56de\u771f\u6b63\u7684internet\u7528\u6237\uff0c\u4e8e\u662f\u5b8c\u6210\u8fd9\u4e00\u6b21\u7684\u8bbf\u95ee\u3002</p> <p>\u770b\u4e86\u4e0a\u9762\u7684\u4e24\u4e2a\u4f8b\u5b50\uff0c\u4e0d\u77e5\u9053\u5927\u5bb6\u662f\u5426\u6e05\u695a\u4e86iptables\u7684\u8f6c\u53d1\u6d41\u7a0b\uff0c\u5e0c\u671b\u5bf9\u5927\u5bb6\u6709\u6240\u5e2e\u52a9\uff0c\u4e0b\u9762\u6211\u4eec\u5c31\u8bf4\u8bf4\u6211\u4e00\u76f4\u5728\u4e0a\u9762\u63d0\u5230\u7684\u5173\u4e8e\u90a3\u4e2a ESTABLISHED,RELATED\u7684\u89c4\u5219\u662f\u600e\u4e48\u56de\u4e8b\uff0c\u5230\u5e95\u6709\u4ec0\u4e48\u7528\u5904\u3002\u8bf4\u8fd9\u4e2a\u4e1c\u897f\u5c31\u8981\u7b80\u5355\u8bf4\u4e00\u4e0b\u7f51\u7edc\u7684\u6570\u636e\u901a\u8baf\u7684\u65b9\u5f0f\uff0c\u6211\u4eec\u77e5\u9053\uff0c\u7f51\u7edc\u7684\u8bbf\u95ee\u662f\u53cc\u5411\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u4e00\u4e2aClient\u4e0eServer\u4e4b\u95f4\u5b8c\u6210\u6570\u636e\u4ea4\u6362\u9700\u8981\u53cc\u65b9\u7684\u53d1\u5305\u4e0e\u6536\u5305\u3002\u5728netfilter\u4e2d\uff0c\u6709\u51e0\u79cd\u72b6\u6001\uff0c\u4e5f\u5c31\u662fnew, established,related,invalid\u3002\u5f53\u4e00\u4e2a\u5ba2\u6237\u7aef\uff0c\u5728\u672c\u6587\u4f8b\u4e00\u4e2d\uff0c\u5185\u7f51\u7684\u4e00\u53f0\u673a\u5668\u8bbf\u95ee\u5916\u7f51\uff0c\u6211\u4eec\u8bbe\u7f6e\u4e86\u89c4\u5219\u5141\u8bb8\u4ed6\u51fa\u53bb\uff0c\u4f46\u662f\u6ca1\u6709\u8bbe\u7f6e\u5141\u8bb8\u56de\u6765\u7684\u89c4\u5219\u963f\uff0c\u600e\u4e48\u5b8c\u6210\u8bbf\u95ee\u5462\uff1f\u8fd9\u5c31\u662fnetfilter\u7684\u72b6\u6001\u673a\u5236\uff0c\u5f53\u4e00\u4e2alan\u7528\u6237\u901a\u8fc7\u8fd9\u4e2alinux\u8bbf\u95ee\u5916\u7f51\u7684\u65f6\u5019\uff0c\u5b83\u53d1\u9001\u4e86\u4e00\u4e2a\u8bf7\u6c42\u5305\uff0c\u8fd9\u4e2a\u5305\u7684\u72b6\u6001\u662fnew,\u5f53\u5916\u7f51\u56de\u5305\u7684\u65f6\u5019\u4ed6\u7684\u72b6\u6001\u5c31\u662festablished,\u6240\u4ee5\uff0clinux\u77e5\u9053\uff0c\u54e6\uff0c\u8fd9\u4e2a\u5305\u662f\u6211\u7684\u5185\u7f51\u7684\u4e00\u53f0\u673a\u5668\u53d1\u51fa\u53bb\u7684\u5e94\u7b54\u5305\uff0c\u4ed6\u5c31\u653e\u884c\u4e86\u3002\u800c\u5916\u7f51\u8bd5\u56fe\u5bf9\u5185\u53d1\u8d77\u4e00\u4e2a\u65b0\u7684\u8fde\u63a5\u7684\u65f6\u5019\uff0c\u4ed6\u7684\u72b6\u6001\u662fnew,\u6240\u4ee5linux\u538b\u6839\u4e0d\u53bb\u7406\u4f1a\u5b83\u3002\u8fd9\u5c31\u662f\u6211\u4eec\u4e3a\u4ec0\u4e48\u8981\u52a0\u8fd9\u4e00\u53e5\u7684\u539f\u56e0\u3002\u8fd8\u6709\u90a3\u4e2a related,\u4ed6\u662f\u4e00\u4e2a\u5173\u8054\u72b6\u6001\uff0c\u4ec0\u4e48\u4f1a\u7528\u5230\u5462\uff1ftftp,ftp\u90fd\u4f1a\u7528\u5230\uff0c\u56e0\u4e3a\u4ed6\u4eec\u7684\u4f20\u8f93\u673a\u5236\u51b3\u5b9a\u4e86\uff0c\u5b83\u4e0d\u50cfhttp\u8bbf\u95ee\u90a3\u6837\uff0cClient_IP: port--&gt;server:80\u00a0 \u7136\u540eserver:80--&gt;Client_IP:port,ftp\u4f7f\u7528tcp21\u5efa\u7acb\u8fde\u63a5\uff0c\u4f7f\u752820\u7aef\u53e3\u53d1\u9001\u6570\u636e\uff0c\u5176\u4e2d\u53c8\u6709\u4e24\u79cd\u65b9\u5f0f\uff0c\u4e00\u79cd\u4e3b\u52a8 active mode,\u4e00\u79cd\u88ab\u52a8passive mode,\u4e3b\u52a8\u6a21\u5f0f\u4e0b\uff0cclient\u4f7f\u7528port\u547d\u4ee4\u544a\u8bc9server\u6211\u7528\u54ea\u4e00\u4e2a\u7aef\u53e3\u63a5\u53d7\u6570\u636e\uff0c\u7136\u540eserver\u4e3b\u52a8\u53d1\u8d77\u5bf9\u8fd9\u4e2a\u7aef\u53e3\u7684\u8bf7\u6c42\u3002\u88ab\u52a8\u6a21\u5f0f\u4e0b\uff0c server\u4f7f\u7528port\u547d\u4ee4\u544a\u8bc9\u5ba2\u6237\u7aef\uff0c\u5b83\u7528\u90a3\u4e2a\u7aef\u53e3\u76d1\u542c\uff0c\u7136\u540e\u5ba2\u6237\u7aef\u53d1\u8d77\u5bf9\u4ed6\u7684\u6570\u636e\u4f20\u8f93\uff0c\u6240\u4ee5\u8fd9\u5bf9\u4e8e\u4e00\u4e2a\u9632\u706b\u5899\u6765\u8bf4\u5c31\u662f\u6bd4\u8f83\u9ebb\u70e6\u7684\u4e8b\u60c5\uff0c\u56e0\u4e3a\u6709\u53ef\u80fd\u4f1a\u6709new\u72b6\u6001\u7684\u6570\u636e\u5305\uff0c\u4f46\u662f\u5b83\u53c8\u662f\u5408\u7406\u7684\u8bf7\u6c42\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u7528\u5230\u8fd9\u4e2arelated\u72b6\u6001\u4e86\uff0c\u4ed6\u5c31\u662f\u4e00\u79cd\u5173\u8054\uff0c\u5728linux\u4e2d\uff0c\u6709\u4e2a\u53eb ftp_conntrack\u7684\u6a21\u5757\uff0c\u5b83\u80fd\u8bc6\u522bport\u547d\u4ee4\uff0c\u7136\u540e\u5bf9\u76f8\u5e94\u7684\u7aef\u53e3\u8fdb\u884c\u653e\u884c\u3002</p> <p>\u4e00\u53e3\u6c14\u5199\u4e86\u8fd9\u4e48\u591a\u4e1c\u897f\uff0c\u4e0d\u77e5\u9053\u8d28\u91cf\u5982\u4f55\uff0c\u5927\u5bb6\u51d1\u548c\u7740\u770b\u5427\uff0c\u5e0c\u671b\u591a\u591a\u4ea4\u6d41\u5171\u540c\u8fdb\u6b65\uff0c\u6211\u8fd8\u662f\u4e00\u4e2alinux\u7684\u521d\u5b66\u8005\uff0c\u96be\u514d\u5f88\u591a\u8c2c\u8bef\uff0c\u5e0c\u671b\u9ad8\u624b\u8d50\u6559\u6307\u6b63\uff0c\u4ee5\u671f\u4e0d\u65ad\u8fdb\u6b65\u3002</p> <p>\u5bf9\u4e86\uff0c\u8fd8\u6709\u51e0\u4e2a\u5728\u5b9e\u9645\u4e2d\u6bd4\u8f83\u5b9e\u7528\uff08\u4e5f\u6bd4\u8f83\u53d7\u7528:-)\uff09\u7684\u547d\u4ee4\u53c2\u6570\uff0c\u5199\u51fa\u6765\u4f9b\u5927\u5bb6\u53c2\u8003</p> <p>iptables -L -n \u8fd9\u6837\u7684\u5217\u8868\u4f1a\u8df3\u8fc7linux\u7684domain lookup,\u6709\u7684\u65f6\u5019\u4f7f\u7528iptables -L\u4f1a\u6bd4\u8f83\u6162\uff0c\u56e0\u4e3alinux\u4f1a\u5c1d\u8bd5\u89e3\u6790ip\u7684\u57df\u540d\uff0c\u771f\u662f\u7f57\u55e6\uff0c\u5982\u679c\u4f60\u7684dns server\u6bd4\u8f83\u4e0d\u723d\u7684\u8bdd\uff0ciptables -L\u5c31\u4f1a\u8ba9\u4f60\u5f88\u4e0d\u723d\uff0c\u52a0\u4e00\u4e2a-n\u53c2\u6570\u5c31\u597d\u4e86\u3002\u5217\u8868\u5237\u7684\u5c31\u51fa\u6765\u3002\u5f53\u7136\u4e86\uff0c\u5982\u679c\u4f60\u7684linux\u5c31\u662f\u505a\u9632\u706b\u5899\uff0c\u5efa\u8bae\u628anameserver\u53bb\u6389\uff0c\u5728 /etc/resolve.conf\u91cc\u9762\uff0c\u56e0\u4e3a\u6709\u65f6\u5019\u4f7f\u7528route\u547d\u4ee4\u4e5f\u4f1a\u6bd4\u8f83\u6162\u5217\u51fa\u6765\uff0c\u5f88\u662f\u4e0d\u723d\u3002</p> <p>iptables -L -v \u8fd9\u4e2a\u547d\u4ee4\u4f1a\u663e\u793a\u94fe\u4e2d\u89c4\u5219\u7684\u5305\u548c\u6d41\u91cf\u8ba1\u6570\uff0c\u563f\u563f\uff0c\u770b\u770b\u54ea\u4e9b\u5c0f\u5b50\u7528\u7684\u6d41\u91cf\u90a3\u4e48\u591a\uff0c\u7528tc\u9650\u4e86\u4ed6\u3002</p> <p>cat /proc/net/ip_conntrack \u67e5\u770b\u76ee\u524d\u7684conntrack\uff0c\u53ef\u80fd\u4f1a\u6bd4\u8f83\u591a\u54e6\uff0c\u6700\u597d\u52a0\u4e00\u4e2a|grep \"\u5173\u952e\u5b57\"\uff0c\u770b\u770b\u4f60\u611f\u5174\u8da3\u7684\u94fe\u63a5\u8ddf\u8e2a</p> <p>wc -l /proc/net/ip_conntrack \u770b\u770b\u603b\u94fe\u63a5\u6709\u591a\u5c11\u6761\u3002</p> <p>iptables-save &gt;/etc/iptables \u628a\u5f53\u524d\u7684\u6240\u6709\u94fe\u5907\u4efd\u4e00\u4e0b\uff0c\u4e4b\u6240\u4ee5\u653e\u5230/etc\u4e0b\u9762\u53ebiptables,\u56e0\u4e3a\u8fd9\u6837\u91cd\u8d77\u673a\u5668\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u52a0\u8f7d\u6240\u6709\u7684\u94fe\uff0c\u7ecf\u5e38\u5730\u5907\u4efd\u4e00\u4e0b\u5427\uff0c\u5426\u5219\u5982\u679c\u94fe\u591a\uff0c\u4e07\u4e00\u6389\u7535\u91cd\u542f\uff0c\u4f60\u8fd8\u662f\u4f1a\u6bd4\u8f83\u75db\u82e6\u3002</p> <p>\u6458\u81ea\u300ehttp://blog.csdn.net/huguohu2006/article/details/6453522\u300f</p>","tags":["iptables"]},{"location":"Misc/2015-11-29-myiptables-iptables%25e5%25b8%25b8%25e7%2594%25a8%25e9%2585%258d%25e7%25bd%25ae.html/","title":"myiptables: iptables\u5e38\u7528\u914d\u7f6e","text":"<p>#!/bin/bash # myiptables.sh iptables -F iptables -P INPUT DROP iptables -P FORWARD DROP iptables -P OUTPUT DROP</p> <p># DNS iptables -A OUTPUT -p udp --dport 53 -j ACCEPT iptables -A INPUT -p udp --sport 53 -j ACCEPT</p> <p># \u5141\u8bb8\u5305\u4ece22\u7aef\u53e3\u8fdb\u5165 iptables -A INPUT -p tcp --dport 22 -j ACCEPT # \u5141\u8bb8\u4ece22\u7aef\u53e3\u8fdb\u5165\u7684\u5305\u8fd4\u56de iptables -A OUTPUT -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT</p> <p># \u5141\u8bb8\u672c\u673a\u8bbf\u95ee\u672c\u673a iptables -A INPUT -i lo -j ACCEPT</p> <p># \u5141\u8bb8\u6240\u6709IP\u8bbf\u95ee80\u7aef\u53e3 iptables -A INPUT -p tcp -s 0/0 --dport 80 -j ACCEPT iptables -A OUTPUT -p tcp --sport 80 -m state --state ESTABLISHED -j ACCEPT</p> <p># \u4fdd\u5b58\u914d\u7f6e \u6216\u8005\u4f7f\u7528\u547d\u4ee4 service iptables save iptables-save &gt; /etc/sysconfig/iptables iptables -L</p> <p>\u6ce8\uff1a\u4ec5\u4ec5\u5c4f\u853d\u5916\u7f51(eth1) iptables -P INPUT ACCEPT iptables -A INPUT -p tcp -i eth1 --dport 8080 -j DROP</p> <p>\u9644\uff1a/etc/sysconfig/iptables \u00a0\u5b9e\u4f8b</p> <pre># Firewall configuration written by system-config-firewall\n# Manual customization of this file is not recommended.\n*filter\n:INPUT ACCEPT [0:0]\n:FORWARD ACCEPT [0:0]\n:OUTPUT ACCEPT [0:0]\n-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n-A INPUT -p icmp -j ACCEPT\n-A INPUT -i lo -j ACCEPT\n-A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT\n-A INPUT -m state --state NEW -m tcp -p tcp --dport 8161 -j ACCEPT\n-A INPUT -m state --state NEW -m tcp -p tcp --dport 6379 -j ACCEPT\n-A INPUT -j REJECT --reject-with icmp-host-prohibited\n-A FORWARD -j REJECT --reject-with icmp-host-prohibited\nCOMMIT\n</pre>","tags":["iptables"]},{"location":"Misc/2015-12-09-mac-finder-%25e6%2598%25be%25e7%25a4%25ba%25e9%259a%2590%25e8%2597%258f%25e6%2596%2587%25e4%25bb%25b6.html/","title":"mac finder \u663e\u793a\u9690\u85cf\u6587\u4ef6","text":"<p><code>defaults write com.apple.finder AppleShowAllFiles -bool true</code></p>","tags":["finder"]},{"location":"Misc/2015-12-09-mac-vi-%25e8%25af%25ad%25e6%25b3%2595%25e9%25ab%2598%25e4%25ba%25ae.html/","title":"mac vi \u8bed\u6cd5\u9ad8\u4eae","text":"<p><code>$ cat .vimrc \" Configuration file for vim set modelines=0 \" CVE-2007-2438 \" Normally we use vim-extensions. If you want true vi-compatibility \" remove change the following statements set nocompatible \" Use Vim defaults instead of 100% vi compatibility set backspace=2 \" more powerful backspacing syntax on set nu! set cindent set ruler \" Don't write backup file if vim is being called by \"crontab -e\" au BufWrite /private/tmp/crontab.* set nowritebackup nobackup \" Don't write backup file if vim is being called by \"chpass\" au BufWrite /private/etc/pw.* set nowritebackup nobackup</code></p>","tags":["vi"]},{"location":"Misc/2015-12-09-rc-local-in-osx-yosemite.html/","title":"rc.local in osx-yosemite","text":"<p>I created\u00a0<code>/Library/LaunchDaemons/local.localhost.startup.plist</code>\u00a0containing the code below. It runs the rc.local script once at start up.</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE plist PUBLIC \"-//Apple Computer//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"&gt;\n&lt;plist version=\"1.0\"&gt;\n&lt;dict&gt;\n    &lt;key&gt;Label&lt;/key&gt;             &lt;string&gt;local.localhost.startup&lt;/string&gt;\n    &lt;key&gt;Disabled&lt;/key&gt;          &lt;false/&gt;\n    &lt;key&gt;RunAtLoad&lt;/key&gt;         &lt;true/&gt;\n    &lt;key&gt;KeepAlive&lt;/key&gt;         &lt;false/&gt;\n    &lt;key&gt;LaunchOnlyOnce&lt;/key&gt;    &lt;true/&gt;\n    &lt;key&gt;ProgramArguments&lt;/key&gt;\n        &lt;array&gt;\n            &lt;string&gt;/etc/rc.local&lt;/string&gt;\n        &lt;/array&gt;\n&lt;/dict&gt;\n&lt;/plist&gt; \n</code></pre> <p>\u6458\u81ea\u300ehttp://apple.stackexchange.com/questions/153387/problem-with-startup-script-rc-local-in-os-x-10-10-yosemite-running-bootcamp-in\u300f</p>","tags":["rc.local"]},{"location":"Misc/2015-12-09-tcpip%25e5%259b%259b%25e5%25b1%2582%25e6%25a8%25a1%25e5%259e%258b.html/","title":"TCP/IP\u56db\u5c42\u6a21\u578b","text":"<p>TCP/IP\u53c2\u8003\u6a21\u578b</p> <p>\u3000\u3000ISO\u5236\u5b9a\u7684OSI\u53c2\u8003\u6a21\u578b\u7684\u8fc7\u4e8e\u5e9e\u5927\u3001\u590d\u6742\u62db\u81f4\u4e86\u8bb8\u591a\u6279\u8bc4\u3002\u4e0e\u6b64\u5bf9\u7167\uff0c\u7531\u6280\u672f\u4eba\u5458\u81ea\u5df1\u5f00\u53d1\u7684TCP/IP\u534f\u8bae\u6808\u83b7\u5f97\u4e86\u66f4\u4e3a\u5e7f\u6cdb\u7684\u5e94\u7528\u3002\u5982\u56fe2-1\u6240\u793a\uff0c\u662fTCP/IP\u53c2\u8003\u6a21\u578b\u548cOSI\u53c2\u8003\u6a21\u578b\u7684\u5bf9\u6bd4\u793a\u610f\u56fe\u3002  \u56fe2-1\u3000 TCP/IP\u53c2\u8003\u6a21\u578b</p> <p>2.1\u3000TCP/IP\u53c2\u8003\u6a21\u578b\u7684\u5c42\u6b21\u7ed3\u6784 TCP/IP\u534f\u8bae\u6808\u662f\u7f8e\u56fd\u56fd\u9632\u90e8\u9ad8\u7ea7\u7814\u7a76\u8ba1\u5212\u5c40\u8ba1\u7b97\u673a\u7f51\uff08Advanced Research Projects Agency Network\uff0cARPANET\uff09\u548c\u5176\u540e\u7ee7\u56e0\u7279\u7f51\u4f7f\u7528\u7684\u53c2\u8003\u6a21\u578b\u3002ARPANET\u662f\u7531\u7f8e\u56fd\u56fd\u9632\u90e8\uff08U.S\uff0eDepartment of Defense\uff0cDoD\uff09\u8d5e\u52a9\u7684\u7814\u7a76\u7f51\u7edc\u3002\u6700\u521d\uff0c\u5b83\u53ea\u8fde\u63a5\u4e86\u7f8e\u56fd\u5883\u5185\u7684\u56db\u6240\u5927\u5b66\u3002\u968f\u540e\u7684\u51e0\u5e74\u4e2d\uff0c\u5b83\u901a\u8fc7\u79df\u7528\u7684\u7535\u8bdd\u7ebf\u8fde\u63a5\u4e86\u6570\u767e\u6240\u5927\u5b66\u548c\u653f\u5e9c\u90e8\u95e8\u3002\u6700\u7ec8ARPANET\u53d1\u5c55\u6210\u4e3a\u5168\u7403\u89c4\u6a21\u6700\u5927\u7684\u4e92\u8fde\u7f51\u7edc-\u56e0\u7279\u7f51\u3002\u6700\u521d\u7684ARPANET\u4e8e1990\u5e74\u6c38\u4e45\u6027\u5730\u5173\u95ed\u3002 TCP/IP\u53c2\u8003\u6a21\u578b\u5206\u4e3a\u56db\u4e2a\u5c42\u6b21\uff1a\u5e94\u7528\u5c42\u3001\u4f20\u8f93\u5c42\u3001\u7f51\u7edc\u4e92\u8fde\u5c42\u548c\u4e3b\u673a\u5230\u7f51\u7edc\u5c42\u3002\u5982\u56fe2-2\u6240\u793a\u3002  \u56fe2-2\u3000 TCP/IP\u53c2\u8003\u6a21\u578b\u7684\u5c42\u6b21\u7ed3\u6784</p> <p>\u5728TCP/IP\u53c2\u8003\u6a21\u578b\u4e2d\uff0c\u53bb\u6389\u4e86OSI\u53c2\u8003\u6a21\u578b\u4e2d\u7684\u4f1a\u8bdd\u5c42\u548c\u8868\u793a\u5c42\uff08\u8fd9\u4e24\u5c42\u7684\u529f\u80fd\u88ab\u5408\u5e76\u5230\u5e94\u7528\u5c42\u5b9e\u73b0\uff09\u3002\u540c\u65f6\u5c06OSI\u53c2\u8003\u6a21\u578b\u4e2d\u7684\u6570\u636e\u94fe\u8def\u5c42\u548c\u7269\u7406\u5c42\u5408\u5e76\u4e3a\u4e3b\u673a\u5230\u7f51\u7edc\u5c42\u3002\u4e0b\u9762\uff0c\u5206\u522b\u4ecb\u7ecd\u5404\u5c42\u7684\u4e3b\u8981\u529f\u80fd\u3002</p> <p>1\u3001\u4e3b\u673a\u5230\u7f51\u7edc\u5c42 \u5b9e\u9645\u4e0aTCP/IP\u53c2\u8003\u6a21\u578b\u6ca1\u6709\u771f\u6b63\u63cf\u8ff0\u8fd9\u4e00\u5c42\u7684\u5b9e\u73b0\uff0c\u53ea\u662f\u8981\u6c42\u80fd\u591f\u63d0\u4f9b\u7ed9\u5176\u4e0a\u5c42-\u7f51\u7edc\u4e92\u8fde\u5c42\u4e00\u4e2a\u8bbf\u95ee\u63a5\u53e3\uff0c\u4ee5\u4fbf\u5728\u5176\u4e0a\u4f20\u9012IP\u5206\u7ec4\u3002\u7531\u4e8e\u8fd9\u4e00\u5c42\u6b21\u672a\u88ab\u5b9a\u4e49\uff0c\u6240\u4ee5\u5176\u5177\u4f53\u7684\u5b9e\u73b0\u65b9\u6cd5\u5c06\u968f\u7740\u7f51\u7edc\u7c7b\u578b\u7684\u4e0d\u540c\u800c\u4e0d\u540c\u3002 2\u3001\u7f51\u7edc\u4e92\u8fde\u5c42 \u7f51\u7edc\u4e92\u8fde\u5c42\u662f\u6574\u4e2aTCP/IP\u534f\u8bae\u6808\u7684\u6838\u5fc3\u3002\u5b83\u7684\u529f\u80fd\u662f\u628a\u5206\u7ec4\u53d1\u5f80\u76ee\u6807\u7f51\u7edc\u6216\u4e3b\u673a\u3002\u540c\u65f6\uff0c\u4e3a\u4e86\u5c3d\u5feb\u5730\u53d1\u9001\u5206\u7ec4\uff0c\u53ef\u80fd\u9700\u8981\u6cbf\u4e0d\u540c\u7684\u8def\u5f84\u540c\u65f6\u8fdb\u884c\u5206\u7ec4\u4f20\u9012\u3002\u56e0\u6b64\uff0c\u5206\u7ec4\u5230\u8fbe\u7684\u987a\u5e8f\u548c\u53d1\u9001\u7684\u987a\u5e8f\u53ef\u80fd\u4e0d\u540c\uff0c\u8fd9\u5c31\u9700\u8981\u4e0a\u5c42\u5fc5\u987b\u5bf9\u5206\u7ec4\u8fdb\u884c\u6392\u5e8f\u3002 \u7f51\u7edc\u4e92\u8fde\u5c42\u5b9a\u4e49\u4e86\u5206\u7ec4\u683c\u5f0f\u548c\u534f\u8bae\uff0c\u5373IP\u534f\u8bae\uff08Internet Protocol\uff09\u3002 \u7f51\u7edc\u4e92\u8fde\u5c42\u9664\u4e86\u9700\u8981\u5b8c\u6210\u8def\u7531\u7684\u529f\u80fd\u5916\uff0c\u4e5f\u53ef\u4ee5\u5b8c\u6210\u5c06\u4e0d\u540c\u7c7b\u578b\u7684\u7f51\u7edc\uff08\u5f02\u6784\u7f51\uff09\u4e92\u8fde\u7684\u4efb\u52a1\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u7f51\u7edc\u4e92\u8fde\u5c42\u8fd8\u9700\u8981\u5b8c\u6210\u62e5\u585e\u63a7\u5236\u7684\u529f\u80fd\u3002 3\u3001\u4f20\u8f93\u5c42 \u5728TCP/IP\u6a21\u578b\u4e2d\uff0c\u4f20\u8f93\u5c42\u7684\u529f\u80fd\u662f\u4f7f\u6e90\u7aef\u4e3b\u673a\u548c\u76ee\u6807\u7aef\u4e3b\u673a\u4e0a\u7684\u5bf9\u7b49\u5b9e\u4f53\u53ef\u4ee5\u8fdb\u884c\u4f1a\u8bdd\u3002\u5728\u4f20\u8f93\u5c42\u5b9a\u4e49\u4e86\u4e24\u79cd\u670d\u52a1\u8d28\u91cf\u4e0d\u540c\u7684\u534f\u8bae\u3002\u5373\uff1a\u4f20\u8f93\u63a7\u5236\u534f\u8baeTCP\uff08transmission control protocol\uff09\u548c\u7528\u6237\u6570\u636e\u62a5\u534f\u8baeUDP\uff08user datagram protocol\uff09\u3002 TCP\u534f\u8bae\u662f\u4e00\u4e2a\u9762\u5411\u8fde\u63a5\u7684\u3001\u53ef\u9760\u7684\u534f\u8bae\u3002\u5b83\u5c06\u4e00\u53f0\u4e3b\u673a\u53d1\u51fa\u7684\u5b57\u8282\u6d41\u65e0\u5dee\u9519\u5730\u53d1\u5f80\u4e92\u8054\u7f51\u4e0a\u7684\u5176\u4ed6\u4e3b\u673a\u3002\u5728\u53d1\u9001\u7aef\uff0c\u5b83\u8d1f\u8d23\u628a\u4e0a\u5c42\u4f20\u9001\u4e0b\u6765\u7684\u5b57\u8282\u6d41\u5206\u6210\u62a5\u6587\u6bb5\u5e76\u4f20\u9012\u7ed9\u4e0b\u5c42\u3002\u5728\u63a5\u6536\u7aef\uff0c\u5b83\u8d1f\u8d23\u628a\u6536\u5230\u7684\u62a5\u6587\u8fdb\u884c\u91cd\u7ec4\u540e\u9012\u4ea4\u7ed9\u4e0a\u5c42\u3002TCP\u534f\u8bae\u8fd8\u8981\u5904\u7406\u7aef\u5230\u7aef\u7684\u6d41\u91cf\u63a7\u5236\uff0c\u4ee5\u907f\u514d\u7f13\u6162\u63a5\u6536\u7684\u63a5\u6536\u65b9\u6ca1\u6709\u8db3\u591f\u7684\u7f13\u51b2\u533a\u63a5\u6536\u53d1\u9001\u65b9\u53d1\u9001\u7684\u5927\u91cf\u6570\u636e\u3002 UDP\u534f\u8bae\u662f\u4e00\u4e2a\u4e0d\u53ef\u9760\u7684\u3001\u65e0\u8fde\u63a5\u534f\u8bae\uff0c\u4e3b\u8981\u9002\u7528\u4e8e\u4e0d\u9700\u8981\u5bf9\u62a5\u6587\u8fdb\u884c\u6392\u5e8f\u548c\u6d41\u91cf\u63a7\u5236\u7684\u573a\u5408\u3002 4\u3001\u5e94\u7528\u5c42 TCP/IP\u6a21\u578b\u5c06OSI\u53c2\u8003\u6a21\u578b\u4e2d\u7684\u4f1a\u8bdd\u5c42\u548c\u8868\u793a\u5c42\u7684\u529f\u80fd\u5408\u5e76\u5230\u5e94\u7528\u5c42\u5b9e\u73b0\u3002 \u5e94\u7528\u5c42\u9762\u5411\u4e0d\u540c\u7684\u7f51\u7edc\u5e94\u7528\u5f15\u5165\u4e86\u4e0d\u540c\u7684\u5e94\u7528\u5c42\u534f\u8bae\u3002\u5176\u4e2d\uff0c\u6709\u57fa\u4e8eTCP\u534f\u8bae\u7684\uff0c\u5982\u6587\u4ef6\u4f20\u8f93\u534f\u8bae\uff08File Transfer Protocol\uff0cFTP\uff09\u3001\u865a\u62df\u7ec8\u7aef\u534f\u8bae\uff08TELNET\uff09\u3001\u8d85\u6587\u672c\u94fe\u63a5\u534f\u8bae\uff08Hyper Text Transfer Protocol\uff0cHTTP\uff09\uff0c\u4e5f\u6709\u57fa\u4e8eUDP\u534f\u8bae\u7684\u3002</p> <p>2.2\u3000TCP/IP\u62a5\u6587\u683c\u5f0f 1\u3001IP\u62a5\u6587\u683c\u5f0f IP\u534f\u8bae\u662fTCP/IP\u534f\u8bae\u65cf\u4e2d\u6700\u4e3a\u6838\u5fc3\u7684\u534f\u8bae\u3002\u5b83\u63d0\u4f9b\u4e0d\u53ef\u9760\u3001\u65e0\u8fde\u63a5\u7684\u670d\u52a1\uff0c\u4e5f\u5373\u4f9d\u8d56\u5176\u4ed6\u5c42\u7684\u534f\u8bae\u8fdb\u884c\u5dee\u9519\u63a7\u5236\u3002\u5728\u5c40\u57df\u7f51\u73af\u5883\uff0cIP\u534f\u8bae\u5f80\u5f80\u88ab\u5c01\u88c5\u5728\u4ee5\u592a\u7f51\u5e27\u4e2d\u4f20\u9001\u3002\u800c\u6240\u6709\u7684TCP\u3001UDP\u3001ICMP\u3001IGMP\u6570\u636e\u90fd\u88ab\u5c01\u88c5\u5728IP\u6570\u636e\u62a5\u4e2d\u4f20\u9001\u3002\u5982\u56fe2-3\u6240\u793a\uff1a  \u56fe2-3\u3000 TCP/IP\u62a5\u6587\u5c01\u88c5</p> <p>\u56fe2-4\u662fIP\u5934\u90e8\uff08\u62a5\u5934\uff09\u683c\u5f0f\uff1a\uff08RFC 791\uff09\u3002  \u56fe2-4\u3000 IP\u5934\u90e8\u683c\u5f0f</p> <p>\u5176\u4e2d\uff1a \u25cf\u7248\u672c\uff08Version\uff09\u5b57\u6bb5\uff1a\u53604\u6bd4\u7279\u3002\u7528\u6765\u8868\u660eIP\u534f\u8bae\u5b9e\u73b0\u7684\u7248\u672c\u53f7\uff0c\u5f53\u524d\u4e00\u822c\u4e3aIPv4\uff0c\u53730100\u3002 \u25cf\u62a5\u5934\u957f\u5ea6\uff08Internet Header Length\uff0cIHL\uff09\u5b57\u6bb5\uff1a\u53604\u6bd4\u7279\u3002\u662f\u5934\u90e8\u536032\u6bd4\u7279\u7684\u6570\u5b57\uff0c\u5305\u62ec\u53ef\u9009\u9879\u3002\u666e\u901aIP\u6570\u636e\u62a5\uff08\u6ca1\u6709\u4efb\u4f55\u9009\u9879\uff09\uff0c\u8be5\u5b57\u6bb5\u7684\u503c\u662f5\uff0c\u5373160\u6bd4\u7279=20\u5b57\u8282\u3002\u6b64\u5b57\u6bb5\u6700\u5927\u503c\u4e3a60\u5b57\u8282\u3002 \u25cf\u670d\u52a1\u7c7b\u578b\uff08Type of Service \uff0cTOS\uff09\u5b57\u6bb5\uff1a\u53608\u6bd4\u7279\u3002\u5176\u4e2d\u524d3\u6bd4\u7279\u4e3a\u4f18\u5148\u6743\u5b50\u5b57\u6bb5\uff08Precedence\uff0c\u73b0\u5df2\u88ab\u5ffd\u7565\uff09\u3002\u7b2c8\u6bd4\u7279\u4fdd\u7559\u672a\u7528\u3002\u7b2c4\u81f3\u7b2c7\u6bd4\u7279\u5206\u522b\u4ee3\u8868\u5ef6\u8fdf\u3001\u541e\u5410\u91cf\u3001\u53ef\u9760\u6027\u548c\u82b1\u8d39\u3002\u5f53\u5b83\u4eec\u53d6\u503c\u4e3a1\u65f6\u5206\u522b\u4ee3\u8868\u8981\u6c42\u6700\u5c0f\u65f6\u5ef6\u3001\u6700\u5927\u541e\u5410\u91cf\u3001\u6700\u9ad8\u53ef\u9760\u6027\u548c\u6700\u5c0f\u8d39\u7528\u3002\u8fd94\u6bd4\u7279\u7684\u670d\u52a1\u7c7b\u578b\u4e2d\u53ea\u80fd\u7f6e\u5176\u4e2d1\u6bd4\u7279\u4e3a1\u3002\u53ef\u4ee5\u5168\u4e3a0\uff0c\u82e5\u5168\u4e3a0\u5219\u8868\u793a\u4e00\u822c\u670d\u52a1\u3002\u670d\u52a1\u7c7b\u578b\u5b57\u6bb5\u58f0\u660e\u4e86\u6570\u636e\u62a5\u88ab\u7f51\u7edc\u7cfb\u7edf\u4f20\u8f93\u65f6\u53ef\u4ee5\u88ab\u600e\u6837\u5904\u7406\u3002\u4f8b\u5982\uff1aTELNET\u534f\u8bae\u53ef\u80fd\u8981\u6c42\u6709\u6700\u5c0f\u7684\u5ef6\u8fdf\uff0cFTP\u534f\u8bae\uff08\u6570\u636e\uff09\u53ef\u80fd\u8981\u6c42\u6709\u6700\u5927\u541e\u5410\u91cf\uff0cSNMP\u534f\u8bae\u53ef\u80fd\u8981\u6c42\u6709\u6700\u9ad8\u53ef\u9760\u6027\uff0cNNTP\uff08Network News Transfer Protocol\uff0c\u7f51\u7edc\u65b0\u95fb\u4f20\u8f93\u534f\u8bae\uff09\u53ef\u80fd\u8981\u6c42\u6700\u5c0f\u8d39\u7528\uff0c\u800cICMP\u534f\u8bae\u53ef\u80fd\u65e0\u7279\u6b8a\u8981\u6c42\uff084\u6bd4\u7279\u5168\u4e3a0\uff09\u3002\u5b9e\u9645\u4e0a\uff0c\u5927\u90e8\u5206\u4e3b\u673a\u4f1a\u5ffd\u7565\u8fd9\u4e2a\u5b57\u6bb5\uff0c\u4f46\u4e00\u4e9b\u52a8\u6001\u8def\u7531\u534f\u8bae\u5982OSPF\uff08Open Shortest Path First Protocol\uff09\u3001IS-IS\uff08Intermediate System to Intermediate System Protocol\uff09\u53ef\u4ee5\u6839\u636e\u8fd9\u4e9b\u5b57\u6bb5\u7684\u503c\u8fdb\u884c\u8def\u7531\u51b3\u7b56\u3002 \u25cf\u603b\u957f\u5ea6\u5b57\u6bb5\uff1a\u536016\u6bd4\u7279\u3002\u6307\u660e\u6574\u4e2a\u6570\u636e\u62a5\u7684\u957f\u5ea6\uff08\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\uff09\u3002\u6700\u5927\u957f\u5ea6\u4e3a65535\u5b57\u8282\u3002 \u25cf\u6807\u5fd7\u5b57\u6bb5\uff1a\u536016\u6bd4\u7279\u3002\u7528\u6765\u552f\u4e00\u5730\u6807\u8bc6\u4e3b\u673a\u53d1\u9001\u7684\u6bcf\u4e00\u4efd\u6570\u636e\u62a5\u3002\u901a\u5e38\u6bcf\u53d1\u4e00\u4efd\u62a5\u6587\uff0c\u5b83\u7684\u503c\u4f1a\u52a01\u3002 \u25cf\u6807\u5fd7\u4f4d\u5b57\u6bb5\uff1a\u53603\u6bd4\u7279\u3002\u6807\u5fd7\u4e00\u4efd\u6570\u636e\u62a5\u662f\u5426\u8981\u6c42\u5206\u6bb5\u3002 \u25cf\u6bb5\u504f\u79fb\u5b57\u6bb5\uff1a\u536013\u6bd4\u7279\u3002\u5982\u679c\u4e00\u4efd\u6570\u636e\u62a5\u8981\u6c42\u5206\u6bb5\u7684\u8bdd\uff0c\u6b64\u5b57\u6bb5\u6307\u660e\u8be5\u6bb5\u504f\u79fb\u8ddd\u539f\u59cb\u6570\u636e\u62a5\u5f00\u59cb\u7684\u4f4d\u7f6e\u3002 \u25cf\u751f\u5b58\u671f\uff08TTL\uff1aTime to Live\uff09\u5b57\u6bb5\uff1a\u53608\u6bd4\u7279\u3002\u7528\u6765\u8bbe\u7f6e\u6570\u636e\u62a5\u6700\u591a\u53ef\u4ee5\u7ecf\u8fc7\u7684\u8def\u7531\u5668\u6570\u3002\u7531\u53d1\u9001\u6570\u636e\u7684\u6e90\u4e3b\u673a\u8bbe\u7f6e\uff0c\u901a\u5e38\u4e3a32\u300164\u3001128\u7b49\u3002\u6bcf\u7ecf\u8fc7\u4e00\u4e2a\u8def\u7531\u5668\uff0c\u5176\u503c\u51cf1\uff0c\u76f4\u52300\u65f6\u8be5\u6570\u636e\u62a5\u88ab\u4e22\u5f03\u3002 \u25cf\u534f\u8bae\u5b57\u6bb5\uff1a\u53608\u6bd4\u7279\u3002\u6307\u660eIP\u5c42\u6240\u5c01\u88c5\u7684\u4e0a\u5c42\u534f\u8bae\u7c7b\u578b\uff0c\u5982ICMP\uff081\uff09\u3001IGMP\uff082\uff09 \u3001TCP\uff086\uff09\u3001UDP\uff0817\uff09\u7b49\u3002 \u25cf\u5934\u90e8\u6821\u9a8c\u548c\u5b57\u6bb5\uff1a\u536016\u6bd4\u7279\u3002\u5185\u5bb9\u662f\u6839\u636eIP\u5934\u90e8\u8ba1\u7b97\u5f97\u5230\u7684\u6821\u9a8c\u548c\u7801\u3002\u8ba1\u7b97\u65b9\u6cd5\u662f\uff1a\u5bf9\u5934\u90e8\u4e2d\u6bcf\u4e2a16\u6bd4\u7279\u8fdb\u884c\u4e8c\u8fdb\u5236\u53cd\u7801\u6c42\u548c\u3002\uff08\u548cICMP\u3001IGMP\u3001TCP\u3001UDP\u4e0d\u540c\uff0cIP\u4e0d\u5bf9\u5934\u90e8\u540e\u7684\u6570\u636e\u8fdb\u884c\u6821\u9a8c\uff09\u3002 \u25cf\u6e90IP\u5730\u5740\u3001\u76ee\u6807IP\u5730\u5740\u5b57\u6bb5\uff1a\u5404\u536032\u6bd4\u7279\u3002\u7528\u6765\u6807\u660e\u53d1\u9001IP\u6570\u636e\u62a5\u6587\u7684\u6e90\u4e3b\u673a\u5730\u5740\u548c\u63a5\u6536IP\u62a5\u6587\u7684\u76ee\u6807\u4e3b\u673a\u5730\u5740\u3002 \u53ef\u9009\u9879\u5b57\u6bb5\uff1a\u536032\u6bd4\u7279\u3002\u7528\u6765\u5b9a\u4e49\u4e00\u4e9b\u4efb\u9009\u9879\uff1a\u5982\u8bb0\u5f55\u8def\u5f84\u3001\u65f6\u95f4\u6233\u7b49\u3002\u8fd9\u4e9b\u9009\u9879\u5f88\u5c11\u88ab\u4f7f\u7528\uff0c\u540c\u65f6\u5e76\u4e0d\u662f\u6240\u6709\u4e3b\u673a\u548c\u8def\u7531\u5668\u90fd\u652f\u6301\u8fd9\u4e9b\u9009\u9879\u3002\u53ef\u9009\u9879\u5b57\u6bb5\u7684\u957f\u5ea6\u5fc5\u987b\u662f32\u6bd4\u7279\u7684\u6574\u6570\u500d\uff0c\u5982\u679c\u4e0d\u8db3\uff0c\u5fc5\u987b\u586b\u51450\u4ee5\u8fbe\u5230\u6b64\u957f\u5ea6\u8981\u6c42\u3002</p> <p>2\u3001TCP\u6570\u636e\u6bb5\u683c\u5f0f TCP\u662f\u4e00\u79cd\u53ef\u9760\u7684\u3001\u9762\u5411\u8fde\u63a5\u7684\u5b57\u8282\u6d41\u670d\u52a1\u3002\u6e90\u4e3b\u673a\u5728\u4f20\u9001\u6570\u636e\u524d\u9700\u8981\u5148\u548c\u76ee\u6807\u4e3b\u673a\u5efa\u7acb\u8fde\u63a5\u3002\u7136\u540e\uff0c\u5728\u6b64\u8fde\u63a5\u4e0a\uff0c\u88ab\u7f16\u53f7\u7684\u6570\u636e\u6bb5\u6309\u5e8f\u6536\u53d1\u3002\u540c\u65f6\uff0c\u8981\u6c42\u5bf9\u6bcf\u4e2a\u6570\u636e\u6bb5\u8fdb\u884c\u786e\u8ba4\uff0c\u4fdd\u8bc1\u4e86\u53ef\u9760\u6027\u3002\u5982\u679c\u5728\u6307\u5b9a\u7684\u65f6\u95f4\u5185\u6ca1\u6709\u6536\u5230\u76ee\u6807\u4e3b\u673a\u5bf9\u6240\u53d1\u6570\u636e\u6bb5\u7684\u786e\u8ba4\uff0c\u6e90\u4e3b\u673a\u5c06\u518d\u6b21\u53d1\u9001\u8be5\u6570\u636e\u6bb5\u3002 \u5982\u56fe2-5\u6240\u793a\uff0c\u662fTCP\u5934\u90e8\u7ed3\u6784\uff08RFC 793\u30011323\uff09\u3002  \u56fe2-5\u3000 TCP\u5934\u90e8\u7ed3\u6784 \u25cf\u6e90\u3001\u76ee\u6807\u7aef\u53e3\u53f7\u5b57\u6bb5\uff1a\u536016\u6bd4\u7279\u3002TCP\u534f\u8bae\u901a\u8fc7\u4f7f\u7528\"\u7aef\u53e3\"\u6765\u6807\u8bc6\u6e90\u7aef\u548c\u76ee\u6807\u7aef\u7684\u5e94\u7528\u8fdb\u7a0b\u3002\u7aef\u53e3\u53f7\u53ef\u4ee5\u4f7f\u75280\u523065535\u4e4b\u95f4\u7684\u4efb\u4f55\u6570\u5b57\u3002\u5728\u6536\u5230\u670d\u52a1\u8bf7\u6c42\u65f6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u52a8\u6001\u5730\u4e3a\u5ba2\u6237\u7aef\u7684\u5e94\u7528\u7a0b\u5e8f\u5206\u914d\u7aef\u53e3\u53f7\u3002\u5728\u670d\u52a1\u5668\u7aef\uff0c\u6bcf\u79cd\u670d\u52a1\u5728\"\u4f17\u6240\u5468\u77e5\u7684\u7aef\u53e3\"\uff08Well-Know Port\uff09\u4e3a\u7528\u6237\u63d0\u4f9b\u670d\u52a1\u3002 \u25cf\u987a\u5e8f\u53f7\u5b57\u6bb5\uff1a\u536032\u6bd4\u7279\u3002\u7528\u6765\u6807\u8bc6\u4eceTCP\u6e90\u7aef\u5411TCP\u76ee\u6807\u7aef\u53d1\u9001\u7684\u6570\u636e\u5b57\u8282\u6d41\uff0c\u5b83\u8868\u793a\u5728\u8fd9\u4e2a\u62a5\u6587\u6bb5\u4e2d\u7684\u7b2c\u4e00\u4e2a\u6570\u636e\u5b57\u8282\u3002 \u25cf\u786e\u8ba4\u53f7\u5b57\u6bb5\uff1a\u536032\u6bd4\u7279\u3002\u53ea\u6709ACK\u6807\u5fd7\u4e3a1\u65f6\uff0c\u786e\u8ba4\u53f7\u5b57\u6bb5\u624d\u6709\u6548\u3002\u5b83\u5305\u542b\u76ee\u6807\u7aef\u6240\u671f\u671b\u6536\u5230\u6e90\u7aef\u7684\u4e0b\u4e00\u4e2a\u6570\u636e\u5b57\u8282\u3002 \u25cf\u5934\u90e8\u957f\u5ea6\u5b57\u6bb5\uff1a\u53604\u6bd4\u7279\u3002\u7ed9\u51fa\u5934\u90e8\u536032\u6bd4\u7279\u7684\u6570\u76ee\u3002\u6ca1\u6709\u4efb\u4f55\u9009\u9879\u5b57\u6bb5\u7684TCP\u5934\u90e8\u957f\u5ea6\u4e3a20\u5b57\u8282\uff1b\u6700\u591a\u53ef\u4ee5\u670960\u5b57\u8282\u7684TCP\u5934\u90e8\u3002 \u25cf\u6807\u5fd7\u4f4d\u5b57\u6bb5\uff08U\u3001A\u3001P\u3001R\u3001S\u3001F\uff09\uff1a\u53606\u6bd4\u7279\u3002\u5404\u6bd4\u7279\u7684\u542b\u4e49\u5982\u4e0b\uff1a \u25c6URG\uff1a\u7d27\u6025\u6307\u9488\uff08urgent pointer\uff09\u6709\u6548\u3002 \u25c6ACK\uff1a\u786e\u8ba4\u5e8f\u53f7\u6709\u6548\u3002 \u25c6PSH\uff1a\u63a5\u6536\u65b9\u5e94\u8be5\u5c3d\u5feb\u5c06\u8fd9\u4e2a\u62a5\u6587\u6bb5\u4ea4\u7ed9\u5e94\u7528\u5c42\u3002 \u25c6RST\uff1a\u91cd\u5efa\u8fde\u63a5\u3002 \u25c6SYN\uff1a\u53d1\u8d77\u4e00\u4e2a\u8fde\u63a5\u3002 \u25c6FIN\uff1a\u91ca\u653e\u4e00\u4e2a\u8fde\u63a5\u3002 \u25cf\u7a97\u53e3\u5927\u5c0f\u5b57\u6bb5\uff1a\u536016\u6bd4\u7279\u3002\u6b64\u5b57\u6bb5\u7528\u6765\u8fdb\u884c\u6d41\u91cf\u63a7\u5236\u3002\u5355\u4f4d\u4e3a\u5b57\u8282\u6570\uff0c\u8fd9\u4e2a\u503c\u662f\u672c\u673a\u671f\u671b\u4e00\u6b21\u63a5\u6536\u7684\u5b57\u8282\u6570\u3002 \u25cfTCP\u6821\u9a8c\u548c\u5b57\u6bb5\uff1a\u536016\u6bd4\u7279\u3002\u5bf9\u6574\u4e2aTCP\u62a5\u6587\u6bb5\uff0c\u5373TCP\u5934\u90e8\u548cTCP\u6570\u636e\u8fdb\u884c\u6821\u9a8c\u548c\u8ba1\u7b97\uff0c\u5e76\u7531\u76ee\u6807\u7aef\u8fdb\u884c\u9a8c\u8bc1\u3002 \u25cf\u7d27\u6025\u6307\u9488\u5b57\u6bb5\uff1a\u536016\u6bd4\u7279\u3002\u5b83\u662f\u4e00\u4e2a\u504f\u79fb\u91cf\uff0c\u548c\u5e8f\u53f7\u5b57\u6bb5\u4e2d\u7684\u503c\u76f8\u52a0\u8868\u793a\u7d27\u6025\u6570\u636e\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u7684\u5e8f\u53f7\u3002 \u25cf\u9009\u9879\u5b57\u6bb5\uff1a\u536032\u6bd4\u7279\u3002\u53ef\u80fd\u5305\u62ec\"\u7a97\u53e3\u6269\u5927\u56e0\u5b50\"\u3001\"\u65f6\u95f4\u6233\"\u7b49\u9009\u9879\u3002</p> <p>3\u3001UDP\u6570\u636e\u6bb5\u683c\u5f0f UDP\u662f\u4e00\u79cd\u4e0d\u53ef\u9760\u7684\u3001\u65e0\u8fde\u63a5\u7684\u6570\u636e\u62a5\u670d\u52a1\u3002\u6e90\u4e3b\u673a\u5728\u4f20\u9001\u6570\u636e\u524d\u4e0d\u9700\u8981\u548c\u76ee\u6807\u4e3b\u673a\u5efa\u7acb\u8fde\u63a5\u3002\u6570\u636e\u88ab\u51a0\u4ee5\u6e90\u3001\u76ee\u6807\u7aef\u53e3\u53f7\u7b49UDP\u62a5\u5934\u5b57\u6bb5\u540e\u76f4\u63a5\u53d1\u5f80\u76ee\u7684\u4e3b\u673a\u3002\u8fd9\u65f6\uff0c\u6bcf\u4e2a\u6570\u636e\u6bb5\u7684\u53ef\u9760\u6027\u4f9d\u9760\u4e0a\u5c42\u534f\u8bae\u6765\u4fdd\u8bc1\u3002\u5728\u4f20\u9001\u6570\u636e\u8f83\u5c11\u3001\u8f83\u5c0f\u7684\u60c5\u51b5\u4e0b\uff0cUDP\u6bd4TCP\u66f4\u52a0\u9ad8\u6548\u3002 \u5982\u56fe2-6\u6240\u793a\uff0c\u662fUDP\u5934\u90e8\u7ed3\u6784\uff08RFC 793\u30011323\uff09\uff1a  \u25cf\u6e90\u3001\u76ee\u6807\u7aef\u53e3\u53f7\u5b57\u6bb5\uff1a\u536016\u6bd4\u7279\u3002\u4f5c\u7528\u4e0eTCP\u6570\u636e\u6bb5\u4e2d\u7684\u7aef\u53e3\u53f7\u5b57\u6bb5\u76f8\u540c\uff0c\u7528\u6765\u6807\u8bc6\u6e90\u7aef\u548c\u76ee\u6807\u7aef\u7684\u5e94\u7528\u8fdb\u7a0b\u3002 \u25cf\u957f\u5ea6\u5b57\u6bb5\uff1a\u536016\u6bd4\u7279\u3002\u6807\u660eUDP\u5934\u90e8\u548cUDP\u6570\u636e\u7684\u603b\u957f\u5ea6\u5b57\u8282\u3002 \u25cf\u6821\u9a8c\u548c\u5b57\u6bb5\uff1a\u536016\u6bd4\u7279\u3002\u7528\u6765\u5bf9UDP\u5934\u90e8\u548cUDP\u6570\u636e\u8fdb\u884c\u6821\u9a8c\u3002\u548cTCP\u4e0d\u540c\u7684\u662f\uff0c\u5bf9UDP\u6765\u8bf4\uff0c\u6b64\u5b57\u6bb5\u662f\u53ef\u9009\u9879\uff0c\u800cTCP\u6570\u636e\u6bb5\u4e2d\u7684\u6821\u9a8c\u548c\u5b57\u6bb5\u662f\u5fc5\u987b\u6709\u7684\u3002</p> <p>2.3\u3000\u5957\u63a5\u5b57 \u5728\u6bcf\u4e2aTCP\u3001UDP\u6570\u636e\u6bb5\u4e2d\u90fd\u5305\u542b\u6e90\u7aef\u53e3\u548c\u76ee\u6807\u7aef\u53e3\u5b57\u6bb5\u3002\u6709\u65f6\uff0c\u6211\u4eec\u628a\u4e00\u4e2aIP\u5730\u5740\u548c\u4e00\u4e2a\u7aef\u53e3\u53f7\u5408\u79f0\u4e3a\u4e00\u4e2a\u5957\u63a5\u5b57\uff08Socket\uff09\uff0c\u800c\u4e00\u4e2a\u5957\u63a5\u5b57\u5bf9\uff08Socket pair\uff09\u53ef\u4ee5\u552f\u4e00\u5730\u786e\u5b9a\u4e92\u8fde\u7f51\u7edc\u4e2d\u6bcf\u4e2aTCP\u8fde\u63a5\u7684\u53cc\u65b9\uff08\u5ba2\u6237IP\u5730\u5740\u3001\u5ba2\u6237\u7aef\u53e3\u53f7\u3001\u670d\u52a1\u5668IP\u5730\u5740\u3001\u670d\u52a1\u5668\u7aef\u53e3\u53f7\uff09\u3002</p> <p>\u5982\u56fe2-7\u6240\u793a\uff0c\u662f\u5e38\u89c1\u7684\u4e00\u4e9b\u534f\u8bae\u548c\u5b83\u4eec\u5bf9\u5e94\u7684\u670d\u52a1\u7aef\u53e3\u53f7\u3002  \u56fe2-7\u3000 \u5e38\u89c1\u534f\u8bae\u548c\u5bf9\u5e94\u7684\u7aef\u53e3\u53f7</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4e0d\u540c\u7684\u5e94\u7528\u5c42\u534f\u8bae\u53ef\u80fd\u57fa\u4e8e\u4e0d\u540c\u7684\u4f20\u8f93\u5c42\u534f\u8bae\uff0c\u5982FTP\u3001TELNET\u3001SMTP\u534f\u8bae\u57fa\u4e8e\u53ef\u9760\u7684TCP\u534f\u8bae\u3002TFTP\u3001SNMP\u3001RIP\u57fa\u4e8e\u4e0d\u53ef\u9760\u7684UDP\u534f\u8bae\u3002 \u540c\u65f6\uff0c\u6709\u4e9b\u5e94\u7528\u5c42\u534f\u8bae\u5360\u7528\u4e86\u4e24\u4e2a\u4e0d\u540c\u7684\u7aef\u53e3\u53f7\uff0c\u5982FTP\u768420\u300121\u7aef\u53e3\uff0cSNMP\u7684161\u3001162\u7aef\u53e3\u3002\u8fd9\u4e9b\u5e94\u7528\u5c42\u534f\u8bae\u5728\u4e0d\u540c\u7684\u7aef\u53e3\u63d0\u4f9b\u4e0d\u540c\u7684\u529f\u80fd\u3002\u5982FTP\u768421\u7aef\u53e3\u7528\u6765\u4fa6\u542c\u7528\u6237\u7684\u8fde\u63a5\u8bf7\u6c42\uff0c\u800c20\u7aef\u53e3\u7528\u6765\u4f20\u9001\u7528\u6237\u7684\u6587\u4ef6\u6570\u636e\u3002\u518d\u5982\uff0cSNMP\u7684161\u7aef\u53e3\u7528\u4e8eSNMP\u7ba1\u7406\u8fdb\u7a0b\u83b7\u53d6SNMP\u4ee3\u7406\u7684\u6570\u636e\uff0c\u800c162\u7aef\u53e3\u7528\u4e8eSNMP\u4ee3\u7406\u4e3b\u52a8\u5411SNMP\u7ba1\u7406\u8fdb\u7a0b\u53d1\u9001\u6570\u636e\u3002 \u8fd8\u6709\u4e00\u4e9b\u534f\u8bae\u4f7f\u7528\u4e86\u4f20\u8f93\u5c42\u7684\u4e0d\u540c\u534f\u8bae\u63d0\u4f9b\u7684\u670d\u52a1\u3002\u5982DNS\u534f\u8bae\u540c\u65f6\u4f7f\u7528\u4e86TCP 53\u7aef\u53e3\u548cUDP 53\u7aef\u53e3\u3002DNS\u534f\u8bae\u5728UDP\u768453\u7aef\u53e3\u63d0\u4f9b\u57df\u540d\u89e3\u6790\u670d\u52a1\uff0c\u5728TCP\u768453\u7aef\u53e3\u63d0\u4f9bDNS\u533a\u57df\u6587\u4ef6\u4f20\u8f93\u670d\u52a1\u3002</p> <p>2.4\u3000TCP\u8fde\u63a5\u5efa\u7acb\u3001\u91ca\u653e\u65f6\u7684\u63e1\u624b\u8fc7\u7a0b 1\u3001TCP\u5efa\u7acb\u8fde\u63a5\u7684\u4e09\u6b21\u63e1\u624b\u8fc7\u7a0b TCP\u4f1a\u8bdd\u901a\u8fc7\u4e09\u6b21\u63e1\u624b\u6765\u521d\u59cb\u5316\u3002\u4e09\u6b21\u63e1\u624b\u7684\u76ee\u6807\u662f\u4f7f\u6570\u636e\u6bb5\u7684\u53d1\u9001\u548c\u63a5\u6536\u540c\u6b65\u3002\u540c\u65f6\u4e5f\u5411\u5176\u4ed6\u4e3b\u673a\u8868\u660e\u5176\u4e00\u6b21\u53ef\u63a5\u6536\u7684\u6570\u636e\u91cf\uff08\u7a97\u53e3\u5927\u5c0f\uff09\uff0c\u5e76\u5efa\u7acb\u903b\u8f91\u8fde\u63a5\u3002\u8fd9\u4e09\u6b21\u63e1\u624b\u7684\u8fc7\u7a0b\u53ef\u4ee5\u7b80\u8ff0\u5982\u4e0b\uff1a \u25cf\u6e90\u4e3b\u673a\u53d1\u9001\u4e00\u4e2a\u540c\u6b65\u6807\u5fd7\u4f4d\uff08SYN\uff09\u7f6e1\u7684TCP\u6570\u636e\u6bb5\u3002\u6b64\u6bb5\u4e2d\u540c\u65f6\u6807\u660e\u521d\u59cb\u5e8f\u53f7\uff08Initial Sequence Number\uff0cISN\uff09\u3002ISN\u662f\u4e00\u4e2a\u968f\u65f6\u95f4\u53d8\u5316\u7684\u968f\u673a\u503c\u3002 \u25cf\u76ee\u6807\u4e3b\u673a\u53d1\u56de\u786e\u8ba4\u6570\u636e\u6bb5\uff0c\u6b64\u6bb5\u4e2d\u7684\u540c\u6b65\u6807\u5fd7\u4f4d\uff08SYN\uff09\u540c\u6837\u88ab\u7f6e1\uff0c\u4e14\u786e\u8ba4\u6807\u5fd7\u4f4d\uff08ACK\uff09\u4e5f\u7f6e1\uff0c\u540c\u65f6\u5728\u786e\u8ba4\u5e8f\u53f7\u5b57\u6bb5\u8868\u660e\u76ee\u6807\u4e3b\u673a\u671f\u5f85\u6536\u5230\u6e90\u4e3b\u673a\u4e0b\u4e00\u4e2a\u6570\u636e\u6bb5\u7684\u5e8f\u53f7\uff08\u5373\u8868\u660e\u524d\u4e00\u4e2a\u6570\u636e\u6bb5\u5df2\u6536\u5230\u5e76\u4e14\u6ca1\u6709\u9519\u8bef\uff09\u3002\u6b64\u5916\uff0c\u6b64\u6bb5\u4e2d\u8fd8\u5305\u542b\u76ee\u6807\u4e3b\u673a\u7684\u6bb5\u521d\u59cb\u5e8f\u53f7\u3002 \u25cf\u6e90\u4e3b\u673a\u518d\u56de\u9001\u4e00\u4e2a\u6570\u636e\u6bb5\uff0c\u540c\u6837\u5e26\u6709\u9012\u589e\u7684\u53d1\u9001\u5e8f\u53f7\u548c\u786e\u8ba4\u5e8f\u53f7\u3002 \u81f3\u6b64\u4e3a\u6b62\uff0cTCP\u4f1a\u8bdd\u7684\u4e09\u6b21\u63e1\u624b\u5b8c\u6210\u3002\u63a5\u4e0b\u6765\uff0c\u6e90\u4e3b\u673a\u548c\u76ee\u6807\u4e3b\u673a\u53ef\u4ee5\u4e92\u76f8\u6536\u53d1\u6570\u636e\u3002\u6574\u4e2a\u8fc7\u7a0b\u53ef\u7528\u56fe2-8\u8868\u793a\u3002  2\u3001TCP\u91ca\u653e\u8fde\u63a5\u7684\u56db\u6b21\u63e1\u624b\u8fc7\u7a0b</p> <p>\u6458\u81ea\u300ehttp://www.cnblogs.com/BlueTzar/articles/811160.html\u300f</p>","tags":["tcp/ip","\u7f51\u7edc"]},{"location":"Misc/2015-12-11-centos7-%25e4%25bd%25bf%25e7%2594%25a8systemctl%25e8%25bf%259b%25e8%25a1%258c%25e9%2585%258d%25e7%25bd%25ae.html/","title":"CentOS7 \u4f7f\u7528systemctl\u8fdb\u884c\u914d\u7f6e","text":"1\uff0ccentos7 \u4f7f\u7528 systemctl \u66ff\u6362\u4e86 service\u547d\u4ee4 \u53c2\u8003\uff1aredhat\u6587\u6863\uff1a https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/System_Administrators_Guide/sect-Managing_Services_with_systemd-Services.html#sect-Managing_Services_with_systemd-Services-List <p>\u67e5\u770b\u5168\u90e8\u670d\u52a1\u547d\u4ee4\uff1a systemctl list-unit-files --type service \u67e5\u770b\u670d\u52a1 systemctl status name.service \u542f\u52a8\u670d\u52a1 systemctl start name.service \u505c\u6b62\u670d\u52a1 systemctl stop name.service \u91cd\u542f\u670d\u52a1 systemctl restart name.service\u589e\u52a0\u5f00\u673a\u542f\u52a8 systemctl enable name.service \u5220\u9664\u5f00\u673a\u542f\u52a8 systemctl disable name.service \u5176\u4e2d.service \u53ef\u4ee5\u7701\u7565\u3002</p> 2\uff0ctomcat\u589e\u52a0\u542f\u52a8\u53c2\u6570 <p>tomcat \u9700\u8981\u589e\u52a0\u4e00\u4e2apid\u6587\u4ef6</p> <p>\u5728tomca/bin \u76ee\u5f55\u4e0b\u9762\uff0c\u589e\u52a0\u00a0setenv.sh \u914d\u7f6e\uff0ccatalina.sh\u542f\u52a8\u7684\u65f6\u5019\u4f1a\u8c03\u7528\uff0c\u540c\u65f6\u914d\u7f6ejava\u5185\u5b58\u53c2\u6570\u3002</p> [plain] view plaincopyprint? <ol> <li>#add\u00a0tomcat\u00a0pid</li> <li>CATALINA_PID=\"$CATALINA_BASE/tomcat.pid\"</li> <li>#add\u00a0java\u00a0opts</li> <li>JAVA_OPTS=\"-server\u00a0-XX:PermSize=256M\u00a0-XX:MaxPermSize=1024m\u00a0-Xms512M\u00a0-Xmx1024M\u00a0-XX:MaxNewSize=256m\"</li> </ol> <p> </p> 3\uff0c\u589e\u52a0tomcat.service <p>\u5728/usr/lib/systemd/system\u76ee\u5f55\u4e0b\u589e\u52a0tomcat.service\uff0c\u76ee\u5f55\u5fc5\u987b\u662f\u7edd\u5bf9\u76ee\u5f55\u3002</p> [plain] view plaincopyprint? <ol> <li>[Unit]</li> <li>Description=Tomcat</li> <li>After=syslog.target\u00a0network.target\u00a0remote-fs.target\u00a0nss-lookup.target</li> <li></li> <li>[Service]</li> <li>Type=forking</li> <li>PIDFile=/data/tomcat/tomcat.pid</li> <li>ExecStart=/data/tomcat/bin/startup.sh</li> <li>ExecReload=/bin/kill\u00a0-s\u00a0HUP\u00a0$MAINPID</li> <li>ExecStop=/bin/kill\u00a0-s\u00a0QUIT\u00a0$MAINPID</li> <li>PrivateTmp=true</li> <li></li> <li>[Install]</li> <li>WantedBy=multi-user.target</li> </ol> <p>[unit]\u914d\u7f6e\u4e86\u670d\u52a1\u7684\u63cf\u8ff0\uff0c\u89c4\u5b9a\u4e86\u5728network\u542f\u52a8\u4e4b\u540e\u6267\u884c\u3002[service]\u914d\u7f6e\u670d\u52a1\u7684pid\uff0c\u670d\u52a1\u7684\u542f\u52a8\uff0c\u505c\u6b62\uff0c\u91cd\u542f\u3002[install]\u914d\u7f6e\u4e86\u4f7f\u7528\u7528\u6237\u3002</p> 4\uff0c\u4f7f\u7528tomcat.service <p>\u914d\u7f6e\u5f00\u673a\u542f\u52a8</p> <p>systemctl enable tomcat</p> <p>\u542f\u52a8tomcat systemctl start tomcat \u505c\u6b62tomcat systemctl stop tomcat \u91cd\u542ftomcat systemctl restart tomcat</p> <p>\u56e0\u4e3a\u914d\u7f6epid\uff0c\u5728\u542f\u52a8\u7684\u65f6\u5019\u4f1a\u518dtomcat\u6839\u76ee\u5f55\u751f\u6210tomcat.pid\u6587\u4ef6\uff0c\u505c\u6b62\u4e4b\u540e\u5220\u9664\u3002</p> <p>\u540c\u65f6tomcat\u5728\u542f\u52a8\u65f6\u5019\uff0c\u6267\u884cstart\u4e0d\u4f1a\u542f\u52a8\u4e24\u4e2atomcat\uff0c\u4fdd\u8bc1\u59cb\u7ec8\u53ea\u6709\u4e00\u4e2atomcat\u670d\u52a1\u5728\u8fd0\u884c\u3002</p> <p>\u591a\u4e2atomcat\u53ef\u4ee5\u914d\u7f6e\u5728\u591a\u4e2a\u76ee\u5f55\u4e0b\uff0c\u4e92\u4e0d\u5f71\u54cd\u3002</p> <p>\u6458\u81ea\u300ehttp://blog.csdn.net/freewebsys/article/details/41646081\u300f</p>","tags":["centos","systemctl","service"]},{"location":"Misc/2015-12-17-ascii%25e8%25a1%25a8.html/","title":"ASCII\u7801\u5bf9\u7167\u8868","text":"ASCII\u63a7\u5236\u5b57\u7b26 \u4e8c\u8fdb\u5236 \u5341\u8fdb\u5236 \u5341\u516d\u8fdb\u5236 \u7f29\u5199 \u53ef\u4ee5\u663e\u793a\u7684\u8868\u793a\u6cd5 \u540d\u79f0/\u610f\u4e49 0000\u00a00000 0 00 NUL \u2400 \u7a7a\u5b57\u7b26\uff08Null\uff09 0000\u00a00001 1 01 SOH \u2401 \u6807\u9898\u5f00\u59cb 0000\u00a00010 2 02 STX \u2402 \u672c\u6587\u5f00\u59cb 0000\u00a00011 3 03 ETX \u2403 \u672c\u6587\u7ed3\u675f 0000\u00a00100 4 04 EOT \u2404 \u4f20\u8f93\u7ed3\u675f 0000\u00a00101 5 05 ENQ \u2405 \u8bf7\u6c42 0000\u00a00110 6 06 ACK \u2406 \u786e\u8ba4\u56de\u5e94 0000\u00a00111 7 07 BEL \u2407 \u54cd\u94c3 0000\u00a01000 8 08 BS \u2408 \u9000\u683c 0000\u00a01001 9 09 HT \u2409 \u6c34\u5e73\u5b9a\u4f4d\u7b26\u53f7 0000\u00a01010 10 0A LF \u240a \u6362\u884c\u952e 0000\u00a01011 11 0B VT \u240b \u5782\u76f4\u5b9a\u4f4d\u7b26\u53f7 0000\u00a01100 12 0C FF \u240c \u6362\u9875\u952e 0000\u00a01101 13 0D CR \u240d \u5f52\u4f4d\u952e 0000\u00a01110 14 0E SO \u240e \u53d6\u6d88\u53d8\u6362\uff08Shift out\uff09 0000\u00a01111 15 0F SI \u240f \u542f\u7528\u53d8\u6362\uff08Shift in\uff09 0001\u00a00000 16 10 DLE \u2410 \u8df3\u51fa\u6570\u636e\u901a\u8baf 0001\u00a00001 17 11 DC1 \u2411 \u8bbe\u5907\u63a7\u5236\u4e00\uff08XON \u542f\u7528\u8f6f\u4ef6\u901f\u5ea6\u63a7\u5236\uff09 0001\u00a00010 18 12 DC2 \u2412 \u8bbe\u5907\u63a7\u5236\u4e8c 0001\u00a00011 19 13 DC3 \u2413 \u8bbe\u5907\u63a7\u5236\u4e09\uff08XOFF \u505c\u7528\u8f6f\u4ef6\u901f\u5ea6\u63a7\u5236\uff09 0001\u00a00100 20 14 DC4 \u2414 \u8bbe\u5907\u63a7\u5236\u56db 0001\u00a00101 21 15 NAK \u2415 \u786e\u8ba4\u5931\u8d25\u56de\u5e94 0001\u00a00110 22 16 SYN \u2416 \u540c\u6b65\u7528\u6682\u505c 0001\u00a00111 23 17 ETB \u2417 \u533a\u5757\u4f20\u8f93\u7ed3\u675f 0001\u00a01000 24 18 CAN \u2418 \u53d6\u6d88 0001\u00a01001 25 19 EM \u2419 \u8fde\u63a5\u4ecb\u8d28\u4e2d\u65ad 0001\u00a01010 26 1A SUB \u241a \u66ff\u6362 0001\u00a01011 27 1B ESC \u241b \u8df3\u51fa 0001\u00a01100 28 1C FS \u241c \u6587\u4ef6\u5206\u5272\u7b26 0001\u00a01101 29 1D GS \u241d \u7ec4\u7fa4\u5206\u9694\u7b26 0001\u00a01110 30 1E RS \u241e \u8bb0\u5f55\u5206\u9694\u7b26 0001\u00a01111 31 1F US \u241f \u5355\u5143\u5206\u9694\u7b26 0111\u00a01111 127 7F DEL \u2421 \u5220\u9664 ASCII\u53ef\u663e\u793a\u5b57\u7b26 \u4e8c\u8fdb\u5236 \u5341\u8fdb\u5236 \u5341\u516d\u8fdb\u5236 \u56fe\u5f62 0010\u00a00000 32 20 \uff08\u7a7a\u683c\uff09(\u2420) 0010\u00a00001 33 21 ! 0010\u00a00010 34 22 \" 0010\u00a00011 35 23 # 0010\u00a00100 36 24 $ 0010\u00a00101 37 25 \u00a0% 0010\u00a00110 38 26 &amp; 0010\u00a00111 39 27 ' 0010\u00a01000 40 28 ( 0010\u00a01001 41 29 ) 0010\u00a01010 42 2A * 0010\u00a01011 43 2B + 0010\u00a01100 44 2C , 0010\u00a01101 45 2D - 0010\u00a01110 46 2E . 0010\u00a01111 47 2F / 0011\u00a00000 48 30 0 0011\u00a00001 49 31 1 0011\u00a00010 50 32 2 0011\u00a00011 51 33 3 0011\u00a00100 52 34 4 0011\u00a00101 53 35 5 0011\u00a00110 54 36 6 0011\u00a00111 55 37 7 0011\u00a01000 56 38 8 0011\u00a01001 57 39 9 0011\u00a01010 58 3A : 0011\u00a01011 59 3B ; 0011\u00a01100 60 3C &lt; 0011\u00a01101 61 3D = 0011\u00a01110 62 3E &gt; 0011\u00a01111 63 3F ? \u4e8c\u8fdb\u5236 \u5341\u8fdb\u5236 \u5341\u516d\u8fdb\u5236 \u56fe\u5f62 0100\u00a00000 64 40 @ 0100\u00a00001 65 41 A 0100\u00a00010 66 42 B 0100\u00a00011 67 43 C 0100\u00a00100 68 44 D 0100\u00a00101 69 45 E 0100\u00a00110 70 46 F 0100\u00a00111 71 47 G 0100\u00a01000 72 48 H 0100\u00a01001 73 49 I 0100\u00a01010 74 4A J 0100\u00a01011 75 4B K 0100\u00a01100 76 4C L 0100\u00a01101 77 4D M 0100\u00a01110 78 4E N 0100\u00a01111 79 4F O 0101\u00a00000 80 50 P 0101\u00a00001 81 51 Q 0101\u00a00010 82 52 R 0101\u00a00011 83 53 S 0101\u00a00100 84 54 T 0101\u00a00101 85 55 U 0101\u00a00110 86 56 V 0101\u00a00111 87 57 W 0101\u00a01000 88 58 X 0101\u00a01001 89 59 Y 0101\u00a01010 90 5A Z 0101\u00a01011 91 5B [ 0101\u00a01100 92 5C \\ 0101\u00a01101 93 5D ] 0101\u00a01110 94 5E ^ 0101\u00a01111 95 5F _ \u4e8c\u8fdb\u5236 \u5341\u8fdb\u5236 \u5341\u516d\u8fdb\u5236 \u56fe\u5f62 0110\u00a00000 96 60 ` 0110\u00a00001 97 61 a 0110\u00a00010 98 62 b 0110\u00a00011 99 63 c 0110\u00a00100 100 64 d 0110\u00a00101 101 65 e 0110\u00a00110 102 66 f 0110\u00a00111 103 67 g 0110\u00a01000 104 68 h 0110\u00a01001 105 69 i 0110\u00a01010 106 6A j 0110\u00a01011 107 6B k 0110\u00a01100 108 6C l 0110\u00a01101 109 6D m 0110\u00a01110 110 6E n 0110\u00a01111 111 6F o 0111\u00a00000 112 70 p 0111\u00a00001 113 71 q 0111\u00a00010 114 72 r 0111\u00a00011 115 73 s 0111\u00a00100 116 74 t 0111\u00a00101 117 75 u 0111\u00a00110 118 76 v 0111\u00a00111 119 77 w 0111\u00a01000 120 78 x 0111\u00a01001 121 79 y 0111\u00a01010 122 7A z 0111\u00a01011 123 7B { 0111\u00a01100 124 7C | 0111\u00a01101 125 7D } 0111\u00a01110 126 7E ~","tags":["ASCII"]},{"location":"Misc/2015-12-17-grep%25e5%2591%25bd%25e4%25bb%25a4%25e7%259a%2584or%25ef%25bc%258cand%25ef%25bc%258cnot%25e6%2593%258d%25e4%25bd%259c%25e7%25a4%25ba%25e4%25be%258b.html/","title":"grep\u547d\u4ee4\u7684or\uff0cand\uff0cnot\u64cd\u4f5c\u793a\u4f8b","text":"<p>\u5728Linux\u7684grep\u547d\u4ee4\u4e2d\u5982\u4f55\u4f7f\u7528OR\uff0cAND\uff0cNOT\u64cd\u4f5c\u7b26\u5462\uff1f</p> <p>\u5176\u5b9e\uff0c\u5728grep\u547d\u4ee4\u4e2d\uff0c\u6709OR\u548cNOT\u64cd\u4f5c\u7b26\u7684\u7b49\u4ef7\u9009\u9879\uff0c\u4f46\u662f\u5e76\u6ca1\u6709grep AND\u8fd9\u79cd\u64cd\u4f5c\u7b26\u3002\u4e0d\u8fc7\u5462\uff0c\u53ef\u4ee5\u4f7f\u7528patterns\u6765\u6a21\u62dfAND\u64cd\u4f5c\u7684\u3002\u4e0b\u9762\u4f1a\u4e3e\u4e00\u4e9b\u4f8b\u5b50\u6765\u8bf4\u660e\u5728Linux\u7684grep\u547d\u4ee4\u4e2d\u5982\u4f55\u4f7f\u7528OR\uff0cAND\uff0cNOT\u3002</p> <p>\u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u4f1a\u7528\u5230\u8fd9\u4e2aemployee.txt\u6587\u4ef6\uff0c\u5982\u4e0b\uff1a</p> [plain] view plaincopy <ol> <li>$\u00a0cat\u00a0employee.txt</li> <li>100\u00a0\u00a0Thomas\u00a0\u00a0Manager\u00a0\u00a0\u00a0\u00a0Sales\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0$5,000</li> <li>200\u00a0\u00a0Jason\u00a0\u00a0\u00a0Developer\u00a0\u00a0Technology\u00a0\u00a0$5,500</li> <li>300\u00a0\u00a0Raj\u00a0\u00a0\u00a0\u00a0\u00a0Sysadmin\u00a0\u00a0\u00a0Technology\u00a0\u00a0$7,000</li> <li>400\u00a0\u00a0Nisha\u00a0\u00a0\u00a0Manager\u00a0\u00a0\u00a0\u00a0Marketing\u00a0\u00a0\u00a0$9,500</li> <li>500\u00a0\u00a0Randy\u00a0\u00a0\u00a0Manager\u00a0\u00a0\u00a0\u00a0Sales\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0$6,000</li> </ol> <p>\uff08\u4e00\uff09Grep OR \u64cd\u4f5c\u7b26</p> <p>\u4ee5\u4e0b\u56db\u79cd\u65b9\u6cd5\u5747\u80fd\u5b9e\u73b0grep OR\u7684\u64cd\u4f5c\u3002\u4e2a\u4eba\u63a8\u8350\u65b9\u6cd53.</p> <p>1.\u4f7f\u7528 \\|</p> <p>\u5982\u679c\u4e0d\u4f7f\u7528grep\u547d\u4ee4\u7684\u4efb\u4f55\u9009\u9879\uff0c\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528 '\\|' \u6765\u5206\u5272\u591a\u4e2apattern\uff0c\u4ee5\u6b64\u5b9e\u73b0OR\u7684\u64cd\u4f5c\u3002</p> [plain] view plaincopy <ol> <li>grep\u00a0'pattern1\\|pattern2'\u00a0filename</li> </ol> <p>\u4f8b\u5b50\u5982\u4e0b\uff1a</p> [plain] view plaincopy <ol> <li>$\u00a0grep\u00a0'Tech\\|Sales'\u00a0employee.txt</li> <li>100\u00a0\u00a0Thomas\u00a0\u00a0Manager\u00a0\u00a0\u00a0\u00a0Sales\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0$5,000</li> <li>200\u00a0\u00a0Jason\u00a0\u00a0\u00a0Developer\u00a0\u00a0Technology\u00a0\u00a0$5,500</li> <li>300\u00a0\u00a0Raj\u00a0\u00a0\u00a0\u00a0\u00a0Sysadmin\u00a0\u00a0\u00a0Technology\u00a0\u00a0$7,000</li> <li>500\u00a0\u00a0Randy\u00a0\u00a0\u00a0Manager\u00a0\u00a0\u00a0\u00a0Sales\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0$6,000</li> </ol> <p>2.\u4f7f\u7528\u9009\u9879 -E</p> <p>grep -E \u9009\u9879\u53ef\u4ee5\u7528\u6765\u6269\u5c55\u9009\u9879\u4e3a\u6b63\u5219\u8868\u8fbe\u5f0f\u3002 \u5982\u679c\u4f7f\u7528\u4e86grep \u547d\u4ee4\u7684\u9009\u9879-E\uff0c\u5219\u5e94\u8be5\u4f7f\u7528 | \u6765\u5206\u5272\u591a\u4e2apattern\uff0c\u4ee5\u6b64\u5b9e\u73b0OR\u64cd\u4f5c\u3002</p> [plain] view plaincopy <ol> <li>grep\u00a0-E\u00a0'pattern1|pattern2'\u00a0filename <p>\u4f8b\u5b50\u5982\u4e0b\uff1a</p> [plain] view plaincopy <ol> <li>$\u00a0grep\u00a0-E\u00a0'Tech|Sales'\u00a0employee.txt</li> <li>100\u00a0\u00a0Thomas\u00a0\u00a0Manager\u00a0\u00a0\u00a0\u00a0Sales\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0$5,000</li> <li>200\u00a0\u00a0Jason\u00a0\u00a0\u00a0Developer\u00a0\u00a0Technology\u00a0\u00a0$5,500</li> <li>300\u00a0\u00a0Raj\u00a0\u00a0\u00a0\u00a0\u00a0Sysadmin\u00a0\u00a0\u00a0Technology\u00a0\u00a0$7,000</li> <li>500\u00a0\u00a0Randy\u00a0\u00a0\u00a0Manager\u00a0\u00a0\u00a0\u00a0Sales\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0$6,000</li> </ol> <p>3. \u4f7f\u7528 egrep</p> <p>egrep \u547d\u4ee4\u7b49\u540c\u4e8e\u2018grep -E\u2019\u3002\u56e0\u6b64\uff0c\u4f7f\u7528egrep (\u4e0d\u5e26\u4efb\u4f55\u9009\u9879)\u547d\u4ee4\uff0c\u4ee5\u6b64\u6839\u636e\u5206\u5272\u7684\u591a\u4e2aPattern\u6765\u5b9e\u73b0OR\u64cd\u4f5c.</p> [plain] view plaincopy <ol> <li>egrep\u00a0'pattern1|pattern2'\u00a0filename</li> </ol> <p>\u4f8b\u5b50\u5982\u4e0b\uff1a</p> [plain] view plaincopy <ol> <li>$\u00a0egrep\u00a0'Tech|Sales'\u00a0employee.txt</li> <li>100\u00a0\u00a0Thomas\u00a0\u00a0Manager\u00a0\u00a0\u00a0\u00a0Sales\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0$5,000</li> <li>200\u00a0\u00a0Jason\u00a0\u00a0\u00a0Developer\u00a0\u00a0Technology\u00a0\u00a0$5,500</li> <li>300\u00a0\u00a0Raj\u00a0\u00a0\u00a0\u00a0\u00a0Sysadmin\u00a0\u00a0\u00a0Technology\u00a0\u00a0$7,000</li> <li>500\u00a0\u00a0Randy\u00a0\u00a0\u00a0Manager\u00a0\u00a0\u00a0\u00a0Sales\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0$6,000</li> </ol> <p>4. \u4f7f\u7528\u9009\u9879 -e</p> <p>\u4f7f\u7528grep -e \u9009\u9879\uff0c\u53ea\u80fd\u4f20\u9012\u4e00\u4e2a\u53c2\u6570\u3002\u5728\u5355\u6761\u547d\u4ee4\u4e2d\u4f7f\u7528\u591a\u4e2a -e \u9009\u9879\uff0c\u5f97\u5230\u591a\u4e2apattern\uff0c\u4ee5\u6b64\u5b9e\u73b0OR\u64cd\u4f5c\u3002</p> [plain] view plaincopy <ol> <li>grep\u00a0-e\u00a0pattern1\u00a0-e\u00a0pattern2\u00a0filename</li> </ol> <p>\u4f8b\u5b50\u5982\u4e0b\uff1a</p> [plain] view plaincopy <ol> <li>$\u00a0grep\u00a0-e\u00a0Tech\u00a0-e\u00a0Sales\u00a0employee.txt</li> <li>100\u00a0\u00a0Thomas\u00a0\u00a0Manager\u00a0\u00a0\u00a0\u00a0Sales\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0$5,000</li> <li>200\u00a0\u00a0Jason\u00a0\u00a0\u00a0Developer\u00a0\u00a0Technology\u00a0\u00a0$5,500</li> <li>300\u00a0\u00a0Raj\u00a0\u00a0\u00a0\u00a0\u00a0Sysadmin\u00a0\u00a0\u00a0Technology\u00a0\u00a0$7,000</li> <li>500\u00a0\u00a0Randy\u00a0\u00a0\u00a0Manager\u00a0\u00a0\u00a0\u00a0Sales\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0$6,000</li> </ol> <p>\uff08\u4e8c\uff09 Grep AND \u64cd\u4f5c</p> <p>1. \u4f7f\u7528 -E 'pattern1.*pattern2'</p> <p>grep\u547d\u4ee4\u672c\u8eab\u4e0d\u63d0\u4f9bAND\u529f\u80fd\u3002\u4f46\u662f\uff0c\u4f7f\u7528 -E \u9009\u9879\u53ef\u4ee5\u5b9e\u73b0AND\u64cd\u4f5c\u3002</p> [plain] view plaincopy <ol> <li>grep\u00a0-E\u00a0'pattern1.*pattern2'\u00a0filename</li> <li>grep\u00a0-E\u00a0'pattern1.*pattern2|pattern2.*pattern1'\u00a0filename</li> </ol> <p>\u7b2c\u4e00\u4e2a\u4f8b\u5b50\u5982\u4e0b\uff1a\uff08\u5176\u4e2d\u4e24\u4e2apattern\u7684\u987a\u5e8f\u662f\u6307\u5b9a\u7684\uff09</p> [plain] view plaincopy <ol> <li>$\u00a0grep\u00a0-E\u00a0'Dev.*Tech'\u00a0employee.txt</li> <li>200\u00a0\u00a0Jason\u00a0\u00a0\u00a0Developer\u00a0\u00a0Technology\u00a0\u00a0$5,500</li> </ol> <p>\u7b2c\u4e8c\u4e2a\u4f8b\u5b50\uff1a\uff08\u4e24\u4e2apattern\u7684\u987a\u5e8f\u4e0d\u662f\u56fa\u5b9a\u7684\uff0c\u53ef\u4ee5\u662f\u4e71\u5e8f\u7684\uff09</p> [plain] view plaincopy <ol> <li>$\u00a0grep\u00a0-E\u00a0'Manager.*Sales|Sales.*Manager'\u00a0employee.txt</li> </ol> <p>2. \u4f7f\u7528\u591a\u4e2agrep\u547d\u4ee4</p> <p>\u53ef\u4ee5\u4f7f\u7528\u591a\u4e2a grep \u547d\u4ee4 \uff0c\u7531\u7ba1\u9053\u7b26\u5206\u5272\uff0c\u4ee5\u6b64\u6765\u5b9e\u73b0 AND \u8bed\u4e49\u3002</p> [plain] view plaincopy <ol> <li>grep\u00a0-E\u00a0'pattern1'\u00a0filename\u00a0|\u00a0grep\u00a0-E\u00a0'pattern2'</li> </ol> <p>\u4f8b\u5b50\u5982\u4e0b\uff1a</p> [plain] view plaincopy <ol> <li>$\u00a0grep\u00a0Manager\u00a0employee.txt\u00a0|\u00a0grep\u00a0Sales</li> <li>100\u00a0\u00a0Thomas\u00a0\u00a0Manager\u00a0\u00a0\u00a0\u00a0Sales\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0$5,000</li> <li>500\u00a0\u00a0Randy\u00a0\u00a0\u00a0Manager\u00a0\u00a0\u00a0\u00a0Sales\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0$6,000</li> </ol> <p>\uff08\u4e09\uff09 Grep NOT\u64cd\u4f5c</p> <p>1. \u4f7f\u7528\u9009\u9879 grep -v</p> <p>\u4f7f\u7528 grep -v \u53ef\u4ee5\u5b9e\u73b0 NOT \u64cd\u4f5c\u3002 -v \u9009\u9879\u7528\u6765\u5b9e\u73b0\u53cd\u9009\u5339\u914d\u7684\uff08 invert match\uff09\u3002\u5982\uff0c\u53ef\u5339\u914d\u5f97\u5230\u9664\u4e0b\u6307\u5b9apattern\u5916\u7684\u6240\u6709lines\u3002</p> [plain] view plaincopy <ol> <li>grep\u00a0-v\u00a0'pattern1'\u00a0filename</li> </ol> <p>\u4f8b\u5b50\u5982\u4e0b\uff1a</p> [plain] view plaincopy <ol> <li>$\u00a0grep\u00a0-v\u00a0Sales\u00a0employee.txt</li> <li>200\u00a0\u00a0Jason\u00a0\u00a0\u00a0Developer\u00a0\u00a0Technology\u00a0\u00a0$5,500</li> <li>300\u00a0\u00a0Raj\u00a0\u00a0\u00a0\u00a0\u00a0Sysadmin\u00a0\u00a0\u00a0Technology\u00a0\u00a0$7,000</li> <li>400\u00a0\u00a0Nisha\u00a0\u00a0\u00a0Manager\u00a0\u00a0\u00a0\u00a0Marketing\u00a0\u00a0\u00a0$9,500</li> </ol> <p>\u5f53\u7136\uff0c\u53ef\u4ee5\u5c06NOT\u64cd\u4f5c\u4e0e\u5176\u4ed6\u64cd\u4f5c\u8054\u5408\u8d77\u6765\uff0c\u4ee5\u6b64\u5b9e\u73b0\u66f4\u5f3a\u5927\u7684\u529f\u80fd \u7ec4\u5408\u3002</p> <p>\u5982\uff0c\u8fd9\u4e2a\u4f8b\u5b50\u5c06\u5f97\u5230\uff1a\u2018Manager\u6216\u8005Developer\uff0c\u4f46\u662f\u4e0d\u662fSales\u2019\u7684\u7ed3\u679c\uff1a</p> [plain] view plaincopy <ol> <li>$\u00a0egrep\u00a0'Manager|Developer'\u00a0employee.txt\u00a0|\u00a0grep\u00a0-v\u00a0Sales</li> <li>200\u00a0\u00a0Jason\u00a0\u00a0\u00a0Developer\u00a0\u00a0Technology\u00a0\u00a0$5,500</li> <li>400\u00a0\u00a0Nisha\u00a0\u00a0\u00a0Manager\u00a0\u00a0\u00a0\u00a0Marketing\u00a0\u00a0\u00a0$9,500</li> </ol> <p>\u6458\u81ea\u300ehttp://blog.csdn.net/jackaduma/article/details/6900242\u300f</p>","tags":["grep"]},{"location":"Misc/2015-12-27-linux-awk-%25e5%2586%2585%25e7%25bd%25ae%25e5%2587%25bd%25e6%2595%25b0%25e8%25af%25a6%25e7%25bb%2586%25e4%25bb%258b%25e7%25bb%258d%25ef%25bc%2588%25e5%25ae%259e%25e4%25be%258b%25ef%25bc%2589.html/","title":"linux awk \u5185\u7f6e\u51fd\u6570\u8be6\u7ec6\u4ecb\u7ecd\uff08\u5b9e\u4f8b\uff09","text":"<p>\u8fd9\u8282\u8be6\u7ec6\u4ecb\u7ecdawk\u5185\u7f6e\u51fd\u6570\uff0c\u4e3b\u8981\u5206\u4ee5\u4e0b3\u79cd\u7c7b\u4f3c\uff1a\u7b97\u6570\u51fd\u6570\u3001\u5b57\u7b26\u4e32\u51fd\u6570\u3001\u5176\u5b83\u4e00\u822c\u51fd\u6570\u3001\u65f6\u95f4\u51fd\u6570</p> <p>\u4e00\u3001\u7b97\u672f\u51fd\u6570:</p> <p>\u4ee5\u4e0b\u7b97\u672f\u51fd\u6570\u6267\u884c\u4e0e C \u8bed\u8a00\u4e2d\u540d\u79f0\u76f8\u540c\u7684\u5b50\u4f8b\u7a0b\u76f8\u540c\u7684\u64cd\u4f5c\uff1a</p> \u51fd\u6570\u540d \u8bf4\u660e atan2( y, x ) \u8fd4\u56de y/x \u7684\u53cd\u6b63\u5207\u3002 cos( x ) \u8fd4\u56de x \u7684\u4f59\u5f26\uff1bx \u662f\u5f27\u5ea6\u3002 sin( x ) \u8fd4\u56de x \u7684\u6b63\u5f26\uff1bx \u662f\u5f27\u5ea6\u3002 exp( x ) \u8fd4\u56de x \u5e42\u51fd\u6570\u3002 log( x ) \u8fd4\u56de x \u7684\u81ea\u7136\u5bf9\u6570\u3002 sqrt( x ) \u8fd4\u56de x \u5e73\u65b9\u6839\u3002 int( x ) \u8fd4\u56de x \u7684\u622a\u65ad\u81f3\u6574\u6570\u7684\u503c\u3002 rand( ) \u8fd4\u56de\u4efb\u610f\u6570\u5b57 n\uff0c\u5176\u4e2d 0 &lt;= n &lt; 1\u3002 srand( [Expr] ) \u5c06 rand \u51fd\u6570\u7684\u79cd\u5b50\u503c\u8bbe\u7f6e\u4e3a Expr \u53c2\u6570\u7684\u503c\uff0c\u6216\u5982\u679c\u7701\u7565 Expr \u53c2\u6570\u5219\u4f7f\u7528\u67d0\u5929\u7684\u65f6\u95f4\u3002\u8fd4\u56de\u5148\u524d\u7684\u79cd\u5b50\u503c\u3002 <p> </p> <p>\u4e3e\u4f8b\u8bf4\u660e\uff1a</p> <p>[chengmo@centos5 ~]$ awk 'BEGIN{OFMT=\"%.3f\";fs=sin(1);fe=exp(10);fl=log(10);fi=int(3.1415);print fs,fe,fl,fi;}' 0.841 22026.466 2.303 3</p> <p> </p> <p>OFMT \u8bbe\u7f6e\u8f93\u51fa\u6570\u636e\u683c\u5f0f\u662f\u4fdd\u75593\u4f4d\u5c0f\u6570</p> <p>\u83b7\u5f97\u968f\u673a\u6570\uff1a</p> <p>[chengmo@centos5 ~]$ awk 'BEGIN{srand();fr=int(100*rand());print fr;}' 78 [chengmo@centos5 ~]$ awk 'BEGIN{srand();fr=int(100*rand());print fr;}' 31 [chengmo@centos5 ~]$ awk 'BEGIN{srand();fr=int(100*rand());print fr;}'</p> <p>41</p> <p> </p> <p> </p>","tags":["awk","linux","\u51fd\u6570"]},{"location":"Misc/2015-12-27-linux-awk-%25e5%2586%2585%25e7%25bd%25ae%25e5%2587%25bd%25e6%2595%25b0%25e8%25af%25a6%25e7%25bb%2586%25e4%25bb%258b%25e7%25bb%258d%25ef%25bc%2588%25e5%25ae%259e%25e4%25be%258b%25ef%25bc%2589.html/#a171c1272","title":"\u4e8c\u3001\u5b57\u7b26\u4e32\u51fd\u6570\u662f\uff1a","text":"\u51fd\u6570 \u8bf4\u660e gsub( Ere, Repl, [ In ] ) \u9664\u4e86\u6b63\u5219\u8868\u8fbe\u5f0f\u6240\u6709\u5177\u4f53\u503c\u88ab\u66ff\u4ee3\u8fd9\u70b9\uff0c\u5b83\u548c sub \u51fd\u6570\u5b8c\u5168\u4e00\u6837\u5730\u6267\u884c\uff0c\u3002 sub( Ere, Repl, [ In ] ) \u7528 Repl \u53c2\u6570\u6307\u5b9a\u7684\u5b57\u7b26\u4e32\u66ff\u6362 In \u53c2\u6570\u6307\u5b9a\u7684\u5b57\u7b26\u4e32\u4e2d\u7684\u7531 Ere \u53c2\u6570\u6307\u5b9a\u7684\u6269\u5c55\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u7b2c\u4e00\u4e2a\u5177\u4f53\u503c\u3002sub \u51fd\u6570\u8fd4\u56de\u66ff\u6362\u7684\u6570\u91cf\u3002\u51fa\u73b0\u5728 Repl \u53c2\u6570\u6307\u5b9a\u7684\u5b57\u7b26\u4e32\u4e2d\u7684 &amp;\uff08\u548c\u7b26\u53f7\uff09\u7531 In \u53c2\u6570\u6307\u5b9a\u7684\u4e0e Ere \u53c2\u6570\u7684\u6307\u5b9a\u7684\u6269\u5c55\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u7684\u5b57\u7b26\u4e32\u66ff\u6362\u3002\u5982\u679c\u672a\u6307\u5b9a In \u53c2\u6570\uff0c\u7f3a\u7701\u503c\u662f\u6574\u4e2a\u8bb0\u5f55\uff08$0 \u8bb0\u5f55\u53d8\u91cf\uff09\u3002 index( String1, String2 ) \u5728\u7531 String1 \u53c2\u6570\u6307\u5b9a\u7684\u5b57\u7b26\u4e32\uff08\u5176\u4e2d\u6709\u51fa\u73b0 String2 \u6307\u5b9a\u7684\u53c2\u6570\uff09\u4e2d\uff0c\u8fd4\u56de\u4f4d\u7f6e\uff0c\u4ece 1 \u5f00\u59cb\u7f16\u53f7\u3002\u5982\u679c String2 \u53c2\u6570\u4e0d\u5728 String1 \u53c2\u6570\u4e2d\u51fa\u73b0\uff0c\u5219\u8fd4\u56de 0\uff08\u96f6\uff09\u3002 length [(String)] \u8fd4\u56de String \u53c2\u6570\u6307\u5b9a\u7684\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\uff08\u5b57\u7b26\u5f62\u5f0f\uff09\u3002\u5982\u679c\u672a\u7ed9\u51fa String \u53c2\u6570\uff0c\u5219\u8fd4\u56de\u6574\u4e2a\u8bb0\u5f55\u7684\u957f\u5ea6\uff08$0 \u8bb0\u5f55\u53d8\u91cf\uff09\u3002 blength [(String)] \u8fd4\u56de String \u53c2\u6570\u6307\u5b9a\u7684\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\uff08\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\uff09\u3002\u5982\u679c\u672a\u7ed9\u51fa String \u53c2\u6570\uff0c\u5219\u8fd4\u56de\u6574\u4e2a\u8bb0\u5f55\u7684\u957f\u5ea6\uff08$0 \u8bb0\u5f55\u53d8\u91cf\uff09\u3002 substr( String, M, [ N ] ) \u8fd4\u56de\u5177\u6709 N \u53c2\u6570\u6307\u5b9a\u7684\u5b57\u7b26\u6570\u91cf\u5b50\u4e32\u3002\u5b50\u4e32\u4ece String \u53c2\u6570\u6307\u5b9a\u7684\u5b57\u7b26\u4e32\u53d6\u5f97\uff0c\u5176\u5b57\u7b26\u4ee5 M \u53c2\u6570\u6307\u5b9a\u7684\u4f4d\u7f6e\u5f00\u59cb\u3002M \u53c2\u6570\u6307\u5b9a\u4e3a\u5c06 String \u53c2\u6570\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4f5c\u4e3a\u7f16\u53f7 1\u3002\u5982\u679c\u672a\u6307\u5b9a N \u53c2\u6570\uff0c\u5219\u5b50\u4e32\u7684\u957f\u5ea6\u5c06\u662f M \u53c2\u6570\u6307\u5b9a\u7684\u4f4d\u7f6e\u5230 String \u53c2\u6570\u7684\u672b\u5c3e \u7684\u957f\u5ea6\u3002 match( String, Ere ) \u5728 String \u53c2\u6570\u6307\u5b9a\u7684\u5b57\u7b26\u4e32\uff08Ere \u53c2\u6570\u6307\u5b9a\u7684\u6269\u5c55\u6b63\u5219\u8868\u8fbe\u5f0f\u51fa\u73b0\u5728\u5176\u4e2d\uff09\u4e2d\u8fd4\u56de\u4f4d\u7f6e\uff08\u5b57\u7b26\u5f62\u5f0f\uff09\uff0c\u4ece 1 \u5f00\u59cb\u7f16\u53f7\uff0c\u6216\u5982\u679c Ere \u53c2\u6570\u4e0d\u51fa\u73b0\uff0c\u5219\u8fd4\u56de 0\uff08\u96f6\uff09\u3002RSTART \u7279\u6b8a\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u8fd4\u56de\u503c\u3002RLENGTH \u7279\u6b8a\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u5339\u914d\u7684\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\uff0c\u6216\u5982\u679c\u672a\u627e\u5230\u4efb\u4f55\u5339\u914d\uff0c\u5219\u8bbe\u7f6e\u4e3a -1\uff08\u8d1f\u4e00\uff09\u3002 split( String, A, [Ere] ) \u5c06 String \u53c2\u6570\u6307\u5b9a\u7684\u53c2\u6570\u5206\u5272\u4e3a\u6570\u7ec4\u5143\u7d20 A[1], A[2], . . ., A[n]\uff0c\u5e76\u8fd4\u56de n \u53d8\u91cf\u7684\u503c\u3002\u6b64\u5206\u9694\u53ef\u4ee5\u901a\u8fc7 Ere \u53c2\u6570\u6307\u5b9a\u7684\u6269\u5c55\u6b63\u5219\u8868\u8fbe\u5f0f\u8fdb\u884c\uff0c\u6216\u7528\u5f53\u524d\u5b57\u6bb5\u5206\u9694\u7b26\uff08FS \u7279\u6b8a\u53d8\u91cf\uff09\u6765\u8fdb\u884c\uff08\u5982\u679c\u6ca1\u6709\u7ed9\u51fa Ere \u53c2\u6570\uff09\u3002\u9664\u975e\u4e0a\u4e0b\u6587\u6307\u660e\u7279\u5b9a\u7684\u5143\u7d20\u8fd8\u5e94\u5177\u6709\u4e00\u4e2a\u6570\u5b57\u503c\uff0c\u5426\u5219 A \u6570\u7ec4\u4e2d\u7684\u5143\u7d20\u7528\u5b57\u7b26\u4e32\u503c\u6765\u521b\u5efa\u3002 tolower( String ) \u8fd4\u56de String \u53c2\u6570\u6307\u5b9a\u7684\u5b57\u7b26\u4e32\uff0c\u5b57\u7b26\u4e32\u4e2d\u6bcf\u4e2a\u5927\u5199\u5b57\u7b26\u5c06\u66f4\u6539\u4e3a\u5c0f\u5199\u3002\u5927\u5199\u548c\u5c0f\u5199\u7684\u6620\u5c04\u7531\u5f53\u524d\u8bed\u8a00\u73af\u5883\u7684 LC_CTYPE \u8303\u7574\u5b9a\u4e49\u3002 toupper( String ) \u8fd4\u56de String \u53c2\u6570\u6307\u5b9a\u7684\u5b57\u7b26\u4e32\uff0c\u5b57\u7b26\u4e32\u4e2d\u6bcf\u4e2a\u5c0f\u5199\u5b57\u7b26\u5c06\u66f4\u6539\u4e3a\u5927\u5199\u3002\u5927\u5199\u548c\u5c0f\u5199\u7684\u6620\u5c04\u7531\u5f53\u524d\u8bed\u8a00\u73af\u5883\u7684 LC_CTYPE \u8303\u7574\u5b9a\u4e49\u3002 sprintf(Format, Expr, Expr, . . . ) \u6839\u636e Format \u53c2\u6570\u6307\u5b9a\u7684 printf \u5b50\u4f8b\u7a0b\u683c\u5f0f\u5b57\u7b26\u4e32\u6765\u683c\u5f0f\u5316 Expr \u53c2\u6570\u6307\u5b9a\u7684\u8868\u8fbe\u5f0f\u5e76\u8fd4\u56de\u6700\u540e\u751f\u6210\u7684\u5b57\u7b26\u4e32\u3002","tags":["awk","linux","\u51fd\u6570"]},{"location":"Misc/2015-12-27-linux-awk-%25e5%2586%2585%25e7%25bd%25ae%25e5%2587%25bd%25e6%2595%25b0%25e8%25af%25a6%25e7%25bb%2586%25e4%25bb%258b%25e7%25bb%258d%25ef%25bc%2588%25e5%25ae%259e%25e4%25be%258b%25ef%25bc%2589.html/#a171c127f","title":"Ere\u90fd\u53ef\u4ee5\u662f\u6b63\u5219\u8868\u8fbe\u5f0f\u4e09\u3001\u4e00\u822c\u51fd\u6570\u662f\uff1a","text":"<p>gsub,sub\u4f7f\u7528</p> <p>[chengmo@centos5 ~]$ awk 'BEGIN{info=\"this is a test2010test!\";gsub(/[0-9]+/,\"!\",info);print info}' this is a test!test!</p> <p> </p> <p>\u5728 info\u4e2d\u67e5\u627e\u6ee1\u8db3\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c/[0-9]+/ \u7528\u201d\u201d\u66ff\u6362\uff0c\u5e76\u4e14\u66ff\u6362\u540e\u7684\u503c\uff0c\u8d4b\u503c\u7ed9info \u672a\u7ed9info\u503c\uff0c\u9ed8\u8ba4\u662f$0</p> <p> </p> <p>\u67e5\u627e\u5b57\u7b26\u4e32\uff08index\u4f7f\u7528\uff09</p> <p>[wangsl@centos5 ~]$ awk 'BEGIN{info=\"this is a test2010test!\";print index(info,\"test\")?\"ok\":\"no found\";}' ok</p> <p>\u672a\u627e\u5230\uff0c\u8fd4\u56de0</p> <p> </p> <p>\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u67e5\u627e(match\u4f7f\u7528\uff09</p> <p>[wangsl@centos5 ~]$ awk 'BEGIN{info=\"this is a test2010test!\";print match(info,/[0-9]+/)?\"ok\":\"no found\";}' ok</p> <p> </p> <p>\u622a\u53d6\u5b57\u7b26\u4e32(substr\u4f7f\u7528\uff09</p> <p>[wangsl@centos5 ~]$ awk 'BEGIN{info=\"this is a test2010test!\";print substr(info,4,10);}' s is a tes</p> <p>\u4ece\u7b2c 4\u4e2a \u5b57\u7b26\u5f00\u59cb\uff0c\u622a\u53d610\u4e2a\u957f\u5ea6\u5b57\u7b26\u4e32</p> <p> </p> <p>\u5b57\u7b26\u4e32\u5206\u5272\uff08split\u4f7f\u7528\uff09</p> <p>[chengmo@centos5 ~]$ awk 'BEGIN{info=\"this is a test\";split(info,tA,\" \");print length(tA);for(k in tA){print k,tA[k];}}' 4 4 test 1 this 2 is 3 a</p> <p> </p> <p>\u5206\u5272info,\u52a8\u6001\u521b\u5efa\u6570\u7ec4tA,\u8fd9\u91cc\u6bd4\u8f83\u6709\u610f\u601d\uff0cawk for \u2026in \u5faa\u73af\uff0c\u662f\u4e00\u4e2a\u65e0\u5e8f\u7684\u5faa\u73af\u3002 \u5e76\u4e0d\u662f\u4ece\u6570\u7ec4\u4e0b\u68071\u2026n \uff0c\u56e0\u6b64\u4f7f\u7528\u65f6\u5019\u9700\u8981\u6ce8\u610f\u3002</p> <p> </p> <p>\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u8f93\u51fa\uff08sprintf\u4f7f\u7528\uff09</p> <p>\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u683c\u5f0f\uff1a</p> <p>\u5176\u4e2d\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u5305\u62ec\u4e24\u90e8\u5206\u5185\u5bb9: \u4e00\u90e8\u5206\u662f\u6b63\u5e38\u5b57\u7b26, \u8fd9\u4e9b\u5b57\u7b26\u5c06\u6309\u539f\u6837\u8f93\u51fa; \u53e6\u4e00\u90e8\u5206\u662f\u683c\u5f0f\u5316\u89c4\u5b9a\u5b57\u7b26, \u4ee5\"%\"\u5f00\u59cb, \u540e\u8ddf\u4e00\u4e2a\u6216\u51e0\u4e2a\u89c4\u5b9a\u5b57\u7b26,\u7528\u6765\u786e\u5b9a\u8f93\u51fa\u5185\u5bb9\u683c\u5f0f\u3002</p> <p> </p> \u683c\u5f0f\u7b26 \u8bf4\u660e %d \u5341\u8fdb\u5236\u6709\u7b26\u53f7\u6574\u6570 %u \u5341\u8fdb\u5236\u65e0\u7b26\u53f7\u6574\u6570 %f \u6d6e\u70b9\u6570 %s \u5b57\u7b26\u4e32 %c \u5355\u4e2a\u5b57\u7b26 %p \u6307\u9488\u7684\u503c %e \u6307\u6570\u5f62\u5f0f\u7684\u6d6e\u70b9\u6570 %x %X \u65e0\u7b26\u53f7\u4ee5\u5341\u516d\u8fdb\u5236\u8868\u793a\u7684\u6574\u6570 %o \u65e0\u7b26\u53f7\u4ee5\u516b\u8fdb\u5236\u8868\u793a\u7684\u6574\u6570 %g \u81ea\u52a8\u9009\u62e9\u5408\u9002\u7684\u8868\u793a\u6cd5 <p>[chengmo@centos5 ~]$ awk 'BEGIN{n1=124.113;n2=-1.224;n3=1.2345; printf(\"%.2f,%.2u,%.2g,%X,%o\\n\",n1,n2,n3,n1,n1);}' 124.11,18446744073709551615,1.2,7C,174</p> <p> </p> \u51fd\u6570 \u8bf4\u660e close( Expression ) \u7528\u540c\u4e00\u4e2a\u5e26\u5b57\u7b26\u4e32\u503c\u7684 Expression \u53c2\u6570\u6765\u5173\u95ed\u7531 print \u6216 printf \u8bed\u53e5\u6253\u5f00\u7684\u6216\u8c03\u7528 getline \u51fd\u6570\u6253\u5f00\u7684\u6587\u4ef6\u6216\u7ba1\u9053\u3002\u5982\u679c\u6587\u4ef6\u6216\u7ba1\u9053\u6210\u529f\u5173\u95ed\uff0c\u5219\u8fd4\u56de 0\uff1b\u5176\u5b83\u60c5\u51b5\u4e0b\u8fd4\u56de\u975e\u96f6\u503c\u3002\u5982\u679c\u6253\u7b97\u5199\u4e00\u4e2a\u6587\u4ef6\uff0c\u5e76\u7a0d\u540e\u5728\u540c\u4e00\u4e2a\u7a0b\u5e8f\u4e2d\u8bfb\u53d6\u6587\u4ef6\uff0c\u5219 close \u8bed\u53e5\u662f\u5fc5\u9700\u7684\u3002 system(Command ) \u6267\u884c Command \u53c2\u6570\u6307\u5b9a\u7684\u547d\u4ee4\uff0c\u5e76\u8fd4\u56de\u9000\u51fa\u72b6\u6001\u3002\u7b49\u540c\u4e8esystem \u5b50\u4f8b\u7a0b\u3002 Expression | getline [ Variable ] \u4ece\u6765\u81ea Expression \u53c2\u6570\u6307\u5b9a\u7684\u547d\u4ee4\u7684\u8f93\u51fa\u4e2d\u901a\u8fc7\u7ba1\u9053\u4f20\u9001\u7684\u6d41\u4e2d\u8bfb\u53d6\u4e00\u4e2a\u8f93\u5165\u8bb0\u5f55\uff0c\u5e76\u5c06\u8be5\u8bb0\u5f55\u7684\u503c\u6307\u5b9a\u7ed9 Variable \u53c2\u6570\u6307\u5b9a\u7684\u53d8\u91cf\u3002\u5982\u679c\u5f53\u524d\u672a\u6253\u5f00\u5c06 Expression \u53c2\u6570\u7684\u503c\u4f5c\u4e3a\u5176\u547d\u4ee4\u540d\u79f0\u7684\u6d41\uff0c\u5219\u521b\u5efa\u6d41\u3002\u521b\u5efa\u7684\u6d41\u7b49\u540c\u4e8e\u8c03\u7528 popen \u5b50\u4f8b\u7a0b\uff0c\u6b64\u65f6 Command \u53c2\u6570\u53d6 Expression \u53c2\u6570\u7684\u503c\u4e14 Mode \u53c2\u6570\u8bbe\u7f6e\u4e3a\u4e00\u4e2a\u662f r \u7684\u503c\u3002\u53ea\u8981\u6d41\u4fdd\u7559\u6253\u5f00\u4e14 Expression \u53c2\u6570\u6c42\u5f97\u540c\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u5219\u5bf9 getline \u51fd\u6570\u7684\u6bcf\u6b21\u540e\u7eed\u8c03\u7528\u8bfb\u53d6\u53e6\u4e00\u4e2a\u8bb0\u5f55\u3002\u5982\u679c\u672a\u6307\u5b9a Variable \u53c2\u6570\uff0c\u5219 $0 \u8bb0\u5f55\u53d8\u91cf\u548c NF \u7279\u6b8a\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u4ece\u6d41\u8bfb\u53d6\u7684\u8bb0\u5f55\u3002 getline [ Variable ] &lt; Expression \u4ece Expression \u53c2\u6570\u6307\u5b9a\u7684\u6587\u4ef6\u8bfb\u53d6\u8f93\u5165\u7684\u4e0b\u4e00\u4e2a\u8bb0\u5f55\uff0c\u5e76\u5c06 Variable \u53c2\u6570\u6307\u5b9a\u7684\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u8be5\u8bb0\u5f55\u7684\u503c\u3002\u53ea\u8981\u6d41\u4fdd\u7559\u6253\u5f00\u4e14 Expression \u53c2\u6570\u5bf9\u540c\u4e00\u4e2a\u5b57\u7b26\u4e32\u6c42\u503c\uff0c\u5219\u5bf9 getline \u51fd\u6570\u7684\u6bcf\u6b21\u540e\u7eed\u8c03\u7528\u8bfb\u53d6\u53e6\u4e00\u4e2a\u8bb0\u5f55\u3002\u5982\u679c\u672a\u6307\u5b9a Variable \u53c2\u6570\uff0c\u5219 $0 \u8bb0\u5f55\u53d8\u91cf\u548c NF \u7279\u6b8a\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u4ece\u6d41\u8bfb\u53d6\u7684\u8bb0\u5f55\u3002 getline [ Variable ] \u5c06 Variable \u53c2\u6570\u6307\u5b9a\u7684\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u4ece\u5f53\u524d\u8f93\u5165\u6587\u4ef6\u8bfb\u53d6\u7684\u4e0b\u4e00\u4e2a\u8f93\u5165\u8bb0\u5f55\u3002\u5982\u679c\u672a\u6307\u5b9a Variable \u53c2\u6570\uff0c\u5219 $0 \u8bb0\u5f55\u53d8\u91cf\u8bbe\u7f6e\u4e3a\u8be5\u8bb0\u5f55\u7684\u503c\uff0c\u8fd8\u5c06\u8bbe\u7f6e NF\u3001NR \u548c FNR \u7279\u6b8a\u53d8\u91cf\u3002 <p> </p> <p>\u6253\u5f00\u5916\u90e8\u6587\u4ef6\uff08close\u7528\u6cd5\uff09</p> <p>[chengmo@centos5 ~]$ awk 'BEGIN{while(\"cat /etc/passwd\"|getline){print $0;};close(\"/etc/passwd\");}' root:x:0:0:root:/root:/bin/bash bin:x:1:1:bin:/bin:/sbin/nologin daemon:x:2:2:daemon:/sbin:/sbin/nologin</p> <p> </p> <p>\u9010\u884c\u8bfb\u53d6\u5916\u90e8\u6587\u4ef6(getline\u4f7f\u7528\u65b9\u6cd5\uff09</p> <p>[chengmo@centos5 ~]$ awk 'BEGIN{while(getline &lt; \"/etc/passwd\"){print $0;};close(\"/etc/passwd\");}' root:x:0:0:root:/root:/bin/bash bin:x:1:1:bin:/bin:/sbin/nologin daemon:x:2:2:daemon:/sbin:/sbin/nologin</p> <p> </p> <p>[chengmo@centos5 ~]$ awk 'BEGIN{print \"Enter your name:\";getline name;print name;}' Enter your name: chengmo chengmo</p> <p> </p> <p>\u8c03\u7528\u5916\u90e8\u5e94\u7528\u7a0b\u5e8f(system\u4f7f\u7528\u65b9\u6cd5\uff09</p> <p>[chengmo@centos5 ~]$ awk 'BEGIN{b=system(\"ls -al\");print b;}' total 42092 drwxr-xr-x 14 chengmo chengmo\u00a0\u00a0\u00a0\u00a0 4096 09-30 17:47 . drwxr-xr-x 95 root\u00a0\u00a0 root\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 4096 10-08 14:01 ..</p> <p> </p> <p>b\u8fd4\u56de\u503c\uff0c\u662f\u6267\u884c\u7ed3\u679c\u3002</p> <p> </p> <p> </p> <p> </p> <p>\u56db\u3001\u65f6\u95f4\u51fd\u6570</p> <p> </p> \u51fd\u6570\u540d \u8bf4\u660e mktime( YYYY MM DD HH MM SS[ DST]) \u751f\u6210\u65f6\u95f4\u683c\u5f0f strftime([format [, timestamp]]) \u683c\u5f0f\u5316\u65f6\u95f4\u8f93\u51fa\uff0c\u5c06\u65f6\u95f4\u6233\u8f6c\u4e3a\u65f6\u95f4\u5b57\u7b26\u4e32 \u5177\u4f53\u683c\u5f0f\uff0c\u89c1\u4e0b\u8868. systime() \u5f97\u5230\u65f6\u95f4\u6233,\u8fd4\u56de\u4ece1970\u5e741\u67081\u65e5\u5f00\u59cb\u5230\u5f53\u524d\u65f6\u95f4(\u4e0d\u8ba1\u95f0\u5e74)\u7684\u6574\u79d2\u6570 <p> </p> <p>\u521b\u5efa\u6307\u5b9a\u65f6\u95f4(mktime\u4f7f\u7528\uff09</p> <p>[chengmo@centos5 ~]$ awk 'BEGIN{tstamp=mktime(\"2001 01 01 12 12 12\");print strftime(\"%c\",tstamp);}' 2001\u5e7401\u670801\u65e5 \u661f\u671f\u4e00 12\u65f612\u520612\u79d2</p> <p> </p> <p>[chengmo@centos5 ~]$ awk 'BEGIN{tstamp1=mktime(\"2001 01 01 12 12 12\");tstamp2=mktime(\"2001 02 01 0 0 0\");print tstamp2-tstamp1;}' 2634468</p> <p>\u6c422\u4e2a\u65f6\u95f4\u6bb5\u4e2d\u95f4\u65f6\u95f4\u5dee,\u4ecb\u7ecd\u4e86strftime\u4f7f\u7528\u65b9\u6cd5</p> <p> </p> <p>[chengmo@centos5 ~]$ awk 'BEGIN{tstamp1=mktime(\"2001 01 01 12 12 12\");tstamp2=systime();print tstamp2-tstamp1;}' 308201392</p> <p> </p> <p>strftime\u65e5\u671f\u548c\u65f6\u95f4\u683c\u5f0f\u8bf4\u660e\u7b26</p> \u683c\u5f0f \u63cf\u8ff0 %a \u661f\u671f\u51e0\u7684\u7f29\u5199(Sun) %A \u661f\u671f\u51e0\u7684\u5b8c\u6574\u5199\u6cd5(Sunday) %b \u6708\u540d\u7684\u7f29\u5199(Oct) %B \u6708\u540d\u7684\u5b8c\u6574\u5199\u6cd5(October) %c \u672c\u5730\u65e5\u671f\u548c\u65f6\u95f4 %d \u5341\u8fdb\u5236\u65e5\u671f %D \u65e5\u671f 08/20/99 %e \u65e5\u671f\uff0c\u5982\u679c\u53ea\u6709\u4e00\u4f4d\u4f1a\u8865\u4e0a\u4e00\u4e2a\u7a7a\u683c %H \u7528\u5341\u8fdb\u5236\u8868\u793a24\u5c0f\u65f6\u683c\u5f0f\u7684\u5c0f\u65f6 %I \u7528\u5341\u8fdb\u5236\u8868\u793a12\u5c0f\u65f6\u683c\u5f0f\u7684\u5c0f\u65f6 %j \u4ece1\u67081\u65e5\u8d77\u4e00\u5e74\u4e2d\u7684\u7b2c\u51e0\u5929 %m \u5341\u8fdb\u5236\u8868\u793a\u7684\u6708\u4efd %M \u5341\u8fdb\u5236\u8868\u793a\u7684\u5206\u949f %p 12\u5c0f\u65f6\u8868\u793a\u6cd5(AM/PM) %S \u5341\u8fdb\u5236\u8868\u793a\u7684\u79d2 %U \u5341\u8fdb\u5236\u8868\u793a\u7684\u4e00\u5e74\u4e2d\u7684\u7b2c\u51e0\u4e2a\u661f\u671f(\u661f\u671f\u5929\u4f5c\u4e3a\u4e00\u4e2a\u661f\u671f\u7684\u5f00\u59cb) %w \u5341\u8fdb\u5236\u8868\u793a\u7684\u661f\u671f\u51e0(\u661f\u671f\u5929\u662f0) %W \u5341\u8fdb\u5236\u8868\u793a\u7684\u4e00\u5e74\u4e2d\u7684\u7b2c\u51e0\u4e2a\u661f\u671f(\u661f\u671f\u4e00\u4f5c\u4e3a\u4e00\u4e2a\u661f\u671f\u7684\u5f00\u59cb) %x \u91cd\u65b0\u8bbe\u7f6e\u672c\u5730\u65e5\u671f(08/20/99) %X \u91cd\u65b0\u8bbe\u7f6e\u672c\u5730\u65f6\u95f4(12\uff1a00\uff1a00) %y \u4e24\u4f4d\u6570\u5b57\u8868\u793a\u7684\u5e74(99) %Y \u5f53\u524d\u6708\u4efd %Z \u65f6\u533a(PDT) %% \u767e\u5206\u53f7(%) <p> </p> <p>\u4ee5\u4e0a\u662fawk\u5e38\u89c1 \u5185\u7f6e\u51fd\u6570\u4f7f\u7528\u53ca\u8bf4\u660e\uff0c\u5e0c\u671b\u5bf9\u5927\u5bb6\u6709\u6240\u5e2e\u52a9\u3002</p> <p>\u6458\u81ea\u300ehttp://www.cnblogs.com/chengmo/archive/2010/10/08/1845913.html\u300f</p>","tags":["awk","linux","\u51fd\u6570"]},{"location":"Misc/2015-12-29-linux%25e4%25b8%258b%25e5%2588%25a9%25e7%2594%25a8nc%25e5%2591%25bd%25e4%25bb%25a4%25e6%259d%25a5%25e7%259b%2591%25e6%258e%25a7%25e6%25a3%2580%25e6%25b5%258b%25e6%259c%258d%25e5%258a%25a1%25e5%2599%25a8%25e7%259a%2584%25e7%25ab%25af%25e5%258f%25a3%25e4%25bd%25bf%25e7%2594%25a8%25e6%2583%2585%25e5%2586%25b5.html/","title":"Linux\u4e0b\u5229\u7528nc\u547d\u4ee4\u6765\u76d1\u63a7\u68c0\u6d4b\u670d\u52a1\u5668\u7684\u7aef\u53e3\u4f7f\u7528\u60c5\u51b5","text":"<p>\u524d\u7aef\u7528apache htttpd\u8fdb\u884c\u53d1\u5e03\uff0880\u7aef\u53e3\uff09\uff0c\u901a\u8fc7\u53cc\u673a\u8d1f\u8f7d\u5747\u8861\u8f6c\u53d1\u5230\u540e\u7aef\u7684\u4e24\u4e2atomcat\u8fdb\u884c\u5904\u7406\uff088081\u548c8082\u7aef\u53e3\uff09\uff0c\u73b0\u5728\u9700\u8981\u968f\u65f6\u76d1\u63a7\u8fd9\u4e09\u4e2a\u7aef\u53e3\u7684\u60c5\u51b5\uff0c\u4e00\u65e6down\u6389\u9700\u8981\u80fd\u591f\u7acb\u5373\u544a\u8b66\u5904\u7406\u3002\u6279\u91cf\u7684\u7cfb\u7edf\u76d1\u63a7\u6bd4\u8f83\u597d\u7684\u662f\u7528nagios\u8f6f\u4ef6\u6765\u5b9e\u73b0\uff0c\u8fd9\u6837\u5c0f\u9879\u76ee\u4e13\u95e8\u88c5\u4e00\u4e2anagios\u8f6f\u4ef6\uff0c\u6709\u70b9\u7e41\u7410\u4e86\u3002\u5728\u7f51\u4e0a\u67e5\u4e86\u4e00\u4e9b\u8d44\u6599\uff0c\u603b\u7ed3\u5b9e\u9a8c\u4e86\u4e00\u4e0b\uff0c\u53ef\u4ee5\u7528\u7b80\u5355\u7684nc\u547d\u4ee4\u6765\u5b9e\u73b0\u3002</p> <p>\u4e00\u3001nc\u547d\u4ee4\u68c0\u6d4b\u7aef\u53e3\u7684\u7528\u6cd5</p> <p>#\u00a0nc\u00a0 -v\u00a0 -w 10 %IP%\u00a0\u00a0 -z\u00a0 %PORT%</p> <p>-v\u00a0 \u663e\u793a\u6307\u4ee4\u6267\u884c\u8fc7\u7a0b\u3002 -w\u00a0 &lt;\u8d85\u65f6\u79d2\u6570&gt;\u00a0\u00a0 \u8bbe\u7f6e\u7b49\u5f85\u8fde\u7ebf\u7684\u65f6\u95f4\u3002 -u\u00a0 \u8868\u793a\u4f7f\u7528UDP\u534f\u8bae -z\u00a0 \u4f7f\u75280\u8f93\u5165/\u8f93\u51fa\u6a21\u5f0f\uff0c\u53ea\u5728\u626b\u63cf\u901a\u4fe1\u7aef\u53e3\u65f6\u4f7f\u7528\u3002</p> <p>\u4f8b1\uff1a\u626b\u63cf\u6307\u5b9a\u76848080\u7aef\u53e3 #\u00a0nc -v -w 10 -z 192.168.0.100 8080 Connection to 192.168.0.100 8080 port [tcp/http] succeeded!</p> <p>\u4f8b2\uff1a\u626b\u63cf20\u523025\u7684\u7aef\u53e3\u8303\u56f4\uff0c\u5e76\u8be6\u7ec6\u8f93\u51fa\u3002 # nc -v -w 2 -z 192.168.0.100 20-25 nc: connect to 192.168.0.100 port 20 (tcp) failed: Connection refused nc: connect to 192.168.0.100 port 21 (tcp) failed: Connection refused Connection to 192.168.0.100 22 port [tcp/ssh] succeeded! nc: connect to 192.168.0.100 port 23 (tcp) failed: Connection refused nc: connect to 192.168.0.100\u00a0\u00a0port 24 (tcp) failed: Connection refused nc: connect to 192.168.0.100 port 25 (tcp) failed: Connection refused</p> <p>\u4f8b3\uff1a\u626b\u63cf1\u523065535\u7684\u7aef\u53e3\u8303\u56f4\uff0c\u53ea\u8f93\u51fa\u6253\u5f00\u7684\u7aef\u53e3\uff08\u53bb\u6389-v\u53c2\u6570\u5373\u53ef\uff09 # nc -w 1 -z 192.168.0.100 1-65535 Connection to 192.168.0.100 22 port [tcp/ssh] succeeded! Connection to 192.168.0.100 80 port [tcp/http] succeeded! Connection to 192.168.0.100 2121 port [tcp/scientia-ssdb] succeeded! Connection to 192.168.0.100 4004 port [tcp/pxc-roid] succeeded! Connection to 192.168.0.100 8081 port [tcp/tproxy] succeeded! Connection to 192.168.0.100 11211 port [tcp/*] succeeded!</p> <p>\u4e8c\u3001\u6279\u91cf\u68c0\u6d4b\u670d\u52a1\u5668\u6307\u5b9a\u7aef\u53e3\u5f00\u653e\u60c5\u51b5\uff1a</p> <p>1\u3001\u5047\u5982\u6211\u4eec\u8981\u76d1\u63a7\u4e00\u5806\u6307\u5b9a\u7684IP\u548c\u7aef\u53e3\uff0c\u53ef\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6\uff08\u7b2c1\u5217\u670d\u52a1\u5668IP\uff0c\u7b2c2\u5217\u8981\u76d1\u63a7\u7684\u7aef\u53e3\uff09\u3002 #\u00a0vim /scripts/ip-ports.txt</p> <ol> <li>192.168.0.100\u00a080</li> <li>192.168.0.100\u00a08081</li> <li>192.168.0.101\u00a08082</li> <li>192.168.1.100\u00a021</li> </ol> <p>2\u3001\u6211\u4eec\u53ef\u4ee5\u5199\u8fd9\u6837\u4e00\u4e2a\u811a\u672c\u6765\u6279\u91cf\u68c0\u6d4b\u7aef\u53e3\u662f\u5426\u5f00\u653e\uff1a #\u00a0vim /scripts/ncports.sh</p> <ol> <li>#!/bin/bash</li> <li>#\u68c0\u6d4b\u670d\u52a1\u5668\u7aef\u53e3\u662f\u5426\u5f00\u653e\uff0c\u6210\u529f\u4f1a\u8fd4\u56de0\u503c\u663e\u793aok\uff0c\u5931\u8d25\u4f1a\u8fd4\u56de1\u503c\u663e\u793afail</li> <li></li> <li>cat\u00a0/scripts/ip-ports.txt\u00a0|\u00a0while\u00a0read\u00a0line</li> <li>do</li> <li>\u00a0\u00a0nc\u00a0-w\u00a010\u00a0-z\u00a0$line\u00a0&gt;\u00a0/dev/null\u00a02&gt;&amp;1</li> <li>\u00a0\u00a0if\u00a0[\u00a0$?\u00a0-eq\u00a00\u00a0]</li> <li>\u00a0\u00a0then</li> <li>\u00a0\u00a0\u00a0\u00a0echo\u00a0$line:ok</li> <li>\u00a0\u00a0else</li> <li>\u00a0\u00a0\u00a0\u00a0echo\u00a0$line:fail</li> <li>\u00a0\u00a0fi</li> <li>done</li> </ol> <p>3\u3001\u6267\u884c\u811a\u672c\u67e5\u770b\u8fd0\u884c\u7ed3\u679c\u5982\u4e0b\uff1a # chmod a+x\u00a0 /scripts/ncports.sh #\u00a0/scripts/ncports.sh 192.168.0.100 80\uff1aok 192.168.0.100 8081\uff1aok 192.168.0.101 8082\uff1aok 192.168.1.100 21\uff1afail</p> <p> </p> <p>\u4e09\u3001\u7aef\u53e3\u4e0d\u901a\u65f6\u8bbe\u7f6e\u544a\u8b66\uff1a</p> <p>1\u3001 \u90ae\u4ef6\u544a\u8b66\uff1a</p> <p>(1) \u5148\u5b89\u88c5linux\u4e0b\u9762\u7684\u90ae\u4ef6\u53d1\u9001\u7a0b\u5e8fmutt\uff08\u53c2\u89c1\u6211\u53e6\u4e00\u7bc7\u6587\u7ae0\u300aLinux\u4e0b\u9762\u5982\u4f55\u7528mutt\u547d\u4ee4\u53d1\u9001\u90ae\u4ef6\u300b</p> <p>(2) \u4fee\u6539\u4e0a\u9762\u7684ncports.sh\u68c0\u6d4b\u811a\u672c\uff0c\u5728\u663e\u793a\u5931\u8d25fail\u7684\u65f6\u5019\u589e\u52a0\u4e00\u884c\uff1a \u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026 echo $line :fail echo \u201c\u670d\u52a1\u5668 $line \u7aef\u53e3\u4e0d\u901a\uff0c\u8bf7\u5c3d\u5feb\u5904\u7406\uff01\u201d | mutt -s \u201c\u3010\u673a\u623f\u76d1\u63a7\u3011\u670d\u52a1\u5668$line\u7aef\u53e3\u4e0d\u901a\u201d\u00a0test@139.com \u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026</p> <p>(3) \u5982\u679c\u4e0a\u9762\u7684\u63a5\u6536\u90ae\u7bb1\u8bbe\u7f6e\u4e3a\u79fb\u52a8139\u90ae\u7bb1\uff0c\u5e76\u5f00\u542f\u63a5\u6536\u90ae\u4ef6\u77ed\u4fe1\u544a\u77e5\uff0c\u5373\u53ef\u5b9e\u73b0\u201c\u77ed\u4fe1\u544a\u8b66\u201d\u7684\u529f\u80fd\u3002</p> <p>2\u3001 windows\u6d88\u606f\u5f39\u7a97\u544a\u8b66\uff1a</p> <p>(1) \u5148\u6253\u5f00\u63a5\u6536\u6d88\u606f\u5f39\u7a97windows\u5ba2\u6237\u673a\u7684\u201cMessenger\u201d\u670d\u52a1\uff0c\u8bbe\u7f6e\u4e3a\u201c\u542f\u52a8\u201d</p> <p>(2) \u5229\u7528smbclient\u547d\u4ee4\u6765\u53d1\u9001\u6d88\u606f\uff0cnet\u811a\u672c\u6587\u4ef6\u5982\u4e0b\uff1a # vim /scripts/net.sh</p> <ol> <li>#!/bin/bash</li> <li>#/scripts/net.sh</li> <li>case\u00a0\u201d$1\u2033\u00a0in</li> <li>send)</li> <li>echo\u00a0\u201d$3\u2033|smbclient\u00a0-I\u00a0\u201d$2\u2033\u00a0-M\u00a0`nmblookup\u00a0-A\u00a0\u201d$2\u2033|sed\u00a0-e\u00a0\u20191d\u2019\u00a0-e\u00a0\u20193,/*/d\u2019|cut\u00a0-f2|cut\u00a0-d\u2019\u00a0\u2019\u00a0-f1`</li> <li>;;</li> <li>*)</li> <li>echo\u00a0\u201dUsage:net\u00a0send\u00a0 \u201d <li>exit\u00a01</li> <li>esac</li> <p># chmod a+x /scripts/net.sh (3) \u53d1\u9001\u6d88\u606f\u5f39\u7a97\u547d\u4ee4\u6d4b\u8bd5\uff1a\uff08\u53d1\u9001\u7ed9192.168.1.83\u8fd9\u53f0win xp\u673a\u5b50\uff0c\u53d1\u9001\u5185\u5bb9\u4e0d\u652f\u6301\u4e2d\u6587\uff09 # /scripts/net.sh\u00a0 send\u00a0 192.168.1.83\u00a0\u00a0\u00a0\u00a0 \u201chello,nihao\u201d</p> <p> </p> <p>3\u3001\u7aef\u53e3\u4e0d\u901a\u65f6\u53d1\u9001\u90ae\u4ef6\u5e76\u6d88\u606f\u5f39\u7a97\u544a\u8b66\u7684\u811a\u672c\u5982\u4e0b\uff1a # vim /scripts/ncports.sh</p> <ol> <li>#!/bin/bash</li> <li>#\u68c0\u6d4b\u670d\u52a1\u5668\u7aef\u53e3\u662f\u5426\u5f00\u653e\uff0c\u6210\u529f\u4f1a\u8fd4\u56de0\u503c\uff0c\u6253\u4e0d\u5f00\u4f1a\u8fd4\u56de1\u503c</li> <li>cat\u00a0/scripts/ip-ports.txt\u00a0|\u00a0while\u00a0read\u00a0line</li> <li>do</li> <li>\u00a0\u00a0nc\u00a0-w\u00a010\u00a0-z\u00a0$line\u00a0&gt;\u00a0/dev/null\u00a02&gt;&amp;1</li> <li>\u00a0\u00a0if\u00a0[\u00a0$?\u00a0-eq\u00a00\u00a0]</li> <li>\u00a0\u00a0then</li> <li>\u00a0\u00a0\u00a0\u00a0echo\u00a0$line:ok</li> <li>\u00a0\u00a0else</li> <li>\u00a0\u00a0\u00a0\u00a0echo\u00a0$line:fail</li> <li>\u00a0\u00a0\u00a0\u00a0echo\u00a0\u201d\u670d\u52a1\u5668\u00a0$line\u00a0\u7aef\u53e3\u4e0d\u901a\uff0c\u8bf7\u5c3d\u5feb\u5904\u7406\uff01\u201d\u00a0|\u00a0mutt\u00a0-s\u00a0\u201d\u3010\u673a\u623f\u76d1\u63a7\u3011\u670d\u52a1\u5668$line\u7aef\u53e3\u4e0d\u901a\u201d\u00a0\u00a0test@139.com</li> <li>\u00a0\u00a0\u00a0\u00a0/scripts/net\u00a0send\u00a0192.168.1.83\u00a0\u201dThe\u00a0$line\u00a0fail\u201d fi</li> <li>done</li> </ol> <p>4\u3001\u52a0\u5165\u4efb\u52a1\u8ba1\u5212\u6bcf2\u5206\u949f\u6267\u884c\u4e00\u6b21</p> <p># crontab -e</p> <ol> <li>*/2\u00a0*\u00a0*\u00a0*\u00a0*\u00a0\u00a0/scripts/ncports.sh\u00a0\u00a0&gt;\u00a0/dev/null\u00a02&gt;&amp;1</li> </ol> <p># service crond restart</p> <p>\u6458\u81ea\u300ehttp://blog.csdn.net/kobejayandy/article/details/13790289\u300f</p>","tags":["linux","nc","\u7aef\u53e3"]},{"location":"Misc/2016-01-09-ubuntu-14-04-lts-%25e7%25b3%25bb%25e7%25bb%259f%25e8%25ae%25be%25e7%25bd%25ae%25e6%25ae%258b%25e7%25bc%25ba%25e7%259a%2584%25e9%2597%25ae%25e9%25a2%2598.html/","title":"Ubuntu 14.04 LTS \u7cfb\u7edf\u8bbe\u7f6e\u6b8b\u7f3a\u7684\u95ee\u9898","text":"<p>\u6211\u4e0d\u5c31\u628aiBus\u7ed9\u5378\u8f7d\u4e86\u5417\uff1f\u4f60\u4f5c\u4e3a\u6297\u8bae\u8fde\u7cfb\u7edf\u8bbe\u7f6e\u90fd\u4e0d\u7ed9\u6211\u7528\u4e86\uff0c\u8fd9\u5c31\u6709\u70b9\u8fc7\u4e86\u5427\uff01</p> <p>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0\u4e00\uff0c\u73b0\u72b6\u3002</p> <p>\u5148\u8ba9\u5927\u5bb6\u770b\u4e00\u4e0b\u75c7\u72b6\uff0c\u540c\u65f6\u53ef\u4ee5\u5bf9\u6bd4\uff0c\u4ee5\u514d\u4ee5\u540e\u4f60\u7684Ubuntu\u53d8\u6210\u4e86\u8fd9\u6837\u4f60\u8fd8\u5230\u5904\u4e71\u6c42\u533b\u95ee\u836f\u7684\u3002</p> <ul> <li> <p>\u4e8c\uff0c\u6765\u7531\u3002</p> <p>\u90a3\u5929\u6211\u770b\u5230\u5947\u4e11\u65e0\u6bd4\u7684iBus\u5c31\u679c\u65ad\u5730\u627eFcitx\u6765\u4ee3\u66ff\u5b83\u4e86\uff0c\u8c01\u6599\u8fd9\u8d27\u8d70\u4e4b\u524d\u5c3d\u7ed9\u6211\u4f7f\u4e9b\u574f\uff0c\u628a\u7cfb\u7edf\u8bbe\u7f6e\u7ed9\u5f04\u6b8b\u4e86\u3002</p> <p>\u4f60\u4e0d\u4fe1\uff1f\u4f60\u53ef\u4ee5\u7ed9\u5b83\u4e0b\u8fd9\u6761\u547d\u4ee4\u8bd5\u8bd5</p> <p>sudo apt-get remove ibus</p> <p>\u4e09\uff0c\u5bfb\u6839\u3002</p> <p>\u6211\u5dee\u4e0d\u591a\u534a\u5929\u4e0d\u5f97\u5176\u89e3\u4e3a\u4ec0\u4e48\uff0c\u5947\u4e11\u65e0\u6bd4\u7684iBus\u8ddfUbuntu 14.04\u5173\u7cfb\u8fd9\u4e48\u7d27\u5bc6\uff0c\u6211\u8fd8\u52a8\u4f60\u4e0d\u5f97\u4e86\u3002\u771f\u60f3\u8ba9Ubuntu 14.04\u518d\u53bb\u6295\u80ce\u4e00\u6b21(\u91cd\u88c5\u7cfb\u7edf\u561b)\uff01\u4f46\u4f5c\u4e3a\u4e00\u4e2a\u4e13\u4e1a\u7684Ubuntu\u5bb6\u65cf\u533b\u751f\uff0c\u6211\u662f\u6709\u8d23\u4efb\u548c\u4e49\u52a1\u77e5\u9053\u5979\u7684\u53d1\u75c5\u539f\u7531\u7684\u597d\u5427\uff01\u7ec8\u4e8e\u5728Ubuntu 14.04\u7684\u4ea4\u5f80\u8bb0\u5f55\u4e2d\u6211\u53d1\u73b0\u4e86\u4e00\u4e2a\u79d8\u5bc6\uff0cUbuntu 14.04\u8ddfiBus\u4e4b\u95f4\u7684\u90a3\u70b9\u5173\u7cfb\u662f\u4e07\u4e07\u4e0d\u80fd\u65ad\u7684\u3002\u5982\u4e0b\u56fe\uff0c\u660e\u4e86\u4e86\u5427\uff1a</p> <p>\u4e09\uff0c\u5f97\u89e3\u3002</p> <p>\u660e\u663e\u6211\u77e5\u9053\u662fUbuntu 14.04\u548ciBus\u4e4b\u95f4\u7684\u5173\u7cfb\u5f15\u8d77\u7684\uff0c\u4f46\u6211\u5c1d\u8bd5\u628aiBus\u8bf7\u56de\u6765\u4e4b\u540e\u95ee\u9898\u4f9d\u65e7\u3002\u6700\u540e\u6211\u53ea\u80fd\u8ddf\u636e\u8bb0\u5f55\u4e00\u4e2a\u4e2a\u6765\u6062\u590d\u4e86\uff0c\u53d1\u73b0\u6b63\u89e3\u5982\u4e0b\uff1a</p> <p>sudo apt-get install ubuntu-desktop</p> <p>\u8fd9\u4e2a\u4f1a\u628aamazon\u5e7f\u544a\u4e5f\u7ed9\u91cd\u65b0\u5b89\u88c5\u4e0a\uff0c\u6240\u4ee5\u4f60\u53ef\u4ee5\u5148\u5b89\u88c5\u518d\u5378\u8f7d\uff0c\u6216\u8005\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u4e00\u6b21\u6027\u89e3\u51b3\uff1a</p> <p>sudo apt-get install ibus-pinyin unity-control-center unity-control-center-signon webaccounts-extension-common xul-ext-webaccounts</p> <p> <p>\u6458\u81ea [\u00a0http://jingyan.baidu.com/article/375c8e19985a2125f2a229cb.html ]</p>","tags":["ubuntu"]},{"location":"Misc/2016-02-26-ubuntu-%25e4%25bd%25bf%25e7%2594%25a8-playonlinux-%25e5%25ae%2589%25e8%25a3%2585-tm2013.html/","title":"Ubuntu \u4f7f\u7528 PlayOnLinux \u5b89\u88c5 TM2013","text":"<p>\u4e00\u3001\u5b89\u88c5wine 1. \u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u6dfb\u52a0 Wine PPA sudo add-apt-repository ppa:ubuntu-wine/ppa</p> <p>2. \u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u66f4\u65b0\u548c\u5b89\u88c5wine sudo apt-get update; sudo apt-get install wine</p> <p>\u4e8c\u3001\u5b89\u88c5PlayOnLinux wget -q \"http://deb.playonlinux.com/public.gpg\" -O- | sudo apt-key add -</p> <p>sudo wget http://deb.playonlinux.com/playonlinux_trusty.list -O /etc/apt/sources.list.d/playonlinux.list</p> <p>sudo apt-get update</p> <p>sudo apt-get install playonlinux</p> <p>\u4e09\u3001\u5b89\u88c5TM2013 playonlinux\u5b89\u88c5\u7a0b\u5e8f\uff0c\u4e00\u822c\u7ecf\u8fc77\u4e2a\u6b65\u9aa4\uff1a 1. \u70b9\u51fbinstall 2. \u70b9\u51fbinstall a non-listed program 3. \u70b9\u51fbinstall a program in a new virtual drive\uff08\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5bb9\u5668\u5b89\u88c5\u7a0b\u5e8f\uff09 4. \u8f93\u5165\u65b0\u5bb9\u5668\u7684\u540d\u79f0 5. \u5728\u4e09\u4e2a\u9879\u76ee\u4e0a\u6253\u52fe\u52fe\uff0c</p> <p>\u7b2c\u4e00\u9879\u662f\u9009\u62e9wine\u7684\u7248\u672c \u7b2c\u4e8c\u9879\u662f\u914d\u7f6ewine \u7b2c\u4e09\u9879\u662f\u5b89\u88c5\u4e00\u4e9bdll\u7684\u8f6f\u4ef6\u5305</p> <p>6. \u9009\u62e9\u6240\u9700\u8981\u7684exe\u6587\u4ef6\u5b89\u88c5 7. \u7ed9\u7a0b\u5e8f\u8bbe\u5b9a\u542f\u52a8\u56fe\u6807</p> <p>////////////////////////</p> <p>\u4ee5\u4e0b\u662f\u4e00\u4e9b\u5e38\u7528\u7a0b\u5e8f\u9700\u8981\u7684dll\u3002</p> <p>TM2013 ======</p> <p>riched20 msxml6 ie8 vcrun2008</p> <p>\u4f7f\u7528\u6ca1\u95ee\u9898\u3002 \u5173\u95ed\u7a0b\u5e8f\uff0c\u8fdb\u7a0b\u8fd8\u5728\u3002 \u9664\u975e\u4f7f\u7528playonlinux\u7684close this application\u53ef\u4ee5\u5173\u95ed\u8fdb\u7a0b\uff0c \u4e0d\u7136\u4e0d\u80fd\u8fde\u7eed\u767b\u5f55\u3002</p> <p>QQ\u6e38\u620f\u5927\u5385 =========</p> <p>fontsmooth-gray fontsmooth-rgb fontsmooth-bgr mfc40 mfc42 msxml3 msxml4 msxml6 riched30 vbrun6 vcrun6 vcrun2005 vcrun2008 ie6 </p> <p>\u4f7f\u7528\u6ca1\u95ee\u9898\u3002</p> <p>\u53c2\u8003 1. http://www.linuxidc.com/Linux/2014-08/105091.htm 2. https://www.playonlinux.com/en/download.html 3. http://forum.ubuntu.com.cn/viewtopic.php?f=121&amp;t=452861</p>","tags":[]},{"location":"Misc/2016-03-02-virtualbox-%25e8%2599%259a%25e6%258b%259f%25e6%259c%25ba%25e5%2585%258b%25e9%259a%2586.html/","title":"virtualbox \u865a\u62df\u673a\u514b\u9686","text":"<p>Virtualbox\u867d\u7136\u5728\u56fe\u5f62\u754c\u9762\u4e0b\u6ca1\u6709\u4e3b\u673a\u514b\u9686\u7684\u529f\u80fd\uff0c\u4f46\u662f\u5728\u547d\u4ee4\u884c\u4e0b\u8fd8\u662f\u63d0\u4f9b\u8fd9\u4e2a\u529f\u80fd\u7684\uff0c\u5728virtualbox\u7684\u5b89\u88c5\u76ee\u5f55\u4e0b\u6267\u884c\"VBoxManage clonevdi\"\u547d\u4ee4\u3002</p> <p>Virtualbox\u514b\u9686\u547d\u4ee4\u683c\u5f0f </p> <p>VBoxManage clonevdi \u539f\u59cbVDI\u6587\u4ef6\u540d \u65b0\u7684VDI\u6587\u4ef6\u540d</p> <p>\u793a\u4f8b\uff1a $ VBoxManage clonevdi centos.vdi  centos3p.vdi 0%...10%...20%...30%...40%...50%...60%...70%...80%...90%...100% Clone medium created in format 'VDI'. UUID: a108550f-c62a-4550-9a92-768036e2ea8b</p> <p>\u6267\u884c\u5b8cVBoxManage clonevdi \u547d\u4ee4\u540e\u4f1a\u5728Virtualbox\u7684\u9ed8\u8ba4\u865a\u62df\u78c1\u76d8\u76ee\u5f55\u4e0b\u751f\u6210\u4e00\u4e2a\u65b0\u7684vdi\u6587\u4ef6\uff0c\u65b0\u5efa\u4e00\u4e2a\u865a\u62df\u673a\u4f7f\u7528\u8be5\u865a\u62df\u78c1\u76d8\u5c31\u53ef\u4ee5\u5b9e\u73b0\u865a\u62df\u673a\u7684\u514b\u9686\u3002</p> <p>\u6458\u81ea\u300chttp://www.liusuping.com/xunihua/virtualbox-guestos-clone.html\u300d</p> <p>\u9644\uff1a</p> <p>\u5728\u514b\u9686\u51fa\u6765\u7684CentOS Linux\u3002 ifconfig...\u6ca1\u6709\u770b\u5230eth0.\u3002\u7136\u540e\u91cd\u542f\u7f51\u5361\u53c8\u62a5\u4e0b\u9762\u9519\u8bef\u3002</p> <p>\u6545\u969c\u73b0\u8c61\uff1a Device eth0 does not seem to be present,delaying initialization.                    [FAILED]</p> <p>\u89e3\u51b3\u529e\u6cd5\uff1a</p> <p>\u9996\u5148\uff0c\u6253\u5f00/etc/udev/rules.d/70-persistent-net.rules\u5185\u5bb9\u5982\u4e0b\u9762\u4f8b\u5b50\u6240\u793a\uff1a</p> <p># vi /etc/udev/rules.d/70-persistent-net.rules # This file was automatically generated by the /lib/udev/write_net_rules # program, run by the persistent-net-generator.rules rules file. # # You can modify it, as long as you keep each rule on a single # line, and change only the value of the NAME= key. # PCI device 0x1022:0x2000 (pcnet32) SUBSYSTEM==\"net\", ACTION==\"add\", DRIVERS==\"?*\", ATTR{address}==\"00:0c:29:8f:89:9 7\", ATTR{type}==\"1\", KERNEL==\"eth*\", NAME=\"eth0\" # PCI device 0x1022:0x2000 (pcnet32) SUBSYSTEM==\"net\", ACTION==\"add\", DRIVERS==\"?*\", ATTR{address}==\"00:0c:29:50:bd:1 7\", ATTR{type}==\"1\", KERNEL==\"eth*\", NAME=\"eth1\"</p> <p>\u8bb0\u5f55\u4e0b\uff0ceth1\u7f51\u5361\u7684mac\u5730\u574000:0c:29:50:bd:17</p> <p>\u63a5\u4e0b\u6765\uff0c # vi /etc/sysconfig/network-scripts/ifcfg-eth0</p> <p>\u5c06 DEVICE=\"eth0\"  \u6539\u6210  DEVICE=\"eth1\"  , \u5c06 HWADDR=\"00:0c:29:8f:89:97\" \u6539\u6210\u4e0a\u9762\u7684mac\u5730\u5740  HWADDR=\"00:0c:29:50:bd:17\"</p> <p>\u6700\u540e\uff0c\u91cd\u542f\u7f51\u7edc</p> <p># service network restart \u6216\u8005 # /etc/init.d/network restart</p> <p>\u6b63\u5e38\u4e86\u3002</p> <p>\u6458\u81ea\u300chttp://www.linuxidc.com/Linux/2012-12/76248.htm\u300d</p>","tags":["\u865a\u62df\u673a"]},{"location":"Misc/2016-06-19-centos-6-x-%25e5%25ae%2589%25e8%25a3%2585nvidia%25e6%2598%25be%25e5%258d%25a1%25e9%25a9%25b1%25e5%258a%25a8%25e5%258f%258a%25e5%25b1%258f%25e5%25b9%2595%25e4%25ba%25ae%25e5%25ba%25a6%25e9%2597%25ae%25e9%25a2%2598.html/","title":"CentOS 6.x \u5b89\u88c5nvidia\u663e\u5361\u9a71\u52a8\u53ca\u5c4f\u5e55\u4eae\u5ea6\u95ee\u9898","text":"<p>\u4e00\u3001\u51c6\u5907 1 \u6839\u636envidia\u663e\u5361\u7684\u5177\u4f53\u578b\u53f7\uff0c\u4ece\u5b98\u65b9\u7f51\u7ad9\u4e0b\u8f7d\u9a71\u52a8\uff0c\u6bd4\u5982 NVIDIA-Linux-x86_64-340.96.run \u300c\u624b\u52a8\u641c\u7d22\u9a71\u52a8\u7a0b\u5e8f\u300d http://www.geforce.cn/drivers#start-search</p> <p>2 \u5b89\u88c5\u7f16\u8bd1\u73af\u5883\uff1agcc\u3001kernel\u3001kernel-devel\u3001kernel-headers [root@localhost ~]# yum -y install gcc kernel kernel-devel kernel-headers</p> <p>3 \u4fee\u6539/etc/modprobe.d/blacklist.conf \u6587\u4ef6\uff0c\u4ee5\u963b\u6b62 nouveau \u6a21\u5757\u7684\u52a0\u8f7d \u65b9\u6cd5\uff1a \u6dfb\u52a0blacklist nouveau\uff0c\u6ce8\u91ca\u6389blacklist nvidiafb</p> <p>4 \u91cd\u65b0\u5efa\u7acbinitramfs image\u6587\u4ef6</p> <p>[root@localhost ~]# mv /boot/initramfs-$(uname -r).img /boot/initramfs-$(uname -r).img.bak [root@localhost ~]# dracut /boot/initramfs-$(uname -r).img $(uname -r)</p> <p>5 \u4fee\u6539/etc/inittab\uff0c\u4f7f\u7cfb\u7edf\u5f00\u673a\u8fdb\u5165init 3\u6587\u672c\u6a21\u5f0f: \u5c06\u6700\u540e\u4e00\u884c\u201cid:5:initdefault:\u201d\u4fee\u6539\u6210\u201cid:3:initdefault:\u201d\uff08\u4e0d\u5305\u542b\u5f15\u53f7\uff09 \u6ce8\u91ca\uff1a5\u4ee3\u8868\u7cfb\u7edf\u542f\u52a8\u65f6\u9ed8\u8ba4\u8fdb\u5165x-window\u56fe\u5f62\u754c\u9762\uff0c3\u4ee3\u8868\u9ed8\u8ba4\u8fdb\u5165\u7ec8\u7aef\u6a21\u5f0f\u3002</p> <p>6 \u91cd\u542f [root@localhost ~]# reboot</p> <p>\u4e8c\u3001\u5b89\u88c5NVIDIA\u9a71\u52a8</p> <p>1 \u8f93\u5165root\u548cpassword\uff0c\u8fdb\u5165\u6839\u7528\u6237\u6a21\u5f0f\u4e0b,\u786e\u4fddnouveau kernel driver\u6ca1\u6709\u88ab\u52a0\u8f7d [root@localhost ~]# lsmod | grep nouveau</p> <p>2 \u8fdb\u5165\u9a71\u52a8\u7a0b\u5e8f\u6240\u5728\u76ee\u5f55,\u5f00\u59cb\u5b89\u88c5 [root@localhost ~]# chmod +x NVIDIA-Linux-x86_64-340.96.run [root@localhost ~]# ./NVIDIA-Linux-x86_64-340.96.run \u5b89\u88c5\u8fc7\u7a0b\u4e2d\uff0c\u6839\u636e\u63d0\u793a\u9009\u62e9accept\uff0cyes \u6216 OK\uff0c\u5373\u53ef\u5b8c\u6210\u5b89\u88c5\u3002</p> <p>3 \u4fee\u6539/etc/inittab\uff0c\u4f7f\u7cfb\u7edf\u5f00\u673a\u8fdb\u5165init 5\u56fe\u5f62\u754c\u9762\u6a21\u5f0f \u5c06\u6700\u540e\u4e00\u884c\u201cid:3:initdefault:\u201d\u4fee\u6539\u6210\u201cid:5:initdefault:\u201d</p> <p>4 \u91cd\u542f [root@localhost ~]#reboot \u5f53\u770b\u5230Nvidia\u7684logo\u540e\uff0c\u5b89\u88c5\u6210\u529f,\u767b\u9646\u540e\u5728\u7cfb\u7edf- \u9996\u9009\u9879\u91cc\u53ef\u4ee5\u770b\u5230NVIDIA X Server Settings\u83dc\u5355\uff0c\u53ef\u4ee5\u67e5\u770b\u57fa\u672c\u4fe1\u606f\u53ca\u8fdb\u884c\u4e00\u4e9b\u8bbe\u7f6e</p> <p>\u4e09\u3001\u00a0\u5c4f\u5e55\u4eae\u5ea6\u4e0d\u53ef\u8c03\u7684\u89e3\u51b3\u65b9\u6cd5 \u89e3\u51b3\u529e\u6cd5\uff1a\u4fee\u6539/etc/X11/xorg.con\u6587\u4ef6\uff0c\u627eSection \"Device\"\uff0c\u7136\u540e\u5728\u76f8\u5e94\u7684EndSection\u4e4b\u524d\u6dfb\u52a0\u4e00\u884c Option \"RegistryDwords\" \"EnableBrightnessControl=1\" \u4fdd\u5b58\u5e76\u91cd\u542f\u7535\u8111\u3002</p> <p>\u53c2\u8003 http://jingyan.baidu.com/article/9f63fb91d7e6b5c8400f0e0c.html http://my.oschina.net/hevakelcj/blog/176129</p>","tags":["centos","nvidia","\u663e\u5361","\u9a71\u52a8"]},{"location":"Misc/2016-11-08-%25e6%259f%25a5%25e7%259c%258b%25e6%2596%2587%25e4%25bb%25b6%25e7%259a%2584-md5-sha1-sha256.html/","title":"\u67e5\u770b\u6587\u4ef6\u7684 md5 sha1 sha256","text":"<p>\u67e5\u770b\u6587\u4ef6MD5\uff1a</p> <p>md5  <p>\u67e5\u770b\u6587\u4ef6SHA1:</p> <p>openssl dgst -sha1  <p>\u67e5\u770b\u6587\u4ef6SHA256\uff1a</p> <p>openssl dgst -sha256","tags":[]},{"location":"Misc/2016-11-24-mac-%25e4%25bd%25bf%25e7%2594%25a8-nfs-%25e8%25bf%259e%25e6%258e%25a5-centos-%25e4%25b8%258a%25e7%259a%2584%25e5%2585%25b1%25e4%25ba%25ab%25e6%2596%2587%25e4%25bb%25b6%25e5%25a4%25b9.html/","title":"Mac \u4f7f\u7528 NFS \u8fde\u63a5 Centos \u4e0a\u7684\u5171\u4eab\u6587\u4ef6\u5939","text":"Centos\u7aef\u914d\u7f6e <pre><code>rpm -qa|grep nfs\n</code>\u68c0\u6d4b\u662f\u5426\u5df2\u5b89\u88c5NFS</pre> <pre><code>[root@localhost ~]# rpm -qa|grep nfs\nnfs-utils-lib-1.0.8-7.2.z2\nnfs-utils-1.0.9-40.el5\nsystem-config-nfs-1.3.23-1.el5\n\n</code></pre> <p>\u5219\u5df2\u5b89\u88c5\u4e86nfs\u8f6f\u4ef6\u5305\u3002\u82e5\u672a\u5b89\u88c5\u5219\u9700\u624b\u52a8\u5b89\u88c5\u540e\u7ee7\u7eed</p> <p>\u63a5\u7740\u914d\u7f6e <code>/etc/exports</code> \u6587\u4ef6\uff1a</p> <pre><code>/var/www 192.168.100.222(rw,sync,no_root_squash,insecure)\n</code></pre> <pre><code>[\u8981\u5171\u4eab\u7684\u76ee\u5f55] [\u5171\u4eab\u7ed9\u5ba2\u6237\u7aefIP(\u9009\u9879)] [\u5ba2\u6237\u7aef2 ...\n</code></pre> <p>\u914d\u7f6e\u6587\u4ef6\u7684\u8be6\u7ec6\u4f7f\u7528\u8bf4\u660e\u8bf7\u53c2\u89c1\uff1a \u8fd9\u91cc</p> <p>\u5982\u679c\u8fde\u63a5\u65f6 Centos \u7aef\u63d0\u793a</p> <p><code>nfsd: request from insecure port (192.168.7.130:49232)!</code></p> <p>\u5219\u5c06'\u9009\u9879'\u914d\u7f6e\u6210 <code>(rw,async,insecure)</code> \u5373\u53ef</p> <p>\u542f\u52a8(\u6216\u91cd\u542f)NFS\u670d\u52a1\u5668\uff08\u5148 portmap \uff0c\u540e nfs \u4e24\u4e2a\u670d\u52a1\u3002\u505c\u6b62\u65f6\u5019\u505c nfs \u5c31\u597d\uff0cportmap \u53ef\u80fd\u4f1a\u88ab\u5176\u4ed6\u670d\u52a1\u6240\u9700\u8981\uff09</p> <pre><code>service nfs start(restart)\n</code></pre> <p>\u8bbe\u7f6e\u4e24\u4e2a\u670d\u52a1\u5f00\u673a\u81ea\u52a8\u542f\u52a8\u3002</p> <pre><code>chkconfig --level 35 nfs on\n</code></pre> <p>\u6839\u636e\u5b9e\u9645\u9700\u8981\u66f4\u6539\u4e0b\u8981\u5171\u4eab\u7684\u6587\u4ef6\u5939\u7684\u6743\u9650</p> <pre><code>chmod -R 777 /var/www\n</code></pre> Mac\u7aef\u914d\u7f6e <pre><code>showmount -e IP\\Domain\n</code></pre> <p>\u6765\u67e5\u770b Centos \u4e3b\u673a\u7684\u5171\u4eab\u72b6\u6001</p> <pre><code>$ sudo mount -o rw -t nfs 192.168.100.222:/var/www /private/nfs</code></pre> <p>\u6ce8:\u5982\u679c\u9700\u8981\u5199\u6743\u9650\uff0c\u5728sever\u7684\u76f8\u5e94\u76ee\u5f55\u4e0a\u6267\u884c chmod o+w</p> <p>\u6458\u81ea\u300ehttp://www.tuicool.com/articles/Av6Nn2\u300f</p>","tags":["nfs"]},{"location":"Misc/2016-12-13-mac-%25e9%2587%258d%25e5%2590%25af-finder.html/","title":"mac \u91cd\u542f finder","text":"<p>\u91cd\u542fFinder: \u65b9\u6cd5\u662f\u6309\u4f4fOption\u952e\uff0c\u300e\u5355\u51fbDock\u4e0a\u7684Finder\u56fe\u6807\u4e0d\u653e\uff0c\u5927\u69822\u79d2\u540e\u300f(\u6216\u53cc\u6307\u70b9\u89e6/\u9f20\u6807\u53f3\u952e)\u5c06\u5728Finder\u56fe\u6807\u4e0a\u51fa\u73b0\u4e00\u4e2a\u83dc\u5355\uff0c\u5355\u51fb\u300e\u91cd\u65b0\u542f\u52a8\u300f</p> <p>see more: http://blog.csdn.net/aaa1117a8w5s6d/article/details/8589259</p>","tags":[]},{"location":"Misc/2016-12-17-linux-%25e6%258c%2582%25e8%25bd%25bd-ntfs.html/","title":"linux \u6302\u8f7d ntfs","text":"<p># yum install ntfs-3g # mount -t ntfs-3g /dev/sdb2  /mnt/_odata_dev/</p>","tags":[]},{"location":"Misc/2017-01-01-ubuntu-linuxmint%25e4%25b8%258b%25e8%2587%25aa%25e5%258a%25a8%25e5%25ae%2589%25e8%25a3%2585%25e9%259b%2585%25e9%25bb%2591%25e5%25ad%2597%25e4%25bd%2593%25e8%2584%259a%25e6%259c%25ac-%25e8%25bd%25ac.html/","title":"ubuntu linuxmint\u4e0b\u81ea\u52a8\u5b89\u88c5\u96c5\u9ed1\u5b57\u4f53\u811a\u672c -- \u8f6c","text":"<p>\u5b89\u88c5ubuntu\u7684\u65f6\u5019\uff0c\u603b\u662f\u9700\u8981\u7f8e\u5316\u4e2d\u6587\u5b57\u4f53\u3002 \u5fae\u8f6f\u96c5\u9ed1\u662f\u6bd4\u8f83\u597d\u7684\u4e2d\u6587\u5b57\u4f53\u7f8e\u5316\u65b9\u6848\u3002 \u4e0b\u9762\u7684\u8fd9\u4e2a\u811a\u672c\u53ef\u4ee5\u5e2e\u52a9\u5927\u5bb6\u81ea\u52a8\u6765\u7f8e\u5316\u4e2d\u6587\u5b57\u4f53\u3002</p> <pre>wget -O get-fonts.sh.zip http://files.cnblogs.com/DengYangjun/get-fonts.sh.zip\nunzip -o get-fonts.sh.zip 1&gt;/dev/null\nchmod a+x get-fonts.sh\n./get-fonts.sh</pre> <p>\u5220\u9664\u4e0b\u8f7d\u7684\u5b57\u4f53\u5b89\u88c5\u811a\u672c\u6587\u4ef6\uff1a</p> <pre>rm get-fonts.sh get-fonts.sh.zip 2&gt;/dev/null</pre> <p>\u6062\u590d\u4ee5\u524d\u7684\u5b57\u4f53\u8bbe\u7f6e\uff1a</p> <pre>cd /etc/fonts/conf.avail\nsudo mv 51-local.conf.old 51-local.conf 2&gt;/dev/null\nsudo mv 69-language-selector-zh-cn.conf.old 69-language-selector-zh-cn.conf 2&gt;/dev/null\nsudo rm -f -r /usr/share/fonts/truetype/myfonts 2&gt;/dev/null\ncd -</pre> <p>\u4fee\u6b63\u8bb0\u5f55\uff1a 1.\u6dfb\u52a0\u4e86\u6700\u65b0\u7684Windows 7\u7684\u5fae\u8f6f\u96c5\u9ed1\u5b57\u4f53\u3002\uff08\u9644\u4ef6\u5927\u5c0f\u9650\u5236\uff0c\u672a\u5b9e\u73b0\uff09 2.\u4fee\u6b63\u4e86CRT\u6e32\u67d3\u7684\u914d\u7f6e\u6587\u4ef6\u7684\u94fe\u63a5\u9519\u8bef\u3002 3.\u6dfb\u52a0\u5b57\u4f53\uff1aAgency FB 4.\u6dfb\u52a0\u5b57\u4f53\u8bbe\u7f6e\u6062\u590d\u529f\u80fd\u3002</p> <p>via http://blog.prosight.me/blogs/722/</p> <p>\u8f6c\u81ea\uff1a http://blog.sae.sina.com.cn/archives/1280</p> <p>\u9644\uff1aget-fonts.sh </p> <pre>\n#!/bin/bash\n\n#dir define\nmyfonts_dir=/usr/share/fonts/truetype/myfonts\nremote_dir=http://files.cnblogs.com/DengYangjun\n\n#fonts define\nmonaco=monaco-linux.ttf\nlucida=lucida-console.ttf\nmsyh=msyh.ttf\nmsyhbd=msyhbd.ttf\nagencyr=agencyr.ttf\nagencyrb=agencyrb.ttf\n\nscreen=0\n\nsudo mkdir $myfonts_dir 2&gt;/dev/null\n\necho \"Ubuntu\u5b57\u4f53\u81ea\u52a8\u5b89\u88c5\u5de5\u5177\"\necho \"(C)2008-2009 Deng.Yangjun@Gmail.com\"\n\necho \"\u5b89\u88c5\u7b49\u5bbd\u82f1\u6587\u53f0\u5b57\u4f53:Monaco\"\nwget -O $monaco.zip $remote_dir/$monaco.zip\nunzip -o $monaco.zip 1&gt;/dev/null\nsudo mv $monaco $myfonts_dir\nrm $monaco.zip\n\necho \"\u5b89\u88c5\u7b49\u5bbd\u82f1\u6587\u5b57\u4f53:Lucida Console\"\nwget -O $lucida.zip $remote_dir/$lucida.zip\nunzip -o $lucida.zip 1&gt;/dev/null\nsudo mv $lucida $myfonts_dir\nrm $lucida.zip\n\necho \"\u5b89\u88c5\u82f1\u6587\u5b57\u4f53:Agency FB\"\nwget -O $agencyr.zip $remote_dir/$agencyr.zip\nunzip -o $agencyr.zip 1&gt;/dev/null\nsudo mv $agencyr $myfonts_dir\nrm $agencyr.zip\n\nwget -O $agencyrb.zip $remote_dir/$agencyrb.zip\nunzip -o $agencyrb.zip 1&gt;/dev/null\nsudo mv $agencyrb $myfonts_dir\nrm $agencyrb.zip\n\necho \"\u5b89\u88c5\u5b57\u4f53:\u5fae\u8f6f\u96c5\u9ed1\"\nwget -O $msyh.zip $remote_dir/$msyh.zip\nunzip -o $msyh.zip 1&gt;/dev/null\nsudo mv $msyh $myfonts_dir\nrm $msyh.zip\n\nwget -O $msyhbd.zip $remote_dir/$msyhbd.zip\nunzip -o $msyhbd.zip 1&gt;/dev/null\nsudo mv $msyhbd $myfonts_dir\nrm $msyhbd.zip\n\n#Ubuntu 7.10\n#wget http://www.cnblogs.com/Files/DengYangjun/language-selector.conf.zip\n#unzip -o language-selector.conf.zip\n#sudo mv language-selector.conf /etc/fonts\n#rm language-selector.conf.zip\n\n#Ubuntu 8.04 \necho \"\u8bf7\u9009\u62e9\u663e\u793a\u5668\u7c7b\u578b(1-2)\uff1a1-LED   2-CRT\"\nread screen\ncase $screen in\n1) \n    wget -O local.conf.zip  $remote_dir/local.conf.led.zip\n    ;;\n2)  \n    wget -O local.conf.zip  $remote_dir/local.conf.crt.zip\n    ;;\n?) \n    echo \"\u65e0\u6548\u9009\u62e9\uff0c\u9000\u51fa\u5b89\u88c5\uff0c\u5b89\u88c5\u672a\u5b8c\u6210\u3002\"\n    exit 1;\nesac\n\nunzip -o local.conf.zip 1&gt;/dev/null\nsudo mv /etc/fonts/conf.avail/51-local.conf /etc/fonts/conf.avail/51-local.conf.old\nsudo mv local.conf /etc/fonts/conf.avail/51-local.conf\nrm local.conf.zip\n\ncd /etc/fonts/conf.avail\nsudo mv 69-language-selector-zh-cn.conf 69-language-selector-zh-cn.conf.old 2&gt;/dev/null\n\necho \"\u8bf7\u7a0d\u7b49\uff0c\u6b63\u5728\u5237\u65b0\u7cfb\u7edf\u5b57\u4f53...\"\ncd $myfonts_dir\nsudo chmod 555 *\nsudo mkfontscale 1&gt;/dev/null\nsudo mkfontdir 1&gt;/dev/null\nsudo fc-cache -v 1&gt;/dev/null\n\necho \"\u5b89\u88c5\u5b57\u4f53\u7ed3\u675f\uff0c\u8c22\u8c22\u4f7f\u7528\u3002\u8bf7\u9000\u51faX-Server\uff0c\u91cd\u65b0\u767b\u5f55\uff0c\u67e5\u770b\u5b57\u4f53\u6548\u679c\u3002\"\n</pre> <p>agencyr-ttf agencyrb-ttf local-conf lucida-console-ttf monaco-linux-ttf msyh-ttf msyhbd-ttf</p>","tags":["ubuntu","linuxmint"]},{"location":"Misc/2017-05-08-osx%25e7%25a6%2581%25e6%25ad%25a2mobilebackups%25e7%2589%25b9%25e6%2580%25a7timemachine%25e6%259c%25ac%25e5%259c%25b0%25e5%25a4%2587%25e4%25bb%25bd.html/","title":"OSX\u7981\u6b62MobileBackups\u7279\u6027(TimeMachine\u672c\u5730\u5907\u4efd)","text":"<p>MobileBackups\uff0c\u5373OS X\u4e0aTimeMachine\u7684\u672c\u5730\u5907\u4efd\u3002\u4f1a\u5360\u7528\u975e\u5e38\u5927\u5f97\u7a7a\u95f4\u3002</p> <p>\u6211\u5728\u67e5\u770b\u786c\u76d8\u4f7f\u7528\u60c5\u51b5\u7684\u65f6\u5019\uff0c\u53d1\u73b0\u76ee\u5f55/Volumes/MobileBackups\u5360\u7528\u4e8620\u591aG\u7a7a\u95f4\uff0c\u8fd9\u662fTimeMachine\u7528\u6765\u505a\u5907\u4efd\u7684\u3002</p> <p>\u6839\u636e\u5b98\u7f51\u7684\u4ecb\u7ecd\uff0c\u5728OS 10.7\u53ca\u4ee5\u540e\u7684\u7248\u672c\u4e2d\uff0c\u5f53\u4f60\u6ca1\u6709\u63d2\u5165\u5176\u4ed6\u786c\u76d8\u4f5c\u4e3aTimeMachine\u7684\u5907\u4efd\u786c\u76d8\u65f6\uff0cTimeMachine\u4f1a\u81ea\u52a8\u521b\u5efa/Volumes/MobileBackups\u7528\u4f5c\u5907\u4efd\u3002\u56e0\u4e3a\u5360\u7528\u7684\u7a7a\u95f4\u592a\u5927\u4e86\uff0c\u6240\u4ee5\u4e0d\u5f97\u4e0d\u7981\u6b62TimeMachine\u7684\u8fd9\u79cd\u884c\u4e3a\u3002</p> <p>\u5728\u7ec8\u7aef\u4e0b\u6267\u884c\u547d\u4ee4\uff1a</p> <pre><code>sudo tmutil disablelocal\n</code></pre> <p>\u5c31\u53ef\u4ee5\u5173\u95ed\u672c\u5730\u5907\u4efd\u4e86\u3002\u4e0d\u8fc7\u8bb0\u5f97\u8981\u53ca\u65f6\u7684\u4f7f\u7528TimeMachine\u5907\u4efd\u8d44\u6599\u3002</p> <p> </p> \u6458\u81ea <p>http://blog.xinspace.space/2015/08/14/osx-disable-mobilebackups/</p>","tags":[]},{"location":"Misc/2017-05-20-linux%25e7%25b3%25bb%25e7%25bb%259f%25e8%25ae%25be%25e7%25bd%25aeswap%25e5%2588%2586%25e5%258c%25ba%25e7%259a%2584%25e5%25a4%25a7%25e5%25b0%258f%25e4%25b8%25a4%25e7%25a7%258d%25e6%2596%25b9%25e6%25b3%2595.html/","title":"Linux\u7cfb\u7edf\u8bbe\u7f6eSwap\u5206\u533a\u7684\u5927\u5c0f(\u4e24\u79cd\u65b9\u6cd5)","text":"\u5728\u5b89\u88c5\u5b8cLinux\u7cfb\u7edf\u540e\uff0cswap\u5206\u533a\u592a\u5c0f\u600e\u4e48\u529e\uff0c\u600e\u4e48\u53ef\u4ee5\u6269\u5927Swap\u5206\u533a\u5462\uff1f\u6709\u4e24\u4e2a\u529e\u6cd5\uff0c\u4e00\u4e2a\u662f\u4ece\u65b0\u5efa\u7acbswap\u5206\u533a\uff0c\u4e00\u4e2a\u662f\u589e\u52a0swap\u5206\u533a\u3002\u4e0b\u9762\u4ecb\u7ecd\u8fd9\u4e24\u79cd\u65b9\u6cd5\uff1a <p>\u7b2c\u4e00\u60a8\u5fc5\u987b\u6709root\u6743\u9650\uff0c\u8fc7\u7a0b\u4e2d\u4e00\u5b9a\u8981\u5f88\u5c0f\u5fc3\uff0c\u4e00\u4e0d\u5c0f\u5fc3\u5c31\u7834\u574f\u4e86\u6574\u4e2a\u786c\u76d8\u7684\u6570\u636e\uff0c\u6267\u884c\u4e0b\u9762\u7684\u8fc7\u7a0b\u4e4b\u524d\u60a8\u9700\u8981\u4e09\u601d\u800c\u884c\uff0c\u9519\u8bef\u64cd\u4f5c\u540e\u7684\u540e\u679c\u7531\u6267\u884c\u8005\u81ea\u5df1\u627f\u62c5\u3002</p> \u65b9\u6cd5\u4e00\uff1a\u65b0\u5efaswap\u5206\u533a\uff08\u614e\u7528\uff09 <ol> <li>\u4ee5root\u8eab\u4efd\u8fdb\u5165\u63a7\u5236\u53f0\uff0c\u8f93\u5165</li> </ol> <p># swapoff -a\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 #\u505c\u6b62\u4ea4\u6362\u5206\u533a</p> <p> </p> <ol> <li>\u7528fdisk\u547d\u4ee4\u52a0swap\u5206\u533a\u7684\u76d8\u7b26\uff0c\uff08\u4f8b\uff1a# fdisk /dev/sdb\uff09\u5254\u9664swap\u5206\u533a\uff0c\u8f93\u5165d\u5220\u9664swap\u5206\u533a\uff0c\u7136\u540e\u518dn\u6dfb\u52a0\u5206\u533a\uff08\u6dfb\u52a0\u65f6\u786c\u76d8\u5fc5\u987b\u8981\u6709\u53ef\u7528\u7a7a\u95f4\uff0c\u7136\u540e\u518d\u7528t\u5c06\u65b0\u6dfb\u7684\u5206\u533aid\u6539\u4e3a82\uff08linux swap\u7c7b\u578b\uff09\uff0c\u6700\u540e\u7528w\u5c06\u64cd\u4f5c\u5b9e\u9645\u5199\u5165\u786c\u76d8\uff08\u6ca1\u7528w\u4e4b\u524d\u7684\u64cd\u4f5c\u662f\u65e0\u6548\u7684\uff09\u3002</li> </ol> <p> </p> <ol> <li># mkswap /dev/sdb2 #\u683c\u5f0f\u5316swap\u5206\u533a\uff0c\u8fd9\u91cc\u7684sdb2\u8981\u770b\u60a8\u52a0\u5b8c\u540ep\u547d\u4ee4\u663e\u793a\u7684\u5b9e\u9645\u5206\u533a\u8bbe\u5907\u540d</li> </ol> <p> </p> <ol> <li># swapon /dev/sdb2 #\u542f\u52a8\u65b0\u7684swap\u5206\u533a</li> </ol> <p> </p> <ol> <li>\u4e3a\u4e86\u8ba9\u7cfb\u7edf\u542f\u52a8\u65f6\u80fd\u81ea\u52a8\u542f\u7528\u4ea4\u6362\u5206\u533a\uff0c\u53ef\u4ee5\u7f16\u8f91/etc/fstab,\u52a0\u5165\u4e0b\u9762\u4e00\u884c</li> </ol> <p>/dev/sdb2\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 swap\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 swap\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 defaults\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0 0</p> <p>6.\u5b8c\u6210</p> \u65b9\u6cd5\u4e8c\uff1a\u589e\u52a0Swap\u5206\u533a <p>1.\u521b\u5efa\u4ea4\u6362\u5206\u533a\u7684\u6587\u4ef6:\u589e\u52a01G\u5927\u5c0f\u7684\u4ea4\u6362\u5206\u533a\uff0c\u5219\u547d\u4ee4\u5199\u6cd5\u5982\u4e0b\uff0c\u5176\u4e2d\u7684 count \u7b49\u4e8e\u60f3\u8981\u7684\u5757\u5927\u5c0f\u3002</p> <p># dd if=/dev/zero of=/home/swapfile bs=1M count=1024</p> <p> </p> <p>2.\u8bbe\u7f6e\u4ea4\u6362\u5206\u533a\u6587\u4ef6:</p> <p># mkswap /home/swapfile\u00a0 #\u5efa\u7acbswap\u7684\u6587\u4ef6\u7cfb\u7edf</p> <p> </p> <p>3.\u7acb\u5373\u542f\u7528\u4ea4\u6362\u5206\u533a\u6587\u4ef6:</p> <p># swapon /home/swapfile\u00a0\u00a0 #\u542f\u7528swap\u6587\u4ef6</p> <p> </p> <p>4.\u4f7f\u7cfb\u7edf\u5f00\u673a\u65f6\u81ea\u542f\u7528\uff0c\u5728\u6587\u4ef6/etc/fstab\u4e2d\u6dfb\u52a0\u4e00\u884c\uff1a</p> <p>/home/swapfile swap swap defaults 0 0</p> <p> </p> <p>5.\u5b8c\u6210</p> <p>\u672c\u6587\u51fa\u81ea \u201chancj\u201d \u535a\u5ba2\uff0c\u8bf7\u52a1\u5fc5\u4fdd\u7559\u6b64\u51fa\u5904http://hancj.blog.51cto.com/89070/197915</p>","tags":["linux","swap"]},{"location":"Misc/2017-05-27-%25e8%25a7%25a3%25e6%25b1%25balinux%25e7%25b3%25bb%25e7%25b5%25b1%25e7%259a%2584%25e4%25b8%25ad%25e6%2596%2587%25e8%25ae%258a%25e6%2588%2590%25e7%25b4%25b0%25e6%2598%258e%25e9%25ab%2594%25e6%2588%2596%25e6%2598%25af%25e6%25a8%2599%25e6%25a5%25b7%25e9%25ab%2594%25e7%259a%2584%25e5%2595%258f%25e9%25a1%258c.html/","title":"\u89e3\u6c7aLinux\u7cfb\u7d71\u7684\u4e2d\u6587\u8b8a\u6210\u7d30\u660e\u9ad4\u6216\u662f\u6a19\u6977\u9ad4\u7684\u554f\u984c","text":"\u65e5\u671f\uff1a2016 \u5e74 6 \u6708 11 \u65e5 | \u4f5c\u8005\uff1aMagic Len <p>\u8a31\u591aLinux\u767c\u884c\u7248\u6703\u5167\u5efa\u5e7e\u500b\u4e2d\u6587\u5b57\u578b\uff0c\u4ee5\u4fbf\u9047\u5230\u4e2d\u6587\u5b57\u7684\u6642\u5019\u53ef\u4ee5\u5957\u7528\uff0c\u800c\u61c9\u7528\u7a0b\u5f0f\u6216\u7db2\u9801\u4e5f\u5e38\u6703\u4ee5\u512a\u5148\u9806\u5e8f\u7684\u65b9\u5f0f\u53bb\u9078\u64c7\u4e2d\u6587\u5b57\u9ad4\u4f86\u5957\u7528\uff0c\u4f8b\u5982\u50cf\u662f\u5fae\u8edf\u6a19\u6977\u9ad4\u7684\u300cAR PL UKai\u300d\uff0c\u6216\u662f\u50cf\u662f\u5fae\u8edf\u7d30\u660e\u9ad4\u7684\u300cAR PL UMing\u300d\uff0c\u90fd\u662f\u5f88\u5e38\u898b\u7684\u9810\u8a2d\u5b57\u578b\u3002\u7b46\u8005\u7fd2\u6163\u4f7f\u7528\u300cNoto Sans CJK TC\u300d\u548c\u300c\u6587\u6cc9\u9a5b\u5fae\u7c73\u9ed1\u300d\uff0c\u6240\u4ee5\u6703\u628a\u9019\u5169\u7a2e\u5b57\u578b\u8a2d\u5b9a\u70ba\u9810\u8a2d\u7684\u5b57\u578b\uff0c\u4f46\u901a\u5e38\u90fd\u6703\u6709\u5c11\u90e8\u4efd\u8edf\u9ad4\u7a0b\u5f0f\u7684\u5b57\u578b\u7121\u6cd5\u5957\u7528\u9810\u8a2d\u7684\u8a2d\u5b9a\uff0c\u800c\u662f\u81ea\u884c\u5957\u7528\u4e86\u300cAR PL UKai\u300d\u6216\u662f\u300cAR PL UMing\u300d\u9019\u5169\u7a2e\u919c\u919c\u7684\u50b3\u7d71\u5370\u5237\u5b57\u3002</p> <p>\u70ba\u4e86\u756b\u9762\u7684\u7f8e\u89c0\uff0c\u7b46\u8005\u6703\u5c07\u300cAR PL UKai\u300d\u548c\u300cAR PL UMing\u300d\u9019\u5169\u500b\u5b57\u578b\u5f9e\u7cfb\u7d71\u4e2d\u79fb\u9664\u3002\u5982\u679c\u662f\u4f7f\u7528Ubuntu\u6216\u662f\u57fa\u65bcUbuntu\u7684Linux\u767c\u884c\u7248\u7684\u8a71\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728\u7d42\u7aef\u6a5f\u8f38\u5165\u4ee5\u4e0b\u6307\u4ee4\u4f86\u79fb\u9664\u5b83\u5011\uff1a</p> <p>sudo apt-get remove fonts-arphic-ukaifonts-arphic-uming</p> <p> </p> <p>\u6458\u81ea\uff1ahttps://magiclen.org/linux-font-remove-kai/</p>","tags":["linuxmint","\u5b57\u4f53","\u6977\u4f53"]},{"location":"Misc/2017-06-13-centos-7-%25e4%25b8%258b-ifconfig-command-not-found-%25e8%25a7%25a3%25e5%2586%25b3%25e5%258a%259e%25e6%25b3%2595.html/","title":"CentOS 7 \u4e0b ifconfig command not found \u89e3\u51b3\u529e\u6cd5","text":"<p>1. \u67e5\u770bifconfig\u547d\u4ee4\u662f\u5426\u5b58\u5728</p> <p>ls /sbin/ifconfig \u662f\u5426\u5b58\u5728</p> <p>2. \u5982\u679cifconfig\u547d\u4ee4\u5b58\u5728\uff0c\u67e5\u770b\u73af\u5883\u53d8\u91cf\u8bbe\u7f6e</p> <pre><code>#echo\u00a0$PATH</code></pre> <p>\u5982\u679c\u73af\u5883\u53d8\u91cf\u4e2d\u6ca1\u6709\u5305\u542bifconfig\u547d\u4ee4\u7684\u8def\u5f84</p> <p>\u4e34\u65f6\u4fee\u6539\u73af\u5883\u53d8\u91cf\uff1a\u5728shell\u4e2d\u8f93\u5165</p> <pre><code>$export\u00a0PATH\u00a0=\u00a0$PATH:/sbin</code></pre> <p>\u7136\u540e\u518d\u8f93\u5165ifconfig\u547d\u4ee4\u5373\u53ef\uff0c\u4f46\u662f\u8fd9\u53ea\u662f\u4e34\u65f6\u66f4\u6539\u4e86shell\u4e2d\u7684PATH\uff0c\u5982\u679c\u5173\u95edshell\uff0c\u5219\u4fee\u6539\u6d88\u5931\uff0c\u4e0b\u6b21\u8fd8\u9700\u8981\u91cd\u590d\u5982\u4e0a\u64cd\u4f5c</p> <p>\u6c38\u4e45\u4fee\u6539PATH\u53d8\u91cf\u4f7f\u4e4b\u5305\u542b/sbin\u8def\u5f84\uff1a</p> <p>\u6253\u5f00/etc/profile\u6587\u4ef6\uff0c\u5728\u5176\u4e2d\u8f93\u5165export PATH=$PATH:/sbin\uff0c\u4fdd\u5b58\u5e76\u91cd\u542f\u5373\u53ef\uff0c\u8fd9\u6837\u4e00\u6765\uff0cPATH\u8def\u5f84\u6c38\u4e45\u4fee\u6539\u6210\u529f\uff0c\u4ee5\u540e\u4efb\u4f55\u65f6\u5019\u53ea\u8f93\u5165ifconfig\u547d\u4ee4\u5373\u53ef</p> <p>3.\u00a0\u5982\u679cifconfig\u547d\u4ee4\u4e0d\u5b58\u5728</p> <pre><code>yum\u00a0upgrade</code></pre> <pre><code>yum\u00a0install\u00a0net-tools</code></pre> <p>\u6458\u81ea\uff1ahttps://my.oschina.net/u/1428349/blog/288708</p>","tags":["centos","ifconfig","redhat","net-tools"]},{"location":"Misc/2017-07-20-encrypt-file-with-openssl-rsa.html/","title":"Encrypt file with openssl RSA","text":"<p>\u751f\u6210\u4e00\u4e2a\u5bc6\u94a5\uff1a</p> <pre>openssl genrsa -out test.key 1024</pre> <p>\u8fd9\u91cc-out\u6307\u5b9a\u751f\u6210\u6587\u4ef6\u7684\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\u8fd9\u4e2a\u6587\u4ef6\u5305\u542b\u4e86\u516c\u94a5\u548c\u5bc6\u94a5\u4e24\u90e8\u5206\uff0c\u4e5f\u5c31\u662f\u8bf4\u8fd9\u4e2a\u6587\u4ef6\u5373\u53ef\u7528\u6765\u52a0\u5bc6\u4e5f\u53ef\u4ee5\u7528\u6765\u89e3\u5bc6\u3002\u540e\u9762\u76841024\u662f\u751f\u6210\u5bc6\u94a5\u7684\u957f\u5ea6\u3002</p> <p>openssl\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u6587\u4ef6\u4e2d\u7684\u516c\u94a5\u63d0\u53d6\u51fa\u6765\uff1a</p> <pre>openssl rsa -in test.key -pubout -out test_pub.key</pre> <p>-in\u6307\u5b9a\u8f93\u5165\u6587\u4ef6\uff0c-out\u6307\u5b9a\u63d0\u53d6\u751f\u6210\u516c\u94a5\u7684\u6587\u4ef6\u540d\u3002\u81f3\u6b64\uff0c\u6211\u4eec\u624b\u4e0a\u5c31\u6709\u4e86\u4e00\u4e2a\u516c\u94a5\uff0c\u4e00\u4e2a\u79c1\u94a5\uff08\u5305\u542b\u516c\u94a5\uff09\u3002\u73b0\u5728\u53ef\u4ee5\u5c06\u7528\u516c\u94a5\u6765\u52a0\u5bc6\u6587\u4ef6\u4e86\u3002</p> <p>\u6211\u5728\u76ee\u5f55\u4e2d\u521b\u5efa\u4e00\u4e2ahello\u7684\u6587\u672c\u6587\u4ef6\uff0c\u7136\u540e\u5229\u7528\u6b64\u524d\u751f\u6210\u7684\u516c\u94a5\u52a0\u5bc6\u6587\u4ef6\uff1a</p> <pre>openssl rsautl -encrypt -in hello -inkey test_pub.key -pubin -out hello.en</pre> <p>-in\u6307\u5b9a\u8981\u52a0\u5bc6\u7684\u6587\u4ef6\uff0c-inkey\u6307\u5b9a\u5bc6\u94a5\uff0c-pubin\u8868\u660e\u662f\u7528\u7eaf\u516c\u94a5\u6587\u4ef6\u52a0\u5bc6\uff0c-out\u4e3a\u52a0\u5bc6\u540e\u7684\u6587\u4ef6\u3002</p> <p>\u89e3\u5bc6\u6587\u4ef6\uff1a</p> <pre>openssl rsautl -decrypt -in hello.en -inkey test.key -out hello.de</pre> <p>-in\u6307\u5b9a\u88ab\u52a0\u5bc6\u7684\u6587\u4ef6\uff0c-inkey\u6307\u5b9a\u79c1\u94a5\u6587\u4ef6\uff0c-out\u4e3a\u89e3\u5bc6\u540e\u7684\u6587\u4ef6\u3002</p> <p> </p> <p>Source:\u00a0https://www.cnblogs.com/alittlebitcool/archive/2011/09/22/2185418.html</p>","tags":["openssl","rsa","encrypt"]},{"location":"Misc/2017-10-02-%25e5%259c%25a8mac%25e4%25b8%258a%25e5%2588%25b6%25e4%25bd%259c-u%25e7%259b%2598-%25e5%2590%25af%25e5%258a%25a8%25e7%259b%2598/","title":"\u5728mac\u4e0a\u5236\u4f5c U\u76d8 \u542f\u52a8\u76d8","text":"","tags":["linux","image","dmg","iso"]},{"location":"Misc/2017-10-02-%25e5%259c%25a8mac%25e4%25b8%258a%25e5%2588%25b6%25e4%25bd%259c-u%25e7%259b%2598-%25e5%2590%25af%25e5%258a%25a8%25e7%259b%2598/#1-hdiutilisodmg","title":"1. \u7528hdiutil\u5c06ISO\u8f6cdmg","text":"<pre><code>$ hdiutil convert -format UDRW -o CentOS-7-x86_64-DVD-1804 CentOS-7-x86_64-DVD-1804.iso\nReading Master Boot Record (MBR : 0)...\nReading CentOS 7 x86_64&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; (Apple_ISO : 1)...\nReading&amp;nbsp; (Type EF : 2)...\nReading CentOS 7 x86_64&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; (Apple_ISO : 3)...\n.........................................................................................\nElapsed Time:&amp;nbsp; 2m 55.451s\nSpeed: 24.3Mbytes/sec\nSavings: 0.0%\ncreated: /Volumes/data/software/CentOS-7-x86_64-DVD-1804.dmg\n</code></pre> <p>\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u4e00\u4e2a.dmg\u786c\u76d8\u955c\u50cf\u6587\u4ef6\u3002</p>","tags":["linux","image","dmg","iso"]},{"location":"Misc/2017-10-02-%25e5%259c%25a8mac%25e4%25b8%258a%25e5%2588%25b6%25e4%25bd%259c-u%25e7%259b%2598-%25e5%2590%25af%25e5%258a%25a8%25e7%259b%2598/#2-unmount-u","title":"2. Unmount U\u76d8","text":"<p>\u67e5\u770bU\u76d8\uff0c\u8def\u5f84\u901a\u5e38\u4e3a/dev/diskN</p> <pre><code>diskutil list\n</code></pre> <p>Unmount U\u76d8</p> <pre><code>$ diskutil unmountDisk /dev/disk4\nUnmount of all volumes on disk4 was successful\n</code></pre>","tags":["linux","image","dmg","iso"]},{"location":"Misc/2017-10-02-%25e5%259c%25a8mac%25e4%25b8%258a%25e5%2588%25b6%25e4%25bd%259c-u%25e7%259b%2598-%25e5%2590%25af%25e5%258a%25a8%25e7%259b%2598/#3","title":"3. \u62f7\u5165\u955c\u50cf","text":"<pre><code>$ sudo dd if=CentOS-7-x86_64-DVD-1804.dmg of=/dev/disk4 bs=1m\n4262+1 records in\n4262+1 records out\n4469153792 bytes transferred in 2602.575198 secs (1717204 bytes/sec)\n</code></pre>","tags":["linux","image","dmg","iso"]},{"location":"Misc/2017-10-02-%25e5%259c%25a8mac%25e4%25b8%258a%25e5%2588%25b6%25e4%25bd%259c-u%25e7%259b%2598-%25e5%2590%25af%25e5%258a%25a8%25e7%259b%2598/#4-u","title":"4. \u6700\u540e\u5f39\u51faU\u76d8","text":"<pre><code>diskutil eject /dev/disk4\n</code></pre>","tags":["linux","image","dmg","iso"]},{"location":"Misc/2017-10-02-installing-fcitx-chinese-ime-arch-linux.html/","title":"Installing fcitx (a Chinese IME) on Arch Linux","text":"<p>Source:\u00a0http://www.fanz.io/2015/10/10/fcitx-notes.html</p> Oct 10, 2015 By Fan Zhang Arch Linux,\u00a0Tools, <p>Fcitx is a popular Chinese input method engine (IME) suggested by ArchWiki. Fcitx is awesome but every time I (re)install Arch Linux on my boxes, I had trouble getting fcitx to work out of the box --\u00a0<code>pacman -Syu fcitx-im</code>\u00a0doesn't give you a working IME. I guess a major facet making the installation and configuration so tricky is that fcitx doesn't provide an all-in-one configuration tool (I guess for good reason though), so as an user you will have to manually put various configuration snippets at several different places. Moreover, before getting all of them right, fcitx just won't work, which makes debugging even more frustrating. So, this short note serves as a memo for myself and hopefully can help others run into the similar troubles.</p> <p> </p>","tags":["linux","arch"]},{"location":"Misc/2017-10-02-installing-fcitx-chinese-ime-arch-linux.html/#prerequisites","title":"Prerequisites","text":"<p>Before installing\u00a0<code>fcitx</code>, you'll need proper fonts installed. ArchWiki (e.g.\u00a0this page) has a comprehensive guidance for doing this.</p>","tags":["linux","arch"]},{"location":"Misc/2017-10-02-installing-fcitx-chinese-ime-arch-linux.html/#installation","title":"Installation","text":"<p>Once the necessary fonts are correctly installed, which can be verified by checking if your browser can render Chinese characters correctly when you go to renren.com or so on, we can proceed to the installation of fcitx.</p> <p>Okay, basically there are three pieces of software to be installed: the\u00a0<code>fcitx</code>\u00a0itself, one or more IMEs of your choices (e.g. I like\u00a0<code>fcitx-googlepinyin</code>) and a couple of input method engines for various toolkits (gtk2, gtk3, etc.). For convenience, they can be installed as a bundle by group\u00a0<code>fcitx-im</code>. I also installed a GUI configuration tool (<code>fcitx-configtool</code>), which is not mandatory but makes my life a little bit easier.</p> <pre><code>pacman -Syu fcitx fcitx-googlepinyin fcitx-im  fcitx-configtool\n</code></pre>","tags":["linux","arch"]},{"location":"Misc/2017-10-02-installing-fcitx-chinese-ime-arch-linux.html/#configuration","title":"Configuration","text":"<p>As I said, there are multiple pieces of configuration to be tweaked. Before getting all of them right, fcitx will not work.</p> <p>First, you need to register those input method modules before using them. Depending on you choice of display manager, add the following lines to your startup script file to. Use\u00a0<code>.xprofile</code>\u00a0if you are using KDM, GDM, LightDM or SDDM. Use\u00a0<code>.xinitrc</code>\u00a0if you are using\u00a0<code>startx</code>\u00a0or Slim.</p> <pre><code># .xprofile or .xinitrc\nexport GTK_IM_MODULE=fcitx\nexport QT_IM_MODULE=fcitx\nexport XMODIFIERS=@im=fcitx\n</code></pre> <p>Second, if your locale is\u00a0<code>en_US.UTF-8</code>, IME for Chinese will\u00a0not\u00a0be activated by default. You'll get a notice by\u00a0<code>fcitx-dianose</code>\u00a0command like this:</p> <pre><code>## Input Methods:\n    1.  Found 1 enabled input methods:\n            fcitx-keyboard-us\n    2.  Default input methods:\n        **You only have one input method enabled, please add a keyboard input method as the first one and your main input method as the second one.**\n</code></pre> <p>In my case, I managed to add\u00a0<code>google-pinyin</code>\u00a0using\u00a0<code>fcitx-configtool</code>. Simply launch the GUI program and add input methods as you like and re-login.</p>","tags":["linux","arch"]},{"location":"Misc/2017-10-02-installing-fcitx-chinese-ime-arch-linux.html/#use-fcitx","title":"Use fcitx","text":"<p>Believe it or not, figuring out how to switch to Chinese input mode consumed the most of my time in this process. One correct way of doing this is to press\u00a0<code>Ctrl-Space</code>\u00a0while focusing on an input field. If a little widget shows up, you're all set. Otherwise, which is highly likely, please proceed to the next section :)</p>","tags":["linux","arch"]},{"location":"Misc/2017-10-02-installing-fcitx-chinese-ime-arch-linux.html/#troubleshooting","title":"Troubleshooting","text":"<p>Fcitx provided nice tools for troubleshooting. However, before getting to the correct way of debugging, please be advised not to fall into the following pitfall as I did:</p> <p>If you're using a desktop environment that happens to a system tray, don't expect an icon there for fcitx (although many other IMEs do have system tray icons). For unknown reasons,\u00a0<code>fcitx</code>\u00a0doesn't display a system tray icon in my case, which confused me a lot because I expect that icon to appear to indicate fcitx is working properly. Long story short: never try to find a system tray icon.</p> <p>The most adorable thing from an user's point of view is\u00a0<code>fcitx-diagnose</code>. This is a small diagnose program coming with\u00a0<code>fcitx</code>\u00a0package, which does not only provide informative diagnosis but also quick fix tips. Whenever you're not sure if you're doing things right (e.g. when you can't find a system tray icon), just run\u00a0<code>fcitx-diagnose</code>\u00a0and check out the red bold errors.</p>","tags":["linux","arch"]},{"location":"Misc/2017-10-02-installing-fcitx-chinese-ime-arch-linux.html/#resources","title":"Resources","text":"<p>I found ArchWiki page on\u00a0fcitx\u00a0super informative.</p>","tags":["linux","arch"]},{"location":"Misc/2017-10-08-install-wps-office-manjaro-linux.html/","title":"Install wps office on Manjaro Linux","text":"<p>It's easy, just open terminal, input following commands:</p> <p>sudo pacman -S --needed base-devel sudo pacman -S yaourt yaourt -S wps-office ttf-wps-fonts</p> <p> </p> <p> </p> <p></p>","tags":["linux","wps","office","manjaro"]},{"location":"Misc/2017-12-15-remote-x11-gui-linuxunix.html/","title":"Remote X11 GUI For Linux/Unix","text":"Source:\u00a0https://www.redwireservices.com/remote-x11-for-linux-unix The Problem <p>One of my most feared questions from end users is \u201chow can I interact with an X11 GUI application on our remote Linux system if I have no access to the physical console, X11 isn\u2019t installed, and there is no VNC access?\u201d \u00a0After hearing this many times at one site, I wrote a script to automate the server side process, but even that does not address the whole story. \u00a0I\u2019m\u00a0writing\u00a0this post as a quick reference when I field this question in the future, and I hope it helps you, too.</p> <p>The problem is that most system administrators do not install X11, Xorg, or other GUI interfaces on Linux and Unix systems as this introduces more packages to manage and patch, more security bugs to fix/mitigate, and a larger install footprint (more used space). That last point may seem moot today, but with many environments deploying hundreds of virtual machines, 200-400MB of extra space per VM can really add up quickly (see my latest presentation on\u00a0Open Source Data Deduplication\u00a0for more ideas on saving space in these environments). \u00a0If you consider the overhead of installing a modern desktop/windowing system such as\u00a0Gnome\u00a0or\u00a0KDE, it could easily more than double the data size footprint of a Linux server.</p> <p>OK, many environments don\u2019t install the Linux/Unix GUI bits (also known as X11 or Xorg server), so who cares, I can just install everything via the command line, right? \u00a0Well, yes, for the most part you can just install applications via the command line and forget this whole issue. \u00a0However, there are a few vendor applications,\u00a0notably\u00a0including Oracle Database and Application Server products, that are difficult if not impossible to install without a GUI.</p> The Solution <p>The modern solution to the problem stated above is to tunnel X11 traffic over ssh (securely), and display it on your workstation, whether it be Windows, Mac OS X, or Linux. \u00a0For sake of helping the most folks, we\u2019ll focus on Windows workstations here, but Linux and Mac OS X should work with only the server side changes we write here (just connect with the command line\u00a0ssh -Y your_username@your_servername.com).</p> <p>In certain circumstances, it may be\u00a0advantageous\u00a0to setup a VNC server to accomplish the same thing, but that requires more of X11 and an windowing environment be configured on the server side, and we\u2019d like to avoid as many server side changes as possible, as many users won\u2019t have access to make these changes themselves.</p> PROCESS OVERVIEW <p>In order to obtain the ability to\u00a0interact\u00a0with an X11 GUI remotely, we will follow these general steps:</p> <ol> <li>Ensure that the foundational X11 packages are installed</li> <li>Ensure that OpenSSH server is configured to forward X11 connections</li> <li>Configure a local X11 server on our workstation</li> <li>Configure our ssh application to forward X11 requests</li> <li>Test with a simple application</li> <li>Configured authentication if user changes are needed</li> <li>Move on with the task at hand</li> </ol> 1) ENSURE THAT THE FOUNDATIONAL X11 PACKAGES ARE INSTALLED <p>In order to use remote X11, you must have a few X11 packages installed on the server. \u00a0In many cases these are already installed, but you may have to ask your System Administrator to install them for you, it\u2019s easy:</p> <p>RHEL/CentOS/Fedora (xterm is optional, but\u00a0beneficial\u00a0for testing):</p> <pre>sudo yum install xorg-x11-xauth xterm\nsudo yum install libXext.x86_64\nsudo yum install libXrender.x86_64\nsudo yum install libXtst.x86_64</pre> 2) ENSURE THAT OPENSSH SERVER IS CONFIGURED TO FORWARD X11 CONNECTIONS <p>On RHEL and related RedHat based servers, the file to check is /etc/ssh/sshd_config. \u00a0Review this file for the following line:</p> <pre>X11Forwarding yes</pre> <p>If that line is preceded by a comment (#) or is set to\u00a0no, update the file to match the above, and restart your ssh server daemon (be careful here \u2014 if you made an error you may lock yourself out of the server).</p> <pre>sudo /etc/init.d/sshd restart</pre> 3)\u00a0CONFIGURE A LOCAL X11 SERVER ON YOUR WORKSTATION <p>Next we need to install and configure a local X11 server,\u00a0Xming\u00a0or\u00a0Cygwin/X\u00a0are popular</p> <p>Click Xming to start the Xming X11 Server on your Desktop/Workstation</p> <p>free choices for Windows. \u00a0Simply download and follow the install instructions for these packages, Xming is by far easier to setup for beginners. \u00a0After the install is complete, and you\u2019ve rebooted your workstation/desktop (if requested), start the X11 server application from the start menu.</p> 4) CONFIGURE OUR SSH APPLICATION TO FORWARD X11 REQUESTS <p>Next, we need to ensure that our ssh client is configured to forward X11 requests from the server. \u00a0If you are using Cygwin/X, a Mac, or a Linux desktop, simple open up a terminal and preface your ssh command with\u00a0-Y, for example:</p> <pre>ssh -Y your_username@your_server.your_domain.com</pre> <p>That will tell SSH to forward all X11 requests to your local desktop. \u00a0For Windows, the most popular client is\u00a0PuTTY. \u00a0To\u00a0achieve\u00a0the same result in PuTTY, load the profile of the server you wish to connect to, or simply fill out the connection details. \u00a0Next expand the\u00a0Connection\u00a0and\u00a0SSH\u00a0options on the left hand side. \u00a0Under\u00a0SSH\u00a0and then\u00a0X11,\u00a0ensure that\u00a0Enable X11 Forwarding\u00a0is checked.</p> <p>PuTTY Configuration Window Show X11 Forwarding Enabled.</p> <p>Finally, click the\u00a0Open\u00a0button to connect to the remote server.</p> 5) TEST WITH A SIMPLE APPLICATION <p>If everything has gone according to plan you now have a server configured to allow X11 connections, an ssh client configured likewise, and you are ready to test. \u00a0When connecting to the remote server (last step in part 4 above), you may see a message like this:</p> <pre>/usr/bin/xauth:  creating new authority file /home/ec2-user/.Xauthority</pre> <p>This is a normal message, and in fact it tells us that part of our changes are working! \u00a0This file contains an authentication token required to connect with the X11 server. \u00a0Now to test, it\u2019s easy, just enter this command on the remote ssh session:</p> <pre>xterm</pre> <p>Wait just a few seconds depending on your internet/network connection speed, and you should see the following.</p> <p>xterm displayed on Windows from a remote Linux Server</p> <p>If you see something similar, congratulations! \u00a0Remote X11 connections are working!</p> 6) CONFIGURED AUTHENTICATION IF USER CHANGES ARE NEEDED <p>X11 forwarding is working, great! \u00a0These days, however, users are often not allowed to log in as root, which is great for security, but adds yet another step to our process. \u00a0In step 5 we ran xterm as ourselves, which validates our setup is proper. \u00a0Try running the same command as another user, though, via\u00a0sudo\u00a0and you\u2019ll likely see an error like the following.</p> <p>X11 Error from Improper Xauth Configuration</p> <p>The problem here is that a\u00a0.Xauthority\u00a0file is created automatically at log in time for our user, allowing our user access to our local X11 server (on our desktop). \u00a0However, when root tries to access this connection it is denied without the proper permissions.</p> <p>To work around this, simply copy the\u00a0.Xauthority\u00a0file from your user directory to the user you want to work with (root for example). \u00a0Note that this should be done from your user account, not as root:</p> <pre>sudo cp ~/.Xauthority ~root/</pre> <pre>sudo /bin/chown root ~root/.Xauthority</pre> <p>Try running\u00a0xterm\u00a0again as root, it should work.</p> <pre>sudo xterm</pre> 7) MOVE ON WITH THE TASK AT HAND <p>There you have it, now that you can login remotely and still access a GUI as any user, you can move on to installing your GUI centric application such as Oracle.</p> <pre>sudo cp ~/.Xauthority ~oracle/</pre> <pre>sudo /bin/chown oracle ~oracle/.Xauthority</pre> <pre>sudo su - oracle</pre> <pre>./runInstaller</pre> <p>Enjoy!</p> Gotchas <p>When installing or configuring an application, like those from Oracle, keep in mind that a break in your internet connection or other problems with your link may cause the remote program to be closed! \u00a0So while it may be tempting to let an X11 process run overnight, you may have better results sticking around until the process completes. \u00a0If your installer/application stops to ask you a question and your link does fail, you will likely lose all the work completed to that point and have to start all over again. \u00a0Save early, save often, as they say.</p> Conclusion <p>If this was helpful, please drop us a line at info at redwireservices.com,\u00a0@RedWireServices\u00a0on Twitter, or using the\u00a0contact\u00a0page. \u00a0If you have additional tips to add, please add a comment below and I will update the post accordingly to help as many as possible.</p> <p>Finally, if you or your company are in need of\u00a0IT disaster recovery planning,\u00a0backup system\u00a0assistance,\u00a0storage, or\u00a0archival\u00a0help, give us a ring at\u00a0(206) 829-8621.</p>","tags":["linux","X11"]},{"location":"Misc/2017-12-23-encrypt-large-file-openssl-using-public-key.html/","title":"How to encrypt a large file in openssl using public key","text":"<p>See:\u00a0https://stackoverflow.com/questions/7143514/how-to-encrypt-a-large-file-in-openssl-using-public-key</p> <p>Generate a symmetric key because you can encrypt large files with it</p> <pre><code>openssl rand -base64 32 &gt; key.bin\n</code></pre> <p>Encrypt the large file using the symmetric key</p> <pre><code>openssl enc -aes-256-cbc -salt -in myLargeFile.xml \\\n  -out myLargeFile.xml.enc -pass file:./key.bin\n</code></pre> <p>Encrypt the symmetric key so you can safely send it to the other person</p> <pre><code>openssl rsautl -encrypt -inkey public.pem -pubin -in key.bin -out key.bin.enc\n</code></pre> <p>Destroy the un-encrypted symmetric key so nobody finds it</p> <pre><code>shred -u key.bin\nor: gshred -u key.bin </code></pre> <p>At this point, you send the encrypted symmetric key (<code>key.bin.enc</code>) and the encrypted large file (<code>myLargeFile.xml.enc</code>) to the other person</p> <p>The other person can then decrypt the symmetric key with their private key using</p> <pre><code>openssl rsautl -decrypt -inkey private.pem -in key.bin.enc -out key.bin\n</code></pre> <p>Now they can use the symmetric key to decrypt the file</p> <pre><code>openssl enc -d -aes-256-cbc -in myLargeFile.xml.enc \\\n  -out myLargeFile.xml -pass file:./key.bin\n</code></pre> <p>And you're done. The other person has the decrypted file and it was safely sent.</p> <p> </p>","tags":["openssl","encrypt"]},{"location":"Misc/2018-01-24-mac-retina-%25e5%2590%2588%25e7%259b%2596%25e5%2590%258e%25e6%2589%2593%25e5%25bc%2580%25e7%25aa%2581%25e7%2584%25b6%25e9%25bb%2591%25e5%25b1%258f%25ef%25bc%258c%25e9%2595%25bf%25e6%258c%2589%25e5%25bc%2580%25e6%259c%25ba%25e9%2594%25ae%25e6%2597%25a0%25e5%258f%258d%25e5%25ba%2594.html/","title":"Mac Retina \u5408\u76d6\u540e\u6253\u5f00\u7a81\u7136\u9ed1\u5c4f\uff0c\u957f\u6309\u5f00\u673a\u952e\u65e0\u53cd\u5e94?","text":"<p>1\u3001\u5f85\u673a\u706d\u5c4f\u540e\uff0c\u6572\u51fb\u952e\u76d8\u65e0\u6cd5\u5524\u8d77\uff0c\u5408\u4e0a\u7535\u8111\u540e\u91cd\u65b0\u6253\u5f00\uff0c\u770b\u673a\u4f1a\uff0c4\u30015\u6b21\u4e4b\u95f4\u6709\u6210\u529f\u7684\u673a\u4f1a\uff1b</p> <p>2\u3001\u4f7f\u7528\u4e2d\u5ffd\u7136\u706d\u5c4f\uff0c\u7528\u4e0a\u8ff0\u65b9\u6cd5\u91cd\u65b0\u6253\u5f00\uff1b</p> <p>\u95ee\u4e86\u8d2d\u4e70\u5546\u5bb6\uff0c\u7528\u4e86\u4e0b\u9762\u7b2c\u4e8c\u79cd\u65b9\u6cd5\uff0c\u75c7\u72b6\u51cf\u8f7b\u4e86\uff0c\u8fd8\u662f\u4f1a\u51fa\u73b0\u70b9\u4e0d\u4eae\u6216\u706d\u5c4f\u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u503e\u5411\u6000\u7591\u662f\u8f6f\u4ef6\u95ee\u9898\u3002\u5e76\u4e14\u662f\u57282\u5468\u524d\u66f4\u65b0\u4e86\u7cfb\u7edf\u540e\u53d1\u751f\u7684\u3002</p> <p>\u65b9\u6cd5\u4e00\uff1a\u7535\u8111\u5173\u673a\uff0c\u63a5\u4e0a\u7535\u6e90\uff0c\u6309\u4f4f\u4ee5\u4e0b4\u4e2a\u6309\u952e\uff0c\u957f\u630930\u79d2\uff1ashift+option+control+\u5f00\u673a\u952e\u3002</p> <p>\u65b9\u6cd5\u4e8c\uff1a\u7535\u8111\u5173\u673a\uff0c\u8fd9\u6b65\u63a5\u4e0d\u63a5\u7535\u6e90\u90fd\u53ef\u4ee5\uff0c\u6309\u7167\u4ee5\u4e0b\u64cd\u4f5c\uff1a\u957f\u6309command+option+P+R\uff0c\u5f00\u673a\u952e\u6309\u4e00\u4e0b\uff0c\u5207\u8bb0\uff0c\u90a3\u56db\u4e2a\u6309\u952e\u662f\u957f\u6309\u4e00\u76f4\u4e0d\u653e\uff0c\u7b49\u5230\u7cfb\u7edf\u81ea\u52a8\u91cd\u542f\u7b2c\u56db\u58f0\u7684\u65f6\u5019\u6240\u6709\u6309\u952e\u653e\u5f00\uff0c\u800c\u5f00\u673a\u952e\u53ea\u8981\u6309\u4e00\u4e0b\u5c31\u53ef\u4ee5\uff0c\u4e0d\u7528\u957f\u6309\u3002</p> <p>\u6301\u7eed\u8ddf\u8fdb\u8fd9\u4e2a\u8bdd\u9898\uff0c\u4e00\u4e9b\u540c\u6837\u7684\u7ecf\u9a8c\uff0c\u4f9b\u5927\u5bb6\u53c2\u8003\u3002</p> <p>\u4f5c\u8005\uff1a\u997f\u8001\u4e09 \u94fe\u63a5\uff1ahttps://www.zhihu.com/question/23015698/answer/188982637 \u6765\u6e90\uff1a\u77e5\u4e4e \u8457\u4f5c\u6743\u5f52\u4f5c\u8005\u6240\u6709\u3002\u5546\u4e1a\u8f6c\u8f7d\u8bf7\u8054\u7cfb\u4f5c\u8005\u83b7\u5f97\u6388\u6743\uff0c\u975e\u5546\u4e1a\u8f6c\u8f7d\u8bf7\u6ce8\u660e\u51fa\u5904\u3002</p>","tags":["mac","\u9ed1\u5c4f"]},{"location":"Misc/2018-01-27-sublime-text-%25e6%2594%25af%25e6%258c%2581gbk%25ef%25bc%2588%25e8%25a7%25a3%25e5%2586%25b3%25e4%25b8%25ad%25e6%2596%2587%25e4%25b9%25b1%25e7%25a0%2581%25ef%25bc%2589.html/","title":"Sublime Text \u652f\u6301GBK\uff08\u89e3\u51b3\u4e2d\u6587\u4e71\u7801\uff09","text":"<p>Sublime Text \u662f\u4e00\u6b3e\u65e2\u7b80\u6d01\u53c8\u5f3a\u5927\u7684\u6587\u672c\u7f16\u8f91\u5668\uff0c\u7136\u800c\u5176\u9ed8\u8ba4\u91c7\u7528UTF8\u7f16\u7801\uff0c\u8fd9\u5c31\u9020\u6210\u4e86\u8bb8\u591a\u91c7\u7528GBK\u7f16\u7801\u7684\u6587\u4ef6\u91cc\u7684\u4e2d\u6587\u663e\u793a\u4e3a\u4e71\u7801\u3002\u8fd8\u597d\u6709\u4e00\u4e2a\u4e13\u95e8\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u63d2\u4ef6\uff1aConvertToUTF8 \u3002</p> <p>\u5b89\u88c5\u65b9\u6cd5\u5982\u4e0b\uff1a</p> <ol> <li>\u6253\u5f00Sublime Text\uff0c\u6309Ctrl + ~\u6253\u5f00\u63a7\u5236\u53f0\uff0c\u5728\u00a0https://packagecontrol.io/installation\u00a0\u6839\u636e\u4f60\u7684 Sublime Text \u7248\u672c\u9009\u62e9\u5bf9\u5e94\u7684\u5b89\u88c5\u4ee3\u7801\uff0c\u5c06\u4ee3\u7801\u8f93\u5165\u63a7\u5236\u53f0\u540e\u56de\u8f66\uff0c\u4e4b\u540e\u4fbf\u4f1a\u81ea\u52a8\u4e0b\u8f7d\u5e76\u5b89\u88c5 Package Control\uff0c\u5b89\u88c5\u5b8c\u6210\u540e\u9700\u8981\u91cd\u542fSublime Text \u3002</li> <li>\u6309Ctrl +\u00a0Shift + P\u6253\u5f00\u4e07\u80fd\u641c\u7d22\u6846\uff0c\u7136\u540e\u8f93\u5165install package\u56de\u8f66\uff0c\u8fd9\u65f6\u5019\u4f1a\u52a0\u8f7d\u6240\u6709\u7684packages\u5217\u8868\u3002\u770b\u5230\u5217\u8868\u4e4b\u540e\u518d\u8f93\u5165ConvertToUTF8\u56de\u8f66\uff0c\u5c31\u4f1a\u4e0b\u8f7d\u5b89\u88c5\u8fd9\u4e2a\u5305\u4e86</li> <li>\u540c\u6837\u7684\u65b9\u5f0f\u5b89\u88c5Codecs33</li> </ol> <p> </p> <p>\u53c2\u8003\uff1ahttp://blog.csdn.net/jackeriss/article/details/44115813</p>","tags":["Sublime","\u4e71\u7801","GBK"]},{"location":"Misc/2018-05-05-using-vi-hex-editor.html/","title":"Using vi as a hex editor","text":"Source: http://www.kevssite.com/using-vi-as-a-hex-editor/ Written on April 21, 2009 by Kev  Sometimes I find it useful to switch to hex mode when editing a file in vi. The command for switching is not very obvious so thought I\u2019d share\u2026 <p>So, open a file in vi as usual. To switch into hex mode hit escape and type:</p> <pre><code>:%!xxd</code></pre> <p>And when your done and want to exit from hex mode hit escape again and type:</p> <pre><code>:%!xxd -r</code></pre> <p>Okay, so this isn\u2019t actaully switching to vi\u2019s \u2018hex mode\u2019; vi doesn\u2019t have one. What the above actually does is to stream vi\u2019s buffer through the external program \u2018xxd\u2019.</p> <p></p>","tags":["vi","hex","editor"]},{"location":"Misc/2018-11-17-install-skype-4-5-centos-7.html/","title":"Install Skype for Linux 4.5 on CentOS 7","text":"$ wget https://repo.skype.com/latest/skypeforlinux-64-alpha.rpm $ sudo yum install skypeforlinux-64-alpha.rpm Reference <p>https://www.techspot.com/downloads/4985-skype-for-linux.html https://www.centos.org/forums/viewtopic.php?t=47069</p>","tags":["linux","centos","Skype"]},{"location":"Misc/2018-12-01-install-fcitx-cloudpinyin-centos-7-5.html/","title":"Install fcitx-cloudpinyin on CentOS 7.5","text":"<p>1. \u5378\u8f7dibus yum remove ibus imsettings</p> <p>2. \u5b89\u88c5\u62fc\u97f3\u8f93\u5165\u6cd5</p> <p> yum install imsettings fcitx yum install fcitx-cloudpinyin fcitx-configtool imsettings-switch fcitx </p> <p>3. \u914d\u7f6eFcitx \u5728~/.bashrc\u4e2d\u6dfb\u52a0\u5982\u4e0b\u5185\u5bb9</p> <p> export GTK_IM_MODULE=fcitx export QT_IM_MODULE=fcitx export XMODIFIERS=\u201d@im=fcitx\u201d </p> <p>\u6253\u5f00fcitx\u7684\u914d\u7f6e\u5de5\u5177\uff0c\u9009\u62e9\u8f93\u5165\u6cd5\u6807\u7b7e\u70b9\u201d+\u201d\u53ef\u4ee5\u641c\u7d22\u5e76\u6dfb\u52a0\u8f93\u5165\u6cd5</p> <p>4. Logout &amp; Login</p> <p>Reference https://blog.csdn.net/maokexu123/article/details/44495395 </p>","tags":["centos","input","fcitx","pinyin"]},{"location":"Misc/2019-01-18-change-default-font-linux.html/","title":"How to change the default font of Linux","text":"<p>You'll need to edit/create the file\u00a0<code>~/.fonts.conf</code>.</p> <ul> <li>The file does not exist by default. However, if you've used things like Font Manager, then there might be a placeholder file at\u00a0<code>~/.fonts.conf</code>\u00a0telling you to use\u00a0<code>~/.config/font-manager/local.conf</code>\u00a0instead, in which case you should create the latter.</li> <li>You should first open\u00a0<code>~/.fonts.conf</code>\u00a0to check.</li> <li>To check if the file exists, a simple way would be to open the file manager, go to \"Home\", check \"View-&gt;Show Hidden Files\" and see if you can find\u00a0<code>.fonts.conf</code>.</li> </ul> <p>Once you've created the file, put the following code in it:</p> <pre><code>\n\n\n    \n        sans-serif\n        \n            Droid Sans\n            WenQuanYi Micro Hei Mono\n        \n    \n\n</code></pre> <p>What it does is create a font resolution fallback list. When a program is requesting a sans-serif font (most GUI fonts are sans-serif by default), the system would try to use the first font (Droid Sans) for a character. If the font does not support that character, the second (UKai) will be used. I'm not sure if specifying Droid Sans as the first preference has any significance, but you might as well keep it, just to be safe.</p> <p>Note also that you'll need to\u00a0logout\u00a0of your account and login again to see the effect.</p> <p> </p> <p>From</p> <p>https://askubuntu.com/questions/73721/how-do-i-change-the-default-chinese-font</p> <p></p> <p></p> <p></p>","tags":[]},{"location":"Misc/2019-07-06-centos7-4%25e5%25ae%2589%25e8%25a3%2585%25e7%25bd%2591%25e6%2598%2593%25e4%25ba%2591%25e9%259f%25b3%25e4%25b9%2590.html/","title":"Centos7.4\u5b89\u88c5\u7f51\u6613\u4e91\u97f3\u4e50","text":"<p>\u8f6c\u81ea\u300chttp://tieba.baidu.com/p/5593470159\u300d</p> <p>\u6b65\u9aa4\u5982\u4e0b\uff1a 1. \u524d\u5f80\u7f51\u6613\u4e91\u97f3\u4e50\u4e0b\u8f7d\u5730\u5740http://music.163.com/#/download\uff0c\u4e0b\u8f7d\u4e4c\u73ed\u56fe64\u4f4d\u7248\u672c\u5b89\u88c5\u7a0b\u5e8f\uff0c\u4f8b\u5982netease-cloud-music_1.1.0_amd64_ubuntu.deb\u3002</p> <p>2. \u89e3\u538bnetease-cloud-music_1.1.0_amd64_ubuntu.deb\u6587\u4ef6\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a sudo ar -vx netease-cloud-music_1.1.0_amd64_ubuntu.deb \u5f97\u5230\u5982\u4e0b\u4e09\u4e2a\u6587\u4ef6\uff1a x - debian-binary x - control.tar.gz x - data.tar.xz \u7ee7\u7eed\u89e3\u538bdata.tar.xz\u6587\u4ef6\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a sudo xz -dk data.tar.xz sudo tar -xvf data.tar \u89e3\u538b\u540e\u5f97\u5230\u7684usr\u76ee\u5f55\uff0c\u76ee\u5f55\u4e2d\u5305\u542bbin\u3001lib\u3001share\u4e09\u4e2a\u6587\u4ef6\u5939\u3002</p> <p>3. \u5c06\u8fd9\u4e2ausr\u6587\u4ef6\u5939\u653e\u5165\u5230CentOS7\u4e2d\u7684/usr\u76ee\u5f55\u4e0b\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a sudo cp -r usr/* /usr/</p> <p>4. \u5b89\u88c5vlc\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a sudo rpm -Uvh\u00a0http://li.nux.ro/download/nux/dextop/el7/x86_64/nux-dextop-release-0-1.el7.nux.noarch.rpm sudo yum update sudo yum install vlc</p> <p>5. \u5b89\u88c5libXScrnSaver\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a sudo yum install libXScrnSaver</p> <p>6. \u5b89\u88c5Anaconda\uff0c\u524d\u5f80https://www.anaconda.com/download/#download\u7f51\u7ad9\uff0c\u4e0b\u8f7dPython 3.6 version * \u201c64-Bit (x86) Installer (551 MB)\u201d\u6587\u4ef6\uff0c\u4f8b\u5982\u201cAnaconda3-5.1.0-Linux-x86_64.sh\u201d\uff0c\u4e0b\u8f7d\u5b8c\u6210\u540e\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a sudo sh Anaconda3-5.1.0-Linux-x86_64.sh \u7136\u540e\u4e00\u8defyes\uff0c\u76f4\u81f3\u5b89\u88c5\u7ed3\u675f\u3002</p> <p>7. \u67e5\u770b\u672c\u673alibgcc\u5e93\u4fe1\u606f\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a sudo strings /usr/lib64/libstdc++.so.6 | grep GLIBC \u53ef\u80fd\u4f1a\u663e\u793a\u5982\u4e0b\u4fe1\u606f\uff0c\u89c6\u5404\u4eba\u673a\u5668\u60c5\u51b5\uff1a GLIBCXX_3.4</p> <p>GLIBCXX_3.4.1</p> <p>GLIBCXX_3.4.2</p> <p>GLIBCXX_3.4.3</p> <p>GLIBCXX_3.4.4</p> <p>GLIBCXX_3.4.5</p> <p>GLIBCXX_3.4.6</p> <p>GLIBCXX_3.4.7</p> <p>GLIBCXX_3.4.8</p> <p>GLIBCXX_3.4.9</p> <p>GLIBCXX_3.4.10</p> <p>GLIBCXX_3.4.11</p> <p>GLIBCXX_3.4.12</p> <p>GLIBCXX_3.4.13</p> <p>GLIBCXX_FORCE_NEW</p> <p>GLIBCXX_DEBUG_MESSAGE_LENGTH \u4ee5\u4e0a\u4fe1\u606f\u53ef\u4ee5\u770b\u51fa\uff0cgcc\u7684\u52a8\u6001\u5e93\u8fd8\u662f\u65e7\u7248\u672c\u7684\uff0c\u8fd9\u4e2a\u4f1a\u5bfc\u81f4\u4e0d\u80fd\u6b63\u5e38\u5f00\u542f\u7f51\u6613\u4e91\u97f3\u4e50\u7a0b\u5e8f\u3002</p> <p>8. \u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff0c\u67e5\u627e\u672c\u673agcc\u7684\u6700\u65b0\u52a8\u6001\u5e93\uff1a find / -name \"libstdc++.so*\" \u6267\u884c\u5b8c\u4e0a\u9762\u547d\u4ee4\uff0c\u4f1a\u663e\u793a\u4e00\u5806\u672c\u673agcc\u52a8\u6001\u5e93\u4fe1\u606f\uff0c\u4ece\u4e2d\u627e\u5230\u5982\u4e0b\u4fe1\u606f\uff1a /root/anaconda3/lib/libstdc++.so.6.0.24 \u53ef\u4ee5\u770b\u51faanaconda3\u4e3a\u7b2c6\u6b65\u5b89\u88c5\u6240\u5f97\uff0c\u5c06libstdc++.so.6.0.24\u6587\u4ef6\u590d\u5236\u5230/usr/lib64\u76ee\u5f55\u4e0b\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a sudo cp /root/anaconda3/lib/libstdc++.so.6.0.24 /usr/lib64 \u5207\u6362\u5de5\u4f5c\u76ee\u5f55\u81f3/usr/lib64\uff0c\u6267\u884c\u547d\u4ee4\uff1a cd /usr/lib64 \u5220\u9664\u539f\u6765\u8f6f\u8fde\u63a5\uff0c\u6267\u884c\u547d\u4ee4\uff1a sudo rm -rf libstdc++.so.6 \u5c06\u9ed8\u8ba4\u5e93\u7684\u8f6f\u8fde\u63a5\u6307\u5411\u6700\u65b0\u52a8\u6001\u5e93\uff0c\u6267\u884c\u547d\u4ee4\uff1a ln -s libstdc++.so.6.0.24 libstdc++.so.6 \u518d\u4e00\u6b21\u6267\u884c\u547d\u4ee4\u68c0\u67e5gcc\u52a8\u6001\u5e93\u60c5\u51b5\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a strings /usr/lib64/libstdc++.so.6 | grep GLIBC \u663e\u793a\u5185\u5bb9\u5305\u542b\u5982\u4e0b\u4fe1\u606f\uff0c\u5219\u4ee3\u8868\u6700\u65b0gcc\u52a8\u6001\u5e93\u5df2\u7ecf\u5f15\u5165\uff1a GLIBCXX_3.4.12 GLIBCXX_3.4.13 GLIBCXX_3.4.14 GLIBCXX_3.4.15 GLIBCXX_3.4.16 GLIBCXX_3.4.17 GLIBCXX_3.4.18 GLIBCXX_3.4.19 GLIBCXX_3.4.20 GLIBCXX_3.4.21 GLIBCXX_3.4.22 GLIBCXX_3.4.23 GLIBCXX_3.4.24</p> <p>9. \u901a\u8fc7\u540e\u53f0\u65b9\u5f0f\u542f\u52a8\u7f51\u6613\u4e91\u97f3\u4e50\u7a0b\u5e8f\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a</p> <p>sudo /usr/bin/netease-cloud-music</p> <p>10. \u901a\u8fc7\u5feb\u6377\u65b9\u5f0f\u56fe\u6807\u542f\u52a8\u7f51\u6613\u4e91\u97f3\u4e50\u7a0b\u5e8f\uff0c\u53c2\u7167\u5982\u4e0b\u6b65\u9aa4\uff1a \u6267\u884c\u547d\u4ee4\uff1a sudo find / -name netease-cloud-music.svg \u5f97\u5230netease-cloud-music.svg\u6587\u4ef6\u8def\u5f84\u4fe1\u606f\uff0c\u5982\uff1a/usr/share/icons/hicolor/scalable/apps/netease-cloud-music.svg \u6267\u884c\u547d\u4ee4\uff1a</p> <p>sudo vim /usr/share/applications/netease-cloud-music.desktop \u4fee\u6539Icon\u56fe\u6807\u8def\u5f84\uff0c\u548cExec\u53ef\u6267\u884c\u547d\u4ee4\u8def\u5f84\uff0c\u5982\u4e0b\uff1a Icon=/usr/share/icons/hicolor/scalable/apps/netease-cloud-music.svg Exec=/usr/bin/netease-cloud-music %U \u4fee\u6539\u684c\u9762\u5feb\u6377\u65b9\u5f0f\u6743\u9650\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a</p> <p>sudo chmod u=rw,g=r,o=r /usr/share/applications/netease-cloud-music.desktop \u5b8c\u6210\u4ee5\u540e\uff0c\u5c06\u4f1a\u5728\u201c\u5e94\u7528\u7a0b\u5e8f\u201d-\u300b\u201c\u5f71\u97f3\u201d\u83dc\u5355\u4e2d\u770b\u5230\u201c\u7f51\u6613\u4e91\u97f3\u4e50\u201d\u56fe\u6807\uff0c\u70b9\u51fb\u5373\u53ef\u5f00\u542f\u7f51\u6613\u4e91\u97f3\u4e50\u7a0b\u5e8f\u3002</p>","tags":["centos","\u7f51\u6613\u4e91\u97f3\u4e50"]},{"location":"Misc/2020-01-10-how-to-mount-exfat-on-centos.html/","title":"How to mount exFAT on centos","text":"sudo yum install fuse-exfat exfat-utils","tags":["centos","exFAT"]},{"location":"Misc/2021-09-19-pretty-git-log-in-one-line/","title":"Pretty git log in one line","text":"<p>TL;DR;</p> <pre><code>git config --global alias.logline \"log --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset' --abbrev-commit\"\n\ngit logline\n</code></pre> <p>See https://ma.ttias.be/pretty-git-log-in-one-line/</p>","tags":["git"]},{"location":"Misc/2021-12-18-shell-script-to-put-file-in-a-ftp-server/","title":"Shell Script to Put File in a FTP Server","text":"<p>TL;DR;</p> <pre><code>#!/bin/bash\n\n# The 3 variables below store server and login details\nHOST=\"192.168.0.104\"\nUSER=\"user1\"\nPASSWORD=\"1234\"\n\n\n# $1 is the first argument to the script\n# We are using it as upload directory path\n# If it is '.', file is uploaded to current directory.\nDESTINATION=$1\n\n\n# Rest of the arguments are a list of files to be uploaded.\n# ${@:2} is an array of arguments without first one.\nALL_FILES=\"${@:2}\"\n\n\n# FTP login and upload is explained in paragraph below\nftp -inv $HOST &lt;&lt;EOF\nuser $USER $PASSWORD\ncd $DESTINATION\nmput $ALL_FILES\nbye\nEOF\n</code></pre> <p>The above script requires the following data:</p> <ol> <li>Server\u2019s hostname</li> <li>Server user\u2019s login details</li> <li>The directory in which to upload files on the server (passed as an argument to the script)</li> <li>The list of files to be uploaded to the server (passed as an argument to script)</li> </ol> <p>The options -inv can also be written as -i -n -v and their functions are explained in the below table:</p> Option Meaning -i Disable interactive mode, so that FTP will not ask for confirmation of each file while using mput command etc. We are using this for convenience while uploading or downloading files -n Disable auto-login. We have to do this, so we can manually log in using \u201cuser\u201d command inside the script -v Enables verbose mode. This helps us to see the server responses after executing each FTP command <p>To execute the script supply the upload directory and also a list of files:</p> <pre><code>./script_name.sh  path_to_upload file1 file2 file3\n</code></pre> <p>See https://www.geeksforgeeks.org/shell-script-to-put-file-in-a-ftp-server/</p>","tags":["ftp"]},{"location":"Misc/2021-12-27-how-to-configure-docker-tls-certs/","title":"How to configure docker TLS certs","text":"","tags":["docker","cert","tls"]},{"location":"Misc/2021-12-27-how-to-configure-docker-tls-certs/#1-generating-the-certs","title":"1. Generating the certs","text":"<p>Refer to the comment from BMitch <sup>1</sup>,  I wrote the shell script <code>make-certs</code> for generating the certs for both client and server sides.</p> <pre><code>curl -sSL -o make-certs https://raw.githubusercontent.com/cloudecho/util-script/master/cert/make-certs\nchmod +x make-certs\n</code></pre> <p>Use the script to generate the certs.</p> <p>Let's say the server dns name is <code>echoyun.demo</code>, and the server ip is <code>192.168.10.3</code></p> <pre><code>./make-certs -d3650 -J/CN=echoyun.demo -Sechoyun.demo -H192.168.10.3\n</code></pre>","tags":["docker","cert","tls"]},{"location":"Misc/2021-12-27-how-to-configure-docker-tls-certs/#2-configuration-of-the-client-side","title":"2. Configuration of the client-side","text":"<pre><code>cd echoyun.demo\nmkdir -p ~/.docker/certs\nsudo cp client-cert.pem ~/.docker/certs/cert.pem\nsudo cp client-key.pem ~/.docker/certs/key.pem \nsudo cp ca.pem ~/.docker/certs/ca.pem \n</code></pre> <p>Configure the envrionment variables by editing <code>~/.bash_profile</code> or <code>~/.profile</code></p> <pre><code>export DOCKER_TLS_VERIFY=\"1\"\nexport COMPOSE_TLS_VERSION=TLSv1_2\nexport DOCKER_HOST=\"tcp://echoyun.demo:2376\"\nexport DOCKER_CERT_PATH=\"$HOME/.docker/certs\"\n</code></pre> configure <code>/etc/hosts</code> if need <pre><code>192.168.10.3  echoyun.demo\n</code></pre>","tags":["docker","cert","tls"]},{"location":"Misc/2021-12-27-how-to-configure-docker-tls-certs/#3-configuration-of-the-server-side","title":"3. Configuration of the server-side","text":"<p>Copy the three files to the server which the docker daemon is runing on</p> <ul> <li><code>ca.pem</code></li> <li><code>server-cert.pem</code></li> <li><code>server-key.pem</code></li> </ul> <p>and put them under a diretory e.g. <code>/var/lib/docker/certs/</code></p> <p>Then configure the docker daemon:</p> <pre><code>sudo mkdir -p /etc/systemd/system/docker.service.d\n\ncat &lt;&lt;EOF | sudo tee /etc/systemd/system/docker.service.d/docker.conf \n[Service]\nExecStart=\nExecStart=/usr/bin/dockerd --containerd=/run/containerd/containerd.sock\nEOF\n\ncat &lt;&lt;EOF | sudo tee /etc/docker/daemon.json \n{\n  \"tls\": true,\n  \"tlscacert\": \"/var/lib/docker/certs/ca.pem\",\n  \"tlscert\": \"/var/lib/docker/certs/server-cert.pem\",\n  \"tlskey\": \"/var/lib/docker/certs/server-key.pem\",\n  \"hosts\": [\"fd://\", \"tcp://0.0.0.0:2376\"]\n} \nEOF\n</code></pre> <p>Remember to enable and start <code>containerd</code> if it hasn't been started:</p> <pre><code>sudo systemctl enable containerd\nsudo systemctl start containerd\nsystemctl status containerd\n</code></pre> <p>Finally, restart docker daemon:</p> <pre><code>sudo systemctl daemon-reload\nsudo systemctl restart docker\nsystemctl status docker\n</code></pre>","tags":["docker","cert","tls"]},{"location":"Misc/2021-12-27-how-to-configure-docker-tls-certs/#4-testing-on-the-client","title":"4. Testing on the client","text":"<pre><code>$ docker info\n... ...\n\nServer:\n Containers: 0\n  Running: 0\n  Paused: 0\n  Stopped: 0\n Images: 15\n Server Version: 20.10.11\n ... ...\n</code></pre>","tags":["docker","cert","tls"]},{"location":"Misc/2021-12-27-how-to-configure-docker-tls-certs/#reference","title":"Reference","text":"<ol> <li>https://stackoverflow.com/questions/38286564/docker-tls-verify-docker-host-and-docker-cert-path-on-ubuntu</li> <li>https://blog.cadena-it.com/linux-tips-how-to/configuring-ssl-requests-with-subjectaltname-with-openssl/</li> </ol>","tags":["docker","cert","tls"]}]}